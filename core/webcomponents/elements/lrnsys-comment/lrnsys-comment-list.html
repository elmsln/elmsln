<html><head><link rel="import" href="lrnsys-comment.html"><link rel="import" href="../iron-ajax/iron-ajax.html"><link rel="import" href="../iron-list/iron-list.html"><link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="import" href="../app-layout/app-layout.html"><link rel="import" href="../lrnsys-button/lrnsys-button.html"><link rel="import" href="../paper-toast/paper-toast.html"><link rel="import" href="../paper-dialog/paper-dialog.html"><link rel="import" href="../paper-input/paper-input.html"><link rel="import" href="../paper-button/paper-button.html"><link rel="import" href="../grafitto-filter/grafitto-filter.html"><link rel="import" href="../dropdown-select/dropdown-select.html"><link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html"><link rel="import" href="../paper-item/paper-item.html"><link rel="import" href="../paper-listbox/paper-listbox.html"><link rel="prefetch" href="../moment-element/moment-element.html"><link rel="prefetch" href="../polymer/polymer.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../moment-element/moment-import.html"><link rel="prefetch" href="../moment/min/moment.min.js"><link rel="prefetch" href="../materializecss-styles/colors.html"><link rel="prefetch" href="../iron-icons/editor-icons.html"><link rel="prefetch" href="../iron-icon/iron-icon.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../iron-iconset-svg/iron-iconset-svg.html"><link rel="prefetch" href="../marked-element/marked-element.html"><link rel="prefetch" href="../marked-element/marked-import.html"><link rel="prefetch" href="../marked/lib/marked.js"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-editor.html"><link rel="prefetch" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-control-generic-line.html"><link rel="prefetch" href="../iron-a11y-keys/iron-a11y-keys.html"><link rel="prefetch" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="prefetch" href="../paper-icon-button/paper-icon-button.html"><link rel="prefetch" href="../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../paper-ripple/paper-ripple.html"><link rel="prefetch" href="../paper-styles/default-theme.html"><link rel="prefetch" href="../paper-styles/color.html"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-control-line-behavior.html"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-control-behavior.html"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-control-generic-wrap.html"><link rel="prefetch" href="../mtz-marked-editor/mtz-marked-control-wrapper-behavior.html"><link rel="prefetch" href="../mtz-marked-editor/controls/mtz-marked-control-link.html"><link rel="prefetch" href="../paper-tooltip/paper-tooltip.html"><link rel="prefetch" href="../paper-card/paper-card.html"><link rel="prefetch" href="../iron-image/iron-image.html"><link rel="prefetch" href="../paper-styles/element-styles/paper-material-styles.html"><link rel="prefetch" href="../paper-styles/shadow.html"><link rel="prefetch" href="../paper-badge/paper-badge.html"><link rel="prefetch" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="prefetch" href="../paper-styles/typography.html"><link rel="prefetch" href="../font-roboto/roboto.html"><link rel="prefetch" href="../paper-behaviors/paper-button-behavior.html"><link rel="prefetch" href="../iron-icons/iron-icons.html"><link rel="prefetch" href="../lrndesign-avatar/lrndesign-avatar.html"><link rel="prefetch" href="../paper-avatar/paper-avatar.html"><link rel="prefetch" href="../paper-avatar/lib/jdenticon-1.4.0.min.js"><link rel="prefetch" href="../paper-avatar/lib/md5.min.js"><link rel="prefetch" href="../materializecss-styles/materializecss-styles.html"><link rel="prefetch" href="../materializecss-styles/shapes.html"><link rel="prefetch" href="../iron-ajax/iron-request.html"><link rel="prefetch" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><link rel="prefetch" href="../app-layout/helpers/helpers.html"><link rel="prefetch" href="../app-layout/app-drawer/app-drawer.html"><link rel="prefetch" href="../app-layout/app-drawer-layout/app-drawer-layout.html"><link rel="prefetch" href="../iron-media-query/iron-media-query.html"><link rel="prefetch" href="../app-layout/app-layout-behavior/app-layout-behavior.html"><link rel="prefetch" href="../app-layout/app-grid/app-grid-style.html"><link rel="prefetch" href="../app-layout/app-header/app-header.html"><link rel="prefetch" href="../app-layout/app-scroll-effects/app-scroll-effects-behavior.html"><link rel="prefetch" href="../app-layout/app-header-layout/app-header-layout.html"><link rel="prefetch" href="../app-layout/app-toolbar/app-toolbar.html"><link rel="prefetch" href="../app-layout/app-box/app-box.html"><link rel="prefetch" href="../iron-a11y-announcer/iron-a11y-announcer.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-behavior.html"><link rel="prefetch" href="../iron-fit-behavior/iron-fit-behavior.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-backdrop.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-scroll-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-focusables-helper.html"><link rel="prefetch" href="../neon-animation/neon-animation-runner-behavior.html"><link rel="prefetch" href="../neon-animation/neon-animatable-behavior.html"><link rel="prefetch" href="../paper-dialog-behavior/paper-dialog-behavior.html"><link rel="prefetch" href="../paper-dialog-behavior/paper-dialog-shared-styles.html"><link rel="prefetch" href="../iron-input/iron-input.html"><link rel="prefetch" href="../paper-input/paper-input-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-char-counter.html"><link rel="prefetch" href="../paper-input/paper-input-addon-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-container.html"><link rel="prefetch" href="../paper-input/paper-input-error.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown-scroll-manager.html"><link rel="prefetch" href="../neon-animation/animations/fade-in-animation.html"><link rel="prefetch" href="../neon-animation/neon-animation-behavior.html"><link rel="prefetch" href="../neon-animation/animations/fade-out-animation.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button-animations.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-icons.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-shared-styles.html"><link rel="prefetch" href="../paper-item/paper-item-behavior.html"><link rel="prefetch" href="../paper-item/paper-item-shared-styles.html"><link rel="prefetch" href="../iron-menu-behavior/iron-menu-behavior.html"><link rel="prefetch" href="../iron-selector/iron-multi-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selection.html"><link rel="prefetch" href="../web-animations-js/web-animations-next-lite.min.html"><link rel="prefetch" href="../web-animations-js/web-animations-next-lite.min.js"></head><body><dom-module id="lrnsys-comment-list"><template><style>:host{display:block;}app-toolbar{padding:0;}app-toolbar > *:not(:last-child){margin-right:10px;}</style><iron-ajax auto="" url="[[sourcePath]]" handle-as="json" last-response="{{comments}}"></iron-ajax><iron-ajax id="ajaxCreateStub" url="[[createStubUrl]]" method="POST" body="[[activeComment.id]]" on-response="_updateReply" last-response="{{newComment}}" handle-as="json"></iron-ajax><iron-ajax id="ajaxUpdateRequest" url="[[reqUrl]]" method="PUT" body="[[activeComment]]" content-type="application/json" handle-as="json" on-response="_handleUpdateResponse"></iron-ajax><iron-ajax id="ajaxDeleteRequest" url="[[reqUrl]]" method="DELETE" body="[[activeComment]]" content-type="application/json" handle-as="json" on-response="_handleDeleteResponse"></iron-ajax><iron-ajax id="ajaxLikeRequest" url="[[reqUrl]]" method="PATCH" body="[[activeComment]]" content-type="application/json" handle-as="json" on-response="_handleLikeResponse"></iron-ajax><app-toolbar><lrnsys-button class="comment-button" raised="" on-click="handleTopReply" id="leave-comment" hover-class="blue white-text" label="Add Comment"></lrnsys-button><dropdown-select id="filter-type" label="Filter Comments by" value="attributes.body"><paper-item value="attributes.body">Body</paper-item><paper-item value="relationships.author.data.name">User Name</paper-item></dropdown-select><paper-input label="Filter Text" id="filter-comments" aria-controls="filtered-comments" value="" always-float-label=""></paper-input></app-toolbar><grafitto-filter id="filtered-comments" items$="[[_toArray(comments.data)]]" where="" as="filtered" like=""><template><iron-list id="comment-list" items$="[[filtered]]" as="item"><template><lrnsys-comment comment="{{item}}" hover-class="blue white-text"></lrnsys-comment></template></iron-list></template></grafitto-filter><paper-toast text="Updated" id="toast"></paper-toast><paper-dialog id="deleteaction" modal=""><h3>Delete comment</h3><p>Are you sure you want to delete your comment?</p><div class="buttons"><paper-button dialog-dismiss="">Decline</paper-button><paper-button on-click="_handleDeleteConfirm" dialog-confirm="" autofocus="">Accept</paper-button></div></paper-dialog></template><script>var _Polymer;Polymer((_Polymer={is:'lrnsys-comment-list',listeners:{"comment-save":'handleSave',"comment-editing":'handleEditing',"comment-reply":'handleReply',"comment-like":'handleLike',"comment-delete-dialog":'handleDeleteDialog'},properties:{csrfToken:{type:String},activeComment:{type:Object,notify:!0},newComment:{type:Object,notify:!0},comments:{type:Object,notify:!0},sourcePath:{type:String,notify:!0,reflectToAttribute:!0},commentOpsBase:{type:String,notify:!0,reflectToAttribute:!0},createStubUrl:{type:String,notify:!0,reflectToAttribute:!0},reqUrl:{type:String,notify:!0,computed:'_computeCommentOpsUrl(activeComment, commentOpsBase, csrfToken)'}},ready:function(){var a=this;a.$$('#filtered-comments').$$('#comment-list').fire('iron-resize'),a.$$('#filter-comments').addEventListener('value-changed',function(b){a.$$('#filtered-comments').like=b.target.value}),a.$$('#filter-type').addEventListener('change',function(b){a.$$('#filter-comments').value='',a.$$('#filtered-comments').where=b.detail.value,a.$$('#filtered-comments').like=''})},_computeCommentOpsUrl:function(a,b,c){return b+'/'+a.id+'?token='+c},handleLike:function(a){var b=this;b.activeComment=a.detail.comment,this.$.ajaxLikeRequest.generateRequest()}},babelHelpers.defineProperty(_Polymer,'handleLike',function(a){var b=this;b.activeComment=a.detail.comment,this.$.ajaxLikeRequest.generateRequest()}),babelHelpers.defineProperty(_Polymer,'_handleLikeResponse',function(){}),babelHelpers.defineProperty(_Polymer,'handleDeleteDialog',function(a){var b=this;b.activeComment=a.detail.comment,document.body.appendChild(b.$.deleteaction),b.$.deleteaction.open()}),babelHelpers.defineProperty(_Polymer,'handleEditing',function(){var a=this;a.$.toast.text='Be awesome to each other',a.$.toast.toggle()}),babelHelpers.defineProperty(_Polymer,'handleTopReply',function(){var a=this;a.set('newComment',[]),a.set('activeComment',[]),a.$.ajaxCreateStub.generateRequest()}),babelHelpers.defineProperty(_Polymer,'handleReply',function(a){var b=this;b.set('newComment',[]),b.activeComment=a.detail.comment,b.$.ajaxCreateStub.generateRequest()}),babelHelpers.defineProperty(_Polymer,'_updateReply',function(){var a=this,b=a.activeComment,c=a.comments.data;if(a.newComment=a.newComment.data,0==c.length)c.push(a.newComment);else if(babelHelpers.typeof(b.id)=='undefined')c.push(a.newComment);else for(var d=0;d<c.length;d++)c[d].id==b.id&&c.splice(d+1,0,a.newComment);a.activeComment=a.newComment,a.set('comments.data',[]),a.set('comments.data',c)}),babelHelpers.defineProperty(_Polymer,'_handleDeleteConfirm',function(){this.$.ajaxDeleteRequest.generateRequest()}),babelHelpers.defineProperty(_Polymer,'_handleDeleteResponse',function(){for(var a=this,b=a.activeComment,c=a.comments.data,d=0;d<c.length;d++)if(c[d].id==b.id)return c.splice(d,1),a.set('activeComment',[]),a.set('comments.data',[]),a.set('comments.data',c),a.$.toast.text='Comment deleted',a.$.toast.toggle(),!0}),babelHelpers.defineProperty(_Polymer,'handleSave',function(a){var b=this;b.activeComment=a.detail.comment,this.$.ajaxUpdateRequest.generateRequest()}),babelHelpers.defineProperty(_Polymer,'_handleUpdateResponse',function(){this.$.toast.text='Comment saved!',this.$.toast.toggle()}),babelHelpers.defineProperty(_Polymer,'_toArray',function(a){return Object.keys(a).map(function(b){return a[b]})}),_Polymer));</script></dom-module></body></html>