<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="marked-import.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../marked/lib/marked.js"></head><body><dom-module id="marked-element"><template><style>:host{display:block;}</style><slot name="markdown-html"><div id="content"></div></slot></template></dom-module><script>'use strict';Polymer({is:'marked-element',properties:{markdown:{type:String,value:null},breaks:{type:Boolean,value:!1},pedantic:{type:Boolean,value:!1},renderer:{type:Function,value:null},sanitize:{type:Boolean,value:!1},sanitizer:{type:Function,value:null},disableRemoteSanitization:{type:Boolean,value:!1},smartypants:{type:Boolean,value:!1},callback:{type:Function,value:null},xhr:{type:Object,notify:!0,readOnly:!0}},observers:['render(markdown, breaks, pedantic, renderer, sanitize, sanitizer, smartypants, callback)'],ready:function(){if(!this.markdown&&(this._markdownElement=Polymer.dom(this).querySelector('[type="text/markdown"]'),!!this._markdownElement)){this._markdownElement.src&&this._request(this._markdownElement.src),''!==this._markdownElement.textContent.trim()&&(this.markdown=this._unindent(this._markdownElement.textContent));var a=new MutationObserver(this._onScriptAttributeChanged.bind(this));a.observe(this._markdownElement,{attributes:!0})}},attached:function(){this._attached=!0,this._outputElement=this.outputElement,this.render()},detached:function(){this._attached=!1},unindent:function(a){return this._unindent(a)},get outputElement(){var a=Polymer.dom(this).queryDistributedElements('[slot="markdown-html"]')[0];return a||this.$.content},render:function(){if(this._attached){if(!this.markdown)return void(Polymer.dom(this._outputElement).innerHTML='');var a=new marked.Renderer;this.renderer&&this.renderer(a);var b={renderer:a,highlight:this._highlight.bind(this),breaks:this.breaks,sanitize:this.sanitize,sanitizer:this.sanitizer,pedantic:this.pedantic,smartypants:this.smartypants};Polymer.dom(this._outputElement).innerHTML=marked(this.markdown,b,this.callback),this.fire('marked-render-complete',{},{composed:!0})}},_highlight:function(a,b){var c=this.fire('syntax-highlight',{code:a,lang:b},{composed:!0});return c.detail.code||a},_unindent:function(a){if(!a)return a;var b=a.replace(/\t/g,'  ').split('\n'),c=b.reduce(function(a,b){if(/^\s*$/.test(b))return a;var c=b.match(/^(\s*)/)[0].length;return null===a?c:c<a?c:a},null);return b.map(function(a){return a.substr(c)}).join('\n')},_request:function(a){this._setXhr(new XMLHttpRequest);var b=this.xhr;return 0<b.readyState?null:void(b.addEventListener('error',this._handleError.bind(this)),b.addEventListener('loadend',function(a){var b=this.xhr.status||0;0===b||200<=b&&300>b?(this.sanitize=!this.disableRemoteSanitization,this.markdown=a.target.response):this._handleError(a),this.fire('marked-loadend',a)}.bind(this)),b.open('GET',a),b.setRequestHeader('Accept','text/markdown'),b.send())},_handleError:function(a){var b=this.fire('marked-request-error',a,{cancelable:!0});b.defaultPrevented||(this.markdown='Failed loading markdown source')},_onScriptAttributeChanged:function(a){'src'!==a[0].attributeName||this._request(this._markdownElement.src)}});</script></body></html>