<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>hax-body demo</title>

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

    <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
    <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
    <link rel="import" href="../hax-body.html">
    <link rel="import" href="../../hax-panel/hax-panel.html">
    <link rel="import" href="../../lrnsys-layout/lrnsys-dialog.html">
    <link rel="import" href="../../paper-toast/paper-toast.html">

    <style is="custom-style" include="demo-pages-shared-styles">
      .vertical-section-container {
        max-width: 60em;
        margin-left: 20em;
      }
      hax-panel {
        font-size: .8rem;
      }
      hax-panel {
      --app-drawer-content-container: {
          background-color: #fafafa;
          padding: 0;
          border-right: 1px solid #c8c8c8;
          overflow-y: scroll;
          width: 300px !important;
          box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);
          height: 100vh;
          top: 0;
          position: sticky;
        }
      }
    </style>
  </head>
  <body>
    <div class="vertical-section-container">
      <h3>Basic hax-body demo</h3>
      <demo-snippet>
        <template is="dom-bind">
          <hax-body id="body" edit-mode>
            <h2>Heading 2</h2>
            <p>A whole bunch of text in here that's awesome!</p>
            <h3>Heading 3</h3>
            <p>A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!</p>
            <p>Another paragraph that's a bit of a break from a whole bunch of text in here that's awesome!</p>
          </hax-body>

          <!-- potential wiring to make this work -->
          <hax-panel id="panel" opened show-advanced>
            <span slot="post">
              <lrnsys-collapselist-item>
              <span slot="label"><div class="label">Engagements</div></span>
              <span slot="content">
                <hax-panel-item
                  icon="touch-app"
                  icon-class="blue-text"
                  label="Interactive video"
                  event-name="h5p-interactive-video"
                  voice-command="insert interactive video"></hax-panel-item>
                <hax-panel-item
                  icon="hardware:videogame-asset"
                  icon-class="red-text"
                  label="Self-check"
                  event-name="h5p-multiple-choice"
                  voice-command="insert self check"></hax-panel-item>
                <hax-panel-item
                  icon="timeline"
                  icon-class="yellow-text text-darken-4"
                  label="Timeline"
                  event-name="timeline"
                  voice-command="insert timeline"></hax-panel-item>
                <hax-panel-item
                  icon="maps:place"
                  icon-class="green-text"
                  label="Map"
                  event-name="map"
                  voice-command="insert map"></hax-panel-item>
                <hax-panel-item
                  icon="social:share"
                  icon-class="pink-text"
                  label="JMOL"
                  event-name="jmol"
                  voice-command="insert molecule"></hax-panel-item>
                <hax-panel-item
                  icon="social:poll"
                  icon-class="orange-text"
                  label="Poll"
                  event-name="poll"
                  voice-command="insert poll"></hax-panel-item>
              </span>
            </lrnsys-collapselist-item>
            <lrnsys-collapselist-item>
              <span slot="label"><div class="label">Assessments</div></span>
              <span slot="content">
                <hax-panel-item
                  icon="assignment"
                  icon-class="yellow-text text-darken-2"
                  label="Assignment"
                  event-name="assignment"
                  voice-command="insert assignment"></hax-panel-item>
                <hax-panel-item
                  icon="assessment"
                  icon-class="purple-text text-darken-2"
                  label="Quiz"
                  event-name="quiz"
                  voice-command="insert quiz"></hax-panel-item>
              </span>
            </lrnsys-collapselist-item>
          </span>
          </hax-panel>
          <paper-toast id="toast"></paper-toast>
          <paper-button id="togglebutton">Enabled</paper-button>
          <lrnsys-dialog body-append id="dialog" title="See HTML">
            <h2 slot="header">HTML generated</h2>
            <div>
              <textarea id="textarea" rows="20" style="width:100%;"></textarea>
            </div>
          </lrnsys-dialog>
          <script>
            var p = document.querySelector('#panel');
            var b = document.querySelector('#body');
            var button = document.querySelector('#togglebutton');
            // alert if there was an error loading content
            p.addEventListener('hax-content-insert', function(e) {
              document.querySelector('#toast').show(e.detail.eventName);
              var properties = {};
              // support for properties to be set automatically optionally
              if (typeof e.detail.properties !== typeof undefined) {
                properties = e.detail.properties;
              }
              b.haxInsert(e.detail.tag, e.detail.content, properties);
            });
            // alert if there was an error loading content
            p.addEventListener('hax-item-selected', function(e) {
              document.querySelector('#toast').show(e.detail.eventName);
              if (e.detail.eventName === 'advanced-import-export') {
                let content = b.haxToContent();
                document.querySelector('#textarea').innerHTML = content;
                document.querySelector('#dialog').toggleDialog();
              }
            });
            // alert if there was an error loading content
            b.addEventListener('hax-body-tag-removed', function(e) {
              document.querySelector('#toast').show('deleted ' + e.detail.node.tagName);
            });
            // simple toggle for state to ensure it matches
            button.addEventListener('click', function(e) {
              window.open = !window.open;
              p.opened = window.open;
              b.editMode = window.open;
            });
          </script>
        </template>
      </demo-snippet>
    </div>
  </body>
</html>
