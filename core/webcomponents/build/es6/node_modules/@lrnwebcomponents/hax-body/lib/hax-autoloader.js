import{html,PolymerElement}from"../../../@polymer/polymer/polymer-element.js";import*as async from"../../../@polymer/polymer/lib/utils/async.js";import{FlattenedNodesObserver}from"../../../@polymer/polymer/lib/utils/flattened-nodes-observer.js";import{pathFromUrl}from"../../../@polymer/polymer/lib/utils/resolve-url.js";import{HAXElement}from"../../hax-body-behaviors/hax-body-behaviors.js";class HaxAutoloader extends(HAXElement(PolymerElement)){static get template(){return html`
      <style>
        :host {
          display: none;
        }
      </style>
      <slot></slot>
    `}static get tag(){return"hax-autoloader"}static get properties(){return{processedList:{type:Object,value:{}}}}ready(){super.ready(),this.dispatchEvent(new CustomEvent("hax-register-autoloader",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),this._observer=new FlattenedNodesObserver(this,info=>{info.addedNodes.length>0&&async.microTask.run(()=>{this.processNewElements(info.addedNodes)})})}processNewElements(e){let effectiveChildren=FlattenedNodesObserver.getFlattenedNodes(this).filter(n=>n.nodeType===Node.ELEMENT_NODE);for(var i=0;i<effectiveChildren.length;i++)if(void 0!==effectiveChildren[i].tagName&&void 0===this.processedList[effectiveChildren[i].tagName])try{let name=effectiveChildren[i].tagName.toLowerCase();if("function"==typeof effectiveChildren[i].getHaxProperties){const evt=new CustomEvent("hax-register-properties",{bubbles:!0,composed:!0,cancelable:!0,detail:{tag:name,properties:effectiveChildren[i].getHaxProperties(),polymer:!0}});context.dispatchEvent(evt)}else if("function"==typeof effectiveChildren[i].HAXWiring){const evt=new CustomEvent("hax-register-properties",{bubbles:!0,cancelable:!0,composed:!0,detail:{tag:name,properties:effectiveChildren[i].HAXWiring.getHaxProperties(),polymer:!1}});context.dispatchEvent(evt)}else{const basePath=pathFromUrl(decodeURIComponent(import.meta.url));import(`${basePath}../../${name}/${name}.js`).then(response=>{let CEClass=window.customElements.get(name);"function"==typeof CEClass.getHaxProperties?this.setHaxProperties(CEClass.getHaxProperties(),name):"function"==typeof CEClass.HAXWiring?this.setHaxProperties(CEClass.HAXWiring.getHaxProperties(),name):CEClass.haxProperties?this.setHaxProperties(CEClass.haxProperties,name):console.log(`${name} didn't have hax wiring in the end`)}).catch(error=>{console.log(error)})}this.processedList[name]=name}catch(err){}}}window.customElements.define(HaxAutoloader.tag,HaxAutoloader);export{HaxAutoloader};