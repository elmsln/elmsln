define(["exports","../../@polymer/polymer/polymer-legacy.js","../../@polymer/polymer/lib/legacy/polymer.dom.js","../../@polymer/polymer/lib/utils/async.js","../../@polymer/iron-a11y-keys/iron-a11y-keys.js","../../@polymer/paper-icon-button/paper-icon-button.js","../../@polymer/iron-icons/iron-icons.js","../hax-body-behaviors/lib/HAXWiring.js","../responsive-utility/responsive-utility.js"],function(_exports,_polymerLegacy,_polymerDom,async){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.GridPlate=void 0;async=babelHelpers.interopRequireWildcard(async);function _templateObject_1a6d9050499a11e9853aab77594e37fb(){var data=babelHelpers.taggedTemplateLiteral(["\n    <custom-style>\n      <style is=\"custom-style\" include=\"simple-colors\">\n        :host {\n          display: block;\n          --grid-plate-row-margin: 0px;\n          --grid-plate-row-padding: 0px;\n          --grid-plate-item-margin: 15px;\n          --grid-plate-editable-border-color: #ccc;\n          --grid-plate-active-border-color: #6cd;\n        }\n        :host .row {\n          width: 100%;\n          display: flex;\n          flex-wrap: wrap;\n          justify-content: space-between;\n          align-items: stretch;\n          margin: var(--grid-plate-row-margin);\n          padding: var(--grid-plate-row-padding);\n        }\n        :host .column {\n          width: 100%;\n          flex: 0 0 auto;\n          transition: all 0.5s;\n        }\n        :host([edit-mode]) .column {\n          min-height: 150px;\n        }\n\n        :host([edit-mode]) .column {\n          outline: 1px dotted var(--grid-plate-editable-border-color);\n        }\n        :host .column[style=\"min-height: unset\"] {\n          display: none;\n        }\n        :host([edit-mode]) .column[style=\"min-height: unset\"]:not(:empty) {\n          display: block;\n          outline: 1px solid red;\n          width: 20%;\n          margin-top: var(--grid-plate-item-margin);\n        }\n        :host([edit-mode])\n          .column[style=\"min-height: unset\"]:not(:empty):before {\n          content: \"Hidden Column (\" attr(id) \")\";\n          color: red;\n          margin: var(--grid-plate-item-margin);\n          padding: 15px 0;\n          min-height: 150px;\n        }\n        :host ::slotted(*) {\n          margin: var(--grid-plate-item-margin);\n          padding: 0;\n        }\n        :host ::slotted(*.mover) {\n          outline: 2px dashed var(--grid-plate-editable-border-color);\n          outline-offset: 4px;\n        }\n        :host ::slotted(*.active-item) {\n          outline: 2px dashed var(--grid-plate-active-border-color);\n          outline-offset: 4px;\n        }\n        :host ::slotted(*[data-draggable]:focus),\n        :host ::slotted(*[data-draggable]:hover),\n        :host ::slotted(*[data-draggable]:active) {\n          cursor: move;\n        }\n\n        :host([edit-mode]) .column.mover {\n          background-color: yellow;\n        }\n        :host .column[data-draggable].mover {\n          background-color: pink;\n        }\n\n        paper-icon-button {\n          display: none;\n          position: absolute;\n          margin: 0;\n          padding: 0;\n          outline: none;\n          width: 20px;\n          height: 20px;\n          color: black;\n          background-color: #eeeeee;\n          border-radius: 50%;\n          box-sizing: content-box !important;\n          z-index: 1;\n          min-width: unset;\n        }\n\n        paper-icon-button[disabled] {\n          color: #aaa;\n          background-color: #ddd;\n        }\n        paper-icon-button[disabled]:focus,\n        paper-icon-button[disabled]:hover {\n          cursor: not-allowed;\n        }\n        paper-icon-button.active {\n          display: block;\n        }\n\n        .button-holding-pen {\n          position: relative;\n        }\n      </style>\n    </custom-style>\n    <div class=\"button-holding-pen\">\n      <paper-icon-button\n        icon=\"icons:arrow-upward\"\n        title=\"move item up\"\n        id=\"up\"\n        on-tap=\"moveActiveElement\"\n      >\n      </paper-icon-button>\n      <paper-icon-button\n        icon=\"icons:arrow-forward\"\n        title=\"move item right\"\n        id=\"right\"\n        on-tap=\"moveActiveElement\"\n      >\n      </paper-icon-button>\n      <paper-icon-button\n        icon=\"icons:arrow-downward\"\n        title=\"move item down\"\n        id=\"down\"\n        on-tap=\"moveActiveElement\"\n      >\n      </paper-icon-button>\n      <paper-icon-button\n        icon=\"icons:arrow-back\"\n        title=\"move item left\"\n        id=\"left\"\n        on-tap=\"moveActiveElement\"\n      >\n      </paper-icon-button>\n    </div>\n    <div class=\"row\">\n      <div\n        class=\"column\"\n        id=\"col1\"\n        style$=\"[[_getColumnWidth(0,columnWidths)]]\"\n      >\n        <slot name=\"col-1\"></slot>\n      </div>\n      <div\n        class=\"column\"\n        id=\"col2\"\n        style$=\"[[_getColumnWidth(1,columnWidths)]]\"\n      >\n        <slot name=\"col-2\"></slot>\n      </div>\n      <div\n        class=\"column\"\n        id=\"col3\"\n        style$=\"[[_getColumnWidth(2,columnWidths)]]\"\n      >\n        <slot name=\"col-3\"></slot>\n      </div>\n      <div\n        class=\"column\"\n        id=\"col4\"\n        style$=\"[[_getColumnWidth(3,columnWidths)]]\"\n      >\n        <slot name=\"col-4\"></slot>\n      </div>\n      <div\n        class=\"column\"\n        id=\"col5\"\n        style$=\"[[_getColumnWidth(4,columnWidths)]]\"\n      >\n        <slot name=\"col-5\"></slot>\n      </div>\n      <div\n        class=\"column\"\n        id=\"col6\"\n        style$=\"[[_getColumnWidth(5,columnWidths)]]\"\n      >\n        <slot name=\"col-6\"></slot>\n      </div>\n    </div>\n    <iron-a11y-keys\n      stop-keyboard-event-propagation\n      target=\"[[__activeItem]]\"\n      keys=\"enter\"\n      on-keys-pressed=\"setActiveElement\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__activeItem]]\"\n      keys=\"esc\"\n      on-keys-pressed=\"cancelActive\"\n    ></iron-a11y-keys>\n  "]);_templateObject_1a6d9050499a11e9853aab77594e37fb=function(){return data};return data}var GridPlate=(0,_polymerLegacy.Polymer)({_template:(0,_polymerLegacy.html)(_templateObject_1a6d9050499a11e9853aab77594e37fb()),is:"grid-plate",listeners:{focusin:"_focusIn",focusout:"_focusOut"},behaviors:[HAXBehaviors.PropertiesBehaviors],properties:{breakpointSm:{type:Number,value:900},breakpointMd:{type:Number,value:1200},breakpointLg:{type:Number,value:1500},breakpointXl:{type:Number,value:1800},columns:{type:Number,computed:"_getColumns(columnWidths)",reflectToAttribute:!0},columnWidths:{type:String,computed:"_getColumnWidths(responsiveSize,layout,layouts,disableResponsive)"},disableResponsive:{type:Boolean,value:!1,notify:!0},editMode:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_editModeChanged"},layout:{type:String,value:"1-1",reflectToAttribute:!0},layouts:{type:Object,value:{1:{columnLayout:"1: full width",xs:["100%"],sm:["100%"],md:["100%"],lg:["100%"],xl:["100%"]},"1-1":{columnLayout:"2: equal width",xs:["100%","100%"],sm:["50%","50%"],md:["50%","50%"],lg:["50%","50%"],xl:["50%","50%"]},"2-1":{columnLayout:"2: wide & narrow",xs:["100%","100%"],sm:["50%","50%"],md:["66.6666667%","33.3333337%"],lg:["66.6666667%","33.3333337%"],xl:["66.6666667%","33.3333337%"]},"1-2":{columnLayout:"2: narrow & wide",xs:["100%","100%"],sm:["50%","50%"],md:["33.3333333%","66.6666667%"],lg:["33.3333333%","66.6666667%"],xl:["33.3333333%","66.6666667%"]},"3-1":{columnLayout:"2: wider & narrower",xs:["100%","100%"],sm:["50%","50%"],md:["75%","25%"],lg:["75%","25%"],xl:["75%","25%"]},"1-3":{columnLayout:"2: narrower & wider",xs:["100%","100%"],sm:["50%","50%"],md:["25%","75%"],lg:["25%","75%"],xl:["25%","75%"]},"1-1-1":{columnLayout:"3: equal width",xs:["100%","100%","100%"],sm:["100%","100%","100%"],md:["33.3333333%","33.3333333%","33.3333333%"],lg:["33.3333333%","33.3333333%","33.3333333%"],xl:["33.3333333%","33.3333333%","33.3333333%"]},"2-1-1":{columnLayout:"3: wide, narrow, and narrow",xs:["100%","100%","100%"],sm:["100%","50%","50%"],md:["50%","25%","25%"],lg:["50%","25%","25%"],xl:["50%","25%","25%"]},"1-2-1":{columnLayout:"3: narrow, wide, and narrow",xs:["100%","100%","100%"],sm:["100%","100%","100%"],md:["25%","50%","25%"],lg:["25%","50%","25%"],xl:["25%","50%","25%"]},"1-1-2":{columnLayout:"3: narrow, narrow, and wide",xs:["100%","100%","100%"],sm:["50%","50%","100%"],md:["25%","25%","50%"],lg:["25%","25%","50%"],xl:["25%","25%","50%"]},"1-1-1-1":{columnLayout:"4: equal width",xs:["100%","100%","100%","100%"],sm:["50%","50%","50%","50%"],md:["25%","25%","25%","25%"],lg:["25%","25%","25%","25%"],xl:["25%","25%","25%","25%"]},"1-1-1-1-1":{columnLayout:"5: equal width",xs:["100%","100%","100%","100%","100%"],sm:["50%","50%","50%","50%","50%"],md:["20%","20%","20%","20%","20%"],lg:["20%","20%","20%","20%","20%"],xl:["20%","20%","20%","20%","20%"]},"1-1-1-1-1-1":{columnLayout:"6: equal width",xs:["100%","100%","100%","100%","100%","100%"],sm:["50%","50%","50%","50%","50%","50%"],md:["33.3333333%","33.3333333%","33.3333333%","33.3333333%","33.3333333%","33.3333333%"],lg:["16.6666667%","16.6666667%","16.6666667%","16.6666667%","16.6666667%","16.6666667%"],xl:["16.6666667%","16.6666667%","16.6666667%","16.6666667%","16.6666667%","16.6666667%"]}}},responsiveSize:{type:String,value:"xs",reflectToAttribute:!0},__activeItem:{type:Object,observer:"_activeItemChanged"}},cancelActive:function cancelActive(){this.__activeItem=null},canMoveSlot:function canMoveSlot(item,before){var dir=before?-1:1,max=this.shadowRoot.querySelectorAll(".column").length,col=item.getAttribute("slot").split("-"),dest=parseInt(col[1])+dir;return 1<=dest&&dest<=max},moveSlot:function moveSlot(item,before){var dir=before?-1:1,col=item.getAttribute("slot").split("-"),dest=parseInt(col[1])+dir;if(this.canMoveSlot(item,dir)){item.setAttribute("slot","col-"+dest)}},canMoveOrder:function canMoveOrder(item,before){var target=before?item.previousElementSibling:item.nextElementSibling;return null!==target&&target.getAttribute("slot")===item.getAttribute("slot")},moveOrder:function moveOrder(item){var before=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0,dir=before?-1:1;if(this.canMoveOrder(item,before)){if(before){(0,_polymerDom.dom)(this).insertBefore(this.__activeItem,this.__activeItem.previousElementSibling)}else{(0,_polymerDom.dom)(this).insertBefore(this.__activeItem.nextElementSibling,this.__activeItem)}}},moveActiveElement:function moveActiveElement(e){var _this=this,normalizedEvent=(0,_polymerDom.dom)(e),local=normalizedEvent.localTarget;switch(local.id){case"up":this.moveOrder(this.__activeItem,!0);break;case"down":this.moveOrder(this.__activeItem,!1);break;case"left":this.moveSlot(this.__activeItem,!0);break;case"right":this.moveSlot(this.__activeItem,!1);break;}setTimeout(function(){if(_this.__activeItem&&"function"===typeof _this.__activeItem.focus){_this.positionArrows(_this.__activeItem);_this.__activeItem.focus()}},100)},_activeItemChanged:function _activeItemChanged(newValue,oldValue){if(babelHelpers.typeof(newValue)!=="undefined"&&null!=newValue){newValue.classList.add("active-item");this.positionArrows(newValue)}else if(null==newValue){this.positionArrows(newValue)}if(babelHelpers.typeof(oldValue)!=="undefined"&&null!=oldValue){oldValue.classList.remove("active-item");oldValue.blur()}},setActiveElement:function setActiveElement(e){this.$.right.focus();e.preventDefault();e.stopPropagation()},_getColumnWidths:function _getColumnWidths(){var responsiveSize=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"sm",layout=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"1-1",layouts=2<arguments.length?arguments[2]:void 0,disableResponsive=3<arguments.length?arguments[3]:void 0,newl=layouts[layout],oldl={12:"1","8/4":"2-1","6/6":"1-1","4/8":"1-2","4/4/4":"1-1-1","3/3/3/3":"1-1-1-1"}[layout],size=!1!==disableResponsive?"xl":responsiveSize;if(newl!==void 0&&newl[size]!==void 0){return layouts[layout][size]}else if(layouts[oldl]!==void 0&&layouts[oldl][size]!==void 0){return layouts[oldl][size]}else{return layouts["1-1"][size]}},_getColumnWidth:function _getColumnWidth(column,columnWidths){return columnWidths!==void 0&&columnWidths[column]!==void 0?"width:"+columnWidths[column]:"min-height: unset"},_getColumns:function _getColumns(columnWidths){return columnWidths.length},_focusIn:function _focusIn(e){if(this.editMode){var normalizedEvent=(0,_polymerDom.dom)(e),local=normalizedEvent.localTarget;if((0,_polymerDom.dom)(local).parentNode===this){this.__activeItem=local}}},_focusOut:function _focusOut(e){if(this.editMode){var normalizedEvent=(0,_polymerDom.dom)(e),local=normalizedEvent.localTarget;if(local.parentNode===this||document.activeElement.parentNode===this||document.activeElement===this){}}},positionArrows:function positionArrows(item){if(null==item){this.$.up.classList.remove("active");this.$.down.classList.remove("active");this.$.left.classList.remove("active");this.$.right.classList.remove("active")}else{this.$.up.classList.add("active");this.$.down.classList.add("active");this.$.left.classList.add("active");this.$.right.classList.add("active");this.$.up.disabled=!this.canMoveOrder(item,!0);this.$.down.disabled=!this.canMoveOrder(item,!1);this.$.left.disabled=!this.canMoveSlot(item,!0);this.$.right.disabled=!this.canMoveSlot(item,!1);var bodyRect=this.getBoundingClientRect(),elemRect=item.getBoundingClientRect(),topOffset=elemRect.top-bodyRect.top,leftOffset=elemRect.left-bodyRect.left;this.$.up.style.top=topOffset-20+"px";this.$.down.style.top=topOffset+elemRect.height+"px";this.$.left.style.top=topOffset+elemRect.height/2+"px";this.$.right.style.top=topOffset+elemRect.height/2+"px";this.$.up.style.left=leftOffset+elemRect.width/2-10+"px";this.$.down.style.left=leftOffset+elemRect.width/2-10+"px";this.$.left.style.left=leftOffset-20+"px";this.$.right.style.left=leftOffset+elemRect.width+"px"}},_editModeChanged:function _editModeChanged(newValue,oldValue){var _this2=this,children=(0,_polymerDom.dom)(this).getEffectiveChildNodes();if("object"===babelHelpers.typeof(children)){if(newValue&&!oldValue){for(var i in children){if(babelHelpers.typeof(children[i].tagName)!=="undefined"){children[i].addEventListener("drop",this.dropEvent.bind(this));children[i].addEventListener("dragstart",this.dragStart.bind(this));children[i].addEventListener("dragend",this.dragEnd.bind(this));children[i].addEventListener("dragover",function(e){e.preventDefault()});children[i].setAttribute("draggable",!0);children[i].setAttribute("data-draggable",!0);children[i].setAttribute("tabindex",0)}}async.microTask.run(function(){for(var j=1;j<=_this2.columns.length;j++){if(_this2.shadowRoot.querySelector("#col"+j)!==void 0){_this2.shadowRoot.querySelector("#col"+j).addEventListener("drop",_this2.dropEvent.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).addEventListener("dragstart",_this2.dragStart.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).addEventListener("dragend",_this2.dragEnd.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).addEventListener("dragover",function(e){e.preventDefault()});_this2.shadowRoot.querySelector("#col"+j).setAttribute("data-draggable",!0)}}})}else if(!newValue&&oldValue){for(var i in children){if(babelHelpers.typeof(children[i].tagName)!=="undefined"){children[i].removeEventListener("drop",this.dropEvent.bind(this));children[i].removeEventListener("dragstart",this.dragStart.bind(this));children[i].removeEventListener("dragend",this.dragEnd.bind(this));children[i].removeEventListener("dragover",function(e){e.preventDefault()});children[i].removeAttribute("draggable");children[i].removeAttribute("data-draggable");children[i].removeAttribute("tabindex")}}async.microTask.run(function(){for(var j=1;j<=_this2.columns.length;j++){if(_this2.shadowRoot.querySelector("#col"+j)!==void 0){_this2.shadowRoot.querySelector("#col"+j).removeEventListener("drop",_this2.dropEvent.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).removeEventListener("dragstart",_this2.dragStart.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).removeEventListener("dragend",_this2.dragEnd.bind(_this2));_this2.shadowRoot.querySelector("#col"+j).removeEventListener("dragover",function(e){e.preventDefault()});_this2.shadowRoot.querySelector("#col"+j).removeAttribute("data-draggable")}}})}}},dropEvent:function dropEvent(e){var _this3=this,normalizedEvent=(0,_polymerDom.dom)(e),local=normalizedEvent.localTarget;if(babelHelpers.typeof(this.__activeItem)!=="undefined"&&babelHelpers.typeof(local)!=="undefined"&&null!=local.getAttribute("slot")&&this.__activeItem!==local){this.__activeItem.setAttribute("slot",local.getAttribute("slot"));(0,_polymerDom.dom)(this).insertBefore(this.__activeItem,local);e.preventDefault();e.stopPropagation()}else if(".column"===local.tagName){var col=local.id.replace("col","");this.__activeItem.setAttribute("slot","col-"+col);(0,_polymerDom.dom)(this).appendChild(this.__activeItem);e.preventDefault();e.stopPropagation()}var children=(0,_polymerDom.dom)(this).children;for(var i in children){if(babelHelpers.typeof(children[i].classList)!=="undefined"){children[i].classList.remove("mover")}}for(var j=1;j<=this.columns.length;j++){if(this.shadowRoot.querySelector("#col"+j)!==void 0){this.shadowRoot.querySelector("#col"+j).classList.remove("mover")}}setTimeout(function(){if(_this3.__activeItem&&"function"===typeof _this3.__activeItem.focus){_this3.positionArrows(_this3.__activeItem);_this3.__activeItem.focus()}},100)},dragStart:function dragStart(){var children=(0,_polymerDom.dom)(this).children;for(var i in children){if(babelHelpers.typeof(children[i].classList)!=="undefined"){children[i].classList.add("mover")}}for(var j=1;j<=this.columns.length;j++){if(this.shadowRoot.querySelector("#col"+j)!==void 0){this.shadowRoot.querySelector("#col"+j).classList.add("mover")}}},dragEnd:function dragEnd(){var children=(0,_polymerDom.dom)(this).children;for(var i in children){if(babelHelpers.typeof(children[i].classList)!=="undefined"){children[i].classList.remove("mover")}}for(var j=1;j<=this.columns.length;j++){if(this.shadowRoot.querySelector("#col"+j)!==void 0){this.shadowRoot.querySelector("#col"+j).classList.remove("mover")}}},attached:function attached(){var root=this;document.body.addEventListener("hax-store-property-updated",root._haxStorePropertyUpdated.bind(root));document.body.addEventListener("hax-insert-content",root.haxInsertContent.bind(root));window.ResponsiveUtility.requestAvailability();window.dispatchEvent(new CustomEvent("responsive-element",{detail:{element:root,attribute:"responsive-size",relativeToParent:!0,sm:root.breakpointSm,md:root.breakpointMd,lg:root.breakpointLg,xl:root.breakpointXl}}));var options={},layouts=Object.keys(root.layouts);(function getOptions(){for(var i=0;i<layouts.length;i++){options[layouts[i]]=root.layouts[layouts[i]].columnLayout}})();root.setHaxProperties({canScale:!0,canPosition:!0,canEditSource:!1,settings:{quick:[],configure:[{property:"layout",title:"Column Layout",description:"Style to present these items (may change for small screens)",inputMethod:"select",options:options}],advanced:[{property:"breakpointSm",title:"Small Breakpoint",description:"Anything less than this number (in pixels) will render with the smallest version of this layout",inputMethod:"textfield",validationType:"number"},{property:"breakpointMd",title:"Medium Breakpoint",description:"Anything less than this number (in pixels) will render with the small version of this layout",inputMethod:"textfield",validationType:"number"},{property:"breakpointLg",title:"Large Breakpoint",description:"Anything less than this number (in pixels) will render with the medium version of this layout.",inputMethod:"textfield",validationType:"number"},{property:"breakpointXl",title:"Extra-Large Breakpoint",description:"Anything less than this number (in pixels) will render with the large version of this layout. Anything greater than or equal to this number will display with the maximum number of columns for this layout.",inputMethod:"textfield",validationType:"number"}]},saveOptions:{unsetAttributes:["__active-item","edit-mode"]}})},haxInsertContent:function haxInsertContent(){var _this4=this;if(this===window.HaxStore.instance.activeContainerNode){this.editMode=!1;setTimeout(function(){_this4.editMode=!0;if(_this4.__activeItem&&"function"===typeof _this4.__activeItem.focus){_this4.positionArrows(_this4.__activeItem);_this4.__activeItem.focus()}},100)}},_haxStorePropertyUpdated:function _haxStorePropertyUpdated(e){if(e.detail&&babelHelpers.typeof(e.detail.value)!=="undefined"&&e.detail.property){if("object"===babelHelpers.typeof(e.detail.value)){this.set(e.detail.property,null)}this.set(e.detail.property,e.detail.value)}}});_exports.GridPlate=GridPlate});