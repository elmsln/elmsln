<?php
/**
 * @file
 * Code for the CLE Perms feature.
 */

/**
 * Implments hook_node_view_alter.
 *
 * Hide fields under the 'group_admin' field group from users
 * who don't have access to the 'administer cle content' permission.
 *
 * @todo This should most likely be a module similar to the field_permissions
 * module.
 */
function cle_perms_node_view_alter(&$build) {
  if (isset($build['#fieldgroups']['group_admin']->children)) {
    global $user;
    if (!user_access('administer cle content', $user)) {
      foreach ($build['#fieldgroups']['group_admin']->children as $child_field) {
        unset($build[$child_field]);
      }
    }
  }
}
