define(["exports", "require", "../../../lit-element/lit-element.js", "../../simple-colors/simple-colors.js", "../../utils/utils.js", "../../hax-body-behaviors/lib/HAXFields.js"], function (_exports, _require, _litElement, _simpleColors, _utils, _HAXFields) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.HaxPreferencesDialog = void 0;
  _require = babelHelpers.interopRequireWildcard(_require);

  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { babelHelpers.defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

  function _templateObject2_172ad3d0accc11eaa8079b516c74c00d() {
    var data = babelHelpers.taggedTemplateLiteral(["\n      <paper-dialog\n        id=\"dialog\"\n        ?opened=\"", "\"\n        @opened-changed=\"", "\"\n      >\n        <h3 class=\"title\">\n          <iron-icon icon=\"icons:settings\"></iron-icon> ", "\n        </h3>\n        <paper-button id=\"closedialog\" @click=\"", "\">\n          <iron-icon icon=\"icons:cancel\" title=\"Close dialog\"></iron-icon>\n        </paper-button>\n        <div style=\"height: 100%; overflow: auto;\" class=\"pref-container\">\n          <simple-fields\n            id=\"settingsform\"\n            .schematizer=\"", "\"\n            .elementizer=\"", "\"\n          >\n          </simple-fields>\n        </div>\n        <a\n          href=\"", "\"\n          rel=\"noopener\"\n          id=\"reportghissue\"\n          target=\"_blank\"\n          >Report an issue with HAX</a\n        >\n      </paper-dialog>\n    "]);

    _templateObject2_172ad3d0accc11eaa8079b516c74c00d = function _templateObject2_172ad3d0accc11eaa8079b516c74c00d() {
      return data;
    };

    return data;
  }

  function _templateObject_172ad3d0accc11eaa8079b516c74c00d() {
    var data = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          display: block;\n        }\n        iron-icon:not(:defined),\n        paper-button:not(:defined),\n        paper-dialog:not(:defined) {\n          display: none;\n        }\n        #dialog {\n          z-index: 100000;\n          margin-top: 56px;\n        }\n        #closedialog {\n          top: 6px;\n          right: 0;\n          position: absolute;\n          padding: 8px;\n          margin: 0;\n          background-color: var(--hax-color-menu-heading-bg, #eeeeee);\n          color: var(--hax-color-menu-heading-color, black);\n          width: 40px;\n          height: 40px;\n          min-width: unset;\n        }\n        .title {\n          position: relative;\n          padding: 16px;\n          outline: 0;\n          font-weight: 600;\n          text-align: left;\n          margin: 0;\n          background-color: var(--hax-color-menu-heading-bg, #eeeeee);\n          color: var(--hax-color-menu-heading-color, black);\n          font-size: 18px;\n          line-height: 18px;\n          font-family: \"Noto Serif\", serif;\n        }\n        .pref-container {\n          text-align: left;\n          padding: 16px;\n        }\n        #reportghissue {\n          color: #81a3a9;\n          font-size: 18px;\n          padding: 16px;\n          font-style: italic;\n        }\n      "]);

    _templateObject_172ad3d0accc11eaa8079b516c74c00d = function _templateObject_172ad3d0accc11eaa8079b516c74c00d() {
      return data;
    };

    return data;
  }

  /**
   * `hax-export-dialog`
   * @element hax-export-dialog
   * `Export dialog with all export options and settings provided.`
   */
  var HaxPreferencesDialog =
  /*#__PURE__*/
  function (_winEventsElement) {
    babelHelpers.inherits(HaxPreferencesDialog, _winEventsElement);
    babelHelpers.createClass(HaxPreferencesDialog, null, [{
      key: "styles",

      /**
       * LitElement constructable styles enhancement
       */
      get: function get() {
        return [].concat(babelHelpers.toConsumableArray(babelHelpers.get(babelHelpers.getPrototypeOf(HaxPreferencesDialog), "styles", this)), [(0, _litElement.css)(_templateObject_172ad3d0accc11eaa8079b516c74c00d())]);
      }
    }]);

    function HaxPreferencesDialog() {
      var _this;

      babelHelpers.classCallCheck(this, HaxPreferencesDialog);
      _this = babelHelpers.possibleConstructorReturn(this, babelHelpers.getPrototypeOf(HaxPreferencesDialog).call(this));
      _this.__winEvents = {
        "hax-store-property-updated": "_haxStorePropertyUpdated"
      };
      _this.ghLink = "https://github.com/elmsln/issues/issues/new?body=URL%20base:%20" + window.location.pathname + "&title=[hax] Bug%20report%20from%20preference%20panel";
      _this.title = "Advanced settings"; // JSON schema object needs delayed to ensure page repaints the form

      _this.schema = [{
        property: "haxRayMode",
        title: "X-Ray vision",
        description: "Visualizes the HTML tag powering the area of the page",
        inputMethod: "boolean",
        value: false
      }, {
        property: "haxVoiceCommands",
        title: "Voice commands",
        description: "Experimental: Voice based control system",
        inputMethod: "boolean",
        value: false
      }];
      _this.schemaValues = {
        haxRayMode: false,
        haxVoiceCommands: false
      };
      setTimeout(function () {
        new Promise(function (res, rej) {
          return _require.default(["../../../@polymer/iron-icon/iron-icon.js"], res, rej);
        });
        new Promise(function (res, rej) {
          return _require.default(["../../../@polymer/paper-button/paper-button.js"], res, rej);
        });
        new Promise(function (res, rej) {
          return _require.default(["../../simple-fields/simple-fields.js"], res, rej);
        });
        new Promise(function (res, rej) {
          return _require.default(["../../../@polymer/paper-dialog/paper-dialog.js"], res, rej);
        });
      }, 0);
      return _this;
    }

    babelHelpers.createClass(HaxPreferencesDialog, [{
      key: "updated",
      value: function updated(changedProperties) {
        var _this2 = this;

        changedProperties.forEach(function (oldValue, propName) {
          // notify when any of these change
          if (propName == "preferences") {
            _this2._preferencesChanged(_this2[propName]);

            _this2.dispatchEvent(new CustomEvent("".concat(propName, "-changed"), {
              detail: {
                value: _this2[propName]
              }
            }));
          }
        });
      }
    }, {
      key: "render",
      value: function render() {
        return (0, _litElement.html)(_templateObject2_172ad3d0accc11eaa8079b516c74c00d(), this.opened, this.openedChanged, this.title, this.closeEvent, _HAXFields.HaxSchematizer, _HAXFields.HaxElementizer, this.ghLink);
      }
    }, {
      key: "openedChanged",
      value: function openedChanged(e) {
        // force close event to align data model if clicking away
        if (!e.detail.value && window.HaxStore.instance.openDrawer === this) {
          window.HaxStore.write("openDrawer", false, this);
        }
      }
    }, {
      key: "closeEvent",
      value: function closeEvent(e) {
        this.opened = false;
      }
    }, {
      key: "firstUpdated",
      value: function firstUpdated(changedProperties) {
        this.shadowRoot.querySelector("#settingsform").fields = babelHelpers.toConsumableArray(this.schema);
        this.shadowRoot.querySelector("#settingsform").value = _objectSpread({}, this.schemaValues);
        this.shadowRoot.querySelector("#settingsform").addEventListener("value-changed", this.__valueChangedEvent.bind(this)); // fire an event that this is a core piece of the system

        this.dispatchEvent(new CustomEvent("hax-register-core-piece", {
          bubbles: true,
          cancelable: true,
          composed: true,
          detail: {
            piece: "haxPreferences",
            object: this
          }
        }));
      }
      /**
       * Store updated, sync.
       */

    }, {
      key: "_haxStorePropertyUpdated",
      value: function _haxStorePropertyUpdated(e) {
        if (e.detail && babelHelpers.typeof(e.detail.value) !== (typeof undefined === "undefined" ? "undefined" : babelHelpers.typeof(undefined)) && e.detail.property && e.detail.property === "globalPreferences" && e.detail.owner !== this) {
          this.preferences = _objectSpread({}, e.detail.value);
        }
      }
      /**
       * Notice preferences have changed.
       */

    }, {
      key: "_preferencesChanged",
      value: function _preferencesChanged(newValue) {
        if (this.schema && window.HaxStore.ready) {
          window.HaxStore.write("globalPreferences", newValue, this);
        }
      }
    }, {
      key: "__valueChangedEvent",
      value: function __valueChangedEvent(e) {
        if (e.detail.value) {
          this.preferences = _objectSpread({}, e.detail.value);
        }
      }
      /**
       * open the dialog
       */

    }, {
      key: "open",
      value: function open() {
        this.opened = true;
        this.shadowRoot.querySelector("#settingsform").fields = babelHelpers.toConsumableArray(this.schema);
        this.shadowRoot.querySelector("#settingsform").value = _objectSpread({}, this.schemaValues);
      }
      /**
       * close the dialog
       */

    }, {
      key: "close",
      value: function close() {
        this.opened = false;
      }
    }], [{
      key: "tag",
      get: function get() {
        return "hax-preferences-dialog";
      }
    }, {
      key: "properties",
      get: function get() {
        return {
          /**
           * github link
           */
          ghLink: {
            type: String
          },

          /**
           * Title when open.
           */
          title: {
            type: String
          },

          /**
           * Schema that has all of inputs / manages state
           */
          schema: {
            type: Object
          },

          /**
           * Preferences managed for everything global about HAX.
           */
          preferences: {
            type: Object
          },
          opened: {
            type: Boolean
          }
        };
      }
    }]);
    return HaxPreferencesDialog;
  }((0, _utils.winEventsElement)(_simpleColors.SimpleColors));

  _exports.HaxPreferencesDialog = HaxPreferencesDialog;
  window.customElements.define(HaxPreferencesDialog.tag, HaxPreferencesDialog);
});