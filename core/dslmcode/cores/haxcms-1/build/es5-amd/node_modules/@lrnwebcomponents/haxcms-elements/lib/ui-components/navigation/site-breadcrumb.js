define(["exports", "../../../../../lit/index.js", "../../core/haxcms-site-store.js", "../../../../simple-icon/lib/simple-icon-lite.js", "../../../../simple-icon/lib/simple-icons.js", "../../../../../mobx/dist/mobx.esm.js"], function (_exports, _index, _haxcmsSiteStore, _simpleIconLite, _simpleIcons, _mobxEsm) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.SiteBreadcrumb = void 0;

  var _templateObject_fa89ea408e0011ed99ce491205e67b1d, _templateObject2_fa89ea408e0011ed99ce491205e67b1d;

  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = babelHelpers.getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = babelHelpers.getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return babelHelpers.possibleConstructorReturn(this, result); }; }

  function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

  /**
   * `site-breadcrumb`
   * `A basic breadcrumb of links based on the active state in HAXcms on JSON Outline Schema`
   *
   * @demo demo/index.html
   */
  var SiteBreadcrumb = /*#__PURE__*/function (_LitElement) {
    babelHelpers.inherits(SiteBreadcrumb, _LitElement);

    var _super = _createSuper(SiteBreadcrumb);

    function SiteBreadcrumb() {
      var _this;

      babelHelpers.classCallCheck(this, SiteBreadcrumb);
      _this = _super.call(this);
      _this.__disposer = [];
      return _this;
    } // render function


    babelHelpers.createClass(SiteBreadcrumb, [{
      key: "render",
      value: function render() {
        return (0, _index.html)(_templateObject_fa89ea408e0011ed99ce491205e67b1d || (_templateObject_fa89ea408e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n      <div\n        id=\"space\"\n        itemscope\n        itemtype=\"http://data-vocabulary.org/Breadcrumb\"\n      ></div>\n    "])));
      }
    }, {
      key: "firstUpdated",
      value: function firstUpdated(changedProperties) {
        var _this2 = this;

        if (babelHelpers.get(babelHelpers.getPrototypeOf(SiteBreadcrumb.prototype), "firstUpdated", this)) {
          babelHelpers.get(babelHelpers.getPrototypeOf(SiteBreadcrumb.prototype), "firstUpdated", this).call(this, changedProperties);
        } // keep editMode in sync globally


        (0, _mobxEsm.autorun)(function (reaction) {
          _this2.manifest = (0, _mobxEsm.toJS)(_haxcmsSiteStore.store.routerManifest);

          _this2.__disposer.push(reaction);
        });
        (0, _mobxEsm.autorun)(function (reaction) {
          _this2.editMode = (0, _mobxEsm.toJS)(_haxcmsSiteStore.store.editMode);

          _this2.__disposer.push(reaction);
        });
        (0, _mobxEsm.autorun)(function (reaction) {
          _this2._activeItemChanged((0, _mobxEsm.toJS)(_haxcmsSiteStore.store.activeItem));

          _this2.__disposer.push(reaction);
        });
      }
      /**
       * Notice the change and build
       */

    }, {
      key: "_activeItemChanged",
      value: function _activeItemChanged(active) {
        var _this3 = this;

        var activeItem = active;

        if (activeItem && this.shadowRoot && this.shadowRoot.querySelector("#space")) {
          var items;
          var i;

          (function () {
            // wipe out the slot and rebuild it
            while (_this3.shadowRoot.querySelector("#space").firstChild !== null) {
              _this3.shadowRoot.querySelector("#space").removeChild(_this3.shadowRoot.querySelector("#space").firstChild);
            }

            items = [{
              title: activeItem.title,
              slug: null
            }];
            var itemBuilder = activeItem; // walk back through parent tree

            while (itemBuilder && itemBuilder.parent != null) {
              itemBuilder = _this3.manifest.items.find(function (i) {
                return i.id == itemBuilder.parent;
              }); // double check structure is sound

              if (itemBuilder) {
                items.unshift({
                  title: itemBuilder.title,
                  slug: itemBuilder.slug
                });
              }
            }

            for (i in items) {
              var icon = document.createElement("simple-icon-lite");
              icon.icon = "icons:chevron-right";

              if (items[i].slug != null) {
                var button = document.createElement("button");
                button.innerText = items[i].title;
                button.noink = true; // disable buttons if we ware editing

                if (_this3.editMode) {
                  button.setAttribute("disabled", "disabled");

                  _this3.shadowRoot.querySelector("#space").appendChild(button);
                } else {
                  var link = document.createElement("a");
                  link.setAttribute("href", items[i].slug);
                  link.setAttribute("tabindex", "-1");
                  link.setAttribute("itemprop", "url");
                  link.appendChild(button);

                  _this3.shadowRoot.querySelector("#space").appendChild(link);
                }

                _this3.shadowRoot.querySelector("#space").appendChild(icon);
              } else {
                var span = document.createElement("span");
                span.innerText = items[i].title;

                _this3.shadowRoot.querySelector("#space").appendChild(span);
              }
            }
          })();
        }
      }
    }, {
      key: "disconnectedCallback",
      value: function disconnectedCallback() {
        for (var i in this.__disposer) {
          this.__disposer[i].dispose();
        }

        babelHelpers.get(babelHelpers.getPrototypeOf(SiteBreadcrumb.prototype), "disconnectedCallback", this).call(this);
      }
    }], [{
      key: "styles",
      get: function get() {
        return [(0, _index.css)(_templateObject2_fa89ea408e0011ed99ce491205e67b1d || (_templateObject2_fa89ea408e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          display: block;\n          font-size: var(--site-breadcrumb-font-size, 16px);\n          color: var(--site-breadcrumb-color, #383f45);\n        }\n        a {\n          display: inline-flex;\n          font-size: var(--site-breadcrumb-font-size, 16px);\n          color: inherit;\n          display: inline-flex;\n          padding: 0 8px 0 0;\n          vertical-align: text-top;\n          text-decoration: var(--site-breadcrumb-text-decoration, underline);\n        }\n        button {\n          margin: 0;\n          padding: 0;\n          font-size: var(--site-breadcrumb-font-size, 16px);\n          font-family: inherit;\n          min-width: unset;\n          display: inline-flex;\n          text-transform: unset;\n          background-color: transparent;\n          border: none;\n          letter-spacing: inherit;\n          cursor: pointer;\n          color: inherit;\n        }\n        a:hover,\n        a:focus,\n        a:active,\n        button:hover,\n        button:focus,\n        button:active {\n          background-color: var(--site-breadcrumb-hover-bg, transparent);\n          color: var(--site-breadcrumb-hover-color, #222222);\n        }\n        span {\n          margin: 0;\n          font-size: var(--site-breadcrumb-font-size, 16px);\n          padding: 0 8px 0 0;\n          height: 24px;\n          display: inline-flex;\n        }\n        simple-icon-lite {\n          display: inline-flex;\n          --simple-icon-height: 24px;\n          --simple-icon-width: 24px;\n          padding: 0 8px 0 0;\n          color: inherit;\n        }\n      "])))];
      }
      /**
       * Store the tag name to make it easier to obtain directly.
       */

    }, {
      key: "tag",
      get: function get() {
        return "site-breadcrumb";
      }
    }]);
    return SiteBreadcrumb;
  }(_index.LitElement);

  _exports.SiteBreadcrumb = SiteBreadcrumb;
  customElements.define(SiteBreadcrumb.tag, SiteBreadcrumb);
});