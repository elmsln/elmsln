define(["exports", "../../lit/index.js", "../simple-colors/simple-colors.js", "../lrndesign-chart/lib/lrndesign-pie.js"], function (_exports, _index, _simpleColors, _lrndesignPie) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ProgressDonut = void 0;

  var _templateObject_211b1b30942811ecb1937969798b231a, _templateObject2_211b1b30942811ecb1937969798b231a;

  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { babelHelpers.defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = babelHelpers.getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = babelHelpers.getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return babelHelpers.possibleConstructorReturn(this, result); }; }

  function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

  /**
   * `progress-donut`
   * @element progress-donut
   * shows progress in as a rounded shape w/ hollow middle
   *
   * @extends LrndesignPie
   * @see @lrnwebcomponents/lrndesign-chart/lib/lrndesign-pie.js
   * @see @lrnwebcomponents/lrndesign-chart/lrndesign-chart.js
   * @see @lrnwebcomponents/chartist-render/chartist-render.js
   * @see @lrnwebcomponents/simple-colors/simple-colors.js
   *
   * @demo demo/index.html
   */
  var ProgressDonut = /*#__PURE__*/function (_LrndesignPie) {
    babelHelpers.inherits(ProgressDonut, _LrndesignPie);

    var _super = _createSuper(ProgressDonut);

    function ProgressDonut() {
      var _thisSuper, _this;

      babelHelpers.classCallCheck(this, ProgressDonut);
      _this = _super.call(this);
      babelHelpers.get((_thisSuper = babelHelpers.assertThisInitialized(_this), babelHelpers.getPrototypeOf(ProgressDonut.prototype)), "setProperties", _thisSuper).call(_thisSuper);
      _this.animation = -1;
      _this.animationDelay = 0;
      _this.complete = [];
      _this.desc = "";
      _this.imageSrc = "";
      _this.imageAlt = "";
      _this.donut = false;
      _this.showLabel = false;
      _this.showTable = false;

      _this.addEventListener("chartist-render-draw", _this.addAnimation);

      return _this;
    }

    babelHelpers.createClass(ProgressDonut, [{
      key: "render",
      value: // render function
      function render() {
        return (0, _index.html)(_templateObject_211b1b30942811ecb1937969798b231a || (_templateObject_211b1b30942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral([" ", ""])), babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut.prototype), "render", this).call(this));
      } // haxProperty definition

    }, {
      key: "disconnectedCallback",
      value:
      /**
       * Called every time the element is removed from the DOM. Useful for
       * running clean up code (removing event listeners, etc.).
       */
      function disconnectedCallback() {
        this.removeEventListener("chartist-render-draw", this.addAnimation);
        babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut.prototype), "disconnectedCallback", this).call(this);
      }
      /**
       * Handles chart creation event.
       * @param {event} e create event
       */

    }, {
      key: "addAnimation",
      value: function addAnimation(e) {
        var data = e && e.detail ? e.detail : undefined;

        if (this.animation > 0 && data && data.type && data.type === "slice") {
          var opacity = 1,
              val = data.value || this.donutTotal / this.donutData.length,
              dur = this.animation * val / this.donutTotal;
          data.element.attr({
            c: opacity
          });
          var animationDefinition = {
            opacity: {
              id: "anim" + data.index,
              dur: dur,
              from: -opacity,
              to: 1,
              fill: "freeze"
            }
          };

          if (data.index !== 0) {
            animationDefinition["opacity"].begin = "anim" + (data.index - 1) + ".end";
          } else {
            animationDefinition["opacity"].begin = this.animationDelay;
          }

          if (this.donutData.length > 0) animationDefinition["opacity"].easing = Chartist.Svg.Easing.easeOutQuint;
          data.element.attr({
            opacity: -opacity
          });
          data.element.animate(animationDefinition, false);
        }

        console.log(data, data.element._node.getTotalLength());

        if (data && data.index === this.complete.length - 1 && this.chart) {
          data.group.append(new Chartist.Svg("ellipse", {
            cx: "50%",
            cy: "50%",
            rx: "32%",
            ry: "32%"
          }, "ct-center-ellipse"));
          data.group.append(new Chartist.Svg("image", {
            href: this.imageSrc,
            alt: this.imageAlt
          }, "ct-center-image"));
        }
      }
    }, {
      key: "donutData",
      get: function get() {
        return Array.isArray(this.complete) ? this.complete : JSON.parse(this.complete || "[]");
      }
    }, {
      key: "donutLabels",
      get: function get() {
        return this.donutData.map(function (h, i) {
          return "Item ".concat(i + 1);
        });
      }
    }, {
      key: "donutTotal",
      get: function get() {
        return Math.max(this.donutData.reduce(function (sum, val) {
          return sum + val;
        }), this.total);
      }
    }, {
      key: "options",
      get: function get() {
        return babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut.prototype), "options", this);
      }
    }, {
      key: "updated",
      value: function updated(changedProperties) {
        var _this2 = this;

        changedProperties.forEach(function (oldValue, propName) {
          if (propName === "complete" && _this2.complete !== oldValue) _this2.data = [_this2.donutLabels, _this2.donutData];
        });
        babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut.prototype), "updated", this).call(this, changedProperties);
      }
    }], [{
      key: "styles",
      get: //styles function
      function get() {
        return [].concat(babelHelpers.toConsumableArray(babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut), "styles", this)), [(0, _index.css)(_templateObject2_211b1b30942811ecb1937969798b231a || (_templateObject2_211b1b30942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n        .ct-center-image {\n          width: 100%;\n          height: 100%;\n          transform: translateX(25%) translateY(25%) scale(0.5);\n          clip-path: circle(50% at 50% 50%);\n        }\n\n        .ct-center-ellipse {\n          fill: var(--chartist-bg-color, #fff);\n        }\n      "])))]);
      }
    }, {
      key: "haxProperties",
      get: function get() {
        return {
          canScale: true,
          canPosition: true,
          canEditSource: true,
          gizmo: {
            title: "Progress Donut",
            description: "Progression donut",
            icon: "av:play-circle-filled",
            color: "grey",
            groups: ["Presentation", "Data"],
            handles: [],
            meta: {
              author: "ELMS:LN"
            }
          },
          settings: {
            configure: [{
              property: "title",
              title: "Title",
              description: "The title of the element",
              inputMethod: "textfield",
              icon: "editor:title"
            }, {
              property: "desc",
              title: "Description",
              description: "Accessible long description",
              inputMethod: "textfield"
            }, {
              property: "imageSrc",
              title: "Image Source",
              description: "Source of image inside donut.",
              inputMethod: "haxupload",
              icon: "link",
              validationType: "url"
            }, {
              property: "imageAlt",
              title: "Image Alt Text",
              description: "Alt text for image.",
              inputMethod: "alt"
            }, {
              property: "animated",
              title: "Animated",
              description: "Whether progress animates on first load",
              inputMethod: "boolean"
            }, {
              property: "complete",
              title: "Complete",
              description: "An array of completed values.",
              inputMethod: "array"
            }, {
              property: "total",
              title: "Total",
              description: "Total when all items are complete.",
              inputMethod: "arrnumberay"
            }, {
              property: "startAngle",
              title: "Start Angle",
              description: "Donut angle where progress starts",
              inputMethod: "number"
            }],
            advanced: []
          }
        };
      } // properties available to the custom element for data binding

    }, {
      key: "properties",
      get: function get() {
        return _objectSpread(_objectSpread({}, babelHelpers.get(babelHelpers.getPrototypeOf(ProgressDonut), "properties", this)), {}, {
          /**
           * Timing for animation or -1 for false
           */
          animation: {
            type: Number,
            attribute: "animation"
          },

          /**
           * Timing for animation or 0 none
           */
          animationDelay: {
            type: Number,
            attribute: "animation-delay"
          },

          /**
           * An array of completed values
           */
          complete: {
            type: Array
          },

          /**
           * Accessible long description
           */
          desc: {
            type: String
          },

          /**
           * Source of image in the center of the object.
           */
          imageSrc: {
            attribute: "image-src",
            type: String,
            reflect: true
          },

          /**
           * Alt text for image.
           */
          imageAlt: {
            attribute: "image-alt",
            type: String,
            reflect: true
          }
        });
      }
    }, {
      key: "tag",
      get: function get() {
        return "progress-donut";
      }
    }]);
    return ProgressDonut;
  }(_lrndesignPie.LrndesignPie);

  _exports.ProgressDonut = ProgressDonut;
  window.customElements.define(ProgressDonut.tag, ProgressDonut);
});