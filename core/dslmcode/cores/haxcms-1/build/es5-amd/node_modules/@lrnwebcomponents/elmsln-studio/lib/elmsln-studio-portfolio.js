define(["exports", "../../../lit/index.js", "./elmsln-studio-styles.js", "./elmsln-studio-utilities.js", "../../img-view-modal/img-view-modal.js", "../../hax-iconset/hax-iconset.js", "../../threaded-discussion/threaded-discussion.js"], function (_exports, _index, _elmslnStudioStyles, _elmslnStudioUtilities, _imgViewModal, _haxIconset, _threadedDiscussion) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ElmslnStudioPortfolio = void 0;

  var _templateObject_6167d480942811ecb1937969798b231a, _templateObject2_6167d480942811ecb1937969798b231a, _templateObject3_6167d480942811ecb1937969798b231a, _templateObject4_6167d480942811ecb1937969798b231a, _templateObject5_6167d480942811ecb1937969798b231a, _templateObject6_6167d480942811ecb1937969798b231a, _templateObject7_6167d480942811ecb1937969798b231a, _templateObject8_6167d480942811ecb1937969798b231a, _templateObject9_6167d480942811ecb1937969798b231a, _templateObject10_6167d480942811ecb1937969798b231a, _templateObject11_6167d480942811ecb1937969798b231a, _templateObject12_6167d480942811ecb1937969798b231a;

  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { babelHelpers.defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = babelHelpers.getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = babelHelpers.getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return babelHelpers.possibleConstructorReturn(this, result); }; }

  function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

  /**
   * `elmsln-studio-portfolio`
   * Studio App for ELMS:LN
   *
   * @customElement elmsln-studio-portfolio
   * @lit-html
   * @lit-element
   * @demo demo/portfolio.html
   */
  var ElmslnStudioPortfolio = /*#__PURE__*/function (_ElmslnStudioUtilitie) {
    babelHelpers.inherits(ElmslnStudioPortfolio, _ElmslnStudioUtilitie);

    var _super = _createSuper(ElmslnStudioPortfolio);

    // life cycle
    function ElmslnStudioPortfolio() {
      var _this;

      babelHelpers.classCallCheck(this, ElmslnStudioPortfolio);
      _this = _super.call(this);
      _this.feedback = {};
      _this.comment = "";
      return _this;
    }

    babelHelpers.createClass(ElmslnStudioPortfolio, [{
      key: "render",
      value: // render function
      function render() {
        var _this2 = this;

        return (0, _index.html)(_templateObject_6167d480942811ecb1937969798b231a || (_templateObject_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n      <div id=\"breadcrumb\">\n        <elmsln-studio-link href=\"submissions\">Submissions</elmsln-studio-link>\n        <span> > </span>\n        ", "\n        ", "\n        <span> > </span>\n        <span\n          >", "</span\n        >\n      </div>\n      <div\n        id=\"primary\"\n        class=\"", "\"\n      >\n        <article id=\"portfolio-project\">\n          <h1>\n            <lrndesign-avatar\n              accent-color=\"", "\"\n              aria-hidden=\"true\"\n              label=\"", "\"\n              .src=\"", "\"\n              two-chars\n            >\n            </lrndesign-avatar>\n            <span class=\"student-name\"\n              >", "</span\n            >\n            ", "\n          </h1>\n          <div id=\"project-buttons\">\n            <button\n              id=\"sort\"\n              aria-pressed=\"", "\"\n              class=\"", "\"\n              @click=\"", "\"\n              controls=\"portfolio-project\"\n            >\n              <simple-icon-lite icon=\"sort\"></simple-icon-lite>\n              <simple-tooltip for=\"sort\"\n                >Sort Submissions\n                ", "</simple-tooltip\n              >\n            </button>\n          </div>\n          ", "\n        </article>\n      </div>\n      <div\n        id=\"secondary\"\n        ?hidden=", "\n      >\n        <aside>\n          <div class=\"instructions callout\">\n            <h2 class=\"callout-label\">\n              <simple-icon-lite\n                icon=\"info\"\n                aria-hidden=\"true\"\n              ></simple-icon-lite>\n              Giving Feedback\n            </h2>\n            <div>\n              <ul>\n                <li>Things to look for: blah, blah, blah</li>\n                <li>How to say it: blah, blah, blah</li>\n                <li>Other info.</li>\n              </ul>\n            </div>\n          </div>\n          <h2 class=\"discussion-label\">Feedback</h2>\n          <div class=\"discussion callout\">\n            <p class=\"callout-label\">\n              <simple-icon-lite\n                icon=\"communication:comment\"\n                aria-hidden=\"true\"\n              ></simple-icon-lite>\n              Post New Feedback\n            </p>\n            <threaded-discussion\n              comment-icon=\"send\"\n              ?demo=\"", "\"\n              .data=\"", "\"\n              latest\n            >\n            </threaded-discussion>\n          </div>\n        </aside>\n      </div>\n      ", "\n    "])), !this.portfolio ? "" : (0, _index.html)(_templateObject2_6167d480942811ecb1937969798b231a || (_templateObject2_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n              ", "\n            "])), !this.portfolio.projectId || !this.portfolio.project ? "" : (0, _index.html)(_templateObject3_6167d480942811ecb1937969798b231a || (_templateObject3_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n                    <elmsln-studio-link\n                      href=\"", "\"\n                      >", "</elmsln-studio-link\n                    >\n                    <span> > </span>\n                  "])), "submissions?project=".concat(this.portfolio.projectId), this.portfolio.project || "Project")), !this.portfolio || !this.assignment ? (0, _index.html)(_templateObject4_6167d480942811ecb1937969798b231a || (_templateObject4_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["<em>Assignment</em>"]))) : (0, _index.html)(_templateObject5_6167d480942811ecb1937969798b231a || (_templateObject5_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n              <elmsln-studio-link\n                href=\"", "\"\n                >", "</elmsln-studio-link\n              >\n            "])), "submissions?".concat(!this.portfolio.projectId || !this.portfolio.project ? "" : "project=".concat(this.portfolio.projectId, "&"), "assignment=").concat(this.assignment.assignmentId), this.assignment.assignment || "Assignment"), !this.portfolio ? (0, _index.html)(_templateObject6_6167d480942811ecb1937969798b231a || (_templateObject6_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["<em>Student</em>"]))) : this.fullName(this.portfolio), this.comment && this.comment !== "" ? "view-discussion" : "", !this.portfolio ? "grey" : this.accentColor(this.fullName(this.portfolio)), !this.portfolio ? "undefined" : this.fullName(this.portfolio), this.portfolio && this.portfolio.avatar ? this.portfolio.avatar : undefined, !this.portfolio ? "Loading..." : this.fullName(this.portfolio), !this.portfolio || !this.portfolio.project ? "" : (0, _index.html)(_templateObject7_6167d480942811ecb1937969798b231a || (_templateObject7_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n                  <span class=\"project-name\">", "</span>\n                "])), this.portfolio.project), this.sortLatest ? "false" : "true", !this.sortLatest ? "" : "sort-latest", function (e) {
          return _this2.sortLatest = !_this2.sortLatest;
        }, !this.sortLatest ? "Oldest First" : "Newest First", this.sortedSubmissions.map(function (s) {
          return (0, _index.html)(_templateObject8_6167d480942811ecb1937969798b231a || (_templateObject8_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n              <section\n                class=\"", "\"\n              >\n                <div class=\"submission-header\">\n                  <h2 id=\"sub-", "\">\n                    <span class=\"assignment-name\">", "</span>\n                    <span class=\"submission-date\"\n                      >Submitted:\n                      <local-time\n                        month=\"long\"\n                        day=\"numeric\"\n                        year=\"numeric\"\n                        hour=\"2-digit\"\n                        minute=\"2-digit\"\n                        second=\"2-digit\"\n                        time-zone-name=\"short\"\n                        datetime=\"", "\"\n                      >\n                        ", "\n                      </local-time>\n                    </span>\n                  </h2>\n                  <elmsln-studio-button\n                    id=\"sub-", "-toggle-button\"\n                    class=\"view-discussion-button\"\n                    aria-describedby=\"sub-", "\"\n                    icon=\"", "\"\n                    path=\"", "\"\n                  >\n                    <span class=\"sr-only\"\n                      >", "</span\n                    >\n                    <span class=\"sr-only\"\n                      >Give / View Feedback (", ")</span\n                    >\n                  </elmsln-studio-button>\n                </div>\n                <div class=\"submission-body\">\n                  ", "\n                </div>\n              </section>\n            "])), _this2.submissionFilter === s.id ? "section-discussion" : "", s.id, s.assignment, s.date, _this2.dateFormat(s.date), s.id, s.id, _this2.submissionFilter === s.id && _this2.comment ? "close" : _this2.getFeedbackIcon(s.feedback.length), _this2.getActivityLink(s, _this2.submissionFilter === s.id && _this2.comment), _this2.submissionFilter === s.id && _this2.comment ? "Close Feedback" : "View Feedback (".concat(s.feedback.length, ")"), s.feedback.length, s.links && s.links.length > 0 ? (0, _index.html)(_templateObject9_6167d480942811ecb1937969798b231a || (_templateObject9_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n                        <ul class=\"submission-links\">\n                          ", "\n                        </ul>\n                      "])), s.links.map(function (link) {
            return (0, _index.html)(_templateObject10_6167d480942811ecb1937969798b231a || (_templateObject10_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n                              <li>\n                                <elmsln-studio-link\n                                  href=\"", "\"\n                                  target=\"_blank\"\n                                  ?disabled=\"", "\"\n                                >\n                                  <simple-icon-lite\n                                    aria-hidden=\"true\"\n                                    icon=\"", "\"\n                                  ></simple-icon-lite>\n                                  ", "\n                                </elmsln-studio-link>\n                              </li>\n                            "])), link.url, _this2.submissionFilter !== s.id && _this2.comment ? true : false, link.type === "pdf" ? "hax:file-pdf" : "link", link.text || link.url);
          })) : !s.sources || s.sources.length === 0 ? (0, _index.html)(_templateObject11_6167d480942811ecb1937969798b231a || (_templateObject11_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral([" ", " "])), s.body) : _this2.getThumnailGrid(s, _this2.submissionFilter !== s.id && _this2.comment));
        }), !this.portfolio || !this.comment || this.comment === "", this.demoMode, this.feedback || [], this.nav);
      } // properties available to the custom element for data binding

    }, {
      key: "firstUpdated",
      value: function firstUpdated(changedProperties) {
        if (babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio.prototype), "firstUpdated", this)) babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio.prototype), "firstUpdated", this).call(this, changedProperties);
        this.fetchData("submissions");
        this.fetchData("portfolios");
        this.fetchData("discussion");
        console.log("updated", this.navigation, this.portfolios, this.feedback);
      }
    }, {
      key: "updated",
      value: function updated(changedProperties) {
        var _this3 = this;

        if (babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio.prototype), "updated", this)) babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio.prototype), "updated", this).call(this, changedProperties);
        changedProperties.forEach(function (oldValue, propName) {
          if (propName === "feedback") console.log("updated", _this3.feedback);
        });
      }
    }, {
      key: "nav",
      get: function get() {
        if (!this.navigation) return;
        var prevLabel = !this.navigation.prev ? "" : this.fullName(this.navigation.prev),
            nextLabel = !this.navigation.next ? "" : this.fullName(this.navigation.next),
            prevHref = !this.navigation.prev ? undefined : this.getActivityLink(this.navigation.prev, !this.comment, this.sortLatest),
            nextHref = !this.navigation.next ? undefined : this.getActivityLink(this.navigation.next, !this.comment, this.sortLatest);
        return this.prevNextNav(prevLabel, prevHref, nextLabel, nextHref);
      }
    }, {
      key: "sortedSubmissions",
      get: function get() {
        return !this.portfolio || !this.portfolio.submissions ? [] : this.sortDates(this.portfolio.submissions, this.sortLatest);
      }
    }, {
      key: "assignment",
      get: function get() {
        var _this4 = this;

        var filter = !this.portfolio || !this.portfolio.submissions ? [] : this.portfolio.submissions.filter(function (s) {
          return !_this4.submissionFilter || s.id === _this4.submissionFilter;
        });
        return !filter ? false : filter[0];
      }
    }], [{
      key: "styles",
      get: function get() {
        return [].concat(babelHelpers.toConsumableArray(babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio), "styles", this)), [(0, _index.css)(_templateObject12_6167d480942811ecb1937969798b231a || (_templateObject12_6167d480942811ecb1937969798b231a = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          display: block;\n          flex-wrap: wrap;\n        }\n        h1 {\n          text-align: center;\n        }\n        #breadcrumb {\n          margin: 0 0 var(--elmsln-studio-margin, 20px);\n          flex: 1 0 100%;\n          --elmsln-studio-link-Color: var(\n            --simple-colors-fixed-theme-light-blue-8\n          );\n          --elmsln-studio-link-focus-Color: var(\n            --simple-colors-fixed-theme-light-blue-9\n          );\n        }\n        #breadcrumb > * {\n          display: inline;\n        }\n        lrndesign-avatar,\n        .student-name,\n        .project-name,\n        .assignment-name,\n        .submission-date {\n          font-weight: normal;\n          display: block;\n        }\n        .student-name {\n          font-size: calc(2 * var(--elmsln-studio-FontSize, 16px));\n          font-weight: bold;\n          color: #4b4b4b;\n        }\n        .project-name {\n          font-size: calc(1.75 * var(--elmsln-studio-FontSize, 16px));\n          color: #95989a;\n        }\n        #project-buttons,\n        .submission-header {\n          position: relative;\n          height: 40px;\n          margin-top: -40px;\n        }\n        #sort,\n        .submission-header elmsln-studio-button {\n          color: #95989a;\n          font-size: var(--elmsln-studio-FontSize, 16px);\n          text-transform: uppercase;\n          position: absolute;\n          right: 0;\n          top: 0;\n        }\n        #sort:focus,\n        #sort:hover,\n        .submission-header elmsln-studio-button:focus,\n        .submission-header elmsln-studio-button:hover {\n          color: #4b4b4b;\n        }\n        #sort.sort-latest {\n          transform: rotateX(180deg) rotateY(0deg);\n        }\n        section {\n          border-top: 2px solid #eaeaea;\n          padding: calc(0.5 * var(--elmsln-studio-margin, 20px)) 0\n            var(--elmsln-studio-margin, 20px);\n        }\n        .view-discussion {\n          border: 1px solid #eaeaea;\n          padding: calc(0.5 * var(--elmsln-studio-margin, 20px));\n          --elmsln-studio-discussion-multiplier: 1;\n        }\n        .view-discussion section {\n          opacity: 0.4;\n          display: none;\n        }\n        .view-discussion section.section-discussion {\n          display: block;\n          opacity: 1;\n        }\n        h2 {\n          margin: calc(2 * var(--elmsln-studio-margin, 20px)) auto;\n          text-align: center;\n        }\n        .assignment-name {\n          font-size: calc(\n            1.25 * var(--elmsln-studio-discussion-multiplier, 1) *\n              var(--elmsln-studio-FontSize, 16px)\n          );\n          color: #555555;\n        }\n        .submission-date {\n          font-size: calc(\n            0.75 * var(--elmsln-studio-discussion-multiplier, 1) *\n              var(--elmsln-studio-FontSize, 16px)\n          );\n          color: #95989a;\n        }\n        .submission-body {\n          color: #95989a;\n          line-height: 160%;\n          margin: calc(0.5 * var(--elmsln-studio-margin, 20px)) auto\n            var(--elmsln-studio-margin, 20px);\n        }\n        .submission-body:first-child {\n          margin-top: 0;\n        }\n        .submission-body:last-child {\n          margin-bottom: 0;\n        }\n        .submission-links {\n          list-style: none;\n          padding-inline-start: 0;\n        }\n        .submission-links > li {\n          display: flex;\n          align-items: flex-start;\n          justify-content: flex-start;\n        }\n        .submission-links a:link,\n        .submission-links a:visited {\n          font-size: calc(1.5 * var(--elmsln-studio-FontSize, 16px));\n          font-weight: bold;\n          color: #000;\n          text-decoration: none;\n        }\n        .submission-links a:focus,\n        .submission-links a:hover {\n          text-decoration: underline;\n        }\n        .submission-links simple-icon-lite {\n          margin-right: 0.5em;\n        }\n        .submission-links a:focus simple-icon-lite,\n        .submission-links a:hover simple-icon-lite {\n          text-decoration: none;\n        }\n        .callout {\n          font-size: calc(0.75 * var(--elmsln-studio-FontSize, 16px));\n          border: 1px solid #eaeaea;\n          padding: 0;\n        }\n        .discussion-label {\n          text-align: left;\n          font-size: calc(1 * var(--elmsln-studio-FontSize, 16px));\n          margin: var(--elmsln-studio-margin, 20px) 0\n            calc(0.25 * var(--elmsln-studio-margin, 20px));\n        }\n        .callout > * {\n          padding: calc(0.25 * var(--elmsln-studio-margin, 20px))\n            calc(0.5 * var(--elmsln-studio-margin, 20px));\n        }\n        .callout .callout-label {\n          font-size: calc(1 * var(--elmsln-studio-FontSize, 16px));\n          font-weight: normal;\n          display: flex;\n          align-items: center;\n          justify-content: flex-start;\n          margin: 0;\n          color: #4b4b4b;\n          border-bottom: 1px solid #eaeaea;\n        }\n        .callout .callout-label simple-icon-lite {\n          margin-right: 1em;\n        }\n        threaded-discussion {\n          background-color: #eaeaea;\n          padding: 1px;\n          --threaded-discussion-comment-button-BackgroundColor: var(\n            --simple-colors-fixed-theme-light-blue-8\n          );\n          --threaded-discussion-comment-button-focus-BackgroundColor: var(\n            --simple-colors-fixed-theme-light-blue-9\n          );\n        }\n        #prev-next-nav {\n          z-index: 1;\n          display: flex;\n        }\n        @media screen and (min-width: 600px) {\n          :host {\n            display: flex;\n            align-items: flex-start;\n            justify-content: space-between;\n          }\n          #primary {\n            flex: 1 0 100%;\n          }\n          #primary.view-discussion {\n            flex: 0 0 calc(50% - var(--elmsln-studio-margin, 20px));\n          }\n          #primary:not(.view-discussion) {\n            max-width: calc(1000px - 2 * var(--elmsln-studio-margin, 20px));\n            margin: 0 auto;\n            border: 1px solid #eaeaea;\n            padding: var(--elmsln-studio-margin, 20px);\n          }\n          .view-discussion {\n            --elmsln-studio-discussion-multiplier: 0.5;\n          }\n          .assignment-name {\n            font-size: calc(\n              1.5 * var(--elmsln-studio-discussion-multiplier, 1) *\n                var(--elmsln-studio-FontSize, 16px)\n            );\n          }\n          .submission-date {\n            font-size: calc(\n              1 * var(--elmsln-studio-discussion-multiplier, 1) *\n                var(--elmsln-studio-FontSize, 16px)\n            );\n          }\n          .view-discussion section {\n            display: block;\n          }\n          .view-discussion section.section-discussion {\n            border: 4px solid #95989a;\n            padding: calc(0.5 * var(--elmsln-studio-margin, 20px))\n              calc(0.5 * var(--elmsln-studio-margin, 20px))\n              var(--elmsln-studio-margin, 20px);\n            opacity: 1;\n          }\n          #secondary {\n            flex: 0 0 calc(50% - var(--elmsln-studio-margin, 20px));\n          }\n        }\n        @media screen and (min-width: 1000px) {\n          .view-discussion {\n            --elmsln-studio-discussion-multiplier: 0.75;\n          }\n        }\n        @media screen and (min-width: 1200px) {\n          .view-discussion {\n            --elmsln-studio-discussion-multiplier: 1;\n          }\n        }\n      "])))]);
      }
    }, {
      key: "properties",
      get: function get() {
        return _objectSpread(_objectSpread({}, babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioPortfolio), "properties", this)), {}, {
          /**
           * all submissions that match a specified student id and project id
           */
          portfolio: {
            type: Object
          },

          /**
           * all feedback on submissions that match a specified student id and project id
           */
          feedback: {
            type: Object
          },

          /**
           * comment id
           */
          comment: {
            type: String,
            attribute: "comment"
          },

          /**
           * gets submission previous next navigation
           */
          navigation: {
            type: Object,
            attribute: "navigation"
          },

          /**
           * submission id to select submission and filter feedback
           */
          submissionFilter: {
            type: String,
            attribute: "submission-filter"
          },

          /**
           * sort submissions latest first instead of oldest first
           */
          sortLatest: {
            type: Boolean,
            attribute: "sort-latest",
            reflect: true
          }
        });
      }
      /**
       * Store the tag name to make it easier to obtain directly.
       * @notice function name must be here for tooling to operate correctly
       */

    }, {
      key: "tag",
      get: function get() {
        return "elmsln-studio-portfolio";
      }
    }]);
    return ElmslnStudioPortfolio;
  }((0, _elmslnStudioUtilities.ElmslnStudioUtilities)((0, _elmslnStudioStyles.ElmslnStudioStyles)(_index.LitElement)));

  _exports.ElmslnStudioPortfolio = ElmslnStudioPortfolio;
  customElements.define("elmsln-studio-portfolio", ElmslnStudioPortfolio);
});