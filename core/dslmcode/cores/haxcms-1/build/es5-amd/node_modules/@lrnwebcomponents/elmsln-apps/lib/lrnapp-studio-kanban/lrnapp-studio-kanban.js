define(["exports", "../../../../@polymer/polymer/polymer-element.js", "../../../../@polymer/polymer/lib/legacy/polymer.dom.js", "../../../../@polymer/iron-ajax/iron-ajax.js", "../../../../@polymer/app-route/app-location.js", "../elmsln-base-deps.js", "../../../../@polymer/app-route/app-route.js", "../../../simple-icon/simple-icon.js", "../../../simple-icon/lib/simple-icons.js", "../../../simple-icon/lib/simple-icon-button.js", "../../../hax-iconset/lib/simple-hax-iconset.js", "../../../../@polymer/paper-badge/paper-badge.js", "../../../../@polymer/paper-toggle-button/paper-toggle-button.js", "../../../../@polymer/app-layout/app-toolbar/app-toolbar.js", "../../../../@polymer/app-layout/app-header/app-header.js", "../../../../@polymer/iron-list/iron-list.js", "../../../../@polymer/paper-toast/paper-toast.js", "../../../../@polymer/paper-dialog/paper-dialog.js", "../../../lrnsys-render-html/lrnsys-render-html.js", "../../../lrnsys-layout/lib/lrnsys-dialog.js", "../../../lrnsys-button/lrnsys-button.js", "../../../elmsln-loading/elmsln-loading.js", "../../../materializecss-styles/materializecss-styles.js", "./lrnapp-studio-project-button.js", "./lrnapp-studio-assignment-button.js", "../lrnapp-studio-submission/lrnapp-studio-submission-button.js", "../../../utils/utils.js"], function (_exports, _polymerElement, _polymerDom, _ironAjax, _appLocation, _elmslnBaseDeps, _appRoute, _simpleIcon, _simpleIcons, _simpleIconButton, _simpleHaxIconset, _paperBadge, _paperToggleButton, _appToolbar, _appHeader, _ironList, _paperToast, _paperDialog, _lrnsysRenderHtml, _lrnsysDialog, _lrnsysButton, _elmslnLoading, _materializecssStyles, _lrnappStudioProjectButton, _lrnappStudioAssignmentButton, _lrnappStudioSubmissionButton, _utils) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.LrnappStudioKanban = void 0;

  var _templateObject_eb143e308e0011ed99ce491205e67b1d;

  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = babelHelpers.getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = babelHelpers.getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return babelHelpers.possibleConstructorReturn(this, result); }; }

  function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

  var LrnappStudioKanban = /*#__PURE__*/function (_PolymerElement) {
    babelHelpers.inherits(LrnappStudioKanban, _PolymerElement);

    var _super = _createSuper(LrnappStudioKanban);

    function LrnappStudioKanban() {
      babelHelpers.classCallCheck(this, LrnappStudioKanban);
      return _super.apply(this, arguments);
    }

    babelHelpers.createClass(LrnappStudioKanban, [{
      key: "lastErrorChanged",
      value:
      /**
       * Handle the last error rolling in
       */
      function lastErrorChanged(e) {
        if (e.detail.value) {
          console.error(e);
          var target = (0, _utils.normalizeEventPath)(e)[0]; // check for JWT needing refreshed vs busted but must be 403

          switch (parseInt(e.detail.value.status)) {
            // cookie data not found, need to go get it
            // @notice this currently isn't possible but we could modify
            // the backend in the future to support throwing 401s dynamically
            // if we KNOW an event must expire the timing token
            case 401:
            case 401:
              // we know what the "target" is as an iron-ajax tag
              // so we know what call was just attempted. Let's await
              // a fetch against the top level site landing page with
              // no-cors will force a hit against the backend to refresh
              // the PHP session / bounce back from Azure as needed
              // so that when we reissue this call it'll go through (magically)
              fetch(window.Drupal.settings.basePath, {
                mode: "no-cors"
              }).then(function (e) {
                console.log(e); // delay just to be sure

                setTimeout(function () {
                  target.generateRequest();
                }, 250);
              });
              break;
          }
        }
      }
    }, {
      key: "connectedCallback",
      value: function connectedCallback() {
        babelHelpers.get(babelHelpers.getPrototypeOf(LrnappStudioKanban.prototype), "connectedCallback", this).call(this);
        window.dispatchEvent(new Event("resize"));
        this.addEventListener("project-created", this._handleProjectCreated.bind(this));
        this.addEventListener("assignment-created", this._handleAssignmentCreated.bind(this));
        setTimeout(function () {
          window.dispatchEvent(new Event("resize"));
        }, 1000);
      }
    }, {
      key: "disconnectedCallback",
      value: function disconnectedCallback() {
        this.removeEventListener("project-created", this._handleProjectCreated.bind(this));
        this.removeEventListener("assignment-created", this._handleAssignmentCreated.bind(this));
        babelHelpers.get(babelHelpers.getPrototypeOf(LrnappStudioKanban.prototype), "disconnectedCallback", this).call(this);
      }
    }, {
      key: "_routeChanged",
      value: // If the current route is outside the scope of our app
      // then allow the website to break out of the single page
      // application routing
      function _routeChanged(route, endPoint) {
        if (typeof route.path === "string") {
          if (typeof endPoint === "string") {
            if (route.path.startsWith(endPoint) || route.path == "/") {
              return;
            }
          }

          window.location.reload();
        }
      }
      /**
       * Support having a toast message because of delete or error elsewhere.
       */

    }, {
      key: "_deleteToast",
      value: function _deleteToast(deletetoast, old) {
        if (babelHelpers.typeof(deletetoast) !== (typeof undefined === "undefined" ? "undefined" : babelHelpers.typeof(undefined))) {
          if (deletetoast == "error") {
            this.$.toast.show("That submission on longer exists!");
          } else {
            this.$.toast.show("Submission deleted successfully!");
          }

          this.set("queryParams.deletetoast", undefined);
          this.notifyPath("queryParams.deletetoast");
        }
      }
      /**
       * @todo  remove this once we have a modal for it
       */

    }, {
      key: "_makeProjectEditLink",
      value: function _makeProjectEditLink(e) {
        var normalizedEvent = (0, _polymerDom.dom)(e);
        var local = normalizedEvent.localTarget;
        var parts = local.id.split("-");
        window.location.href = this.basePath + "../node/" + parts[1] + "/edit?destination=apps/lrnapp-studio-kanban";
      }
      /**
       * @todo  remove this once we have a modal for it
       */

    }, {
      key: "_makeAssignmentEditLink",
      value: function _makeAssignmentEditLink(e) {
        var normalizedEvent = (0, _polymerDom.dom)(e);
        var local = normalizedEvent.localTarget;
        var parts = local.id.split("-");
        window.location.href = this.basePath + "../node/" + parts[2] + "/edit?destination=apps/lrnapp-studio-kanban";
      }
      /**
       * Handle the push to delete a project, pop up the modal.
       */

    }, {
      key: "_deleteProjectDialog",
      value: function _deleteProjectDialog(e) {
        var normalizedEvent = (0, _polymerDom.dom)(e);
        var local = normalizedEvent.localTarget;
        var parts = local.id.split("-"); // set values so we know what to drop

        this.projectToDelete = parts[1];
        this._deleteTitle = "Delete project";
        this._deleteText = "Are you sure you want to delete this project and all related assignments!?";
        this._deleteType = "project";
        this.$.delete.open();
      }
      /**
       * Handle the call to delete the assignment specified.
       */

    }, {
      key: "_handleDelete",
      value: function _handleDelete() {
        if (this._deleteType == "project") {
          this.$.backend.method = "DELETE";
          this.$.backend.body = this.projectToDelete;
          this.$.backend.url = this.endPoint + "/api/projects/" + this.projectToDelete + "?token=" + this.csrfToken;
          this.$.backend.generateRequest();
        } else if (this._deleteType == "assignment") {
          this.$.backend.method = "DELETE";
          this.$.backend.body = this.assignmentToDelete;
          this.$.backend.url = this.endPoint + "/api/assignments/" + this.assignmentToDelete + "?token=" + this.csrfToken;
          this.$.backend.generateRequest();
        }
      }
      /**
       * Handle the push to delete an assignment, pop up the modal.
       */

    }, {
      key: "_deleteAssignmentDialog",
      value: function _deleteAssignmentDialog(e) {
        var normalizedEvent = (0, _polymerDom.dom)(e);
        var local = normalizedEvent.localTarget;
        var parts = local.id.split("-");
        this.assignmentToDelete = parts[2]; // set values so we know what to drop

        this._deleteTitle = "Delete assignment";
        this._deleteText = "Are you sure you want to delete this assignment?";
        this._deleteType = "assignment";
        this.$.delete.open();
      }
      /**
       * if we should show new badge based on new comment count.
       */

    }, {
      key: "displayNewBadge",
      value: function displayNewBadge(count) {
        if (babelHelpers.typeof(count) === (typeof undefined === "undefined" ? "undefined" : babelHelpers.typeof(undefined)) || count == 0) {
          return true;
        }

        return false;
      }
      /**
       * Handle toggling the status for the submission.
       */

    }, {
      key: "statusToggle",
      value: function statusToggle(e) {
        // find our xhr for callbacks
        var xhr = this.$.backend; // break the id out into project and assignment

        var parts = this.activeAssignment.split("-"); // focus in on the submissions / assignment meta

        var submission = this.projectResponse.data.projects["project-" + parts[1]].relationships.assignments["assignment-" + parts[2]].meta.relatedSubmissions.complete; // ensure this isn't disabled though it shouldn't be possible

        if (!this.shadowRoot.querySelector("#activetoggle").disabled) {
          // hide the loading screen
          this.$.loading.hidden = false; // queue of the request parameters

          xhr.params = {
            submissionid: submission.submission.id,
            status: this.shadowRoot.querySelector("#activetoggle").checked
          }; // send the request

          xhr.generateRequest();
        }
      }
      /**
       * Handle toggle for mouse class and manage classList array for button.
       */

    }, {
      key: "assignmentClick",
      value: function assignmentClick(e) {
        var normalizedEvent = (0, _polymerDom.dom)(e);
        var local = normalizedEvent.localTarget;

        if (local.tagName === "SPAN") {
          local = local.parentNode;
        }

        if (this.activeAssignment != null && this.activeAssignment != local.id) {
          this.shadowRoot.querySelector("#" + this.activeAssignment).nextElementSibling.classList.remove("show");
          this.shadowRoot.querySelector("#" + this.activeAssignment).classList.remove("active");
        }

        this.activeAssignment = local.id;
        var parts = this.activeAssignment.split("-");
        this.activeAssignmentNode = this.projectResponse.data.projects["project-" + parts[1]].relationships.assignments["assignment-" + parts[2]];

        this._setToggle(false);

        local.nextElementSibling.classList.add("show");
        local.classList.add("active");
        this.$.activeitemcontainer.toggle();
      }
      /**
       * Handle response for the whole projects object.
       */

    }, {
      key: "_handleProjectResponse",
      value: function _handleProjectResponse(event) {
        var _this = this;

        this.$.loading.hidden = true;

        this._setToggle(true);

        window.dispatchEvent(new Event("resize"));

        if (this.activeAssignment) {
          setTimeout(function () {
            var parts = _this.activeAssignment.split("-");

            _this.set("activeAssignmentNode", {});

            _this.activeAssignmentNode = _this.projectResponse.data.projects["project-" + parts[1]].relationships.assignments["assignment-" + parts[2]];
            window.dispatchEvent(new Event("resize"));
          }, 100);
        }
      }
      /**
       * buildSubmissionPath for generating a new submission or linking to existing.
       */

    }, {
      key: "buildSubmissionPath",
      value: function buildSubmissionPath(path) {
        return path + "lrnapp-studio-submission";
      }
    }, {
      key: "ready",
      value: function ready() {
        babelHelpers.get(babelHelpers.getPrototypeOf(LrnappStudioKanban.prototype), "ready", this).call(this);
        window.dispatchEvent(new Event("resize"));
      }
      /**
       * Handle a response from updating an item
       */

    }, {
      key: "_handleUpdateResponse",
      value: function _handleUpdateResponse(event) {
        var _this2 = this;

        if (this.backendResponse.status == 200) {
          this.$.toast.text = "Updated successfully";
          this.$.toast.toggle();
          window.dispatchEvent(new Event("resize")); // this will force a repaint of the UI pieces on reload

          this.set("projectResponse", {});
          this.$.projectbackend.generateRequest();
          setTimeout(function () {
            var parts = _this2.activeAssignment.split("-");

            window.dispatchEvent(new Event("resize"));

            _this2.set("activeAssignmentNode", {});

            _this2.activeAssignmentNode = _this2.projectResponse.data.projects["project-" + parts[1]].relationships.assignments["assignment-" + parts[2]];
          }, 500);
        } else {
          // this would imply an error
          this.$.loading.hidden = true;
        }
      }
      /**
       * set the toggle state when assignment gets focus
       */

    }, {
      key: "_setToggle",
      value: function _setToggle(update) {
        if (this.activeAssignment != null) {
          var parts = this.activeAssignment.split("-"); // focus in on the submissions / assignment meta

          var submission = this.projectResponse.data.projects["project-" + parts[1]].relationships.assignments["assignment-" + parts[2]].meta.relatedSubmissions.complete; // not finished but also not started

          if (submission.status == 0 && submission.submission.length == 0) {
            if (!update) {
              this.shadowRoot.querySelector("#activetoggle").disabled = true;
              this.shadowRoot.querySelector("#activetoggle").checked = false;
            }

            this.shadowRoot.querySelector("#activetoggle").title = "Submission not started";
            this.shadowRoot.querySelector("#activetoggletext").textContent = "Submission not started";
          } else if (submission.status == 0) {
            if (!update) {
              this.shadowRoot.querySelector("#activetoggle").disabled = false;
              this.shadowRoot.querySelector("#activetoggle").checked = false;
            }

            this.shadowRoot.querySelector("#activetoggle").title = "Submission started";
            this.shadowRoot.querySelector("#activetoggletext").textContent = "Submission in progress";
          } else {
            if (!update) {
              this.shadowRoot.querySelector("#activetoggle").disabled = false;
              this.shadowRoot.querySelector("#activetoggle").checked = true;
            }

            this.shadowRoot.querySelector("#activetoggle").title = "Submission ready";
            this.shadowRoot.querySelector("#activetoggletext").textContent = "Submission ready";
          }
        }
      }
      /**
       * Event came from the project button to indicate it was successful.
       */

    }, {
      key: "_handleProjectCreated",
      value: function _handleProjectCreated(e) {
        this.$.toast.text = "Project added";
        this.$.toast.toggle();
        this.$.projectbackend.generateRequest();
        setTimeout(function () {
          window.dispatchEvent(new Event("resize"));
        }, 100);
      }
      /**
       * Event came from the assignment button to indicate it was successful.
       */

    }, {
      key: "_handleAssignmentCreated",
      value: function _handleAssignmentCreated(e) {
        this.$.toast.text = "Assignment added";
        this.$.toast.toggle();
        this.$.projectbackend.generateRequest();
        setTimeout(function () {
          window.dispatchEvent(new Event("resize"));
        }, 100);
      }
      /*
       * Simple way to convert from object to array.
       */

    }, {
      key: "_toArray",
      value: function _toArray(obj) {
        if (obj == null) {
          return [];
        }

        return Object.keys(obj).map(function (key) {
          return obj[key];
        });
      }
    }], [{
      key: "template",
      get: function get() {
        return (0, _polymerElement.html)(_templateObject_eb143e308e0011ed99ce491205e67b1d || (_templateObject_eb143e308e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n      <style include=\"materializecss-styles\">\n        [hidden] {\n          display: none !important;\n        }\n        :host {\n          display: block;\n        }\n        div.card {\n          box-shadow: 0 5px 5px rgba(0, 0, 0, 0.7);\n        }\n        #loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.8;\n          text-align: center;\n          align-content: center;\n          justify-content: center;\n          height: 100vh;\n          position: absolute;\n          background-color: white;\n        }\n        .projects-container {\n          -webkit-box-pack: start;\n          -ms-flex-pack: start;\n          justify-content: flex-start;\n          -webkit-box-align: start;\n          -ms-flex-align: start;\n          align-items: flex-start;\n          min-height: 23em;\n        }\n        @media screen and (max-width: 800px) {\n          .projects-container {\n            width: auto;\n          }\n        }\n        #activetoggle {\n          padding-left: 16px;\n        }\n        .card-content {\n          scrollbar-face-color: #aa5555;\n          scrollbar-shadow-color: #ffc107;\n          scrollbar-highlight-color: #ffc107;\n          scrollbar-3dlight-color: #ffc107;\n          scrollbar-darkshadow-color: #ffc107;\n          scrollbar-track-color: #ffc107;\n          scrollbar-arrow-color: #ffc107;\n        }\n        .card-content::-webkit-scrollbar-track {\n          background-color: #833900;\n        }\n        /* the new scrollbar will have a flat appearance with the set background color */\n        .card-content::-webkit-scrollbar-thumb {\n          background-color: #ffc107;\n        }\n        /* this will style the thumb, ignoring the track */\n        .card-content::-webkit-scrollbar-button {\n          background-color: #833900;\n        }\n        /* optionally, you can style the top and the bottom buttons (left and right for horizontal bars) */\n        .card-content::-webkit-scrollbar-corner {\n          background-color: #833900;\n        }\n        /* if both the vertical and the horizontal bars appear, then perhaps the right bottom corner*/\n        .card-content::-webkit-scrollbar {\n          width: 10px;\n          height: 10px;\n        }\n        /* this targets the default scrollbar (compulsory) */\n        button {\n          padding: 0;\n          margin: 0;\n          min-width: 12px;\n        }\n        .project-card {\n          width: 320px;\n          margin: 0;\n          height: 100%;\n          min-height: 10em;\n        }\n        .project-card h3.header {\n          font-size: 16px;\n          word-break: break-all;\n          padding: 8px;\n          overflow: hidden;\n          margin: 0;\n        }\n        div.card {\n          box-shadow: 0 5px 5px rgba(0, 0, 0, 0.7);\n        }\n        .project-container {\n          padding: 16px;\n        }\n        .project-card .card-content {\n          height: 320px;\n          overflow-y: auto;\n          padding: 0;\n        }\n        .assignment-container {\n          height: 100%;\n        }\n        .project-container:hover .project-operations {\n          display: block;\n        }\n        .project-operations {\n          position: absolute;\n          top: 8px;\n          right: -20px;\n          display: none;\n          transform: scale(0.6);\n        }\n        .project-operations .operation {\n          --lrnsys-button-height: 48px;\n          display: inline-flex;\n        }\n        .project-operations .operation[hidden] {\n          display: none;\n        }\n        .assignment-row {\n          height: 40px;\n          border: 1px solid #000000;\n          background-color: #ffffff;\n        }\n        .assignment-row .assignment-row-button.active {\n          background-color: var(--paper-amber-50);\n          font-weight: bold;\n        }\n        .assignment-row-title {\n          font-size: 16px;\n          text-align: left;\n          line-height: 16px;\n          margin-top: 8px;\n          overflow: hidden;\n        }\n        .assignment-row:hover .assignment-operations {\n          display: block;\n          overflow: visible;\n        }\n        .assignment-row-button {\n          width: 100%;\n          justify-content: flex-start;\n          text-transform: none;\n        }\n        .assignment-row-button::part(lrnsys-button-inner-div) {\n          padding: 0;\n        }\n        .assignment-row-button[icon=\"assignment\"]::part(lrnsys-button-icon) {\n          --simple-icon-color: black;\n        }\n        .assignment-row-button[icon=\"assignment-late\"]::part(lrnsys-button-icon) {\n          --simple-icon-color: orangered;\n        }\n        .assignment-row-button[icon=\"done\"]::part(lrnsys-button-icon) {\n          --simple-icon-color: green;\n        }\n        .status-indicator {\n          border-right: 1px solid grey;\n          padding: 0.5em;\n          margin: 0 0.5em 0 0;\n          display: inline-flex;\n          line-height: 40px;\n          height: 40px;\n          justify-content: center;\n          align-items: center;\n        }\n        .button-contents {\n          display: flex;\n          align-content: center;\n        }\n        .assignment-operations {\n          position: absolute;\n          padding: 0;\n          display: none;\n          top: -14px;\n          right: -18px;\n          padding: 0;\n          transform: scale(0.6);\n        }\n        .assignment-operations.show {\n          display: block;\n          overflow: visible;\n        }\n        .assignment-operations .operation {\n          display: inline-flex;\n          width: 40px;\n          height: 40px;\n          margin: 10px 10px 0 0;\n        }\n        .assignment-operations .operation[hidden] {\n          display: none;\n        }\n        lrnapp-studio-project-button {\n          margin: 0em auto;\n          max-width: 10em;\n        }\n        lrnsys-button {\n          --lrnsys-button-height: 40px;\n        }\n      </style>\n      <iron-ajax\n        reject-with-request\n        on-last-error-changed=\"lastErrorChanged\"\n        auto=\"\"\n        id=\"projectbackend\"\n        url=\"[[sourcePath]]\"\n        handle-as=\"json\"\n        last-response=\"{{projectResponse}}\"\n        on-response=\"_handleProjectResponse\"\n      >\n      </iron-ajax>\n      <iron-ajax\n        reject-with-request\n        on-last-error-changed=\"lastErrorChanged\"\n        id=\"backend\"\n        url=\"[[sourcePath]]\"\n        params=\"\"\n        handle-as=\"json\"\n        last-response=\"{{backendResponse}}\"\n        on-response=\"_handleUpdateResponse\"\n      >\n      </iron-ajax>\n\n      <app-location\n        route=\"{{route}}\"\n        query-params=\"{{queryParams}}\"\n      ></app-location>\n      <app-route\n        route=\"{{route}}\"\n        pattern=\"[[endPoint]]/:page\"\n        data=\"{{data}}\"\n        tail=\"{{tail}}\"\n        query-params=\"{{queryParams}}\"\n      >\n      </app-route>\n      <div id=\"loading\">\n        <h3>Loading..</h3>\n        <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n      </div>\n      <lrnapp-studio-project-button\n        hidden$=\"[[!projectResponse.data.canCreateProjects]]\"\n        classes=\"amber darken-4 white-text\"\n        end-point=\"[[endPoint]]\"\n        csrf-token=\"[[csrfToken]]\"\n        icon=\"add\"\n      ></lrnapp-studio-project-button>\n      <div class=\"projects-window\">\n        <iron-list\n          items=\"[[_toArray(projectResponse.data.projects)]]\"\n          as=\"project\"\n          class=\"projects-container\"\n          grid=\"\"\n          mutable-data\n        >\n          <template class=\"projects-container-items\">\n            <div class=\"project-container\">\n              <div\n                id$=\"project-[[project.id]]\"\n                class=\"project-card grey lighten-3 card\"\n              >\n                <h3 class=\"header\">[[project.attributes.title]]</h3>\n                <div class=\"project-operations\">\n                  <lrnsys-button\n                    icon-class=\"no-margin\"\n                    id$=\"project-[[project.id]]-edit\"\n                    title=\"Edit project\"\n                    class=\"operation\"\n                    hover-class=\"amber lighten-2\"\n                    hidden=\"[[!project.meta.canUpdate]]\"\n                    icon=\"create\"\n                    on-click=\"_makeProjectEditLink\"\n                  >\n                  </lrnsys-button>\n                  <lrnapp-studio-assignment-button\n                    project-id=\"[[project.id]]\"\n                    icon-class=\"no-margin\"\n                    id$=\"project-[[project.id]]-add\"\n                    title=\"Add assignment\"\n                    class=\"operation\"\n                    hover-class=\"amber lighten-2\"\n                    hidden=\"[[!project.meta.canUpdate]]\"\n                    icon=\"add\"\n                    end-point=\"[[endPoint]]\"\n                    csrf-token=\"[[csrfToken]]\"\n                  >\n                  </lrnapp-studio-assignment-button>\n                  <lrnsys-button\n                    id$=\"project-[[project.id]]-delete\"\n                    title=\"Delete project!\"\n                    class=\"operation\"\n                    hover-class=\"red darken-2 white-text\"\n                    header=\"Delete project!\"\n                    hidden=\"[[!project.meta.canDelete]]\"\n                    icon=\"delete-forever\"\n                    on-click=\"_deleteProjectDialog\"\n                    icon-class=\"no-margin\"\n                  >\n                  </lrnsys-button>\n                </div>\n                <div class=\"card-content\">\n                  <iron-list\n                    items=\"[[_toArray(project.relationships.assignments)]]\"\n                    as=\"assignment\"\n                    mutable-data\n                    class=\"assignment-container\"\n                  >\n                    <template>\n                      <div class=\"assignment-row\" id=\"assignment\">\n                        <lrnsys-button\n                          id$=\"assignment-[[project.id]]-[[assignment.id]]\"\n                          class=\"assignment-row-button\"\n                          hover-class=\"amber lighten-5\"\n                          on-click=\"assignmentClick\"\n                          icon=\"[[assignment.meta.relatedSubmissions.complete.icon]]\"\n                        >\n                          <span class=\"assignment-row-title\"\n                            >[[assignment.attributes.title]]</span\n                          >\n                        </lrnsys-button>\n                        <span class=\"assignment-operations\">\n                          <lrnsys-button\n                            id$=\"assignment-[[project.id]]-[[assignment.id]]-add-critique\"\n                            icon=\"editor:insert-comment\"\n                            title=\"Add critique\"\n                            class=\"operation\"\n                            hover-class=\"green lighten-2\"\n                            hidden=\"[[!assignment.meta.canCritique]]\"\n                            href$=\"[[assignment.meta.critiqueLink]]\"\n                            icon-class=\"no-margin\"\n                          ></lrnsys-button>\n                          <lrnsys-button\n                            id$=\"assignment-[[project.id]]-[[assignment.id]]-edit\"\n                            icon=\"editor:mode-edit\"\n                            title=\"Edit\"\n                            class=\"operation\"\n                            hover-class=\"amber lighten-2\"\n                            hidden=\"[[!assignment.meta.canUpdate]]\"\n                            on-click=\"_makeAssignmentEditLink\"\n                            icon-class=\"no-margin green-text text-darken-4\"\n                          ></lrnsys-button>\n                          <lrnsys-button\n                            id$=\"assignment-[[project.id]]-[[assignment.id]]-delete\"\n                            icon=\"delete-forever\"\n                            title=\"Delete\"\n                            class=\"operation\"\n                            hover-class=\"red darken-2 white-text\"\n                            hidden=\"[[!assignment.meta.canDelete]]\"\n                            on-click=\"_deleteAssignmentDialog\"\n                            icon-class=\"no-margin red-text text-darken-4\"\n                          ></lrnsys-button>\n                        </span>\n                      </div>\n                    </template>\n                  </iron-list>\n                </div>\n              </div>\n            </div>\n          </template>\n        </iron-list>\n      </div>\n      <paper-toast text=\"Updated\" id=\"toast\"></paper-toast>\n      <paper-dialog id=\"delete\" modal=\"\">\n        <h3>[[_deleteTitle]]</h3>\n        <p>[[_deleteText]]</p>\n        <div class=\"buttons\">\n          <button dialog-dismiss=\"\">Decline</button>\n          <button\n            id=\"deleteaccept\"\n            on-click=\"_handleDelete\"\n            dialog-confirm=\"\"\n            autofocus=\"\"\n          >\n            Accept\n          </button>\n        </div>\n      </paper-dialog>\n      <paper-dialog id=\"activeitemcontainer\" with-backdrop>\n        <div id=\"activecontent\">\n          <app-header reveals>\n            <app-toolbar\n              class$=\"[[activeAssignmentNode.meta.relatedSubmissions.complete.color]]\"\n            >\n              <div>\n                <simple-icon\n                  icon=\"[[activeAssignmentNode.meta.relatedSubmissions.complete.icon]]\"\n                  disabled$=\"[[!activeAssignmentNode.meta.relatedSubmissions.canCreate]]\"\n                ></simple-icon>\n                [[activeAssignmentNode.meta.relatedSubmissions.complete.submission.title]]\n              </div>\n              <div\n                spacer=\"\"\n                class=\"comment-box\"\n                hidden$=\"[[!activeAssignmentNode.meta.relatedSubmissions.complete.submission.id]]\"\n              >\n                <div\n                  id$=\"assignment-[[activeAssignmentNode.relationships.project.data.id]]-[[activeAssignmentNode.id]]-comments\"\n                  style=\"margin:0;padding:.25em;text-transform:none;\"\n                >\n                  <simple-icon icon=\"communication:forum\"></simple-icon>\n                  [[activeAssignmentNode.meta.relatedSubmissions.complete.submission.meta.comments.count]]\n                  Comments\n                </div>\n                <paper-badge\n                  hidden$=\"[[displayNewBadge(activeAssignmentNode.meta.relatedSubmissions.complete.submission.meta.new)]]\"\n                  for$=\"assignment-[[activeAssignmentNode.relationships.project.data.id]]-[[activeAssignmentNode.id]]-comments\"\n                  label$=\"[[activeAssignmentNode.meta.relatedSubmissions.complete.submission.meta.comments.new]]\"\n                ></paper-badge>\n              </div>\n\n              <lrnapp-studio-submission-button\n                spacer\n                auto\n                assignment-id=\"[[activeAssignmentNode.id]]\"\n                submission=\"{{submission}}\"\n                end-point=\"[[buildSubmissionPath(basePath)]]\"\n                csrf-token=\"[[csrfToken]]\"\n                submission-id=\"[[activeAssignmentNode.meta.relatedSubmissions.complete.submission.id]]\"\n              ></lrnapp-studio-submission-button>\n              <paper-toggle-button\n                id=\"activetoggle\"\n                on-click=\"statusToggle\"\n              ></paper-toggle-button>\n              <span id=\"activetoggletext\"></span>\n            </app-toolbar>\n            <div class=\"status-rationale\">\n              [[activeAssignmentNode.meta.relatedSubmissions.complete.rationale.text]]\n            </div>\n          </app-header>\n          <lrnsys-render-html\n            style=\"padding:2em;\"\n            html=\"[[activeAssignmentNode.attributes.body]]\"\n          ></lrnsys-render-html>\n        </div>\n      </paper-dialog>\n    "])));
      }
    }, {
      key: "tag",
      get: function get() {
        return "lrnapp-studio-kanban";
      }
    }, {
      key: "properties",
      get: function get() {
        return {
          elmslnCourse: {
            type: String
          },
          elmslnSection: {
            type: String
          },
          basePath: {
            type: String,
            notify: true
          },
          csrfToken: {
            type: String,
            notify: true
          },
          endPoint: {
            type: String,
            notify: true
          },
          activeAssignment: {
            type: String,
            value: null,
            notify: true
          },
          activeAssignmentNode: {
            type: Object
          },
          projectToDelete: {
            type: String,
            value: null,
            notify: true
          },
          assignmentToDelete: {
            type: String,
            value: null,
            notify: true
          },
          sourcePath: {
            type: String,
            notify: true
          },

          /**
           * Submission for two-way data binding on return from the button being pushed
           */
          submission: {
            type: Object,
            notify: true
          },

          /**
           * Response from the server.
           */
          projectResponse: {
            type: Object,
            notify: true
          },

          /**
           * Response from the server for non-project requests.
           */
          backendResponse: {
            type: Object,
            notify: true
          }
        };
      }
    }, {
      key: "observers",
      get: function get() {
        return ["_routeChanged(route, endPoint)", "_deleteToast(queryParams.deletetoast)"];
      }
    }]);
    return LrnappStudioKanban;
  }(_polymerElement.PolymerElement);

  _exports.LrnappStudioKanban = LrnappStudioKanban;
  customElements.define(LrnappStudioKanban.tag, LrnappStudioKanban);
});