define(["exports", "../../../lit/index.js", "./simple-fields-fieldset.js", "./simple-fields-ui.js", "../../simple-toolbar/lib/simple-toolbar-button.js", "../../simple-icon/simple-icon.js", "../../simple-icon/lib/simple-icons.js", "./simple-fields-array-item.js", "../../responsive-utility/responsive-utility.js"], function (_exports, _index, _simpleFieldsFieldset, _simpleFieldsUi, _simpleToolbarButton, _simpleIcon, _simpleIcons, _simpleFieldsArrayItem, _responsiveUtility) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.SimpleFieldsArray = void 0;

  var _templateObject_dd58ec508e0011ed99ce491205e67b1d, _templateObject2_dd58ec508e0011ed99ce491205e67b1d, _templateObject3_dd58ec508e0011ed99ce491205e67b1d;

  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { babelHelpers.defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = babelHelpers.getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = babelHelpers.getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return babelHelpers.possibleConstructorReturn(this, result); }; }

  function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

  /**
   * `simple-fields-array` takes in a JSON schema of type array and builds a form,
   * exposing a `value` property that represents an array described by the schema.
   *
   * @customElement
   * @group simple-field
   * @extends simple-fields-fieldset
   * @element simple-fields-array
   * @class SimpleFieldsArray
   * @extends {SimpleFieldsFieldsetBehaviors(LitElement)}
   */
  var SimpleFieldsArray = /*#__PURE__*/function (_SimpleFieldsFieldset) {
    babelHelpers.inherits(SimpleFieldsArray, _SimpleFieldsFieldset);

    var _super = _createSuper(SimpleFieldsArray);

    function SimpleFieldsArray() {
      var _this;

      babelHelpers.classCallCheck(this, SimpleFieldsArray);
      _this = _super.call(this);
      _this.count = 0;
      _this.expanded = true;
      _this.disableAdd = false;
      _this.responsiveSize = "sm";
      return _this;
    }

    babelHelpers.createClass(SimpleFieldsArray, [{
      key: "render",
      value: function render() {
        return (0, _index.html)(_templateObject_dd58ec508e0011ed99ce491205e67b1d || (_templateObject_dd58ec508e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n      <fieldset part=\"fieldset\">", "", "</fieldset>\n    "])), this.legend, this.fields);
      }
    }, {
      key: "fields",
      get: function get() {
        var _this2 = this;

        return (0, _index.html)(_templateObject2_dd58ec508e0011ed99ce491205e67b1d || (_templateObject2_dd58ec508e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n      <div id=\"top\" part=\"top\">\n        ", "\n        <simple-toolbar-button\n          id=\"expand\"\n          controls=\"item-fields\"\n          icon=\"more-vert\"\n          ?disabled=\"", "\"\n          @click=\"", "\"\n          ?toggled=\"", "\"\n          toggles\n          ?show-text-label=\"", "\"\n          label=\"", "\"\n          part=\"expand\"\n        >\n        </simple-toolbar-button>\n      </div>\n      <div id=\"item-fields\" aria-live=\"polite\" part=\"items\">\n        <slot></slot>\n        <simple-toolbar-button\n          id=\"add\"\n          icon=\"add\"\n          ?disabled=\"", "\"\n          controls=\"item-fields\"\n          @click=\"", "\"\n          part=\"add\"\n          icon=\"more-vert\"\n          ?toggled=\"", "\"\n          toggles\n          ?show-text-label=\"", "\"\n          label=\"Add Item\"\n        >\n        </simple-toolbar-button>\n      </div>\n    "])), this.descriptionTemplate, this.disabled, function (e) {
          return _this2.toggle();
        }, this.expanded, this.responsiveSize !== "xs", this.expanded ? "Collapse All" : "Expand All", this.disabled || this.disableAdd, function (e) {
          return _this2._handleAdd();
        }, this.expanded, this.responsiveSize !== "xs");
      }
    }, {
      key: "firstUpdated",
      value: function firstUpdated(changedProperties) {
        if (babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray.prototype), "firstUpdated", this)) babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray.prototype), "firstUpdated", this).call(this, changedProperties);
        window.ResponsiveUtility.requestAvailability();
        /**
         * needs the size of parent container to add responsive styling
         * @event responsive-element
         */

        window.dispatchEvent(new CustomEvent("responsive-element", {
          detail: {
            element: this,
            attribute: "responsive-size",
            relativeToParent: true,
            sm: 250,
            md: 500,
            lg: 1000,
            xl: 2000
          }
        }));
      }
    }, {
      key: "updated",
      value: function updated(changedProperties) {
        var _this3 = this;

        if (babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray.prototype), "updated", this)) babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray.prototype), "updated", this).call(this, changedProperties);
        changedProperties.forEach(function (oldValue, propName) {
          if (propName === "expanded") _this3.querySelectorAll("simple-fields-array-item").forEach(function (item) {
            return item.setAttribute("aria-expanded", _this3.expanded);
          });
        });
      }
    }, {
      key: "buildItem",
      value: function buildItem(id) {
        var _this4 = this;

        var item = document.createElement("simple-fields-array-item");
        item.id = id;
        item.expanded = this.expanded;
        item.innerHTML = "\n      <slot name=\"sort\"></slot>\n      <slot name=\"preview\"></slot>\n      <slot></slot>";
        this.appendChild(item);
        item.addEventListener("remove", function (e) {
          return _this4._handleRemove(e);
        });
        return item;
      }
      /**
       * Fires add event
       * @event add
       */

    }, {
      key: "_handleAdd",
      value: function _handleAdd() {
        this.dispatchEvent(new CustomEvent("add", {
          detail: this
        }));
      }
      /**
       * Fires add event
       * @event add
       */

    }, {
      key: "_handleRemove",
      value: function _handleRemove(e) {
        e.stopPropagation();
        e.stopImmediatePropagation();
        this.dispatchEvent(new CustomEvent("remove", {
          detail: e.detail
        }));
      }
      /**
       * Collapses the content
       */

    }, {
      key: "collapse",
      value: function collapse() {
        this.toggle(false);
      }
      /**
       * Expands the content
       */

    }, {
      key: "expand",
      value: function expand() {
        this.toggle(true);
      }
      /**
       * handles focus
       *
       * @memberof SimpleFieldsArray
       */

    }, {
      key: "focus",
      value: function focus(index) {
        if (this.childNodes && index) {
          if (this.childNodes.length < index) index = this.childNodes.length - 1; // account for delete of 1st item

          if (index == -1) {
            index = 0;
          }

          if (this.childNodes.length != 0) {
            this.childNodes[index].focus();
          }
        } else if (this.shadowRoot) {
          var id = !this.childNodes ? "add" : "expand";
          this.shadowRoot.getElementById(id).focus();
        }
      }
      /**
       * Toggles based on mode
       * @param {boolean} open whether to toggle open
       */

    }, {
      key: "toggle",
      value: function toggle() {
        var open = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !this.expanded;
        this.expanded = open;

        this._handleToggle();
      }
      /**
       * Fires toggling events
       */

    }, {
      key: "_handleToggle",
      value: function _handleToggle() {
        /**
         * Fires when toggled.
         *
         * @event toggle
         */
        this.dispatchEvent(new CustomEvent("toggle", {
          detail: this
        }));

        if (this.expanded) {
          /**
           * Fires when expanded.
           *
           * @event expand
           */
          this.dispatchEvent(new CustomEvent("expand", {
            detail: this
          }));
        } else {
          /**
           * Fires when collapsed.
           *
           * @event collapse
           */
          this.dispatchEvent(new CustomEvent("collapse", {
            detail: this
          }));
        }
      }
    }], [{
      key: "tag",
      get: function get() {
        return "simple-fields-array";
      }
    }, {
      key: "styles",
      get: function get() {
        return [].concat(babelHelpers.toConsumableArray(babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray), "styles", this)), babelHelpers.toConsumableArray(_simpleFieldsUi.SimpleFieldsButtonStyles), [(0, _index.css)(_templateObject3_dd58ec508e0011ed99ce491205e67b1d || (_templateObject3_dd58ec508e0011ed99ce491205e67b1d = babelHelpers.taggedTemplateLiteral(["\n        :host([expanded]) #expand::part(icon) {\n          transform: rotate(90deg);\n          transition: all 0.5s ease;\n        }\n        #item-fields {\n          margin: var(--simple-fields-margin-small, 8px) 0;\n          clear: both;\n          z-index: 3;\n        }\n        #top {\n          display: flex;\n          align-items: flex-end;\n          justify-content: flex-end;\n        }\n        #add {\n          float: right;\n        }\n      "])))]);
      }
    }, {
      key: "properties",
      get: function get() {
        return _objectSpread(_objectSpread({}, babelHelpers.get(babelHelpers.getPrototypeOf(SimpleFieldsArray), "properties", this)), {}, {
          count: {
            type: Number
          },
          disableAdd: {
            type: Boolean,
            attribute: "disable-add"
          },

          /*
           * icon when expanded
           */
          expanded: {
            type: Boolean,
            reflect: true
          },
          responsiveSize: {
            type: String,
            attribute: "responsive-size",
            reflect: true
          },
          __dragging: {
            type: Boolean
          }
        });
      }
    }]);
    return SimpleFieldsArray;
  }((0, _simpleFieldsFieldset.SimpleFieldsFieldsetBehaviors)(_index.LitElement));

  _exports.SimpleFieldsArray = SimpleFieldsArray;
  customElements.define(SimpleFieldsArray.tag, SimpleFieldsArray);
});