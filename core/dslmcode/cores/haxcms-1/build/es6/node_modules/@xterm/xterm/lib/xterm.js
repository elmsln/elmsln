!function(N,j){if("object"==typeof exports&&"object"==typeof module)module.exports=j();else if("function"==typeof define&&define.amd)define([],j);else{var X=j();for(var ie in X)("object"==typeof exports?exports:N)[ie]=X[ie]}}(globalThis,(()=>(()=>{var N={2840:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.AccessibilityManager=void 0;const le=X(7721),he=X(4292),ce=X(7150),_e=X(7098),me=X(6501),ve=X(7093);let Se=class extends ce.Disposable{constructor(N,j,X,ie){super(),this._terminal=N,this._coreBrowserService=X,this._renderService=ie,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";const se=this._coreBrowserService.mainDocument;this._accessibilityContainer=se.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=se.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let N=0;N<this._terminal.rows;N++)this._rowElements[N]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[N]);if(this._topBoundaryFocusListener=N=>this._handleBoundaryFocus(N,0),this._bottomBoundaryFocusListener=N=>this._handleBoundaryFocus(N,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=se.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new he.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize((N=>this._handleResize(N.rows)))),this._register(this._terminal.onRender((N=>this._refreshRows(N.start,N.end)))),this._register(this._terminal.onScroll((()=>this._refreshRows()))),this._register(this._terminal.onA11yChar((N=>this._handleChar(N)))),this._register(this._terminal.onLineFeed((()=>this._handleChar("\n")))),this._register(this._terminal.onA11yTab((N=>this._handleTab(N)))),this._register(this._terminal.onKey((N=>this._handleKey(N.key)))),this._register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this._register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this._register((0,ve.addDisposableListener)(se,"selectionchange",(()=>this._handleSelectionChange()))),this._register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRowsDimensions(),this._refreshRows(),this._register((0,ce.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(N){for(let j=0;j<N;j++)this._handleChar(" ")}_handleChar(N){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==N&&(this._charsToAnnounce+=N):this._charsToAnnounce+=N,"\n"===N&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=le.tooMuchOutput.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(N){this._clearLiveRegion(),/\p{Control}/u.test(N)||this._charsToConsume.push(N)}_refreshRows(N,j){this._liveRegionDebouncer.refresh(N,j,this._terminal.rows)}_renderRows(N,j){const X=this._terminal.buffer,ie=X.lines.length.toString();for(let se=N;se<=j;se++){const N=X.lines.get(X.ydisp+se),j=[],le=N?.translateToString(!0,void 0,void 0,j)||"",he=(X.ydisp+se+1).toString(),ce=this._rowElements[se];ce&&(0===le.length?(ce.innerText="Â ",this._rowColumns.set(ce,[0,1])):(ce.textContent=le,this._rowColumns.set(ce,j)),ce.setAttribute("aria-posinset",he),ce.setAttribute("aria-setsize",ie),this._alignRowWidth(ce))}this._announceCharacters()}_announceCharacters(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(N,j){const X=N.target,ie=this._rowElements[0===j?1:this._rowElements.length-2];if(X.getAttribute("aria-posinset")===(0===j?"1":`${this._terminal.buffer.lines.length}`))return;if(N.relatedTarget!==ie)return;let se,le;if(0===j?(se=X,le=this._rowElements.pop(),this._rowContainer.removeChild(le)):(se=this._rowElements.shift(),le=X,this._rowContainer.removeChild(se)),se.removeEventListener("focus",this._topBoundaryFocusListener),le.removeEventListener("focus",this._bottomBoundaryFocusListener),0===j){const N=this._createAccessibilityTreeNode();this._rowElements.unshift(N),this._rowContainer.insertAdjacentElement("afterbegin",N)}else{const N=this._createAccessibilityTreeNode();this._rowElements.push(N),this._rowContainer.appendChild(N)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===j?-1:1),this._rowElements[0===j?1:this._rowElements.length-2].focus(),N.preventDefault(),N.stopImmediatePropagation()}_handleSelectionChange(){if(0===this._rowElements.length)return;const N=this._coreBrowserService.mainDocument.getSelection();if(!N)return;if(N.isCollapsed)return void(this._rowContainer.contains(N.anchorNode)&&this._terminal.clearSelection());if(!N.anchorNode||!N.focusNode)return void console.error("anchorNode and/or focusNode are null");let j={node:N.anchorNode,offset:N.anchorOffset},X={node:N.focusNode,offset:N.focusOffset};if((j.node.compareDocumentPosition(X.node)&Node.DOCUMENT_POSITION_PRECEDING||j.node===X.node&&j.offset>X.offset)&&([j,X]=[X,j]),j.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(j={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(j.node))return;const ie=this._rowElements.slice(-1)[0];if(X.node.compareDocumentPosition(ie)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(X={node:ie,offset:ie.textContent?.length??0}),!this._rowContainer.contains(X.node))return;const r=({node:N,offset:j})=>{const X=N instanceof Text?N.parentNode:N;let ie=parseInt(X?.getAttribute("aria-posinset"),10)-1;if(isNaN(ie))return console.warn("row is invalid. Race condition?"),null;const se=this._rowColumns.get(X);if(!se)return console.warn("columns is null. Race condition?"),null;let le=j<se.length?se[j]:se.slice(-1)[0]+1;return le>=this._terminal.cols&&(++ie,le=0),{row:ie,column:le}},se=r(j),le=r(X);if(se&&le){if(se.row>le.row||se.row===le.row&&se.column>=le.column)throw new Error("invalid range");this._terminal.select(se.column,se.row,(le.row-se.row)*this._terminal.cols-se.column+le.column)}}_handleResize(N){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let N=this._rowContainer.children.length;N<this._terminal.rows;N++)this._rowElements[N]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[N]);for(;this._rowElements.length>N;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const N=this._coreBrowserService.mainDocument.createElement("div");return N.setAttribute("role","listitem"),N.tabIndex=-1,this._refreshRowDimensions(N),N}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let N=0;N<this._terminal.rows;N++)this._refreshRowDimensions(this._rowElements[N]),this._alignRowWidth(this._rowElements[N])}}_refreshRowDimensions(N){N.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(N){N.style.transform="";const j=N.getBoundingClientRect().width,X=this._rowColumns.get(N)?.slice(-1)?.[0];if(!X)return;const ie=X*this._renderService.dimensions.css.cell.width;N.style.transform=`scaleX(${ie/j})`}};j.AccessibilityManager=Se,j.AccessibilityManager=Se=ie([se(1,me.IInstantiationService),se(2,_e.ICoreBrowserService),se(3,_e.IRenderService)],Se)},7861:(N,j)=>{function i(N){return N.replace(/\r?\n/g,"\r")}function s(N,j){return j?"[200~"+N+"[201~":N}function r(N,j,X,ie){N=s(N=i(N),X.decPrivateModes.bracketedPasteMode&&!0!==ie.rawOptions.ignoreBracketedPasteMode),X.triggerDataEvent(N,!0),j.value=""}function n(N,j,X){const ie=X.getBoundingClientRect(),se=N.clientX-ie.left-10,le=N.clientY-ie.top-10;j.style.width="20px",j.style.height="20px",j.style.left=`${se}px`,j.style.top=`${le}px`,j.style.zIndex="1000",j.focus()}Object.defineProperty(j,"__esModule",{value:!0}),j.prepareTextForTerminal=i,j.bracketTextForPaste=s,j.copyHandler=function(N,j){N.clipboardData&&N.clipboardData.setData("text/plain",j.selectionText),N.preventDefault()},j.handlePasteEvent=function(N,j,X,ie){N.stopPropagation(),N.clipboardData&&r(N.clipboardData.getData("text/plain"),j,X,ie)},j.paste=r,j.moveTextAreaUnderMouseCursor=n,j.rightClickHandler=function(N,j,X,ie,se){n(N,j,X),se&&ie.rightClickSelect(N),j.value=ie.selectionText,j.select()}},7174:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ColorContrastCache=void 0;const ie=X(7710);j.ColorContrastCache=class{constructor(){this._color=new ie.TwoKeyMap,this._css=new ie.TwoKeyMap}setCss(N,j,X){this._css.set(N,j,X)}getCss(N,j){return this._css.get(N,j)}setColor(N,j,X){this._color.set(N,j,X)}getColor(N,j){return this._color.get(N,j)}clear(){this._color.clear(),this._css.clear()}}},1718:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CoreBrowserTerminal=void 0;const ie=X(7861),se=X(7721),le=X(3285),he=X(4017),ce=X(4196),_e=X(9925),me=X(3618),ve=X(3955),Se=X(4792),be=X(945),Ce=X(9574),ye=X(9820),we=X(9784),Ee=X(5783),De=X(2079),Le=X(7098),Ae=X(9078),Re=X(4103),Te=X(5777),ke=X(701),Me=X(6107),Oe=X(3534),Ie=X(706),Pe=X(8693),xe=X(4720),Be=X(6501),Ne=X(2486),Ue=X(2840),Fe=X(8906),We=X(802),He=X(7093),Ke=X(7150);class x extends Te.CoreTerminal{get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(N={}){super(N),this._linkifier=this._register(new Ke.MutableDisposable),this.browser=ke,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new Ke.MutableDisposable),this._onCursorMove=this._register(new We.Emitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new We.Emitter),this.onKey=this._onKey.event,this._onRender=this._register(new We.Emitter),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new We.Emitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new We.Emitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new We.Emitter),this.onBell=this._onBell.event,this._onFocus=this._register(new We.Emitter),this._onBlur=this._register(new We.Emitter),this._onA11yCharEmitter=this._register(new We.Emitter),this._onA11yTabEmitter=this._register(new We.Emitter),this._onWillOpen=this._register(new We.Emitter),this._setup(),this._decorationService=this._instantiationService.createInstance(xe.DecorationService),this._instantiationService.setService(Be.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(ye.LinkProviderService),this._instantiationService.setService(Le.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(le.OscLinkProvider)),this._register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this._register(this._inputHandler.onRequestRefreshRows((N=>this.refresh(N?.start??0,N?.end??this.rows-1)))),this._register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this._register(this._inputHandler.onRequestReset((()=>this.reset()))),this._register(this._inputHandler.onRequestWindowsOptionsReport((N=>this._reportWindowsOptions(N)))),this._register(this._inputHandler.onColor((N=>this._handleColorEvent(N)))),this._register(We.Event.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(We.Event.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(We.Event.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(We.Event.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize((N=>this._afterResize(N.cols,N.rows)))),this._register((0,Ke.toDisposable)((()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)})))}_handleColorEvent(N){if(this._themeService)for(const j of N){let N,X="";switch(j.index){case 256:N="foreground",X="10";break;case 257:N="background",X="11";break;case 258:N="cursor",X="12";break;default:N="ansi",X="4;"+j.index}switch(j.type){case 0:const ie=Re.color.toColorRGB("ansi"===N?this._themeService.colors.ansi[j.index]:this._themeService.colors[N]);this.coreService.triggerDataEvent(`${Oe.C0.ESC}]${X};${(0,Pe.toRgbString)(ie)}${Oe.C1_ESCAPED.ST}`);break;case 1:if("ansi"===N)this._themeService.modifyColors((N=>N.ansi[j.index]=Re.channels.toColor(...j.color)));else{const X=N;this._themeService.modifyColors((N=>N[X]=Re.channels.toColor(...j.color)))}break;case 2:this._themeService.restoreColor(j.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(N){N?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Ue.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(N){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(Oe.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(Oe.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const N=this.buffer.ybase+this.buffer.y,j=this.buffer.lines.get(N);if(!j)return;const X=Math.min(this.buffer.x,this.cols-1),ie=this._renderService.dimensions.css.cell.height,se=j.getWidth(X),le=this._renderService.dimensions.css.cell.width*se,he=this.buffer.y*this._renderService.dimensions.css.cell.height,ce=X*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ce+"px",this.textarea.style.top=he+"px",this.textarea.style.width=le+"px",this.textarea.style.height=ie+"px",this.textarea.style.lineHeight=ie+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register((0,He.addDisposableListener)(this.element,"copy",(N=>{this.hasSelection()&&(0,ie.copyHandler)(N,this._selectionService)})));const e=N=>(0,ie.handlePasteEvent)(N,this.textarea,this.coreService,this.optionsService);this._register((0,He.addDisposableListener)(this.textarea,"paste",e)),this._register((0,He.addDisposableListener)(this.element,"paste",e)),ke.isFirefox?this._register((0,He.addDisposableListener)(this.element,"mousedown",(N=>{2===N.button&&(0,ie.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this._register((0,He.addDisposableListener)(this.element,"contextmenu",(N=>{(0,ie.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),ke.isLinux&&this._register((0,He.addDisposableListener)(this.element,"auxclick",(N=>{1===N.button&&(0,ie.moveTextAreaUnderMouseCursor)(N,this.textarea,this.screenElement)})))}_bindKeys(){this._register((0,He.addDisposableListener)(this.textarea,"keyup",(N=>this._keyUp(N)),!0)),this._register((0,He.addDisposableListener)(this.textarea,"keydown",(N=>this._keyDown(N)),!0)),this._register((0,He.addDisposableListener)(this.textarea,"keypress",(N=>this._keyPress(N)),!0)),this._register((0,He.addDisposableListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this._register((0,He.addDisposableListener)(this.textarea,"compositionupdate",(N=>this._compositionHelper.compositionupdate(N)))),this._register((0,He.addDisposableListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this._register((0,He.addDisposableListener)(this.textarea,"input",(N=>this._inputEvent(N)),!0)),this._register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(N){if(!N)throw new Error("Terminal requires a parent element.");if(N.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=N.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),N.appendChild(this.element);const j=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),j.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register((0,He.addDisposableListener)(this.screenElement,"mousemove",(N=>this.updateCursorStyle(N)))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),j.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",se.promptLabel.get()),ke.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._register(this._instantiationService.createInstance(Ce.CoreBrowserService,this.textarea,N.ownerDocument.defaultView??window,this._document??"undefined"!=typeof window?window.document:null)),this._instantiationService.setService(Le.ICoreBrowserService,this._coreBrowserService),this._register((0,He.addDisposableListener)(this.textarea,"focus",(N=>this._handleTextAreaFocus(N)))),this._register((0,He.addDisposableListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(Se.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(Le.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(Ae.ThemeService),this._instantiationService.setService(Le.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(be.CharacterJoinerService),this._instantiationService.setService(Le.ICharacterJoinerService,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(Ee.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(Le.IRenderService,this._renderService),this._register(this._renderService.onRenderedViewportChange((N=>this._onRender.fire(N)))),this.onResize((N=>this._renderService.resize(N.cols,N.rows))),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(me.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(we.MouseService),this._instantiationService.setService(Le.IMouseService,this._mouseService);const X=this._linkifier.value=this._register(this._instantiationService.createInstance(Fe.Linkifier,this.screenElement));this.element.appendChild(j);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this._register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this._register(this.onBlur((()=>this._renderService.handleBlur()))),this._register(this.onFocus((()=>this._renderService.handleFocus()))),this._viewport=this._register(this._instantiationService.createInstance(he.Viewport,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines((N=>{super.scrollLines(N,!1),this.refresh(0,this.rows-1)}))),this._selectionService=this._register(this._instantiationService.createInstance(De.SelectionService,this.element,this.screenElement,X)),this._instantiationService.setService(Le.ISelectionService,this._selectionService),this._register(this._selectionService.onRequestScrollLines((N=>this.scrollLines(N.amount,N.suppressScrollEvent)))),this._register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this._register(this._selectionService.onRequestRedraw((N=>this._renderService.handleSelectionChanged(N.start,N.end,N.columnSelectMode)))),this._register(this._selectionService.onLinuxMouseSelection((N=>{this.textarea.value=N,this.textarea.focus(),this.textarea.select()}))),this._register(this._onScroll.event((()=>this._selectionService.refresh()))),this._register(this._instantiationService.createInstance(ce.BufferDecorationRenderer,this.screenElement)),this._register((0,He.addDisposableListener)(this.element,"mousedown",(N=>this._selectionService.handleMouseDown(N)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Ue.AccessibilityManager,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",(N=>this._handleScreenReaderModeOptionChange(N)))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(_e.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",(N=>{!this._overviewRulerRenderer&&N&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(_e.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(ve.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const N=this,j=this.element;function i(j){const X=N._mouseService.getMouseReportCoords(j,N.screenElement);if(!X)return!1;let ie,se;switch(j.overrideType||j.type){case"mousemove":se=32,void 0===j.buttons?(ie=3,void 0!==j.button&&(ie=j.button<3?j.button:3)):ie=1&j.buttons?0:4&j.buttons?1:2&j.buttons?2:3;break;case"mouseup":se=0,ie=j.button<3?j.button:3;break;case"mousedown":se=1,ie=j.button<3?j.button:3;break;case"wheel":if(N._customWheelEventHandler&&!1===N._customWheelEventHandler(j))return!1;const X=j.deltaY;if(0===X)return!1;se=X<0?0:1,ie=4;break;default:return!1}return!(void 0===se||void 0===ie||ie>4)&&N.coreMouseService.triggerMouseEvent({col:X.col,row:X.row,x:X.x,y:X.y,button:ie,action:se,ctrl:j.ctrlKey,alt:j.altKey,shift:j.shiftKey})}const X={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ie={mouseup:N=>(i(N),N.buttons||(this._document.removeEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.removeEventListener("mousemove",X.mousedrag)),this.cancel(N)),wheel:N=>(i(N),this.cancel(N,!0)),mousedrag:N=>{N.buttons&&i(N)},mousemove:N=>{N.buttons||i(N)}};this._register(this.coreMouseService.onProtocolChange((N=>{N?("debug"===this.optionsService.rawOptions.logLevel&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(N)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&N?X.mousemove||(j.addEventListener("mousemove",ie.mousemove),X.mousemove=ie.mousemove):(j.removeEventListener("mousemove",X.mousemove),X.mousemove=null),16&N?X.wheel||(j.addEventListener("wheel",ie.wheel,{passive:!1}),X.wheel=ie.wheel):(j.removeEventListener("wheel",X.wheel),X.wheel=null),2&N?X.mouseup||(X.mouseup=ie.mouseup):(this._document.removeEventListener("mouseup",X.mouseup),X.mouseup=null),4&N?X.mousedrag||(X.mousedrag=ie.mousedrag):(this._document.removeEventListener("mousemove",X.mousedrag),X.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register((0,He.addDisposableListener)(j,"mousedown",(N=>{if(N.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(N))return i(N),X.mouseup&&this._document.addEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.addEventListener("mousemove",X.mousedrag),this.cancel(N)}))),this._register((0,He.addDisposableListener)(j,"wheel",(N=>{if(!X.wheel){if(this._customWheelEventHandler&&!1===this._customWheelEventHandler(N))return!1;if(!this.buffer.hasScrollback){if(0===N.deltaY)return!1;const j=Oe.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(N.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(j,!0),this.cancel(N,!0)}}}),{passive:!1}))}refresh(N,j){this._renderService?.refreshRows(N,j)}updateCursorStyle(N){this._selectionService?.shouldColumnSelect(N)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(N,j){this._viewport?this._viewport.scrollLines(N):super.scrollLines(N,j),this.refresh(0,this.rows-1)}scrollPages(N){this.scrollLines(N*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(N){N&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(N){const j=N-this._bufferService.buffer.ydisp;0!==j&&this.scrollLines(j)}paste(N){(0,ie.paste)(N,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(N){this._customKeyEventHandler=N}attachCustomWheelEventHandler(N){this._customWheelEventHandler=N}registerLinkProvider(N){return this._linkProviderService.registerLinkProvider(N)}registerCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const j=this._characterJoinerService.register(N);return this.refresh(0,this.rows-1),j}deregisterCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(N)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(N){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+N)}registerDecoration(N){return this._decorationService.registerDecoration(N)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(N,j,X){this._selectionService.setSelection(N,j,X)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(N,j){this._selectionService?.selectLines(N,j)}_keyDown(N){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(N))return!1;const j=this.browser.isMac&&this.options.macOptionIsMeta&&N.altKey;if(!j&&!this._compositionHelper.keydown(N))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;j||"Dead"!==N.key&&"AltGraph"!==N.key||(this._unprocessedDeadKey=!0);const X=(0,Ie.evaluateKeyboardEvent)(N,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(N),3===X.type||2===X.type){const j=this.rows-1;return this.scrollLines(2===X.type?-j:j),this.cancel(N,!0)}return 1===X.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,N)||(X.cancel&&this.cancel(N,!0),!X.key||!!(N.key&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&1===N.key.length&&N.key.charCodeAt(0)>=65&&N.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(X.key!==Oe.C0.ETX&&X.key!==Oe.C0.CR||(this.textarea.value=""),this._onKey.fire({key:X.key,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(X.key,!0),!this.optionsService.rawOptions.screenReaderMode||N.altKey||N.ctrlKey?this.cancel(N,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(N,j){const X=N.isMac&&!this.options.macOptionIsMeta&&j.altKey&&!j.ctrlKey&&!j.metaKey||N.isWindows&&j.altKey&&j.ctrlKey&&!j.metaKey||N.isWindows&&j.getModifierState("AltGraph");return"keypress"===j.type?X:X&&(!j.keyCode||j.keyCode>47)}_keyUp(N){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(N)||(function(N){return 16===N.keyCode||17===N.keyCode||18===N.keyCode}(N)||this.focus(),this.updateCursorStyle(N),this._keyPressHandled=!1)}_keyPress(N){let j;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(N))return!1;if(this.cancel(N),N.charCode)j=N.charCode;else if(null===N.which||void 0===N.which)j=N.keyCode;else{if(0===N.which||0===N.charCode)return!1;j=N.which}return!(!j||(N.altKey||N.ctrlKey||N.metaKey)&&!this._isThirdLevelShift(this.browser,N)||(j=String.fromCharCode(j),this._onKey.fire({key:j,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(j,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(N){if(N.data&&"insertText"===N.inputType&&(!N.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const j=N.data;return this.coreService.triggerDataEvent(j,!0),this.cancel(N),!0}return!1}resize(N,j){N!==this.cols||j!==this.rows?super.resize(N,j):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(N,j){this._charSizeService?.measure()}clear(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let N=1;N<this.rows;N++)this.buffer.lines.push(this.buffer.getBlankLine(Me.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const N=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=N,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(Oe.C0.ESC+"[I"):this.coreService.triggerDataEvent(Oe.C0.ESC+"[O")}_reportWindowsOptions(N){if(this._renderService)switch(N){case Ne.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const N=this._renderService.dimensions.css.canvas.width.toFixed(0),j=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${Oe.C0.ESC}[4;${j};${N}t`);break;case Ne.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const X=this._renderService.dimensions.css.cell.width.toFixed(0),ie=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${Oe.C0.ESC}[6;${ie};${X}t`)}}cancel(N,j){if(this.options.cancelEvents||j)return N.preventDefault(),N.stopPropagation(),!1}}j.CoreBrowserTerminal=x},8906:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.Linkifier=void 0;const le=X(7150),he=X(6501),ce=X(7098),_e=X(802),me=X(7093);let ve=class extends le.Disposable{get currentLink(){return this._currentLink}constructor(N,j,X,ie,se){super(),this._element=N,this._mouseService=j,this._renderService=X,this._bufferService=ie,this._linkProviderService=se,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new _e.Emitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new _e.Emitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register((0,le.toDisposable)((()=>{(0,le.dispose)(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()}))),this._register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0}))),this._register((0,me.addDisposableListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this._register((0,me.addDisposableListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register((0,me.addDisposableListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register((0,me.addDisposableListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(N){this._lastMouseEvent=N;const j=this._positionFromMouseEvent(N,this._element,this._mouseService);if(!j)return;this._isMouseOut=!1;const X=N.composedPath();for(let N=0;N<X.length;N++){const j=X[N];if(j.classList.contains("xterm"))break;if(j.classList.contains("xterm-hover"))return}this._lastBufferCell&&j.x===this._lastBufferCell.x&&j.y===this._lastBufferCell.y||(this._handleHover(j),this._lastBufferCell=j)}_handleHover(N){if(this._activeLine!==N.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(N,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,N)||(this._clearCurrentLink(),this._askForLink(N,!0))}_askForLink(N,j){this._activeProviderReplies&&j||(this._activeProviderReplies?.forEach((N=>{N?.forEach((N=>{N.link.dispose&&N.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=N.y);let X=!1;for(const[ie,se]of this._linkProviderService.linkProviders.entries())if(j){const j=this._activeProviderReplies?.get(ie);j&&(X=this._checkLinkProviderResult(ie,N,X))}else se.provideLinks(N.y,(j=>{if(this._isMouseOut)return;const se=j?.map((N=>({link:N})));this._activeProviderReplies?.set(ie,se),X=this._checkLinkProviderResult(ie,N,X),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(N.y,this._activeProviderReplies)}))}_removeIntersectingLinks(N,j){const X=new Set;for(let ie=0;ie<j.size;ie++){const se=j.get(ie);if(se)for(let j=0;j<se.length;j++){const ie=se[j],le=ie.link.range.start.y<N?0:ie.link.range.start.x,he=ie.link.range.end.y>N?this._bufferService.cols:ie.link.range.end.x;for(let N=le;N<=he;N++){if(X.has(N)){se.splice(j--,1);break}X.add(N)}}}}_checkLinkProviderResult(N,j,X){if(!this._activeProviderReplies)return X;const ie=this._activeProviderReplies.get(N);let se=!1;for(let j=0;j<N;j++)this._activeProviderReplies.has(j)&&!this._activeProviderReplies.get(j)||(se=!0);if(!se&&ie){const N=ie.find((N=>this._linkAtPosition(N.link,j)));N&&(X=!0,this._handleNewLink(N))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!X)for(let N=0;N<this._activeProviderReplies.size;N++){const ie=this._activeProviderReplies.get(N)?.find((N=>this._linkAtPosition(N.link,j)));if(ie){X=!0,this._handleNewLink(ie);break}}return X}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(N){if(!this._currentLink)return;const j=this._positionFromMouseEvent(N,this._element,this._mouseService);var X,ie;j&&this._mouseDownLink&&(X=this._mouseDownLink.link,ie=this._currentLink.link,X.text===ie.text&&X.range.start.x===ie.range.start.x&&X.range.start.y===ie.range.start.y&&X.range.end.x===ie.range.end.x&&X.range.end.y===ie.range.end.y)&&this._linkAtPosition(this._currentLink.link,j)&&this._currentLink.link.activate(N,this._currentLink.link.text)}_clearCurrentLink(N,j){this._currentLink&&this._lastMouseEvent&&(!N||!j||this._currentLink.link.range.start.y>=N&&this._currentLink.link.range.end.y<=j)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,le.dispose)(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(N){if(!this._lastMouseEvent)return;const j=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);j&&this._linkAtPosition(N.link,j)&&(this._currentLink=N,this._currentLink.state={decorations:{underline:void 0===N.link.decorations||N.link.decorations.underline,pointerCursor:void 0===N.link.decorations||N.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,N.link,this._lastMouseEvent),N.link.decorations={},Object.defineProperties(N.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:N=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==N&&(this._currentLink.state.decorations.pointerCursor=N,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",N))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:j=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==j&&(this._currentLink.state.decorations.underline=j,this._currentLink.state.isHovered&&this._fireUnderlineEvent(N.link,j))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((N=>{if(!this._currentLink)return;const j=0===N.start?0:N.start+1+this._bufferService.buffer.ydisp,X=this._bufferService.buffer.ydisp+1+N.end;if(this._currentLink.link.range.start.y>=j&&this._currentLink.link.range.end.y<=X&&(this._clearCurrentLink(j,X),this._lastMouseEvent)){const N=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);N&&this._askForLink(N,!1)}}))))}_linkHover(N,j,X){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(j,!0),this._currentLink.state.decorations.pointerCursor&&N.classList.add("xterm-cursor-pointer")),j.hover&&j.hover(X,j.text)}_fireUnderlineEvent(N,j){const X=N.range,ie=this._bufferService.buffer.ydisp,se=this._createLinkUnderlineEvent(X.start.x-1,X.start.y-ie-1,X.end.x,X.end.y-ie-1,void 0);(j?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(se)}_linkLeave(N,j,X){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(j,!1),this._currentLink.state.decorations.pointerCursor&&N.classList.remove("xterm-cursor-pointer")),j.leave&&j.leave(X,j.text)}_linkAtPosition(N,j){const X=N.range.start.y*this._bufferService.cols+N.range.start.x,ie=N.range.end.y*this._bufferService.cols+N.range.end.x,se=j.y*this._bufferService.cols+j.x;return X<=se&&se<=ie}_positionFromMouseEvent(N,j,X){const ie=X.getCoords(N,j,this._bufferService.cols,this._bufferService.rows);if(ie)return{x:ie[0],y:ie[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(N,j,X,ie,se){return{x1:N,y1:j,x2:X,y2:ie,cols:this._bufferService.cols,fg:se}}};j.Linkifier=ve,j.Linkifier=ve=ie([se(1,ce.IMouseService),se(2,ce.IRenderService),se(3,he.IBufferService),se(4,ce.ILinkProviderService)],ve)},7721:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.tooMuchOutput=j.promptLabel=void 0;let X="Terminal input";const ie={get:()=>X,set:N=>X=N};j.promptLabel=ie;let se="Too much output to announce, navigate to rows manually to read";const le={get:()=>se,set:N=>se=N};j.tooMuchOutput=le},3285:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.OscLinkProvider=void 0;const le=X(3055),he=X(6501);let ce=class{constructor(N,j,X){this._bufferService=N,this._optionsService=j,this._oscLinkService=X}provideLinks(N,j){const X=this._bufferService.buffer.lines.get(N-1);if(!X)return void j(void 0);const ie=[],se=this._optionsService.rawOptions.linkHandler,he=new le.CellData,ce=X.getTrimmedLength();let _e=-1,me=-1,ve=!1;for(let j=0;j<ce;j++)if(-1!==me||X.hasContent(j)){if(X.loadCell(j,he),he.hasExtendedAttrs()&&he.extended.urlId){if(-1===me){me=j,_e=he.extended.urlId;continue}ve=he.extended.urlId!==_e}else-1!==me&&(ve=!0);if(ve||-1!==me&&j===ce-1){const X=this._oscLinkService.getLinkData(_e)?.uri;if(X){const le={start:{x:me+1,y:N},end:{x:j+(ve||j!==ce-1?0:1),y:N}};let he=!1;if(!se?.allowNonHttpProtocols)try{const N=new URL(X);["http:","https:"].includes(N.protocol)||(he=!0)}catch(N){he=!0}he||ie.push({text:X,range:le,activate:(N,j)=>se?se.activate(N,j,le):l(0,j),hover:(N,j)=>se?.hover?.(N,j,le),leave:(N,j)=>se?.leave?.(N,j,le)})}ve=!1,he.hasExtendedAttrs()&&he.extended.urlId?(me=j,_e=he.extended.urlId):(me=-1,_e=-1)}}j(ie)}};function l(N,j){if(confirm(`Do you want to navigate to ${j}?\n\nWARNING: This link could potentially be dangerous`)){const N=window.open();if(N){try{N.opener=null}catch{}N.location.href=j}else console.warn("Opening link blocked as opener could not be cleared")}}j.OscLinkProvider=ce,j.OscLinkProvider=ce=ie([se(0,he.IBufferService),se(1,he.IOptionsService),se(2,he.IOscLinkService)],ce)},4852:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.RenderDebouncer=void 0,j.RenderDebouncer=class{constructor(N,j){this._renderCallback=N,this._coreBrowserService=j,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(N){return this._refreshCallbacks.push(N),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(N,j,X){this._rowCount=X,N=void 0!==N?N:0,j=void 0!==j?j:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,N):N,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,j):j,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return void this._runRefreshCallbacks();const N=Math.max(this._rowStart,0),j=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(N,j),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const N of this._refreshCallbacks)N(0);this._refreshCallbacks=[]}}},4292:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.TimeBasedDebouncer=void 0,j.TimeBasedDebouncer=class{constructor(N,j=1e3){this._renderCallback=N,this._debounceThresholdMS=j,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(N,j,X){this._rowCount=X,N=void 0!==N?N:0,j=void 0!==j?j:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,N):N,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,j):j;const ie=Date.now();if(ie-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=ie,this._innerRefresh();else if(!this._additionalRefreshRequested){const N=ie-this._lastRefreshMs,j=this._debounceThresholdMS-N;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),j)}}_innerRefresh(){if(void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return;const N=Math.max(this._rowStart,0),j=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(N,j)}}},9302:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DEFAULT_ANSI_COLORS=void 0;const ie=X(4103);j.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const N=[ie.css.toColor("#2e3436"),ie.css.toColor("#cc0000"),ie.css.toColor("#4e9a06"),ie.css.toColor("#c4a000"),ie.css.toColor("#3465a4"),ie.css.toColor("#75507b"),ie.css.toColor("#06989a"),ie.css.toColor("#d3d7cf"),ie.css.toColor("#555753"),ie.css.toColor("#ef2929"),ie.css.toColor("#8ae234"),ie.css.toColor("#fce94f"),ie.css.toColor("#729fcf"),ie.css.toColor("#ad7fa8"),ie.css.toColor("#34e2e2"),ie.css.toColor("#eeeeec")],j=[0,95,135,175,215,255];for(let X=0;X<216;X++){const se=j[X/36%6|0],le=j[X/6%6|0],he=j[X%6];N.push({css:ie.channels.toCss(se,le,he),rgba:ie.channels.toRgba(se,le,he)})}for(let j=0;j<24;j++){const X=8+10*j;N.push({css:ie.channels.toCss(X,X,X),rgba:ie.channels.toRgba(X,X,X)})}return N})())},4017:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.Viewport=void 0;const le=X(7098),he=X(7150),ce=X(6501),_e=X(7093),me=X(8234),ve=X(802),Se=X(9881);let be=class extends he.Disposable{constructor(N,j,X,ie,se,le,ce,be){super(),this._bufferService=X,this._optionsService=ce,this._renderService=be,this._onRequestScrollLines=this._register(new ve.Emitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;const Ce=this._register(new Se.Scrollable({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:N=>(0,_e.scheduleAtNextAnimationFrame)(ie.window,N)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",(()=>{Ce.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)}))),this._scrollableElement=this._register(new me.SmoothScrollableElement(j,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},Ce)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],(()=>this._scrollableElement.updateOptions(this._getChangeOptions())))),this._register(se.onProtocolChange((N=>{this._scrollableElement.updateOptions({handleMouseWheel:!(16&N)})}))),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(ve.Event.runAndSubscribe(le.onChangeColors,(()=>{this._scrollableElement.getDomNode().style.backgroundColor=le.colors.background.css}))),N.appendChild(this._scrollableElement.getDomNode()),this._register((0,he.toDisposable)((()=>this._scrollableElement.getDomNode().remove()))),this._styleElement=ie.mainDocument.createElement("style"),j.appendChild(this._styleElement),this._register((0,he.toDisposable)((()=>this._styleElement.remove()))),this._register(ve.Event.runAndSubscribe(le.onChangeColors,(()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${le.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${le.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${le.colors.scrollbarSliderActiveBackground.css};`,"}"].join("\n")}))),this._register(this._bufferService.onResize((()=>this._queueSync()))),this._register(this._bufferService.buffers.onBufferActivate((()=>this._queueSync()))),this._register(this._bufferService.onScroll((()=>this._sync()))),this._register(this._scrollableElement.onScroll((N=>this._handleScroll(N))))}scrollLines(N){const j=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:j.scrollTop+N*this._renderService.dimensions.css.cell.height})}scrollToLine(N,j){j&&(this._latestYDisp=N),this._scrollableElement.setScrollPosition({reuseAnimation:!j,scrollTop:N*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}_queueSync(N){void 0!==N&&(this._latestYDisp=N),void 0===this._queuedAnimationFrame&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback((()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)})))}_sync(N=this._bufferService.buffer.ydisp){this._renderService&&!this._isSyncing&&(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,N!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:N*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(N){if(!this._renderService)return;if(this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;const j=Math.round(N.scrollTop/this._renderService.dimensions.css.cell.height),X=j-this._bufferService.buffer.ydisp;0!==X&&(this._latestYDisp=j,this._onRequestScrollLines.fire(X)),this._isHandlingScroll=!1}};j.Viewport=be,j.Viewport=be=ie([se(2,ce.IBufferService),se(3,le.ICoreBrowserService),se(4,ce.ICoreMouseService),se(5,le.IThemeService),se(6,ce.IOptionsService),se(7,le.IRenderService)],be)},4196:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.BufferDecorationRenderer=void 0;const le=X(7098),he=X(7150),ce=X(6501);let _e=class extends he.Disposable{constructor(N,j,X,ie,se){super(),this._screenElement=N,this._bufferService=j,this._coreBrowserService=X,this._decorationService=ie,this._renderService=se,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this._register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this._register(this._coreBrowserService.onDprChange((()=>this._queueRefresh()))),this._register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this._register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this._register(this._decorationService.onDecorationRemoved((N=>this._removeDecoration(N)))),this._register((0,he.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const N of this._decorationService.decorations)this._renderDecoration(N);this._dimensionsChanged=!1}_renderDecoration(N){this._refreshStyle(N),this._dimensionsChanged&&this._refreshXPosition(N)}_createElement(N){const j=this._coreBrowserService.mainDocument.createElement("div");j.classList.add("xterm-decoration"),j.classList.toggle("xterm-decoration-top-layer","top"===N?.options?.layer),j.style.width=`${Math.round((N.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,j.style.height=(N.options.height||1)*this._renderService.dimensions.css.cell.height+"px",j.style.top=(N.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",j.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const X=N.options.x??0;return X&&X>this._bufferService.cols&&(j.style.display="none"),this._refreshXPosition(N,j),j}_refreshStyle(N){const j=N.marker.line-this._bufferService.buffers.active.ydisp;if(j<0||j>=this._bufferService.rows)N.element&&(N.element.style.display="none",N.onRenderEmitter.fire(N.element));else{let X=this._decorationElements.get(N);X||(X=this._createElement(N),N.element=X,this._decorationElements.set(N,X),this._container.appendChild(X),N.onDispose((()=>{this._decorationElements.delete(N),X.remove()}))),X.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(X.style.width=`${Math.round((N.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,X.style.height=(N.options.height||1)*this._renderService.dimensions.css.cell.height+"px",X.style.top=j*this._renderService.dimensions.css.cell.height+"px",X.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),N.onRenderEmitter.fire(X)}}_refreshXPosition(N,j=N.element){if(!j)return;const X=N.options.x??0;"right"===(N.options.anchor||"left")?j.style.right=X?X*this._renderService.dimensions.css.cell.width+"px":"":j.style.left=X?X*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(N){this._decorationElements.get(N)?.remove(),this._decorationElements.delete(N),N.dispose()}};j.BufferDecorationRenderer=_e,j.BufferDecorationRenderer=_e=ie([se(1,ce.IBufferService),se(2,le.ICoreBrowserService),se(3,ce.IDecorationService),se(4,le.IRenderService)],_e)},957:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ColorZoneStore=void 0,j.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(N){if(N.options.overviewRulerOptions){for(const j of this._zones)if(j.color===N.options.overviewRulerOptions.color&&j.position===N.options.overviewRulerOptions.position){if(this._lineIntersectsZone(j,N.marker.line))return;if(this._lineAdjacentToZone(j,N.marker.line,N.options.overviewRulerOptions.position))return void this._addLineToZone(j,N.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=N.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=N.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=N.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=N.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:N.options.overviewRulerOptions.color,position:N.options.overviewRulerOptions.position,startBufferLine:N.marker.line,endBufferLine:N.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(N){this._linePadding=N}_lineIntersectsZone(N,j){return j>=N.startBufferLine&&j<=N.endBufferLine}_lineAdjacentToZone(N,j,X){return j>=N.startBufferLine-this._linePadding[X||"full"]&&j<=N.endBufferLine+this._linePadding[X||"full"]}_addLineToZone(N,j){N.startBufferLine=Math.min(N.startBufferLine,j),N.endBufferLine=Math.max(N.endBufferLine,j)}}},9925:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.OverviewRulerRenderer=void 0;const le=X(957),he=X(7098),ce=X(7150),_e=X(6501),me={full:0,left:0,center:0,right:0},ve={full:0,left:0,center:0,right:0},Se={full:0,left:0,center:0,right:0};let be=class extends ce.Disposable{get _width(){return this._optionsService.options.overviewRuler?.width||0}constructor(N,j,X,ie,se,he,_e,me){super(),this._viewportElement=N,this._screenElement=j,this._bufferService=X,this._decorationService=ie,this._renderService=se,this._optionsService=he,this._themeService=_e,this._coreBrowserService=me,this._colorZoneStore=new le.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register((0,ce.toDisposable)((()=>this._canvas?.remove())));const ve=this._canvas.getContext("2d");if(!ve)throw new Error("Ctx cannot be null");this._ctx=ve,this._register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this._register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0)))),this._register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this._register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this._register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))),this._register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this._register(this._coreBrowserService.onDprChange((()=>this._queueRefresh(!0)))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",(()=>this._queueRefresh(!0)))),this._register(this._themeService.onChangeColors((()=>this._queueRefresh()))),this._queueRefresh(!0)}_refreshDrawConstants(){const N=Math.floor((this._canvas.width-1)/3),j=Math.ceil((this._canvas.width-1)/3);ve.full=this._canvas.width,ve.left=N,ve.center=j,ve.right=N,this._refreshDrawHeightConstants(),Se.full=1,Se.left=1,Se.center=1+ve.left,Se.right=1+ve.left+ve.center}_refreshDrawHeightConstants(){me.full=Math.round(2*this._coreBrowserService.dpr);const N=this._canvas.height/this._bufferService.buffer.lines.length,j=Math.round(Math.max(Math.min(N,12),6)*this._coreBrowserService.dpr);me.left=j,me.center=j,me.right=j}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*me.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*me.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*me.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*me.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const N of this._decorationService.decorations)this._colorZoneStore.addDecoration(N);this._ctx.lineWidth=1,this._renderRulerOutline();const N=this._colorZoneStore.zones;for(const j of N)"full"!==j.position&&this._renderColorZone(j);for(const j of N)"full"===j.position&&this._renderColorZone(j);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(N){this._ctx.fillStyle=N.color,this._ctx.fillRect(Se[N.position||"full"],Math.round((this._canvas.height-1)*(N.startBufferLine/this._bufferService.buffers.active.lines.length)-me[N.position||"full"]/2),ve[N.position||"full"],Math.round((this._canvas.height-1)*((N.endBufferLine-N.startBufferLine)/this._bufferService.buffers.active.lines.length)+me[N.position||"full"]))}_queueRefresh(N,j){this._shouldUpdateDimensions=N||this._shouldUpdateDimensions,this._shouldUpdateAnchor=j||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};j.OverviewRulerRenderer=be,j.OverviewRulerRenderer=be=ie([se(2,_e.IBufferService),se(3,_e.IDecorationService),se(4,he.IRenderService),se(5,_e.IOptionsService),se(6,he.IThemeService),se(7,he.ICoreBrowserService)],be)},3618:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.CompositionHelper=void 0;const le=X(7098),he=X(6501),ce=X(3534);let _e=class{get isComposing(){return this._isComposing}constructor(N,j,X,ie,se,le){this._textarea=N,this._compositionView=j,this._bufferService=X,this._optionsService=ie,this._coreService=se,this._renderService=le,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(N){this._compositionView.textContent=N.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(N){if(this._isComposing||this._isSendingComposition){if(229===N.keyCode)return!1;if(16===N.keyCode||17===N.keyCode||18===N.keyCode)return!1;this._finalizeComposition(!1)}return 229!==N.keyCode||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(N){if(this._compositionView.classList.remove("active"),this._isComposing=!1,N){const N={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let j;this._isSendingComposition=!1,N.start+=this._dataAlreadySent.length,j=this._isComposing?this._textarea.value.substring(N.start,this._compositionPosition.start):this._textarea.value.substring(N.start),j.length>0&&this._coreService.triggerDataEvent(j,!0)}}),0)}else{this._isSendingComposition=!1;const N=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(N,!0)}}_handleAnyTextareaChanges(){const N=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const j=this._textarea.value,X=j.replace(N,"");this._dataAlreadySent=X,j.length>N.length?this._coreService.triggerDataEvent(X,!0):j.length<N.length?this._coreService.triggerDataEvent(`${ce.C0.DEL}`,!0):j.length===N.length&&j!==N&&this._coreService.triggerDataEvent(j,!0)}}),0)}updateCompositionElements(N){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const N=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),j=this._renderService.dimensions.css.cell.height,X=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,ie=N*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=ie+"px",this._compositionView.style.top=X+"px",this._compositionView.style.height=j+"px",this._compositionView.style.lineHeight=j+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const se=this._compositionView.getBoundingClientRect();this._textarea.style.left=ie+"px",this._textarea.style.top=X+"px",this._textarea.style.width=Math.max(se.width,1)+"px",this._textarea.style.height=Math.max(se.height,1)+"px",this._textarea.style.lineHeight=se.height+"px"}N||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};j.CompositionHelper=_e,j.CompositionHelper=_e=ie([se(2,he.IBufferService),se(3,he.IOptionsService),se(4,he.ICoreService),se(5,le.IRenderService)],_e)},5251:(N,j)=>{function i(N,j,X){const ie=X.getBoundingClientRect(),se=N.getComputedStyle(X),le=parseInt(se.getPropertyValue("padding-left")),he=parseInt(se.getPropertyValue("padding-top"));return[j.clientX-ie.left-le,j.clientY-ie.top-he]}Object.defineProperty(j,"__esModule",{value:!0}),j.getCoordsRelativeToElement=i,j.getCoords=function(N,j,X,ie,se,le,he,ce,_e){if(!le)return;const me=i(N,j,X);return me?(me[0]=Math.ceil((me[0]+(_e?he/2:0))/he),me[1]=Math.ceil(me[1]/ce),me[0]=Math.min(Math.max(me[0],1),ie+(_e?1:0)),me[1]=Math.min(Math.max(me[1],1),se),me):void 0}},9686:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.moveToCellSequence=function(N,j,X,ie){const se=X.buffer.x,le=X.buffer.y;if(!X.buffer.hasScrollback)return function(N,j,X,ie,se,le){return 0===r(j,ie,se,le).length?"":h(a(N,j,N,j-n(j,se),!1,se).length,l("D",le))}(se,le,0,j,X,ie)+r(le,j,X,ie)+function(N,j,X,ie,se,le){let he;he=r(j,ie,se,le).length>0?ie-n(ie,se):j;const ce=ie,_e=function(N,j,X,ie,se,le){let he;return he=r(X,ie,se,le).length>0?ie-n(ie,se):j,N<X&&he<=ie||N>=X&&he<ie?"C":"D"}(N,j,X,ie,se,le);return h(a(N,he,X,ce,"C"===_e,se).length,l(_e,le))}(se,le,N,j,X,ie);let he;if(le===j)return he=se>N?"D":"C",h(Math.abs(se-N),l(he,ie));he=le>j?"D":"C";const ce=Math.abs(le-j);return h(function(N,j){return j.cols-N}(le>j?N:se,X)+(ce-1)*X.cols+1+((le>j?se:N)-1),l(he,ie))};const ie=X(3534);function r(N,j,X,ie){const se=N-n(N,X),le=j-n(j,X),he=Math.abs(se-le)-function(N,j,X){let ie=0;const se=N-n(N,X),le=j-n(j,X);for(let he=0;he<Math.abs(se-le);he++){const le="A"===o(N,j)?-1:1,ce=X.buffer.lines.get(se+le*he);ce?.isWrapped&&ie++}return ie}(N,j,X);return h(he,l(o(N,j),ie))}function n(N,j){let X=0,ie=j.buffer.lines.get(N),se=ie?.isWrapped;for(;se&&N>=0&&N<j.rows;)X++,ie=j.buffer.lines.get(--N),se=ie?.isWrapped;return X}function o(N,j){return N>j?"A":"B"}function a(N,j,X,ie,se,le){let he=N,ce=j,_e="";for(;he!==X||ce!==ie;)he+=se?1:-1,se&&he>le.cols-1?(_e+=le.buffer.translateBufferLineToString(ce,!1,N,he),he=0,N=0,ce++):!se&&he<0&&(_e+=le.buffer.translateBufferLineToString(ce,!1,0,N+1),he=le.cols-1,N=he,ce--);return _e+le.buffer.translateBufferLineToString(ce,!1,N,he)}function l(N,j){const X=j?"O":"[";return ie.C0.ESC+X+N}function h(N,j){N=Math.floor(N);let X="";for(let ie=0;ie<N;ie++)X+=j;return X}},3955:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.DomRenderer=void 0;const le=X(1433),he=X(2744),ce=X(9176),_e=X(6181),me=X(2274),ve=X(7098),Se=X(4103),be=X(7150),Ce=X(6501),ye=X(802),we="xterm-dom-renderer-owner-",Ee="xterm-rows",De="xterm-fg-",Le="xterm-bg-",Ae="xterm-focus",Re="xterm-selection";let Te=1,ke=class extends be.Disposable{constructor(N,j,X,ie,se,ce,ve,Se,Ce,De,Le,Ae,ke){super(),this._terminal=N,this._document=j,this._element=X,this._screenElement=ie,this._viewportElement=se,this._helperContainer=ce,this._linkifier2=ve,this._charSizeService=Ce,this._optionsService=De,this._bufferService=Le,this._coreBrowserService=Ae,this._themeService=ke,this._terminalClass=Te++,this._rowElements=[],this._selectionRenderModel=(0,me.createSelectionRenderModel)(),this.onRequestRedraw=this._register(new ye.Emitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(Ee),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(Re),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,_e.createRenderDimensions)(),this._updateDimensions(),this._register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this._register(this._themeService.onChangeColors((N=>this._injectCss(N)))),this._injectCss(this._themeService.colors),this._rowFactory=Se.createInstance(le.DomRendererRowFactory,document),this._element.classList.add(we+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline((N=>this._handleLinkHover(N)))),this._register(this._linkifier2.onHideLinkUnderline((N=>this._handleLinkLeave(N)))),this._register((0,be.toDisposable)((()=>{this._element.classList.remove(we+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new he.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const N=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*N,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*N),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/N),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/N),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const N of this._rowElements)N.style.width=`${this.dimensions.css.canvas.width}px`,N.style.height=`${this.dimensions.css.cell.height}px`,N.style.lineHeight=`${this.dimensions.css.cell.height}px`,N.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const j=`${this._terminalSelector} .${Ee} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=j,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(N){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let j=`${this._terminalSelector} .${Ee} { color: ${N.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;j+=`${this._terminalSelector} .${Ee} .xterm-dim { color: ${Se.color.multiplyOpacity(N.foreground,.5).css};}`,j+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const X=`blink_underline_${this._terminalClass}`,ie=`blink_bar_${this._terminalClass}`,se=`blink_block_${this._terminalClass}`;j+=`@keyframes ${X} { 50% {  border-bottom-style: hidden; }}`,j+=`@keyframes ${ie} { 50% {  box-shadow: none; }}`,j+=`@keyframes ${se} { 0% {  background-color: ${N.cursor.css};  color: ${N.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${N.cursor.css}; }}`,j+=`${this._terminalSelector} .${Ee}.${Ae} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${Ee}.${Ae} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${ie} 1s step-end infinite;}${this._terminalSelector} .${Ee}.${Ae} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${se} 1s step-end infinite;}${this._terminalSelector} .${Ee} .xterm-cursor.xterm-cursor-block { background-color: ${N.cursor.css}; color: ${N.cursorAccent.css};}${this._terminalSelector} .${Ee} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${N.cursor.css} !important; color: ${N.cursorAccent.css} !important;}${this._terminalSelector} .${Ee} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${N.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${Ee} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${N.cursor.css} inset;}${this._terminalSelector} .${Ee} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${N.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,j+=`${this._terminalSelector} .${Re} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${Re} div { position: absolute; background-color: ${N.selectionBackgroundOpaque.css};}${this._terminalSelector} .${Re} div { position: absolute; background-color: ${N.selectionInactiveBackgroundOpaque.css};}`;for(const[X,ie]of N.ansi.entries())j+=`${this._terminalSelector} .${De}${X} { color: ${ie.css}; }${this._terminalSelector} .${De}${X}.xterm-dim { color: ${Se.color.multiplyOpacity(ie,.5).css}; }${this._terminalSelector} .${Le}${X} { background-color: ${ie.css}; }`;j+=`${this._terminalSelector} .${De}${ce.INVERTED_DEFAULT_COLOR} { color: ${Se.color.opaque(N.background).css}; }${this._terminalSelector} .${De}${ce.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${Se.color.multiplyOpacity(Se.color.opaque(N.background),.5).css}; }${this._terminalSelector} .${Le}${ce.INVERTED_DEFAULT_COLOR} { background-color: ${N.foreground.css}; }`,this._themeStyleElement.textContent=j}_setDefaultSpacing(){const N=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${N}px`,this._rowFactory.defaultSpacing=N}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(N,j){for(let N=this._rowElements.length;N<=j;N++){const N=this._document.createElement("div");this._rowContainer.appendChild(N),this._rowElements.push(N)}for(;this._rowElements.length>j;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(N,j){this._refreshRowElements(N,j),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(Ae),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(Ae),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(N,j,X){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(N,j,X),this.renderRows(0,this._bufferService.rows-1),!N||!j)return;if(this._selectionRenderModel.update(this._terminal,N,j,X),!this._selectionRenderModel.hasSelection)return;const ie=this._selectionRenderModel.viewportStartRow,se=this._selectionRenderModel.viewportEndRow,le=this._selectionRenderModel.viewportCappedStartRow,he=this._selectionRenderModel.viewportCappedEndRow,ce=this._document.createDocumentFragment();if(X){const X=N[0]>j[0];ce.appendChild(this._createSelectionElement(le,X?j[0]:N[0],X?N[0]:j[0],he-le+1))}else{const X=ie===le?N[0]:0,_e=le===se?j[0]:this._bufferService.cols;ce.appendChild(this._createSelectionElement(le,X,_e));const me=he-le-1;if(ce.appendChild(this._createSelectionElement(le+1,0,this._bufferService.cols,me)),le!==he){const N=se===he?j[0]:this._bufferService.cols;ce.appendChild(this._createSelectionElement(he,0,N))}}this._selectionContainer.appendChild(ce)}_createSelectionElement(N,j,X,ie=1){const se=this._document.createElement("div"),le=j*this.dimensions.css.cell.width;let he=this.dimensions.css.cell.width*(X-j);return le+he>this.dimensions.css.canvas.width&&(he=this.dimensions.css.canvas.width-le),se.style.height=ie*this.dimensions.css.cell.height+"px",se.style.top=N*this.dimensions.css.cell.height+"px",se.style.left=`${le}px`,se.style.width=`${he}px`,se}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const N of this._rowElements)N.replaceChildren()}renderRows(N,j){const X=this._bufferService.buffer,ie=X.ybase+X.y,se=Math.min(X.x,this._bufferService.cols-1),le=this._optionsService.rawOptions.cursorBlink,he=this._optionsService.rawOptions.cursorStyle,ce=this._optionsService.rawOptions.cursorInactiveStyle;for(let _e=N;_e<=j;_e++){const N=_e+X.ydisp,j=this._rowElements[_e],me=X.lines.get(N);if(!j||!me)break;j.replaceChildren(...this._rowFactory.createRow(me,N,N===ie,he,ce,se,le,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${we}${this._terminalClass}`}_handleLinkHover(N){this._setCellUnderline(N.x1,N.x2,N.y1,N.y2,N.cols,!0)}_handleLinkLeave(N){this._setCellUnderline(N.x1,N.x2,N.y1,N.y2,N.cols,!1)}_setCellUnderline(N,j,X,ie,se,le){X<0&&(N=0),ie<0&&(j=0);const he=this._bufferService.rows-1;X=Math.max(Math.min(X,he),0),ie=Math.max(Math.min(ie,he),0),se=Math.min(se,this._bufferService.cols);const ce=this._bufferService.buffer,_e=ce.ybase+ce.y,me=Math.min(ce.x,se-1),ve=this._optionsService.rawOptions.cursorBlink,Se=this._optionsService.rawOptions.cursorStyle,be=this._optionsService.rawOptions.cursorInactiveStyle;for(let he=X;he<=ie;++he){const Ce=he+ce.ydisp,ye=this._rowElements[he],we=ce.lines.get(Ce);if(!ye||!we)break;ye.replaceChildren(...this._rowFactory.createRow(we,Ce,Ce===_e,Se,be,me,ve,this.dimensions.css.cell.width,this._widthCache,le?he===X?N:0:-1,le?(he===ie?j:se)-1:-1))}}};j.DomRenderer=ke,j.DomRenderer=ke=ie([se(7,Ce.IInstantiationService),se(8,ve.ICharSizeService),se(9,Ce.IOptionsService),se(10,Ce.IBufferService),se(11,ve.ICoreBrowserService),se(12,ve.IThemeService)],ke)},1433:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.DomRendererRowFactory=void 0;const le=X(9176),he=X(8938),ce=X(3055),_e=X(6501),me=X(4103),ve=X(7098),Se=X(945),be=X(6181),Ce=X(5451);let ye=class{constructor(N,j,X,ie,se,le,he){this._document=N,this._characterJoinerService=j,this._optionsService=X,this._coreBrowserService=ie,this._coreService=se,this._decorationService=le,this._themeService=he,this._workCell=new ce.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(N,j,X){this._selectionStart=N,this._selectionEnd=j,this._columnSelectMode=X}createRow(N,j,X,ie,se,ce,_e,ve,be,ye,we){const Ee=[],De=this._characterJoinerService.getJoinedCharacters(j),Le=this._themeService.colors;let Ae,Re=N.getNoBgTrimmedLength();X&&Re<ce+1&&(Re=ce+1);let Te=0,ke="",Me=0,Oe=0,Ie=0,Pe=!1,xe=0,Be=!1,Ne=0;const Ue=[],Fe=-1!==ye&&-1!==we;for(let We=0;We<Re;We++){N.loadCell(We,this._workCell);let Re=this._workCell.getWidth();if(0===Re)continue;let He=!1,Ke=We,ze=this._workCell;if(De.length>0&&We===De[0][0]){He=!0;const j=De.shift();ze=new Se.JoinedCellData(this._workCell,N.translateToString(!0,j[0],j[1]),j[1]-j[0]),Ke=j[1]-1,Re=ze.getWidth()}const je=this._isCellInSelection(We,j),$e=X&&We===ce,Ve=Fe&&We>=ye&&We<=we;let Ge=!1;this._decorationService.forEachDecorationAtCell(We,j,void 0,(N=>{Ge=!0}));let qe=ze.getChars()||he.WHITESPACE_CELL_CHAR;if(" "===qe&&(ze.isUnderline()||ze.isOverline())&&(qe="Â "),Ne=Re*ve-be.get(qe,ze.isBold(),ze.isItalic()),Ae){if(Te&&(je&&Be||!je&&!Be&&ze.bg===Me)&&(je&&Be&&Le.selectionForeground||ze.fg===Oe)&&ze.extended.ext===Ie&&Ve===Pe&&Ne===xe&&!$e&&!He&&!Ge){ze.isInvisible()?ke+=he.WHITESPACE_CELL_CHAR:ke+=qe,Te++;continue}Te&&(Ae.textContent=ke),Ae=this._document.createElement("span"),Te=0,ke=""}else Ae=this._document.createElement("span");if(Me=ze.bg,Oe=ze.fg,Ie=ze.extended.ext,Pe=Ve,xe=Ne,Be=je,He&&ce>=We&&ce<=Ke&&(ce=We),!this._coreService.isCursorHidden&&$e&&this._coreService.isCursorInitialized)if(Ue.push("xterm-cursor"),this._coreBrowserService.isFocused)_e&&Ue.push("xterm-cursor-blink"),Ue.push("bar"===ie?"xterm-cursor-bar":"underline"===ie?"xterm-cursor-underline":"xterm-cursor-block");else if(se)switch(se){case"outline":Ue.push("xterm-cursor-outline");break;case"block":Ue.push("xterm-cursor-block");break;case"bar":Ue.push("xterm-cursor-bar");break;case"underline":Ue.push("xterm-cursor-underline")}if(ze.isBold()&&Ue.push("xterm-bold"),ze.isItalic()&&Ue.push("xterm-italic"),ze.isDim()&&Ue.push("xterm-dim"),ke=ze.isInvisible()?he.WHITESPACE_CELL_CHAR:ze.getChars()||he.WHITESPACE_CELL_CHAR,ze.isUnderline()&&(Ue.push(`xterm-underline-${ze.extended.underlineStyle}`)," "===ke&&(ke="Â "),!ze.isUnderlineColorDefault()))if(ze.isUnderlineColorRGB())Ae.style.textDecorationColor=`rgb(${Ce.AttributeData.toColorRGB(ze.getUnderlineColor()).join(",")})`;else{let N=ze.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ze.isBold()&&N<8&&(N+=8),Ae.style.textDecorationColor=Le.ansi[N].css}ze.isOverline()&&(Ue.push("xterm-overline")," "===ke&&(ke="Â ")),ze.isStrikethrough()&&Ue.push("xterm-strikethrough"),Ve&&(Ae.style.textDecoration="underline");let Xe=ze.getFgColor(),Ye=ze.getFgColorMode(),Ze=ze.getBgColor(),Qe=ze.getBgColorMode();const Je=!!ze.isInverse();if(Je){const N=Xe;Xe=Ze,Ze=N;const j=Ye;Ye=Qe,Qe=j}let et,tt,it,st=!1;switch(this._decorationService.forEachDecorationAtCell(We,j,void 0,(N=>{"top"!==N.options.layer&&st||(N.backgroundColorRGB&&(Qe=50331648,Ze=N.backgroundColorRGB.rgba>>8&16777215,et=N.backgroundColorRGB),N.foregroundColorRGB&&(Ye=50331648,Xe=N.foregroundColorRGB.rgba>>8&16777215,tt=N.foregroundColorRGB),st="top"===N.options.layer)})),!st&&je&&(et=this._coreBrowserService.isFocused?Le.selectionBackgroundOpaque:Le.selectionInactiveBackgroundOpaque,Ze=et.rgba>>8&16777215,Qe=50331648,st=!0,Le.selectionForeground&&(Ye=50331648,Xe=Le.selectionForeground.rgba>>8&16777215,tt=Le.selectionForeground)),st&&Ue.push("xterm-decoration-top"),Qe){case 16777216:case 33554432:it=Le.ansi[Ze],Ue.push(`xterm-bg-${Ze}`);break;case 50331648:it=me.channels.toColor(Ze>>16,Ze>>8&255,255&Ze),this._addStyle(Ae,`background-color:#${p((Ze>>>0).toString(16),"0",6)}`);break;default:Je?(it=Le.foreground,Ue.push(`xterm-bg-${le.INVERTED_DEFAULT_COLOR}`)):it=Le.background}switch(et||ze.isDim()&&(et=me.color.multiplyOpacity(it,.5)),Ye){case 16777216:case 33554432:ze.isBold()&&Xe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Xe+=8),this._applyMinimumContrast(Ae,it,Le.ansi[Xe],ze,et,void 0)||Ue.push(`xterm-fg-${Xe}`);break;case 50331648:const N=me.channels.toColor(Xe>>16&255,Xe>>8&255,255&Xe);this._applyMinimumContrast(Ae,it,N,ze,et,tt)||this._addStyle(Ae,`color:#${p(Xe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(Ae,it,Le.foreground,ze,et,tt)||Je&&Ue.push(`xterm-fg-${le.INVERTED_DEFAULT_COLOR}`)}Ue.length&&(Ae.className=Ue.join(" "),Ue.length=0),$e||He||Ge?Ae.textContent=ke:Te++,Ne!==this.defaultSpacing&&(Ae.style.letterSpacing=`${Ne}px`),Ee.push(Ae),We=Ke}return Ae&&Te&&(Ae.textContent=ke),Ee}_applyMinimumContrast(N,j,X,ie,se,le){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,be.treatGlyphAsBackgroundColor)(ie.getCode()))return!1;const he=this._getContrastCache(ie);let ce;if(se||le||(ce=he.getColor(j.rgba,X.rgba)),void 0===ce){const N=this._optionsService.rawOptions.minimumContrastRatio/(ie.isDim()?2:1);ce=me.color.ensureContrastRatio(se||j,le||X,N),he.setColor((se||j).rgba,(le||X).rgba,ce??null)}return!!ce&&(this._addStyle(N,`color:${ce.css}`),!0)}_getContrastCache(N){return N.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(N,j){N.setAttribute("style",`${N.getAttribute("style")||""}${j};`)}_isCellInSelection(N,j){const X=this._selectionStart,ie=this._selectionEnd;return!(!X||!ie)&&(this._columnSelectMode?X[0]<=ie[0]?N>=X[0]&&j>=X[1]&&N<ie[0]&&j<=ie[1]:N<X[0]&&j>=X[1]&&N>=ie[0]&&j<=ie[1]:j>X[1]&&j<ie[1]||X[1]===ie[1]&&j===X[1]&&N>=X[0]&&N<ie[0]||X[1]<ie[1]&&j===ie[1]&&N<ie[0]||X[1]<ie[1]&&j===X[1]&&N>=X[0])}};function p(N,j,X){for(;N.length<X;)N=j+N;return N}j.DomRendererRowFactory=ye,j.DomRendererRowFactory=ye=ie([se(1,ve.ICharacterJoinerService),se(2,_e.IOptionsService),se(3,ve.ICoreBrowserService),se(4,_e.ICoreService),se(5,_e.IDecorationService),se(6,ve.IThemeService)],ye)},2744:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.WidthCache=void 0,j.WidthCache=class{constructor(N,j){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=N.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const X=N.createElement("span");X.classList.add("xterm-char-measure-element");const ie=N.createElement("span");ie.classList.add("xterm-char-measure-element"),ie.style.fontWeight="bold";const se=N.createElement("span");se.classList.add("xterm-char-measure-element"),se.style.fontStyle="italic";const le=N.createElement("span");le.classList.add("xterm-char-measure-element"),le.style.fontWeight="bold",le.style.fontStyle="italic",this._measureElements=[X,ie,se,le],this._container.appendChild(X),this._container.appendChild(ie),this._container.appendChild(se),this._container.appendChild(le),j.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(N,j,X,ie){N===this._font&&j===this._fontSize&&X===this._weight&&ie===this._weightBold||(this._font=N,this._fontSize=j,this._weight=X,this._weightBold=ie,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${X}`,this._measureElements[1].style.fontWeight=`${ie}`,this._measureElements[2].style.fontWeight=`${X}`,this._measureElements[3].style.fontWeight=`${ie}`,this.clear())}get(N,j,X){let ie=0;if(!j&&!X&&1===N.length&&(ie=N.charCodeAt(0))<256){if(-9999!==this._flat[ie])return this._flat[ie];const j=this._measure(N,0);return j>0&&(this._flat[ie]=j),j}let se=N;j&&(se+="B"),X&&(se+="I");let le=this._holey.get(se);if(void 0===le){let ie=0;j&&(ie|=1),X&&(ie|=2),le=this._measure(N,ie),le>0&&this._holey.set(se,le)}return le}_measure(N,j){const X=this._measureElements[j];return X.textContent=N.repeat(32),X.offsetWidth/32}}},9176:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.TEXT_BASELINE=j.DIM_OPACITY=j.INVERTED_DEFAULT_COLOR=void 0;const ie=X(701);j.INVERTED_DEFAULT_COLOR=257,j.DIM_OPACITY=.5,j.TEXT_BASELINE=ie.isFirefox||ie.isLegacyEdge?"bottom":"ideographic"},6181:(N,j)=>{function i(N){return 57508<=N&&N<=57558}function s(N){return N>=128512&&N<=128591||N>=127744&&N<=128511||N>=128640&&N<=128767||N>=9728&&N<=9983||N>=9984&&N<=10175||N>=65024&&N<=65039||N>=129280&&N<=129535||N>=127462&&N<=127487}Object.defineProperty(j,"__esModule",{value:!0}),j.throwIfFalsy=function(N){if(!N)throw new Error("value must not be falsy");return N},j.isPowerlineGlyph=i,j.isRestrictedPowerlineGlyph=function(N){return 57520<=N&&N<=57527},j.isEmoji=s,j.allowRescaling=function(N,j,X,ie){return 1===j&&X>Math.ceil(1.5*ie)&&void 0!==N&&N>255&&!s(N)&&!i(N)&&!function(N){return 57344<=N&&N<=63743}(N)},j.treatGlyphAsBackgroundColor=function(N){return i(N)||function(N){return 9472<=N&&N<=9631}(N)},j.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},j.computeNextVariantOffset=function(N,j,X=0){return(N-(2*Math.round(j)-X))%(2*Math.round(j))}},2274:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.createSelectionRenderModel=function(){return new i};class i{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(N,j,X,ie=!1){if(this.selectionStart=j,this.selectionEnd=X,!j||!X||j[0]===X[0]&&j[1]===X[1])return void this.clear();const se=N.buffers.active.ydisp,le=j[1]-se,he=X[1]-se,ce=Math.max(le,0),_e=Math.min(he,N.rows-1);ce>=N.rows||_e<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=ie,this.viewportStartRow=le,this.viewportEndRow=he,this.viewportCappedStartRow=ce,this.viewportCappedEndRow=_e,this.startCol=j[0],this.endCol=X[0])}isCellSelected(N,j,X){return!!this.hasSelection&&(X-=N.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?j>=this.startCol&&X>=this.viewportCappedStartRow&&j<this.endCol&&X<=this.viewportCappedEndRow:j<this.startCol&&X>=this.viewportCappedStartRow&&j>=this.endCol&&X<=this.viewportCappedEndRow:X>this.viewportStartRow&&X<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&X===this.viewportStartRow&&j>=this.startCol&&j<this.endCol||this.viewportStartRow<this.viewportEndRow&&X===this.viewportEndRow&&j<this.endCol||this.viewportStartRow<this.viewportEndRow&&X===this.viewportStartRow&&j>=this.startCol)}}},5959:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.SelectionModel=void 0,j.SelectionModel=class{constructor(N){this._bufferService=N,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const N=this.selectionStart[0]+this.selectionStartLength;return N>this._bufferService.cols?N%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(N/this._bufferService.cols)-1]:[N%this._bufferService.cols,this.selectionStart[1]+Math.floor(N/this._bufferService.cols)]:[N,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const N=this.selectionStart[0]+this.selectionStartLength;return N>this._bufferService.cols?[N%this._bufferService.cols,this.selectionStart[1]+Math.floor(N/this._bufferService.cols)]:[Math.max(N,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const N=this.selectionStart,j=this.selectionEnd;return!(!N||!j)&&(N[1]>j[1]||N[1]===j[1]&&N[0]>j[0])}handleTrim(N){return this.selectionStart&&(this.selectionStart[1]-=N),this.selectionEnd&&(this.selectionEnd[1]-=N),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},4792:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.CharSizeService=void 0;const le=X(6501),he=X(7150),ce=X(802);let _e=class extends he.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(N,j,X){super(),this._optionsService=X,this.width=0,this.height=0,this._onCharSizeChange=this._register(new ce.Emitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new d(this._optionsService))}catch{this._measureStrategy=this._register(new c(N,j,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}measure(){const N=this._measureStrategy.measure();N.width===this.width&&N.height===this.height||(this.width=N.width,this.height=N.height,this._onCharSizeChange.fire())}};j.CharSizeService=_e,j.CharSizeService=_e=ie([se(2,le.IOptionsService)],_e);class h extends he.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(N,j){void 0!==N&&N>0&&void 0!==j&&j>0&&(this._result.width=N,this._result.height=j)}}class c extends h{constructor(N,j,X){super(),this._document=N,this._parentElement=j,this._optionsService=X,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class d extends h{constructor(N){super(),this._optionsService=N,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const j=this._ctx.measureText("W");if(!("width"in j&&"fontBoundingBoxAscent"in j&&"fontBoundingBoxDescent"in j))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const N=this._ctx.measureText("W");return this._validateAndSet(N.width,N.fontBoundingBoxAscent+N.fontBoundingBoxDescent),this._result}}},945:function(N,j,X){var ie,se=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},le=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.CharacterJoinerService=j.JoinedCellData=void 0;const he=X(5451),ce=X(8938),_e=X(3055),me=X(6501);class c extends he.AttributeData{constructor(N,j,X){super(),this.content=0,this.combinedData="",this.fg=N.fg,this.bg=N.bg,this.combinedData=j,this._width=X}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(N){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}j.JoinedCellData=c;let ve=ie=class{constructor(N){this._bufferService=N,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new _e.CellData}register(N){const j={id:this._nextCharacterJoinerId++,handler:N};return this._characterJoiners.push(j),j.id}deregister(N){for(let j=0;j<this._characterJoiners.length;j++)if(this._characterJoiners[j].id===N)return this._characterJoiners.splice(j,1),!0;return!1}getJoinedCharacters(N){if(0===this._characterJoiners.length)return[];const j=this._bufferService.buffer.lines.get(N);if(!j||0===j.length)return[];const X=[],ie=j.translateToString(!0);let se=0,le=0,he=0,_e=j.getFg(0),me=j.getBg(0);for(let N=0;N<j.getTrimmedLength();N++)if(j.loadCell(N,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==_e||this._workCell.bg!==me){if(N-se>1){const N=this._getJoinedRanges(ie,he,le,j,se);for(let j=0;j<N.length;j++)X.push(N[j])}se=N,he=le,_e=this._workCell.fg,me=this._workCell.bg}le+=this._workCell.getChars().length||ce.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-se>1){const N=this._getJoinedRanges(ie,he,le,j,se);for(let j=0;j<N.length;j++)X.push(N[j])}return X}_getJoinedRanges(N,j,X,se,le){const he=N.substring(j,X);let ce=[];try{ce=this._characterJoiners[0].handler(he)}catch(N){console.error(N)}for(let j=1;j<this._characterJoiners.length;j++)try{const N=this._characterJoiners[j].handler(he);for(let j=0;j<N.length;j++)ie._mergeRanges(ce,N[j])}catch(N){console.error(N)}return this._stringRangesToCellRanges(ce,se,le),ce}_stringRangesToCellRanges(N,j,X){let ie=0,se=!1,le=0,he=N[ie];if(he){for(let _e=X;_e<this._bufferService.cols;_e++){const X=j.getWidth(_e),me=j.getString(_e).length||ce.WHITESPACE_CELL_CHAR.length;if(0!==X){if(!se&&he[0]<=le&&(he[0]=_e,se=!0),he[1]<=le){if(he[1]=_e,he=N[++ie],!he)break;he[0]<=le?(he[0]=_e,se=!0):se=!1}le+=me}}he&&(he[1]=this._bufferService.cols)}}static _mergeRanges(N,j){let X=!1;for(let ie=0;ie<N.length;ie++){const se=N[ie];if(X){if(j[1]<=se[0])return N[ie-1][1]=j[1],N;if(j[1]<=se[1])return N[ie-1][1]=Math.max(j[1],se[1]),N.splice(ie,1),N;N.splice(ie,1),ie--}else{if(j[1]<=se[0])return N.splice(ie,0,j),N;if(j[1]<=se[1])return se[0]=Math.min(j[0],se[0]),N;j[0]<se[1]&&(se[0]=Math.min(j[0],se[0]),X=!0)}}return X?N[N.length-1][1]=j[1]:N.push(j),N}};j.CharacterJoinerService=ve,j.CharacterJoinerService=ve=ie=se([le(0,me.IBufferService)],ve)},9574:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CoreBrowserService=void 0;const ie=X(802),se=X(7093),le=X(7150);class o extends le.Disposable{constructor(N,j,X){super(),this._textarea=N,this._window=j,this.mainDocument=X,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new a(this._window)),this._onDprChange=this._register(new ie.Emitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new ie.Emitter),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange((N=>this._screenDprMonitor.setWindow(N)))),this._register(ie.Event.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register((0,se.addDisposableListener)(this._textarea,"focus",(()=>this._isFocused=!0))),this._register((0,se.addDisposableListener)(this._textarea,"blur",(()=>this._isFocused=!1)))}get window(){return this._window}set window(N){this._window!==N&&(this._window=N,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}j.CoreBrowserService=o;class a extends le.Disposable{constructor(N){super(),this._parentWindow=N,this._windowResizeListener=this._register(new le.MutableDisposable),this._onDprChange=this._register(new ie.Emitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register((0,le.toDisposable)((()=>this.clearListener())))}setWindow(N){this._parentWindow=N,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,se.addDisposableListener)(this._parentWindow,"resize",(()=>this._setDprAndFireIfDiffers()))}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},9820:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.LinkProviderService=void 0;const ie=X(7150);class r extends ie.Disposable{constructor(){super(),this.linkProviders=[],this._register((0,ie.toDisposable)((()=>this.linkProviders.length=0)))}registerLinkProvider(N){return this.linkProviders.push(N),{dispose:()=>{const j=this.linkProviders.indexOf(N);-1!==j&&this.linkProviders.splice(j,1)}}}}j.LinkProviderService=r},9784:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.MouseService=void 0;const le=X(7098),he=X(5251);let ce=class{constructor(N,j){this._renderService=N,this._charSizeService=j}getCoords(N,j,X,ie,se){return(0,he.getCoords)(window,N,j,X,ie,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,se)}getMouseReportCoords(N,j){const X=(0,he.getCoordsRelativeToElement)(window,N,j);if(this._charSizeService.hasValidSize)return X[0]=Math.min(Math.max(X[0],0),this._renderService.dimensions.css.canvas.width-1),X[1]=Math.min(Math.max(X[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(X[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(X[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(X[0]),y:Math.floor(X[1])}}};j.MouseService=ce,j.MouseService=ce=ie([se(0,le.IRenderService),se(1,le.ICharSizeService)],ce)},5783:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.RenderService=void 0;const le=X(4852),he=X(7098),ce=X(7150),_e=X(6168),me=X(6501),ve=X(802);let Se=class extends ce.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(N,j,X,ie,se,he,me,Se){super(),this._rowCount=N,this._charSizeService=ie,this._renderer=this._register(new ce.MutableDisposable),this._pausedResizeTask=new _e.DebouncedIdleTask,this._observerDisposable=this._register(new ce.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new ve.Emitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new ve.Emitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new ve.Emitter),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new ve.Emitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new le.RenderDebouncer(((N,j)=>this._renderRows(N,j)),me),this._register(this._renderDebouncer),this._register(me.onDprChange((()=>this.handleDevicePixelRatioChange()))),this._register(he.onResize((()=>this._fullRefresh()))),this._register(he.buffers.onBufferActivate((()=>this._renderer.value?.clear()))),this._register(X.onOptionChange((()=>this._handleOptionsChanged()))),this._register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this._register(se.onDecorationRegistered((()=>this._fullRefresh()))),this._register(se.onDecorationRemoved((()=>this._fullRefresh()))),this._register(X.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],(()=>{this.clear(),this.handleResize(he.cols,he.rows),this._fullRefresh()}))),this._register(X.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(he.buffer.y,he.buffer.y,!0)))),this._register(Se.onChangeColors((()=>this._fullRefresh()))),this._registerIntersectionObserver(me.window,j),this._register(me.onWindowChange((N=>this._registerIntersectionObserver(N,j))))}_registerIntersectionObserver(N,j){if("IntersectionObserver"in N){const X=new N.IntersectionObserver((N=>this._handleIntersectionChange(N[N.length-1])),{threshold:0});X.observe(j),this._observerDisposable.value=(0,ce.toDisposable)((()=>X.disconnect()))}}_handleIntersectionChange(N){this._isPaused=void 0===N.isIntersecting?0===N.intersectionRatio:!N.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(N,j,X=!1){this._isPaused?this._needsFullRefresh=!0:(X||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(N,j,this._rowCount))}_renderRows(N,j){this._renderer.value&&(N=Math.min(N,this._rowCount-1),j=Math.min(j,this._rowCount-1),this._renderer.value.renderRows(N,j),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:N,end:j}),this._onRender.fire({start:N,end:j}),this._isNextRenderRedrawOnly=!0)}resize(N,j){this._rowCount=j,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(N){this._renderer.value=N,this._renderer.value&&(this._renderer.value.onRequestRedraw((N=>this.refreshRows(N.start,N.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(N){return this._renderDebouncer.addRefreshCallback(N)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(N,j){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((()=>this._renderer.value?.handleResize(N,j))):this._renderer.value.handleResize(N,j),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(N,j,X){this._selectionState.start=N,this._selectionState.end=j,this._selectionState.columnSelectMode=X,this._renderer.value?.handleSelectionChanged(N,j,X)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};j.RenderService=Se,j.RenderService=Se=ie([se(2,me.IOptionsService),se(3,he.ICharSizeService),se(4,me.IDecorationService),se(5,me.IBufferService),se(6,he.ICoreBrowserService),se(7,he.IThemeService)],Se)},2079:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.SelectionService=void 0;const le=X(5251),he=X(9686),ce=X(5959),_e=X(7098),me=X(7150),ve=X(701),Se=X(9384),be=X(3055),Ce=X(6501),ye=X(802),we=String.fromCharCode(160),Ee=new RegExp(we,"g");let De=class extends me.Disposable{constructor(N,j,X,ie,se,le,he,_e,ve){super(),this._element=N,this._screenElement=j,this._linkifier=X,this._bufferService=ie,this._coreService=se,this._mouseService=le,this._optionsService=he,this._renderService=_e,this._coreBrowserService=ve,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new be.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new ye.Emitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new ye.Emitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new ye.Emitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new ye.Emitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=N=>this._handleMouseMove(N),this._mouseUpListener=N=>this._handleMouseUp(N),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((N=>this._handleTrim(N))),this._register(this._bufferService.buffers.onBufferActivate((N=>this._handleBufferActivate(N)))),this.enable(),this._model=new ce.SelectionModel(this._bufferService),this._activeSelectionMode=0,this._register((0,me.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const N=this._model.finalSelectionStart,j=this._model.finalSelectionEnd;return!(!N||!j||N[0]===j[0]&&N[1]===j[1])}get selectionText(){const N=this._model.finalSelectionStart,j=this._model.finalSelectionEnd;if(!N||!j)return"";const X=this._bufferService.buffer,ie=[];if(3===this._activeSelectionMode){if(N[0]===j[0])return"";const se=N[0]<j[0]?N[0]:j[0],le=N[0]<j[0]?j[0]:N[0];for(let he=N[1];he<=j[1];he++){const N=X.translateBufferLineToString(he,!0,se,le);ie.push(N)}}else{const se=N[1]===j[1]?j[0]:void 0;ie.push(X.translateBufferLineToString(N[1],!0,N[0],se));for(let se=N[1]+1;se<=j[1]-1;se++){const N=X.lines.get(se),j=X.translateBufferLineToString(se,!0);N?.isWrapped?ie[ie.length-1]+=j:ie.push(j)}if(N[1]!==j[1]){const N=X.lines.get(j[1]),se=X.translateBufferLineToString(j[1],!0,0,j[0]);N&&N.isWrapped?ie[ie.length-1]+=se:ie.push(se)}}return ie.map((N=>N.replace(Ee," "))).join(ve.isWindows?"\r\n":"\n")}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(N){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),ve.isLinux&&N&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}_isClickInSelection(N){const j=this._getMouseBufferCoords(N),X=this._model.finalSelectionStart,ie=this._model.finalSelectionEnd;return!!(X&&ie&&j)&&this._areCoordsInSelection(j,X,ie)}isCellInSelection(N,j){const X=this._model.finalSelectionStart,ie=this._model.finalSelectionEnd;return!(!X||!ie)&&this._areCoordsInSelection([N,j],X,ie)}_areCoordsInSelection(N,j,X){return N[1]>j[1]&&N[1]<X[1]||j[1]===X[1]&&N[1]===j[1]&&N[0]>=j[0]&&N[0]<X[0]||j[1]<X[1]&&N[1]===X[1]&&N[0]<X[0]||j[1]<X[1]&&N[1]===j[1]&&N[0]>=j[0]}_selectWordAtCursor(N,j){const X=this._linkifier.currentLink?.link?.range;if(X)return this._model.selectionStart=[X.start.x-1,X.start.y-1],this._model.selectionStartLength=(0,Se.getRangeLength)(X,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const ie=this._getMouseBufferCoords(N);return!!ie&&(this._selectWordAt(ie,j),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(N,j){this._model.clearSelection(),N=Math.max(N,0),j=Math.min(j,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,N],this._model.selectionEnd=[this._bufferService.cols,j],this.refresh(),this._onSelectionChange.fire()}_handleTrim(N){this._model.handleTrim(N)&&this.refresh()}_getMouseBufferCoords(N){const j=this._mouseService.getCoords(N,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(j)return j[0]--,j[1]--,j[1]+=this._bufferService.buffer.ydisp,j}_getMouseEventScrollAmount(N){let j=(0,le.getCoordsRelativeToElement)(this._coreBrowserService.window,N,this._screenElement)[1];const X=this._renderService.dimensions.css.canvas.height;return j>=0&&j<=X?0:(j>X&&(j-=X),j=Math.min(Math.max(j,-50),50),j/=50,j/Math.abs(j)+Math.round(14*j))}shouldForceSelection(N){return ve.isMac?N.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:N.shiftKey}handleMouseDown(N){if(this._mouseDownTimeStamp=N.timeStamp,(2!==N.button||!this.hasSelection)&&0===N.button){if(!this._enabled){if(!this.shouldForceSelection(N))return;N.stopPropagation()}N.preventDefault(),this._dragScrollAmount=0,this._enabled&&N.shiftKey?this._handleIncrementalClick(N):1===N.detail?this._handleSingleClick(N):2===N.detail?this._handleDoubleClick(N):3===N.detail&&this._handleTripleClick(N),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(N){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(N))}_handleSingleClick(N){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(N)?3:0,this._model.selectionStart=this._getMouseBufferCoords(N),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const j=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);j&&j.length!==this._model.selectionStart[0]&&0===j.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}_handleDoubleClick(N){this._selectWordAtCursor(N,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(N){const j=this._getMouseBufferCoords(N);j&&(this._activeSelectionMode=2,this._selectLineAt(j[1]))}shouldColumnSelect(N){return N.altKey&&!(ve.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(N){if(N.stopImmediatePropagation(),!this._model.selectionStart)return;const j=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(N),!this._model.selectionEnd)return void this.refresh(!0);2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(N),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const X=this._bufferService.buffer;if(this._model.selectionEnd[1]<X.lines.length){const N=X.lines.get(this._model.selectionEnd[1]);N&&0===N.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}j&&j[0]===this._model.selectionEnd[0]&&j[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const N=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(N.ydisp+this._bufferService.rows,N.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=N.ydisp),this.refresh()}}_handleMouseUp(N){const j=N.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&j<500&&N.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const j=this._mouseService.getCoords(N,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(j&&void 0!==j[0]&&void 0!==j[1]){const N=(0,he.moveToCellSequence)(j[0]-1,j[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(N,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const N=this._model.finalSelectionStart,j=this._model.finalSelectionEnd,X=!(!N||!j||N[0]===j[0]&&N[1]===j[1]);X?N&&j&&(this._oldSelectionStart&&this._oldSelectionEnd&&N[0]===this._oldSelectionStart[0]&&N[1]===this._oldSelectionStart[1]&&j[0]===this._oldSelectionEnd[0]&&j[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(N,j,X)):this._oldHasSelection&&this._fireOnSelectionChange(N,j,X)}_fireOnSelectionChange(N,j,X){this._oldSelectionStart=N,this._oldSelectionEnd=j,this._oldHasSelection=X,this._onSelectionChange.fire()}_handleBufferActivate(N){this.clearSelection(),this._trimListener.dispose(),this._trimListener=N.activeBuffer.lines.onTrim((N=>this._handleTrim(N)))}_convertViewportColToCharacterIndex(N,j){let X=j;for(let ie=0;j>=ie;ie++){const se=N.loadCell(ie,this._workCell).getChars().length;0===this._workCell.getWidth()?X--:se>1&&j!==ie&&(X+=se-1)}return X}setSelection(N,j,X){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[N,j],this._model.selectionStartLength=X,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(N){this._isClickInSelection(N)||(this._selectWordAtCursor(N,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(N,j,X=!0,ie=!0){if(N[0]>=this._bufferService.cols)return;const se=this._bufferService.buffer,le=se.lines.get(N[1]);if(!le)return;const he=se.translateBufferLineToString(N[1],!1);let ce=this._convertViewportColToCharacterIndex(le,N[0]),_e=ce;const me=N[0]-ce;let ve=0,Se=0,be=0,Ce=0;if(" "===he.charAt(ce)){for(;ce>0&&" "===he.charAt(ce-1);)ce--;for(;_e<he.length&&" "===he.charAt(_e+1);)_e++}else{let j=N[0],X=N[0];0===le.getWidth(j)&&(ve++,j--),2===le.getWidth(X)&&(Se++,X++);const ie=le.getString(X).length;for(ie>1&&(Ce+=ie-1,_e+=ie-1);j>0&&ce>0&&!this._isCharWordSeparator(le.loadCell(j-1,this._workCell));){le.loadCell(j-1,this._workCell);const N=this._workCell.getChars().length;0===this._workCell.getWidth()?(ve++,j--):N>1&&(be+=N-1,ce-=N-1),ce--,j--}for(;X<le.length&&_e+1<he.length&&!this._isCharWordSeparator(le.loadCell(X+1,this._workCell));){le.loadCell(X+1,this._workCell);const N=this._workCell.getChars().length;2===this._workCell.getWidth()?(Se++,X++):N>1&&(Ce+=N-1,_e+=N-1),_e++,X++}}_e++;let ye=ce+me-ve+be,we=Math.min(this._bufferService.cols,_e-ce+ve+Se-be-Ce);if(j||""!==he.slice(ce,_e).trim()){if(X&&0===ye&&32!==le.getCodePoint(0)){const j=se.lines.get(N[1]-1);if(j&&le.isWrapped&&32!==j.getCodePoint(this._bufferService.cols-1)){const j=this._getWordAt([this._bufferService.cols-1,N[1]-1],!1,!0,!1);if(j){const N=this._bufferService.cols-j.start;ye-=N,we+=N}}}if(ie&&ye+we===this._bufferService.cols&&32!==le.getCodePoint(this._bufferService.cols-1)){const j=se.lines.get(N[1]+1);if(j?.isWrapped&&32!==j.getCodePoint(0)){const j=this._getWordAt([0,N[1]+1],!1,!1,!0);j&&(we+=j.length)}}return{start:ye,length:we}}}_selectWordAt(N,j){const X=this._getWordAt(N,j);if(X){for(;X.start<0;)X.start+=this._bufferService.cols,N[1]--;this._model.selectionStart=[X.start,N[1]],this._model.selectionStartLength=X.length}}_selectToWordAt(N){const j=this._getWordAt(N,!0);if(j){let X=N[1];for(;j.start<0;)j.start+=this._bufferService.cols,X--;if(!this._model.areSelectionValuesReversed())for(;j.start+j.length>this._bufferService.cols;)j.length-=this._bufferService.cols,X++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?j.start:j.start+j.length,X]}}_isCharWordSeparator(N){return 0!==N.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(N.getChars())>=0}_selectLineAt(N){const j=this._bufferService.buffer.getWrappedRangeForLine(N),X={start:{x:0,y:j.first},end:{x:this._bufferService.cols-1,y:j.last}};this._model.selectionStart=[0,j.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,Se.getRangeLength)(X,this._bufferService.cols)}};j.SelectionService=De,j.SelectionService=De=ie([se(3,Ce.IBufferService),se(4,Ce.ICoreService),se(5,_e.IMouseService),se(6,Ce.IOptionsService),se(7,_e.IRenderService),se(8,_e.ICoreBrowserService)],De)},7098:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ILinkProviderService=j.IThemeService=j.ICharacterJoinerService=j.ISelectionService=j.IRenderService=j.IMouseService=j.ICoreBrowserService=j.ICharSizeService=void 0;const ie=X(6201);j.ICharSizeService=(0,ie.createDecorator)("CharSizeService"),j.ICoreBrowserService=(0,ie.createDecorator)("CoreBrowserService"),j.IMouseService=(0,ie.createDecorator)("MouseService"),j.IRenderService=(0,ie.createDecorator)("RenderService"),j.ISelectionService=(0,ie.createDecorator)("SelectionService"),j.ICharacterJoinerService=(0,ie.createDecorator)("CharacterJoinerService"),j.IThemeService=(0,ie.createDecorator)("ThemeService"),j.ILinkProviderService=(0,ie.createDecorator)("LinkProviderService")},9078:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.ThemeService=void 0;const le=X(7174),he=X(9302),ce=X(4103),_e=X(7150),me=X(6501),ve=X(802),Se=ce.css.toColor("#ffffff"),be=ce.css.toColor("#000000"),Ce=ce.css.toColor("#ffffff"),ye=be,we={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},Ee=Se;let De=class extends _e.Disposable{get colors(){return this._colors}constructor(N){super(),this._optionsService=N,this._contrastCache=new le.ColorContrastCache,this._halfContrastCache=new le.ColorContrastCache,this._onChangeColors=this._register(new ve.Emitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:Se,background:be,cursor:Ce,cursorAccent:ye,selectionForeground:void 0,selectionBackgroundTransparent:we,selectionBackgroundOpaque:ce.color.blend(be,we),selectionInactiveBackgroundTransparent:we,selectionInactiveBackgroundOpaque:ce.color.blend(be,we),scrollbarSliderBackground:ce.color.opacity(Se,.2),scrollbarSliderHoverBackground:ce.color.opacity(Se,.4),scrollbarSliderActiveBackground:ce.color.opacity(Se,.5),overviewRulerBorder:Se,ansi:he.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this._register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}_setTheme(N={}){const j=this._colors;if(j.foreground=v(N.foreground,Se),j.background=v(N.background,be),j.cursor=v(N.cursor,Ce),j.cursorAccent=v(N.cursorAccent,ye),j.selectionBackgroundTransparent=v(N.selectionBackground,we),j.selectionBackgroundOpaque=ce.color.blend(j.background,j.selectionBackgroundTransparent),j.selectionInactiveBackgroundTransparent=v(N.selectionInactiveBackground,j.selectionBackgroundTransparent),j.selectionInactiveBackgroundOpaque=ce.color.blend(j.background,j.selectionInactiveBackgroundTransparent),j.selectionForeground=N.selectionForeground?v(N.selectionForeground,ce.NULL_COLOR):void 0,j.selectionForeground===ce.NULL_COLOR&&(j.selectionForeground=void 0),ce.color.isOpaque(j.selectionBackgroundTransparent)){const N=.3;j.selectionBackgroundTransparent=ce.color.opacity(j.selectionBackgroundTransparent,N)}if(ce.color.isOpaque(j.selectionInactiveBackgroundTransparent)){const N=.3;j.selectionInactiveBackgroundTransparent=ce.color.opacity(j.selectionInactiveBackgroundTransparent,N)}if(j.scrollbarSliderBackground=v(N.scrollbarSliderBackground,ce.color.opacity(j.foreground,.2)),j.scrollbarSliderHoverBackground=v(N.scrollbarSliderHoverBackground,ce.color.opacity(j.foreground,.4)),j.scrollbarSliderActiveBackground=v(N.scrollbarSliderActiveBackground,ce.color.opacity(j.foreground,.5)),j.overviewRulerBorder=v(N.overviewRulerBorder,Ee),j.ansi=he.DEFAULT_ANSI_COLORS.slice(),j.ansi[0]=v(N.black,he.DEFAULT_ANSI_COLORS[0]),j.ansi[1]=v(N.red,he.DEFAULT_ANSI_COLORS[1]),j.ansi[2]=v(N.green,he.DEFAULT_ANSI_COLORS[2]),j.ansi[3]=v(N.yellow,he.DEFAULT_ANSI_COLORS[3]),j.ansi[4]=v(N.blue,he.DEFAULT_ANSI_COLORS[4]),j.ansi[5]=v(N.magenta,he.DEFAULT_ANSI_COLORS[5]),j.ansi[6]=v(N.cyan,he.DEFAULT_ANSI_COLORS[6]),j.ansi[7]=v(N.white,he.DEFAULT_ANSI_COLORS[7]),j.ansi[8]=v(N.brightBlack,he.DEFAULT_ANSI_COLORS[8]),j.ansi[9]=v(N.brightRed,he.DEFAULT_ANSI_COLORS[9]),j.ansi[10]=v(N.brightGreen,he.DEFAULT_ANSI_COLORS[10]),j.ansi[11]=v(N.brightYellow,he.DEFAULT_ANSI_COLORS[11]),j.ansi[12]=v(N.brightBlue,he.DEFAULT_ANSI_COLORS[12]),j.ansi[13]=v(N.brightMagenta,he.DEFAULT_ANSI_COLORS[13]),j.ansi[14]=v(N.brightCyan,he.DEFAULT_ANSI_COLORS[14]),j.ansi[15]=v(N.brightWhite,he.DEFAULT_ANSI_COLORS[15]),N.extendedAnsi){const X=Math.min(j.ansi.length-16,N.extendedAnsi.length);for(let ie=0;ie<X;ie++)j.ansi[ie+16]=v(N.extendedAnsi[ie],he.DEFAULT_ANSI_COLORS[ie+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(N){this._restoreColor(N),this._onChangeColors.fire(this.colors)}_restoreColor(N){if(void 0!==N)switch(N){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[N]=this._restoreColors.ansi[N]}else for(let N=0;N<this._restoreColors.ansi.length;++N)this._colors.ansi[N]=this._restoreColors.ansi[N]}modifyColors(N){N(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function v(N,j){if(void 0!==N)try{return ce.css.toColor(N)}catch{}return j}j.ThemeService=De,j.ThemeService=De=ie([se(0,me.IOptionsService)],De)},5639:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CircularList=void 0;const ie=X(7150),se=X(802);class n extends ie.Disposable{constructor(N){super(),this._maxLength=N,this.onDeleteEmitter=this._register(new se.Emitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new se.Emitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new se.Emitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(N){if(this._maxLength===N)return;const j=new Array(N);for(let X=0;X<Math.min(N,this.length);X++)j[X]=this._array[this._getCyclicIndex(X)];this._array=j,this._maxLength=N,this._startIndex=0}get length(){return this._length}set length(N){if(N>this._length)for(let j=this._length;j<N;j++)this._array[j]=void 0;this._length=N}get(N){return this._array[this._getCyclicIndex(N)]}set(N,j){this._array[this._getCyclicIndex(N)]=j}push(N){this._array[this._getCyclicIndex(this._length)]=N,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(N,j,...X){if(j){for(let X=N;X<this._length-j;X++)this._array[this._getCyclicIndex(X)]=this._array[this._getCyclicIndex(X+j)];this._length-=j,this.onDeleteEmitter.fire({index:N,amount:j})}for(let j=this._length-1;j>=N;j--)this._array[this._getCyclicIndex(j+X.length)]=this._array[this._getCyclicIndex(j)];for(let j=0;j<X.length;j++)this._array[this._getCyclicIndex(N+j)]=X[j];if(X.length&&this.onInsertEmitter.fire({index:N,amount:X.length}),this._length+X.length>this._maxLength){const N=this._length+X.length-this._maxLength;this._startIndex+=N,this._length=this._maxLength,this.onTrimEmitter.fire(N)}else this._length+=X.length}trimStart(N){N>this._length&&(N=this._length),this._startIndex+=N,this._length-=N,this.onTrimEmitter.fire(N)}shiftElements(N,j,X){if(!(j<=0)){if(N<0||N>=this._length)throw new Error("start argument out of range");if(N+X<0)throw new Error("Cannot shift elements in list beyond index 0");if(X>0){for(let ie=j-1;ie>=0;ie--)this.set(N+ie+X,this.get(N+ie));const ie=N+j+X-this._length;if(ie>0)for(this._length+=ie;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let ie=0;ie<j;ie++)this.set(N+ie+X,this.get(N+ie))}}_getCyclicIndex(N){return(this._startIndex+N)%this._maxLength}}j.CircularList=n},7453:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.clone=function e(N,j=5){if("object"!=typeof N)return N;const X=Array.isArray(N)?[]:{};for(const ie in N)X[ie]=j<=1?N[ie]:N[ie]&&e(N[ie],j-1);return X}},4103:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.rgba=j.rgb=j.css=j.color=j.channels=j.NULL_COLOR=void 0,j.toPaddedHex=d,j.contrastRatio=u;let X=0,ie=0,se=0,le=0;var he,ce,_e,me,ve;function d(N){const j=N.toString(16);return j.length<2?"0"+j:j}function u(N,j){return N<j?(j+.05)/(N+.05):(N+.05)/(j+.05)}j.NULL_COLOR={css:"#00000000",rgba:0},function(N){N.toCss=function(N,j,X,ie){return void 0!==ie?`#${d(N)}${d(j)}${d(X)}${d(ie)}`:`#${d(N)}${d(j)}${d(X)}`},N.toRgba=function(N,j,X,ie=255){return(N<<24|j<<16|X<<8|ie)>>>0},N.toColor=function(j,X,ie,se){return{css:N.toCss(j,X,ie,se),rgba:N.toRgba(j,X,ie,se)}}}(he||(j.channels=he={})),function(N){function t(N,j){return le=Math.round(255*j),[X,ie,se]=ve.toChannels(N.rgba),{css:he.toCss(X,ie,se,le),rgba:he.toRgba(X,ie,se,le)}}N.blend=function(N,j){if(le=(255&j.rgba)/255,1===le)return{css:j.css,rgba:j.rgba};const ce=j.rgba>>24&255,_e=j.rgba>>16&255,me=j.rgba>>8&255,ve=N.rgba>>24&255,Se=N.rgba>>16&255,be=N.rgba>>8&255;return X=ve+Math.round((ce-ve)*le),ie=Se+Math.round((_e-Se)*le),se=be+Math.round((me-be)*le),{css:he.toCss(X,ie,se),rgba:he.toRgba(X,ie,se)}},N.isOpaque=function(N){return!(255&~N.rgba)},N.ensureContrastRatio=function(N,j,X){const ie=ve.ensureContrastRatio(N.rgba,j.rgba,X);if(ie)return he.toColor(ie>>24&255,ie>>16&255,ie>>8&255)},N.opaque=function(N){const j=(255|N.rgba)>>>0;return[X,ie,se]=ve.toChannels(j),{css:he.toCss(X,ie,se),rgba:j}},N.opacity=t,N.multiplyOpacity=function(N,j){return le=255&N.rgba,t(N,le*j/255)},N.toColorRGB=function(N){return[N.rgba>>24&255,N.rgba>>16&255,N.rgba>>8&255]}}(ce||(j.color=ce={})),function(N){let j,ce;try{const N=document.createElement("canvas");N.width=1,N.height=1;const X=N.getContext("2d",{willReadFrequently:!0});X&&(j=X,j.globalCompositeOperation="copy",ce=j.createLinearGradient(0,0,1,1))}catch{}N.toColor=function(N){if(N.match(/#[\da-f]{3,8}/i))switch(N.length){case 4:return X=parseInt(N.slice(1,2).repeat(2),16),ie=parseInt(N.slice(2,3).repeat(2),16),se=parseInt(N.slice(3,4).repeat(2),16),he.toColor(X,ie,se);case 5:return X=parseInt(N.slice(1,2).repeat(2),16),ie=parseInt(N.slice(2,3).repeat(2),16),se=parseInt(N.slice(3,4).repeat(2),16),le=parseInt(N.slice(4,5).repeat(2),16),he.toColor(X,ie,se,le);case 7:return{css:N,rgba:(parseInt(N.slice(1),16)<<8|255)>>>0};case 9:return{css:N,rgba:parseInt(N.slice(1),16)>>>0}}const _e=N.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(_e)return X=parseInt(_e[1]),ie=parseInt(_e[2]),se=parseInt(_e[3]),le=Math.round(255*(void 0===_e[5]?1:parseFloat(_e[5]))),he.toColor(X,ie,se,le);if(!j||!ce)throw new Error("css.toColor: Unsupported css format");if(j.fillStyle=ce,j.fillStyle=N,"string"!=typeof j.fillStyle)throw new Error("css.toColor: Unsupported css format");if(j.fillRect(0,0,1,1),[X,ie,se,le]=j.getImageData(0,0,1,1).data,255!==le)throw new Error("css.toColor: Unsupported css format");return{rgba:he.toRgba(X,ie,se,le),css:N}}}(_e||(j.css=_e={})),function(N){function t(N,j,X){const ie=N/255,se=j/255,le=X/255;return.2126*(ie<=.03928?ie/12.92:Math.pow((ie+.055)/1.055,2.4))+.7152*(se<=.03928?se/12.92:Math.pow((se+.055)/1.055,2.4))+.0722*(le<=.03928?le/12.92:Math.pow((le+.055)/1.055,2.4))}N.relativeLuminance=function(N){return t(N>>16&255,N>>8&255,255&N)},N.relativeLuminance2=t}(me||(j.rgb=me={})),function(N){function t(N,j,X){const ie=N>>24&255,se=N>>16&255,le=N>>8&255;let he=j>>24&255,ce=j>>16&255,_e=j>>8&255,ve=u(me.relativeLuminance2(he,ce,_e),me.relativeLuminance2(ie,se,le));for(;ve<X&&(he>0||ce>0||_e>0);)he-=Math.max(0,Math.ceil(.1*he)),ce-=Math.max(0,Math.ceil(.1*ce)),_e-=Math.max(0,Math.ceil(.1*_e)),ve=u(me.relativeLuminance2(he,ce,_e),me.relativeLuminance2(ie,se,le));return(he<<24|ce<<16|_e<<8|255)>>>0}function a(N,j,X){const ie=N>>24&255,se=N>>16&255,le=N>>8&255;let he=j>>24&255,ce=j>>16&255,_e=j>>8&255,ve=u(me.relativeLuminance2(he,ce,_e),me.relativeLuminance2(ie,se,le));for(;ve<X&&(he<255||ce<255||_e<255);)he=Math.min(255,he+Math.ceil(.1*(255-he))),ce=Math.min(255,ce+Math.ceil(.1*(255-ce))),_e=Math.min(255,_e+Math.ceil(.1*(255-_e))),ve=u(me.relativeLuminance2(he,ce,_e),me.relativeLuminance2(ie,se,le));return(he<<24|ce<<16|_e<<8|255)>>>0}N.blend=function(N,j){if(le=(255&j)/255,1===le)return j;const ce=j>>24&255,_e=j>>16&255,me=j>>8&255,ve=N>>24&255,Se=N>>16&255,be=N>>8&255;return X=ve+Math.round((ce-ve)*le),ie=Se+Math.round((_e-Se)*le),se=be+Math.round((me-be)*le),he.toRgba(X,ie,se)},N.ensureContrastRatio=function(N,j,X){const ie=me.relativeLuminance(N>>8),se=me.relativeLuminance(j>>8);if(u(ie,se)<X){if(se<ie){const se=t(N,j,X),le=u(ie,me.relativeLuminance(se>>8));if(le<X){const he=a(N,j,X);return le>u(ie,me.relativeLuminance(he>>8))?se:he}return se}const le=a(N,j,X),he=u(ie,me.relativeLuminance(le>>8));if(he<X){const se=t(N,j,X);return he>u(ie,me.relativeLuminance(se>>8))?le:se}return le}},N.reduceLuminance=t,N.increaseLuminance=a,N.toChannels=function(N){return[N>>24&255,N>>16&255,N>>8&255,255&N]}}(ve||(j.rgba=ve={}))},5777:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CoreTerminal=void 0;const ie=X(6501),se=X(6025),le=X(7276),he=X(9640),ce=X(56),_e=X(4071),me=X(7792),ve=X(6415),Se=X(5746),be=X(5882),Ce=X(2486),ye=X(3562),we=X(8811),Ee=X(802),De=X(7150);let Le=!1;class S extends De.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new Ee.Emitter),this._onScroll.event((N=>{this._onScrollApi?.fire(N.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(N){for(const j in N)this.optionsService.options[j]=N[j]}constructor(N){super(),this._windowsWrappingHeuristics=this._register(new De.MutableDisposable),this._onBinary=this._register(new Ee.Emitter),this.onBinary=this._onBinary.event,this._onData=this._register(new Ee.Emitter),this.onData=this._onData.event,this._onLineFeed=this._register(new Ee.Emitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new Ee.Emitter),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new Ee.Emitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new Ee.Emitter),this._instantiationService=new se.InstantiationService,this.optionsService=this._register(new ce.OptionsService(N)),this._instantiationService.setService(ie.IOptionsService,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(he.BufferService)),this._instantiationService.setService(ie.IBufferService,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(le.LogService)),this._instantiationService.setService(ie.ILogService,this._logService),this.coreService=this._register(this._instantiationService.createInstance(_e.CoreService)),this._instantiationService.setService(ie.ICoreService,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(me.CoreMouseService)),this._instantiationService.setService(ie.ICoreMouseService,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(ve.UnicodeService)),this._instantiationService.setService(ie.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(Se.CharsetService),this._instantiationService.setService(ie.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(we.OscLinkService),this._instantiationService.setService(ie.IOscLinkService,this._oscLinkService),this._inputHandler=this._register(new Ce.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(Ee.Event.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(Ee.Event.forward(this._bufferService.onResize,this._onResize)),this._register(Ee.Event.forward(this.coreService.onData,this._onData)),this._register(Ee.Event.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom(!0)))),this._register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this._register(this._bufferService.onScroll((()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this._register(new ye.WriteBuffer(((N,j)=>this._inputHandler.parse(N,j)))),this._register(Ee.Event.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(N,j){this._writeBuffer.write(N,j)}writeSync(N,j){this._logService.logLevel<=ie.LogLevelEnum.WARN&&!Le&&(this._logService.warn("writeSync is unreliable and will be removed soon."),Le=!0),this._writeBuffer.writeSync(N,j)}input(N,j=!0){this.coreService.triggerDataEvent(N,j)}resize(N,j){isNaN(N)||isNaN(j)||(N=Math.max(N,he.MINIMUM_COLS),j=Math.max(j,he.MINIMUM_ROWS),this._bufferService.resize(N,j))}scroll(N,j=!1){this._bufferService.scroll(N,j)}scrollLines(N,j){this._bufferService.scrollLines(N,j)}scrollPages(N){this.scrollLines(N*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(N){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(N){const j=N-this._bufferService.buffer.ydisp;0!==j&&this.scrollLines(j)}registerEscHandler(N,j){return this._inputHandler.registerEscHandler(N,j)}registerDcsHandler(N,j){return this._inputHandler.registerDcsHandler(N,j)}registerCsiHandler(N,j){return this._inputHandler.registerCsiHandler(N,j)}registerOscHandler(N,j){return this._inputHandler.registerOscHandler(N,j)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let N=!1;const j=this.optionsService.rawOptions.windowsPty;j&&void 0!==j.buildNumber&&void 0!==j.buildNumber?N=!!("conpty"===j.backend&&j.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(N=!0),N?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const N=[];N.push(this.onLineFeed(be.updateWindowsModeWrappedState.bind(null,this._bufferService))),N.push(this.registerCsiHandler({final:"H"},(()=>((0,be.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics.value=(0,De.toDisposable)((()=>{for(const j of N)j.dispose()}))}}}j.CoreTerminal=S},2486:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.InputHandler=j.WindowsOptionsReportType=void 0,j.isValidColorIndex=A;const le=X(3534),he=X(6760),ce=X(6717),_e=X(7150),me=X(726),ve=X(6107),Se=X(8938),be=X(3055),Ce=X(5451),ye=X(6501),we=X(6415),Ee=X(1346),De=X(9823),Le=X(8693),Ae=X(802),Re={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Te=131072;function y(N,j){if(N>24)return j.setWinLines||!1;switch(N){case 1:return!!j.restoreWin;case 2:return!!j.minimizeWin;case 3:return!!j.setWinPosition;case 4:return!!j.setWinSizePixels;case 5:return!!j.raiseWin;case 6:return!!j.lowerWin;case 7:return!!j.refreshWin;case 8:return!!j.setWinSizeChars;case 9:return!!j.maximizeWin;case 10:return!!j.fullscreenWin;case 11:return!!j.getWinState;case 13:return!!j.getWinPosition;case 14:return!!j.getWinSizePixels;case 15:return!!j.getScreenSizePixels;case 16:return!!j.getCellSizePixels;case 18:return!!j.getWinSizeChars;case 19:return!!j.getScreenSizeChars;case 20:return!!j.getIconTitle;case 21:return!!j.getWinTitle;case 22:return!!j.pushTitle;case 23:return!!j.popTitle;case 24:return!!j.setWinLines}return!1}var ke;!function(N){N[N.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",N[N.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(ke||(j.WindowsOptionsReportType=ke={}));let Me=0;class D extends _e.Disposable{getAttrData(){return this._curAttrData}constructor(N,j,X,ie,se,_e,Se,be,Ce=new ce.EscapeSequenceParser){super(),this._bufferService=N,this._charsetService=j,this._coreService=X,this._logService=ie,this._optionsService=se,this._oscLinkService=_e,this._coreMouseService=Se,this._unicodeService=be,this._parser=Ce,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new me.StringToUtf32,this._utf8Decoder=new me.Utf8ToUtf32,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=ve.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=ve.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this._register(new Ae.Emitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new Ae.Emitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new Ae.Emitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new Ae.Emitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new Ae.Emitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new Ae.Emitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new Ae.Emitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new Ae.Emitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new Ae.Emitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new Ae.Emitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new Ae.Emitter),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new Ae.Emitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new Ae.Emitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new Oe(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate((N=>this._activeBuffer=N.activeBuffer))),this._parser.setCsiHandlerFallback(((N,j)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(N),params:j.toArray()})})),this._parser.setEscHandlerFallback((N=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(N)})})),this._parser.setExecuteHandlerFallback((N=>{this._logService.debug("Unknown EXECUTE code: ",{code:N})})),this._parser.setOscHandlerFallback(((N,j,X)=>{this._logService.debug("Unknown OSC code: ",{identifier:N,action:j,data:X})})),this._parser.setDcsHandlerFallback(((N,j,X)=>{"HOOK"===j&&(X=X.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(N),action:j,payload:X})})),this._parser.setPrintHandler(((N,j,X)=>this.print(N,j,X))),this._parser.registerCsiHandler({final:"@"},(N=>this.insertChars(N))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(N=>this.scrollLeft(N))),this._parser.registerCsiHandler({final:"A"},(N=>this.cursorUp(N))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(N=>this.scrollRight(N))),this._parser.registerCsiHandler({final:"B"},(N=>this.cursorDown(N))),this._parser.registerCsiHandler({final:"C"},(N=>this.cursorForward(N))),this._parser.registerCsiHandler({final:"D"},(N=>this.cursorBackward(N))),this._parser.registerCsiHandler({final:"E"},(N=>this.cursorNextLine(N))),this._parser.registerCsiHandler({final:"F"},(N=>this.cursorPrecedingLine(N))),this._parser.registerCsiHandler({final:"G"},(N=>this.cursorCharAbsolute(N))),this._parser.registerCsiHandler({final:"H"},(N=>this.cursorPosition(N))),this._parser.registerCsiHandler({final:"I"},(N=>this.cursorForwardTab(N))),this._parser.registerCsiHandler({final:"J"},(N=>this.eraseInDisplay(N,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(N=>this.eraseInDisplay(N,!0))),this._parser.registerCsiHandler({final:"K"},(N=>this.eraseInLine(N,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(N=>this.eraseInLine(N,!0))),this._parser.registerCsiHandler({final:"L"},(N=>this.insertLines(N))),this._parser.registerCsiHandler({final:"M"},(N=>this.deleteLines(N))),this._parser.registerCsiHandler({final:"P"},(N=>this.deleteChars(N))),this._parser.registerCsiHandler({final:"S"},(N=>this.scrollUp(N))),this._parser.registerCsiHandler({final:"T"},(N=>this.scrollDown(N))),this._parser.registerCsiHandler({final:"X"},(N=>this.eraseChars(N))),this._parser.registerCsiHandler({final:"Z"},(N=>this.cursorBackwardTab(N))),this._parser.registerCsiHandler({final:"`"},(N=>this.charPosAbsolute(N))),this._parser.registerCsiHandler({final:"a"},(N=>this.hPositionRelative(N))),this._parser.registerCsiHandler({final:"b"},(N=>this.repeatPrecedingCharacter(N))),this._parser.registerCsiHandler({final:"c"},(N=>this.sendDeviceAttributesPrimary(N))),this._parser.registerCsiHandler({prefix:">",final:"c"},(N=>this.sendDeviceAttributesSecondary(N))),this._parser.registerCsiHandler({final:"d"},(N=>this.linePosAbsolute(N))),this._parser.registerCsiHandler({final:"e"},(N=>this.vPositionRelative(N))),this._parser.registerCsiHandler({final:"f"},(N=>this.hVPosition(N))),this._parser.registerCsiHandler({final:"g"},(N=>this.tabClear(N))),this._parser.registerCsiHandler({final:"h"},(N=>this.setMode(N))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(N=>this.setModePrivate(N))),this._parser.registerCsiHandler({final:"l"},(N=>this.resetMode(N))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(N=>this.resetModePrivate(N))),this._parser.registerCsiHandler({final:"m"},(N=>this.charAttributes(N))),this._parser.registerCsiHandler({final:"n"},(N=>this.deviceStatus(N))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(N=>this.deviceStatusPrivate(N))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(N=>this.softReset(N))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(N=>this.setCursorStyle(N))),this._parser.registerCsiHandler({final:"r"},(N=>this.setScrollRegion(N))),this._parser.registerCsiHandler({final:"s"},(N=>this.saveCursor(N))),this._parser.registerCsiHandler({final:"t"},(N=>this.windowOptions(N))),this._parser.registerCsiHandler({final:"u"},(N=>this.restoreCursor(N))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(N=>this.insertColumns(N))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(N=>this.deleteColumns(N))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(N=>this.selectProtected(N))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(N=>this.requestMode(N,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(N=>this.requestMode(N,!1))),this._parser.setExecuteHandler(le.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(le.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(le.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(le.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(le.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(le.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(le.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(le.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(le.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(le.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(le.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(le.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new Ee.OscHandler((N=>(this.setTitle(N),this.setIconName(N),!0)))),this._parser.registerOscHandler(1,new Ee.OscHandler((N=>this.setIconName(N)))),this._parser.registerOscHandler(2,new Ee.OscHandler((N=>this.setTitle(N)))),this._parser.registerOscHandler(4,new Ee.OscHandler((N=>this.setOrReportIndexedColor(N)))),this._parser.registerOscHandler(8,new Ee.OscHandler((N=>this.setHyperlink(N)))),this._parser.registerOscHandler(10,new Ee.OscHandler((N=>this.setOrReportFgColor(N)))),this._parser.registerOscHandler(11,new Ee.OscHandler((N=>this.setOrReportBgColor(N)))),this._parser.registerOscHandler(12,new Ee.OscHandler((N=>this.setOrReportCursorColor(N)))),this._parser.registerOscHandler(104,new Ee.OscHandler((N=>this.restoreIndexedColor(N)))),this._parser.registerOscHandler(110,new Ee.OscHandler((N=>this.restoreFgColor(N)))),this._parser.registerOscHandler(111,new Ee.OscHandler((N=>this.restoreBgColor(N)))),this._parser.registerOscHandler(112,new Ee.OscHandler((N=>this.restoreCursorColor(N)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const N in he.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:N},(()=>this.selectCharset("("+N))),this._parser.registerEscHandler({intermediates:")",final:N},(()=>this.selectCharset(")"+N))),this._parser.registerEscHandler({intermediates:"*",final:N},(()=>this.selectCharset("*"+N))),this._parser.registerEscHandler({intermediates:"+",final:N},(()=>this.selectCharset("+"+N))),this._parser.registerEscHandler({intermediates:"-",final:N},(()=>this.selectCharset("-"+N))),this._parser.registerEscHandler({intermediates:".",final:N},(()=>this.selectCharset("."+N))),this._parser.registerEscHandler({intermediates:"/",final:N},(()=>this.selectCharset("/"+N)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((N=>(this._logService.error("Parsing error: ",N),N))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new De.DcsHandler(((N,j)=>this.requestStatusString(N,j))))}_preserveStack(N,j,X,ie){this._parseStack.paused=!0,this._parseStack.cursorStartX=N,this._parseStack.cursorStartY=j,this._parseStack.decodedLength=X,this._parseStack.position=ie}_logSlowResolvingAsync(N){this._logService.logLevel<=ye.LogLevelEnum.WARN&&Promise.race([N,new Promise(((N,j)=>setTimeout((()=>j("#SLOW_TIMEOUT")),5e3)))]).catch((N=>{if("#SLOW_TIMEOUT"!==N)throw N;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(N,j){let X,ie=this._activeBuffer.x,se=this._activeBuffer.y,le=0;const he=this._parseStack.paused;if(he){if(X=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,j))return this._logSlowResolvingAsync(X),X;ie=this._parseStack.cursorStartX,se=this._parseStack.cursorStartY,this._parseStack.paused=!1,N.length>Te&&(le=this._parseStack.position+Te)}if(this._logService.logLevel<=ye.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof N?` "${N}"`:` "${Array.prototype.map.call(N,(N=>String.fromCharCode(N))).join("")}"`),"string"==typeof N?N.split("").map((N=>N.charCodeAt(0))):N),this._parseBuffer.length<N.length&&this._parseBuffer.length<Te&&(this._parseBuffer=new Uint32Array(Math.min(N.length,Te))),he||this._dirtyRowTracker.clearRange(),N.length>Te)for(let j=le;j<N.length;j+=Te){const le=j+Te<N.length?j+Te:N.length,he="string"==typeof N?this._stringDecoder.decode(N.substring(j,le),this._parseBuffer):this._utf8Decoder.decode(N.subarray(j,le),this._parseBuffer);if(X=this._parser.parse(this._parseBuffer,he))return this._preserveStack(ie,se,he,j),this._logSlowResolvingAsync(X),X}else if(!he){const j="string"==typeof N?this._stringDecoder.decode(N,this._parseBuffer):this._utf8Decoder.decode(N,this._parseBuffer);if(X=this._parser.parse(this._parseBuffer,j))return this._preserveStack(ie,se,j,0),this._logSlowResolvingAsync(X),X}this._activeBuffer.x===ie&&this._activeBuffer.y===se||this._onCursorMove.fire();const ce=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),_e=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);_e<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(_e,this._bufferService.rows-1),end:Math.min(ce,this._bufferService.rows-1)})}print(N,j,X){let ie,se;const le=this._charsetService.charset,he=this._optionsService.rawOptions.screenReaderMode,ce=this._bufferService.cols,_e=this._coreService.decPrivateModes.wraparound,be=this._coreService.modes.insertMode,Ce=this._curAttrData;let ye=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&X-j>0&&2===ye.getWidth(this._activeBuffer.x-1)&&ye.setCellFromCodepoint(this._activeBuffer.x-1,0,1,Ce);let Ee=this._parser.precedingJoinState;for(let De=j;De<X;++De){if(ie=N[De],ie<127&&le){const N=le[String.fromCharCode(ie)];N&&(ie=N.charCodeAt(0))}const j=this._unicodeService.charProperties(ie,Ee);se=we.UnicodeService.extractWidth(j);const X=we.UnicodeService.extractShouldJoin(j),Le=X?we.UnicodeService.extractWidth(Ee):0;if(Ee=j,he&&this._onA11yChar.fire((0,me.stringFromCodePoint)(ie)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+se-Le>ce)if(_e){const N=ye;let j=this._activeBuffer.x-Le;for(this._activeBuffer.x=Le,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),ye=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),Le>0&&ye instanceof ve.BufferLine&&ye.copyCellsFrom(N,j,0,Le,!1);j<ce;)N.setCellFromCodepoint(j++,0,1,Ce)}else if(this._activeBuffer.x=ce-1,2===se)continue;if(X&&this._activeBuffer.x){const N=ye.getWidth(this._activeBuffer.x-1)?1:2;ye.addCodepointToCell(this._activeBuffer.x-N,ie,se);for(let N=se-Le;--N>=0;)ye.setCellFromCodepoint(this._activeBuffer.x++,0,0,Ce)}else if(be&&(ye.insertCells(this._activeBuffer.x,se-Le,this._activeBuffer.getNullCell(Ce)),2===ye.getWidth(ce-1)&&ye.setCellFromCodepoint(ce-1,Se.NULL_CELL_CODE,Se.NULL_CELL_WIDTH,Ce)),ye.setCellFromCodepoint(this._activeBuffer.x++,ie,se,Ce),se>0)for(;--se;)ye.setCellFromCodepoint(this._activeBuffer.x++,0,0,Ce)}this._parser.precedingJoinState=Ee,this._activeBuffer.x<ce&&X-j>0&&0===ye.getWidth(this._activeBuffer.x)&&!ye.hasContent(this._activeBuffer.x)&&ye.setCellFromCodepoint(this._activeBuffer.x,0,1,Ce),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(N,j){return"t"!==N.final||N.prefix||N.intermediates?this._parser.registerCsiHandler(N,j):this._parser.registerCsiHandler(N,(N=>!y(N.params[0],this._optionsService.rawOptions.windowOptions)||j(N)))}registerDcsHandler(N,j){return this._parser.registerDcsHandler(N,new De.DcsHandler(j))}registerEscHandler(N,j){return this._parser.registerEscHandler(N,j)}registerOscHandler(N,j){return this._parser.registerOscHandler(N,new Ee.OscHandler(j))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);N.hasWidth(this._activeBuffer.x)&&!N.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const N=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-N),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(N=this._bufferService.cols-1){this._activeBuffer.x=Math.min(N,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(N,j){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=N,this._activeBuffer.y=this._activeBuffer.scrollTop+j):(this._activeBuffer.x=N,this._activeBuffer.y=j),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(N,j){this._restrictCursor(),this._setCursor(this._activeBuffer.x+N,this._activeBuffer.y+j)}cursorUp(N){const j=this._activeBuffer.y-this._activeBuffer.scrollTop;return j>=0?this._moveCursor(0,-Math.min(j,N.params[0]||1)):this._moveCursor(0,-(N.params[0]||1)),!0}cursorDown(N){const j=this._activeBuffer.scrollBottom-this._activeBuffer.y;return j>=0?this._moveCursor(0,Math.min(j,N.params[0]||1)):this._moveCursor(0,N.params[0]||1),!0}cursorForward(N){return this._moveCursor(N.params[0]||1,0),!0}cursorBackward(N){return this._moveCursor(-(N.params[0]||1),0),!0}cursorNextLine(N){return this.cursorDown(N),this._activeBuffer.x=0,!0}cursorPrecedingLine(N){return this.cursorUp(N),this._activeBuffer.x=0,!0}cursorCharAbsolute(N){return this._setCursor((N.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(N){return this._setCursor(N.length>=2?(N.params[1]||1)-1:0,(N.params[0]||1)-1),!0}charPosAbsolute(N){return this._setCursor((N.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(N){return this._moveCursor(N.params[0]||1,0),!0}linePosAbsolute(N){return this._setCursor(this._activeBuffer.x,(N.params[0]||1)-1),!0}vPositionRelative(N){return this._moveCursor(0,N.params[0]||1),!0}hVPosition(N){return this.cursorPosition(N),!0}tabClear(N){const j=N.params[0];return 0===j?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===j&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(N){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let j=N.params[0]||1;for(;j--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(N){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let j=N.params[0]||1;for(;j--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(N){const j=N.params[0];return 1===j&&(this._curAttrData.bg|=536870912),2!==j&&0!==j||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(N,j,X,ie=!1,se=!1){const le=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);le.replaceCells(j,X,this._activeBuffer.getNullCell(this._eraseAttrData()),se),ie&&(le.isWrapped=!1)}_resetBufferLine(N,j=!1){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);X&&(X.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),j),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+N),X.isWrapped=!1)}eraseInDisplay(N,j=!1){let X;switch(this._restrictCursor(this._bufferService.cols),N.params[0]){case 0:for(X=this._activeBuffer.y,this._dirtyRowTracker.markDirty(X),this._eraseInBufferLine(X++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,j);X<this._bufferService.rows;X++)this._resetBufferLine(X,j);this._dirtyRowTracker.markDirty(X);break;case 1:for(X=this._activeBuffer.y,this._dirtyRowTracker.markDirty(X),this._eraseInBufferLine(X,0,this._activeBuffer.x+1,!0,j),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(X+1).isWrapped=!1);X--;)this._resetBufferLine(X,j);this._dirtyRowTracker.markDirty(0);break;case 2:for(X=this._bufferService.rows,this._dirtyRowTracker.markDirty(X-1);X--;)this._resetBufferLine(X,j);this._dirtyRowTracker.markDirty(0);break;case 3:const N=this._activeBuffer.lines.length-this._bufferService.rows;N>0&&(this._activeBuffer.lines.trimStart(N),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-N,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-N,0),this._onScroll.fire(0))}return!0}eraseInLine(N,j=!1){switch(this._restrictCursor(this._bufferService.cols),N.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,j);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,j);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,j)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(N){this._restrictCursor();let j=N.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const X=this._activeBuffer.ybase+this._activeBuffer.y,ie=this._bufferService.rows-1-this._activeBuffer.scrollBottom,se=this._bufferService.rows-1+this._activeBuffer.ybase-ie+1;for(;j--;)this._activeBuffer.lines.splice(se-1,1),this._activeBuffer.lines.splice(X,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(N){this._restrictCursor();let j=N.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const X=this._activeBuffer.ybase+this._activeBuffer.y;let ie;for(ie=this._bufferService.rows-1-this._activeBuffer.scrollBottom,ie=this._bufferService.rows-1+this._activeBuffer.ybase-ie;j--;)this._activeBuffer.lines.splice(X,1),this._activeBuffer.lines.splice(ie,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(N){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.insertCells(this._activeBuffer.x,N.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(N){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.deleteCells(this._activeBuffer.x,N.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(N){let j=N.params[0]||1;for(;j--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(N){let j=N.params[0]||1;for(;j--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(ve.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=N.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);X.deleteCells(0,j,this._activeBuffer.getNullCell(this._eraseAttrData())),X.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=N.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);X.insertCells(0,j,this._activeBuffer.getNullCell(this._eraseAttrData())),X.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=N.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);X.insertCells(this._activeBuffer.x,j,this._activeBuffer.getNullCell(this._eraseAttrData())),X.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=N.params[0]||1;for(let N=this._activeBuffer.scrollTop;N<=this._activeBuffer.scrollBottom;++N){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);X.deleteCells(this._activeBuffer.x,j,this._activeBuffer.getNullCell(this._eraseAttrData())),X.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(N){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(N.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(N){const j=this._parser.precedingJoinState;if(!j)return!0;const X=N.params[0]||1,ie=we.UnicodeService.extractWidth(j),se=this._activeBuffer.x-ie,le=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(se),he=new Uint32Array(le.length*X);let ce=0;for(let N=0;N<le.length;){const j=le.codePointAt(N)||0;he[ce++]=j,N+=j>65535?2:1}let _e=ce;for(let N=1;N<X;++N)he.copyWithin(_e,0,ce),_e+=ce;return this.print(he,0,_e),!0}sendDeviceAttributesPrimary(N){return N.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(le.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(le.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(N){return N.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(le.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(le.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(N.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(le.C0.ESC+"[>83;40003;0c")),!0}_is(N){return 0===(this._optionsService.rawOptions.termName+"").indexOf(N)}setMode(N){for(let j=0;j<N.length;j++)switch(N.params[j]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(N){for(let j=0;j<N.length;j++)switch(N.params[j]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,he.DEFAULT_CHARSET),this._charsetService.setgCharset(1,he.DEFAULT_CHARSET),this._charsetService.setgCharset(2,he.DEFAULT_CHARSET),this._charsetService.setgCharset(3,he.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(N){for(let j=0;j<N.length;j++)switch(N.params[j]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(N){for(let j=0;j<N.length;j++)switch(N.params[j]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===N.params[j]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(N,j){const X=this._coreService.decPrivateModes,{activeProtocol:ie,activeEncoding:se}=this._coreMouseService,he=this._coreService,{buffers:ce,cols:_e}=this._bufferService,{active:me,alt:ve}=ce,Se=this._optionsService.rawOptions,u=N=>N?1:2,be=N.params[0];return Ce=be,ye=j?2===be?4:4===be?u(he.modes.insertMode):12===be?3:20===be?u(Se.convertEol):0:1===be?u(X.applicationCursorKeys):3===be?Se.windowOptions.setWinLines?80===_e?2:132===_e?1:0:0:6===be?u(X.origin):7===be?u(X.wraparound):8===be?3:9===be?u("X10"===ie):12===be?u(Se.cursorBlink):25===be?u(!he.isCursorHidden):45===be?u(X.reverseWraparound):66===be?u(X.applicationKeypad):67===be?4:1e3===be?u("VT200"===ie):1002===be?u("DRAG"===ie):1003===be?u("ANY"===ie):1004===be?u(X.sendFocus):1005===be?4:1006===be?u("SGR"===se):1015===be?4:1016===be?u("SGR_PIXELS"===se):1048===be?1:47===be||1047===be||1049===be?u(me===ve):2004===be?u(X.bracketedPasteMode):0,he.triggerDataEvent(`${le.C0.ESC}[${j?"":"?"}${Ce};${ye}$y`),!0;var Ce,ye}_updateAttrColor(N,j,X,ie,se){return 2===j?(N|=50331648,N&=-16777216,N|=Ce.AttributeData.fromColorRGB([X,ie,se])):5===j&&(N&=-50331904,N|=33554432|255&X),N}_extractColor(N,j,X){const ie=[0,0,-1,0,0,0];let se=0,le=0;do{if(ie[le+se]=N.params[j+le],N.hasSubParams(j+le)){const X=N.getSubParams(j+le);let he=0;do{5===ie[1]&&(se=1),ie[le+he+1+se]=X[he]}while(++he<X.length&&he+le+1+se<ie.length);break}if(5===ie[1]&&le+se>=2||2===ie[1]&&le+se>=5)break;ie[1]&&(se=1)}while(++le+j<N.length&&le+se<ie.length);for(let N=2;N<ie.length;++N)-1===ie[N]&&(ie[N]=0);switch(ie[0]){case 38:X.fg=this._updateAttrColor(X.fg,ie[1],ie[3],ie[4],ie[5]);break;case 48:X.bg=this._updateAttrColor(X.bg,ie[1],ie[3],ie[4],ie[5]);break;case 58:X.extended=X.extended.clone(),X.extended.underlineColor=this._updateAttrColor(X.extended.underlineColor,ie[1],ie[3],ie[4],ie[5])}return le}_processUnderline(N,j){j.extended=j.extended.clone(),(!~N||N>5)&&(N=1),j.extended.underlineStyle=N,j.fg|=268435456,0===N&&(j.fg&=-268435457),j.updateExtended()}_processSGR0(N){N.fg=ve.DEFAULT_ATTR_DATA.fg,N.bg=ve.DEFAULT_ATTR_DATA.bg,N.extended=N.extended.clone(),N.extended.underlineStyle=0,N.extended.underlineColor&=-67108864,N.updateExtended()}charAttributes(N){if(1===N.length&&0===N.params[0])return this._processSGR0(this._curAttrData),!0;const j=N.length;let X;const ie=this._curAttrData;for(let se=0;se<j;se++)X=N.params[se],X>=30&&X<=37?(ie.fg&=-50331904,ie.fg|=16777216|X-30):X>=40&&X<=47?(ie.bg&=-50331904,ie.bg|=16777216|X-40):X>=90&&X<=97?(ie.fg&=-50331904,ie.fg|=16777224|X-90):X>=100&&X<=107?(ie.bg&=-50331904,ie.bg|=16777224|X-100):0===X?this._processSGR0(ie):1===X?ie.fg|=134217728:3===X?ie.bg|=67108864:4===X?(ie.fg|=268435456,this._processUnderline(N.hasSubParams(se)?N.getSubParams(se)[0]:1,ie)):5===X?ie.fg|=536870912:7===X?ie.fg|=67108864:8===X?ie.fg|=1073741824:9===X?ie.fg|=2147483648:2===X?ie.bg|=134217728:21===X?this._processUnderline(2,ie):22===X?(ie.fg&=-134217729,ie.bg&=-134217729):23===X?ie.bg&=-67108865:24===X?(ie.fg&=-268435457,this._processUnderline(0,ie)):25===X?ie.fg&=-536870913:27===X?ie.fg&=-67108865:28===X?ie.fg&=-1073741825:29===X?ie.fg&=2147483647:39===X?(ie.fg&=-67108864,ie.fg|=16777215&ve.DEFAULT_ATTR_DATA.fg):49===X?(ie.bg&=-67108864,ie.bg|=16777215&ve.DEFAULT_ATTR_DATA.bg):38===X||48===X||58===X?se+=this._extractColor(N,se,ie):53===X?ie.bg|=1073741824:55===X?ie.bg&=-1073741825:59===X?(ie.extended=ie.extended.clone(),ie.extended.underlineColor=-1,ie.updateExtended()):100===X?(ie.fg&=-67108864,ie.fg|=16777215&ve.DEFAULT_ATTR_DATA.fg,ie.bg&=-67108864,ie.bg|=16777215&ve.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",X);return!0}deviceStatus(N){switch(N.params[0]){case 5:this._coreService.triggerDataEvent(`${le.C0.ESC}[0n`);break;case 6:const N=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${le.C0.ESC}[${N};${j}R`)}return!0}deviceStatusPrivate(N){if(6===N.params[0]){const N=this._activeBuffer.y+1,j=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${le.C0.ESC}[?${N};${j}R`)}return!0}softReset(N){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=ve.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(N){const j=N.params[0]||1;switch(j){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const X=j%2==1;return this._optionsService.options.cursorBlink=X,!0}setScrollRegion(N){const j=N.params[0]||1;let X;return(N.length<2||(X=N.params[1])>this._bufferService.rows||0===X)&&(X=this._bufferService.rows),X>j&&(this._activeBuffer.scrollTop=j-1,this._activeBuffer.scrollBottom=X-1,this._setCursor(0,0)),!0}windowOptions(N){if(!y(N.params[0],this._optionsService.rawOptions.windowOptions))return!0;const j=N.length>1?N.params[1]:0;switch(N.params[0]){case 14:2!==j&&this._onRequestWindowsOptionsReport.fire(ke.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(ke.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${le.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:0!==j&&2!==j||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==j&&1!==j||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==j&&2!==j||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==j&&1!==j||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(N){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(N){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(N){return this._windowTitle=N,this._onTitleChange.fire(N),!0}setIconName(N){return this._iconName=N,!0}setOrReportIndexedColor(N){const j=[],X=N.split(";");for(;X.length>1;){const N=X.shift(),ie=X.shift();if(/^\d+$/.exec(N)){const X=parseInt(N);if(A(X))if("?"===ie)j.push({type:0,index:X});else{const N=(0,Le.parseColor)(ie);N&&j.push({type:1,index:X,color:N})}}}return j.length&&this._onColor.fire(j),!0}setHyperlink(N){const j=N.indexOf(";");if(-1===j)return!0;const X=N.slice(0,j).trim(),ie=N.slice(j+1);return ie?this._createHyperlink(X,ie):!X.trim()&&this._finishHyperlink()}_createHyperlink(N,j){this._getCurrentLinkId()&&this._finishHyperlink();const X=N.split(":");let ie;const se=X.findIndex((N=>N.startsWith("id=")));return-1!==se&&(ie=X[se].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:ie,uri:j}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(N,j){const X=N.split(";");for(let N=0;N<X.length&&!(j>=this._specialColors.length);++N,++j)if("?"===X[N])this._onColor.fire([{type:0,index:this._specialColors[j]}]);else{const ie=(0,Le.parseColor)(X[N]);ie&&this._onColor.fire([{type:1,index:this._specialColors[j],color:ie}])}return!0}setOrReportFgColor(N){return this._setOrReportSpecialColor(N,0)}setOrReportBgColor(N){return this._setOrReportSpecialColor(N,1)}setOrReportCursorColor(N){return this._setOrReportSpecialColor(N,2)}restoreIndexedColor(N){if(!N)return this._onColor.fire([{type:2}]),!0;const j=[],X=N.split(";");for(let N=0;N<X.length;++N)if(/^\d+$/.exec(X[N])){const ie=parseInt(X[N]);A(ie)&&j.push({type:2,index:ie})}return j.length&&this._onColor.fire(j),!0}restoreFgColor(N){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(N){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(N){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,he.DEFAULT_CHARSET),!0}selectCharset(N){return 2!==N.length?(this.selectDefaultCharset(),!0):("/"===N[0]||this._charsetService.setgCharset(Re[N[0]],he.CHARSETS[N[1]]||he.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const N=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,N,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=ve.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=ve.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(N){return this._charsetService.setgLevel(N),!0}screenAlignmentPattern(){const N=new be.CellData;N.content=1<<22|"E".charCodeAt(0),N.fg=this._curAttrData.fg,N.bg=this._curAttrData.bg,this._setCursor(0,0);for(let j=0;j<this._bufferService.rows;++j){const X=this._activeBuffer.ybase+this._activeBuffer.y+j,ie=this._activeBuffer.lines.get(X);ie&&(ie.fill(N),ie.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(N,j){const X=this._bufferService.buffer,ie=this._optionsService.rawOptions;return(N=>(this._coreService.triggerDataEvent(`${le.C0.ESC}${N}${le.C0.ESC}\\`),!0))('"q'===N?`P1$r${this._curAttrData.isProtected()?1:0}"q`:'"p'===N?'P1$r61;1"p':"r"===N?`P1$r${X.scrollTop+1};${X.scrollBottom+1}r`:"m"===N?"P1$r0m":" q"===N?`P1$r${{block:2,underline:4,bar:6}[ie.cursorStyle]-(ie.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(N,j){this._dirtyRowTracker.markRangeDirty(N,j)}}j.InputHandler=D;let Oe=class{constructor(N){this._bufferService=N,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(N){N<this.start?this.start=N:N>this.end&&(this.end=N)}markRangeDirty(N,j){N>j&&(Me=N,N=j,j=Me),N<this.start&&(this.start=N),j>this.end&&(this.end=j)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function A(N){return 0<=N&&N<256}Oe=ie([se(0,ye.IBufferService)],Oe)},7710:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.FourKeyMap=j.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(N,j,X){this._data[N]||(this._data[N]={}),this._data[N][j]=X}get(N,j){return this._data[N]?this._data[N][j]:void 0}clear(){this._data={}}}j.TwoKeyMap=i,j.FourKeyMap=class{constructor(){this._data=new i}set(N,j,X,ie,se){this._data.get(N,j)||this._data.set(N,j,new i),this._data.get(N,j).set(X,ie,se)}get(N,j,X,ie){return this._data.get(N,j)?.get(X,ie)}clear(){this._data.clear()}}},701:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.isChromeOS=j.isLinux=j.isWindows=j.isIphone=j.isIpad=j.isMac=j.isSafari=j.isLegacyEdge=j.isFirefox=j.isNode=void 0,j.getSafariVersion=function(){if(!j.isSafari)return 0;const N=X.match(/Version\/(\d+)/);return null===N||N.length<2?0:parseInt(N[1])},j.isNode="undefined"!=typeof process&&"title"in process;const X=j.isNode?"node":navigator.userAgent,ie=j.isNode?"node":navigator.platform;j.isFirefox=X.includes("Firefox"),j.isLegacyEdge=X.includes("Edge"),j.isSafari=/^((?!chrome|android).)*safari/i.test(X),j.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(ie),j.isIpad="iPad"===ie,j.isIphone="iPhone"===ie,j.isWindows=["Windows","Win16","Win32","WinCE"].includes(ie),j.isLinux=ie.indexOf("Linux")>=0,j.isChromeOS=/\bCrOS\b/.test(X)},3087:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.SortedList=void 0;const ie=X(6168);let se=0;j.SortedList=class{constructor(N){this._getKey=N,this._array=[],this._insertedValues=[],this._flushInsertedTask=new ie.IdleTaskQueue,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new ie.IdleTaskQueue,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(N){this._flushCleanupDeleted(),0===this._insertedValues.length&&this._flushInsertedTask.enqueue((()=>this._flushInserted())),this._insertedValues.push(N)}_flushInserted(){const N=this._insertedValues.sort(((N,j)=>this._getKey(N)-this._getKey(j)));let j=0,X=0;const ie=new Array(this._array.length+this._insertedValues.length);for(let se=0;se<ie.length;se++)X>=this._array.length||this._getKey(N[j])<=this._getKey(this._array[X])?(ie[se]=N[j],j++):ie[se]=this._array[X++];this._array=ie,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(N){if(this._flushCleanupInserted(),0===this._array.length)return!1;const j=this._getKey(N);if(void 0===j)return!1;if(se=this._search(j),-1===se)return!1;if(this._getKey(this._array[se])!==j)return!1;do{if(this._array[se]===N)return 0===this._deletedIndices.length&&this._flushDeletedTask.enqueue((()=>this._flushDeleted())),this._deletedIndices.push(se),!0}while(++se<this._array.length&&this._getKey(this._array[se])===j);return!1}_flushDeleted(){this._isFlushingDeleted=!0;const N=this._deletedIndices.sort(((N,j)=>N-j));let j=0;const X=new Array(this._array.length-N.length);let ie=0;for(let se=0;se<this._array.length;se++)N[j]===se?j++:X[ie++]=this._array[se];this._array=X,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(N){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),0!==this._array.length&&(se=this._search(N),!(se<0||se>=this._array.length)&&this._getKey(this._array[se])===N))do{yield this._array[se]}while(++se<this._array.length&&this._getKey(this._array[se])===N)}forEachByKey(N,j){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),0!==this._array.length&&(se=this._search(N),!(se<0||se>=this._array.length)&&this._getKey(this._array[se])===N))do{j(this._array[se])}while(++se<this._array.length&&this._getKey(this._array[se])===N)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(N){let j=0,X=this._array.length-1;for(;X>=j;){let ie=j+X>>1;const se=this._getKey(this._array[ie]);if(se>N)X=ie-1;else{if(!(se<N)){for(;ie>0&&this._getKey(this._array[ie-1])===N;)ie--;return ie}j=ie+1}}return j}}},6168:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DebouncedIdleTask=j.IdleTaskQueue=j.PriorityTaskQueue=void 0;const ie=X(701);class r{constructor(){this._tasks=[],this._i=0}enqueue(N){this._tasks.push(N),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(N){this._idleCallback=void 0;let j=0,X=0,ie=N.timeRemaining(),se=0;for(;this._i<this._tasks.length;){if(j=Date.now(),this._tasks[this._i]()||this._i++,j=Math.max(1,Date.now()-j),X=Math.max(j,X),se=N.timeRemaining(),1.5*X>se)return ie-j<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(ie-j))}ms`),void this._start();ie=se}this.clear()}}class n extends r{_requestCallback(N){return setTimeout((()=>N(this._createDeadline(16))))}_cancelCallback(N){clearTimeout(N)}_createDeadline(N){const j=Date.now()+N;return{timeRemaining:()=>Math.max(0,j-Date.now())}}}j.PriorityTaskQueue=n,j.IdleTaskQueue=!ie.isNode&&"requestIdleCallback"in window?class extends r{_requestCallback(N){return requestIdleCallback(N)}_cancelCallback(N){cancelIdleCallback(N)}}:n,j.DebouncedIdleTask=class{constructor(){this._queue=new j.IdleTaskQueue}set(N){this._queue.clear(),this._queue.enqueue(N)}flush(){this._queue.flush()}}},5882:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.updateWindowsModeWrappedState=function(N){const j=N.buffer.lines.get(N.buffer.ybase+N.buffer.y-1),X=j?.get(N.cols-1),se=N.buffer.lines.get(N.buffer.ybase+N.buffer.y);se&&X&&(se.isWrapped=X[ie.CHAR_DATA_CODE_INDEX]!==ie.NULL_CELL_CODE&&X[ie.CHAR_DATA_CODE_INDEX]!==ie.WHITESPACE_CELL_CODE)};const ie=X(8938)},5451:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ExtendedAttrs=j.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new s}static toColorRGB(N){return[N>>>16&255,N>>>8&255,255&N]}static fromColorRGB(N){return(255&N[0])<<16|(255&N[1])<<8|255&N[2]}clone(){const N=new i;return N.fg=this.fg,N.bg=this.bg,N.extended=this.extended.clone(),N}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return!(50331648&~this.fg)}isBgRGB(){return!(50331648&~this.bg)}isFgPalette(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}isBgPalette(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}isFgDefault(){return!(50331648&this.fg)}isBgDefault(){return!(50331648&this.bg)}isAttributeDefault(){return 0===this.fg&&0===this.bg}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}j.AttributeData=i;class s{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(N){this._ext=N}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(N){this._ext&=-469762049,this._ext|=N<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(N){this._ext&=-67108864,this._ext|=67108863&N}get urlId(){return this._urlId}set urlId(N){this._urlId=N}get underlineVariantOffset(){const N=(3758096384&this._ext)>>29;return N<0?4294967288^N:N}set underlineVariantOffset(N){this._ext&=536870911,this._ext|=N<<29&3758096384}constructor(N=0,j=0){this._ext=0,this._urlId=0,this._ext=N,this._urlId=j}clone(){return new s(this._ext,this._urlId)}isEmpty(){return 0===this.underlineStyle&&0===this._urlId}}j.ExtendedAttrs=s},1073:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Buffer=j.MAX_BUFFER_SIZE=void 0;const ie=X(5639),se=X(6168),le=X(5451),he=X(6107),ce=X(732),_e=X(3055),me=X(8938),ve=X(8158),Se=X(6760);j.MAX_BUFFER_SIZE=4294967295,j.Buffer=class{constructor(N,j,X){this._hasScrollback=N,this._optionsService=j,this._bufferService=X,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=he.DEFAULT_ATTR_DATA.clone(),this.savedCharset=Se.DEFAULT_CHARSET,this.markers=[],this._nullCell=_e.CellData.fromCharData([0,me.NULL_CELL_CHAR,me.NULL_CELL_WIDTH,me.NULL_CELL_CODE]),this._whitespaceCell=_e.CellData.fromCharData([0,me.WHITESPACE_CELL_CHAR,me.WHITESPACE_CELL_WIDTH,me.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new se.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new ie.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(N){return N?(this._nullCell.fg=N.fg,this._nullCell.bg=N.bg,this._nullCell.extended=N.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new le.ExtendedAttrs),this._nullCell}getWhitespaceCell(N){return N?(this._whitespaceCell.fg=N.fg,this._whitespaceCell.bg=N.bg,this._whitespaceCell.extended=N.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new le.ExtendedAttrs),this._whitespaceCell}getBlankLine(N,j){return new he.BufferLine(this._bufferService.cols,this.getNullCell(N),j)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const N=this.ybase+this.y-this.ydisp;return N>=0&&N<this._rows}_getCorrectBufferLength(N){if(!this._hasScrollback)return N;const X=N+this._optionsService.rawOptions.scrollback;return X>j.MAX_BUFFER_SIZE?j.MAX_BUFFER_SIZE:X}fillViewportRows(N){if(0===this.lines.length){void 0===N&&(N=he.DEFAULT_ATTR_DATA);let j=this._rows;for(;j--;)this.lines.push(this.getBlankLine(N))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new ie.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(N,j){const X=this.getNullCell(he.DEFAULT_ATTR_DATA);let ie=0;const se=this._getCorrectBufferLength(j);if(se>this.lines.maxLength&&(this.lines.maxLength=se),this.lines.length>0){if(this._cols<N)for(let j=0;j<this.lines.length;j++)ie+=+this.lines.get(j).resize(N,X);let le=0;if(this._rows<j)for(let ie=this._rows;ie<j;ie++)this.lines.length<j+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new he.BufferLine(N,X)):this.ybase>0&&this.lines.length<=this.ybase+this.y+le+1?(this.ybase--,le++,this.ydisp>0&&this.ydisp--):this.lines.push(new he.BufferLine(N,X)));else for(let N=this._rows;N>j;N--)this.lines.length>j+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(se<this.lines.maxLength){const N=this.lines.length-se;N>0&&(this.lines.trimStart(N),this.ybase=Math.max(this.ybase-N,0),this.ydisp=Math.max(this.ydisp-N,0),this.savedY=Math.max(this.savedY-N,0)),this.lines.maxLength=se}this.x=Math.min(this.x,N-1),this.y=Math.min(this.y,j-1),le&&(this.y+=le),this.savedX=Math.min(this.savedX,N-1),this.scrollTop=0}if(this.scrollBottom=j-1,this._isReflowEnabled&&(this._reflow(N,j),this._cols>N))for(let j=0;j<this.lines.length;j++)ie+=+this.lines.get(j).resize(N,X);this._cols=N,this._rows=j,this._memoryCleanupQueue.clear(),ie>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let N=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,N=!1);let j=0;for(;this._memoryCleanupPosition<this.lines.length;)if(j+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),j>100)return!0;return N}get _isReflowEnabled(){const N=this._optionsService.rawOptions.windowsPty;return N&&N.buildNumber?this._hasScrollback&&"conpty"===N.backend&&N.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(N,j){this._cols!==N&&(N>this._cols?this._reflowLarger(N,j):this._reflowSmaller(N,j))}_reflowLarger(N,j){const X=(0,ce.reflowLargerGetLinesToRemove)(this.lines,this._cols,N,this.ybase+this.y,this.getNullCell(he.DEFAULT_ATTR_DATA));if(X.length>0){const ie=(0,ce.reflowLargerCreateNewLayout)(this.lines,X);(0,ce.reflowLargerApplyNewLayout)(this.lines,ie.layout),this._reflowLargerAdjustViewport(N,j,ie.countRemoved)}}_reflowLargerAdjustViewport(N,j,X){const ie=this.getNullCell(he.DEFAULT_ATTR_DATA);let se=X;for(;se-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<j&&this.lines.push(new he.BufferLine(N,ie))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-X,0)}_reflowSmaller(N,j){const X=this.getNullCell(he.DEFAULT_ATTR_DATA),ie=[];let se=0;for(let le=this.lines.length-1;le>=0;le--){let _e=this.lines.get(le);if(!_e||!_e.isWrapped&&_e.getTrimmedLength()<=N)continue;const me=[_e];for(;_e.isWrapped&&le>0;)_e=this.lines.get(--le),me.unshift(_e);const ve=this.ybase+this.y;if(ve>=le&&ve<le+me.length)continue;const Se=me[me.length-1].getTrimmedLength(),be=(0,ce.reflowSmallerGetNewLineLengths)(me,this._cols,N),Ce=be.length-me.length;let ye;ye=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+Ce):Math.max(0,this.lines.length-this.lines.maxLength+Ce);const we=[];for(let N=0;N<Ce;N++){const N=this.getBlankLine(he.DEFAULT_ATTR_DATA,!0);we.push(N)}we.length>0&&(ie.push({start:le+me.length+se,newLines:we}),se+=we.length),me.push(...we);let Ee=be.length-1,De=be[Ee];0===De&&(Ee--,De=be[Ee]);let Le=me.length-Ce-1,Ae=Se;for(;Le>=0;){const N=Math.min(Ae,De);if(void 0===me[Ee])break;if(me[Ee].copyCellsFrom(me[Le],Ae-N,De-N,N,!0),De-=N,0===De&&(Ee--,De=be[Ee]),Ae-=N,0===Ae){Le--;const N=Math.max(Le,0);Ae=(0,ce.getWrappedLineTrimmedLength)(me,N,this._cols)}}for(let j=0;j<me.length;j++)be[j]<N&&me[j].setCell(be[j],X);let Re=Ce-ye;for(;Re-- >0;)0===this.ybase?this.y<j-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+se)-j&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+Ce,this.ybase+j-1)}if(ie.length>0){const N=[],j=[];for(let N=0;N<this.lines.length;N++)j.push(this.lines.get(N));const X=this.lines.length;let le=X-1,he=0,ce=ie[he];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+se);let _e=0;for(let me=Math.min(this.lines.maxLength-1,X+se-1);me>=0;me--)if(ce&&ce.start>le+_e){for(let N=ce.newLines.length-1;N>=0;N--)this.lines.set(me--,ce.newLines[N]);me++,N.push({index:le+1,amount:ce.newLines.length}),_e+=ce.newLines.length,ce=ie[++he]}else this.lines.set(me,j[le--]);let me=0;for(let j=N.length-1;j>=0;j--)N[j].index+=me,this.lines.onInsertEmitter.fire(N[j]),me+=N[j].amount;const ve=Math.max(0,X+se-this.lines.maxLength);ve>0&&this.lines.onTrimEmitter.fire(ve)}}translateBufferLineToString(N,j,X=0,ie){const se=this.lines.get(N);return se?se.translateToString(j,X,ie):""}getWrappedRangeForLine(N){let j=N,X=N;for(;j>0&&this.lines.get(j).isWrapped;)j--;for(;X+1<this.lines.length&&this.lines.get(X+1).isWrapped;)X++;return{first:j,last:X}}setupTabStops(N){for(null!=N?this.tabs[N]||(N=this.prevStop(N)):(this.tabs={},N=0);N<this._cols;N+=this._optionsService.rawOptions.tabStopWidth)this.tabs[N]=!0}prevStop(N){for(null==N&&(N=this.x);!this.tabs[--N]&&N>0;);return N>=this._cols?this._cols-1:N<0?0:N}nextStop(N){for(null==N&&(N=this.x);!this.tabs[++N]&&N<this._cols;);return N>=this._cols?this._cols-1:N<0?0:N}clearMarkers(N){this._isClearing=!0;for(let j=0;j<this.markers.length;j++)this.markers[j].line===N&&(this.markers[j].dispose(),this.markers.splice(j--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let N=0;N<this.markers.length;N++)this.markers[N].dispose();this.markers.length=0,this._isClearing=!1}addMarker(N){const j=new ve.Marker(N);return this.markers.push(j),j.register(this.lines.onTrim((N=>{j.line-=N,j.line<0&&j.dispose()}))),j.register(this.lines.onInsert((N=>{j.line>=N.index&&(j.line+=N.amount)}))),j.register(this.lines.onDelete((N=>{j.line>=N.index&&j.line<N.index+N.amount&&j.dispose(),j.line>N.index&&(j.line-=N.amount)}))),j.register(j.onDispose((()=>this._removeMarker(j)))),j}_removeMarker(N){this._isClearing||this.markers.splice(this.markers.indexOf(N),1)}}},6107:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BufferLine=j.DEFAULT_ATTR_DATA=void 0;const ie=X(5451),se=X(3055),le=X(8938),he=X(726);j.DEFAULT_ATTR_DATA=Object.freeze(new ie.AttributeData);let ce=0;class l{constructor(N,j,X=!1){this.isWrapped=X,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*N);const ie=j||se.CellData.fromCharData([0,le.NULL_CELL_CHAR,le.NULL_CELL_WIDTH,le.NULL_CELL_CODE]);for(let j=0;j<N;++j)this.setCell(j,ie);this.length=N}get(N){const j=this._data[3*N+0],X=2097151&j;return[this._data[3*N+1],2097152&j?this._combined[N]:X?(0,he.stringFromCodePoint)(X):"",j>>22,2097152&j?this._combined[N].charCodeAt(this._combined[N].length-1):X]}set(N,j){this._data[3*N+1]=j[le.CHAR_DATA_ATTR_INDEX],j[le.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[N]=j[1],this._data[3*N+0]=2097152|N|j[le.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*N+0]=j[le.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|j[le.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(N){return this._data[3*N+0]>>22}hasWidth(N){return 12582912&this._data[3*N+0]}getFg(N){return this._data[3*N+1]}getBg(N){return this._data[3*N+2]}hasContent(N){return 4194303&this._data[3*N+0]}getCodePoint(N){const j=this._data[3*N+0];return 2097152&j?this._combined[N].charCodeAt(this._combined[N].length-1):2097151&j}isCombined(N){return 2097152&this._data[3*N+0]}getString(N){const j=this._data[3*N+0];return 2097152&j?this._combined[N]:2097151&j?(0,he.stringFromCodePoint)(2097151&j):""}isProtected(N){return 536870912&this._data[3*N+2]}loadCell(N,j){return ce=3*N,j.content=this._data[ce+0],j.fg=this._data[ce+1],j.bg=this._data[ce+2],2097152&j.content&&(j.combinedData=this._combined[N]),268435456&j.bg&&(j.extended=this._extendedAttrs[N]),j}setCell(N,j){2097152&j.content&&(this._combined[N]=j.combinedData),268435456&j.bg&&(this._extendedAttrs[N]=j.extended),this._data[3*N+0]=j.content,this._data[3*N+1]=j.fg,this._data[3*N+2]=j.bg}setCellFromCodepoint(N,j,X,ie){268435456&ie.bg&&(this._extendedAttrs[N]=ie.extended),this._data[3*N+0]=j|X<<22,this._data[3*N+1]=ie.fg,this._data[3*N+2]=ie.bg}addCodepointToCell(N,j,X){let ie=this._data[3*N+0];2097152&ie?this._combined[N]+=(0,he.stringFromCodePoint)(j):2097151&ie?(this._combined[N]=(0,he.stringFromCodePoint)(2097151&ie)+(0,he.stringFromCodePoint)(j),ie&=-2097152,ie|=2097152):ie=j|1<<22,X&&(ie&=-12582913,ie|=X<<22),this._data[3*N+0]=ie}insertCells(N,j,X){if((N%=this.length)&&2===this.getWidth(N-1)&&this.setCellFromCodepoint(N-1,0,1,X),j<this.length-N){const ie=new se.CellData;for(let X=this.length-N-j-1;X>=0;--X)this.setCell(N+j+X,this.loadCell(N+X,ie));for(let ie=0;ie<j;++ie)this.setCell(N+ie,X)}else for(let j=N;j<this.length;++j)this.setCell(j,X);2===this.getWidth(this.length-1)&&this.setCellFromCodepoint(this.length-1,0,1,X)}deleteCells(N,j,X){if(N%=this.length,j<this.length-N){const ie=new se.CellData;for(let X=0;X<this.length-N-j;++X)this.setCell(N+X,this.loadCell(N+j+X,ie));for(let N=this.length-j;N<this.length;++N)this.setCell(N,X)}else for(let j=N;j<this.length;++j)this.setCell(j,X);N&&2===this.getWidth(N-1)&&this.setCellFromCodepoint(N-1,0,1,X),0!==this.getWidth(N)||this.hasContent(N)||this.setCellFromCodepoint(N,0,1,X)}replaceCells(N,j,X,ie=!1){if(ie)for(N&&2===this.getWidth(N-1)&&!this.isProtected(N-1)&&this.setCellFromCodepoint(N-1,0,1,X),j<this.length&&2===this.getWidth(j-1)&&!this.isProtected(j)&&this.setCellFromCodepoint(j,0,1,X);N<j&&N<this.length;)this.isProtected(N)||this.setCell(N,X),N++;else for(N&&2===this.getWidth(N-1)&&this.setCellFromCodepoint(N-1,0,1,X),j<this.length&&2===this.getWidth(j-1)&&this.setCellFromCodepoint(j,0,1,X);N<j&&N<this.length;)this.setCell(N++,X)}resize(N,j){if(N===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const X=3*N;if(N>this.length){if(this._data.buffer.byteLength>=4*X)this._data=new Uint32Array(this._data.buffer,0,X);else{const N=new Uint32Array(X);N.set(this._data),this._data=N}for(let X=this.length;X<N;++X)this.setCell(X,j)}else{this._data=this._data.subarray(0,X);const j=Object.keys(this._combined);for(let X=0;X<j.length;X++){const ie=parseInt(j[X],10);ie>=N&&delete this._combined[ie]}const ie=Object.keys(this._extendedAttrs);for(let j=0;j<ie.length;j++){const X=parseInt(ie[j],10);X>=N&&delete this._extendedAttrs[X]}}return this.length=N,4*X*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const N=new Uint32Array(this._data.length);return N.set(this._data),this._data=N,1}return 0}fill(N,j=!1){if(j)for(let j=0;j<this.length;++j)this.isProtected(j)||this.setCell(j,N);else{this._combined={},this._extendedAttrs={};for(let j=0;j<this.length;++j)this.setCell(j,N)}}copyFrom(N){this.length!==N.length?this._data=new Uint32Array(N._data):this._data.set(N._data),this.length=N.length,this._combined={};for(const j in N._combined)this._combined[j]=N._combined[j];this._extendedAttrs={};for(const j in N._extendedAttrs)this._extendedAttrs[j]=N._extendedAttrs[j];this.isWrapped=N.isWrapped}clone(){const N=new l(0);N._data=new Uint32Array(this._data),N.length=this.length;for(const j in this._combined)N._combined[j]=this._combined[j];for(const j in this._extendedAttrs)N._extendedAttrs[j]=this._extendedAttrs[j];return N.isWrapped=this.isWrapped,N}getTrimmedLength(){for(let N=this.length-1;N>=0;--N)if(4194303&this._data[3*N+0])return N+(this._data[3*N+0]>>22);return 0}getNoBgTrimmedLength(){for(let N=this.length-1;N>=0;--N)if(4194303&this._data[3*N+0]||50331648&this._data[3*N+2])return N+(this._data[3*N+0]>>22);return 0}copyCellsFrom(N,j,X,ie,se){const le=N._data;if(se)for(let se=ie-1;se>=0;se--){for(let N=0;N<3;N++)this._data[3*(X+se)+N]=le[3*(j+se)+N];268435456&le[3*(j+se)+2]&&(this._extendedAttrs[X+se]=N._extendedAttrs[j+se])}else for(let se=0;se<ie;se++){for(let N=0;N<3;N++)this._data[3*(X+se)+N]=le[3*(j+se)+N];268435456&le[3*(j+se)+2]&&(this._extendedAttrs[X+se]=N._extendedAttrs[j+se])}const he=Object.keys(N._combined);for(let ie=0;ie<he.length;ie++){const se=parseInt(he[ie],10);se>=j&&(this._combined[se-j+X]=N._combined[se])}}translateToString(N,j,X,ie){j=j??0,X=X??this.length,N&&(X=Math.min(X,this.getTrimmedLength())),ie&&(ie.length=0);let se="";for(;j<X;){const N=this._data[3*j+0],X=2097151&N,ce=2097152&N?this._combined[j]:X?(0,he.stringFromCodePoint)(X):le.WHITESPACE_CELL_CHAR;if(se+=ce,ie)for(let N=0;N<ce.length;++N)ie.push(j);j+=N>>22||1}return ie&&ie.push(j),se}}j.BufferLine=l},9384:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.getRangeLength=function(N,j){if(N.start.y>N.end.y)throw new Error(`Buffer range end (${N.end.x}, ${N.end.y}) cannot be before start (${N.start.x}, ${N.start.y})`);return j*(N.end.y-N.start.y)+(N.end.x-N.start.x+1)}},732:(N,j)=>{function i(N,j,X){if(j===N.length-1)return N[j].getTrimmedLength();const ie=!N[j].hasContent(X-1)&&1===N[j].getWidth(X-1),se=2===N[j+1].getWidth(0);return ie&&se?X-1:X}Object.defineProperty(j,"__esModule",{value:!0}),j.reflowLargerGetLinesToRemove=function(N,j,X,ie,se){const le=[];for(let he=0;he<N.length-1;he++){let ce=he,_e=N.get(++ce);if(!_e.isWrapped)continue;const me=[N.get(he)];for(;ce<N.length&&_e.isWrapped;)me.push(_e),_e=N.get(++ce);if(ie>=he&&ie<ce){he+=me.length-1;continue}let ve=0,Se=i(me,ve,j),be=1,Ce=0;for(;be<me.length;){const N=i(me,be,j),ie=N-Ce,le=X-Se,he=Math.min(ie,le);me[ve].copyCellsFrom(me[be],Ce,Se,he,!1),Se+=he,Se===X&&(ve++,Se=0),Ce+=he,Ce===N&&(be++,Ce=0),0===Se&&0!==ve&&2===me[ve-1].getWidth(X-1)&&(me[ve].copyCellsFrom(me[ve-1],X-1,Se++,1,!1),me[ve-1].setCell(X-1,se))}me[ve].replaceCells(Se,X,se);let ye=0;for(let N=me.length-1;N>0&&(N>ve||0===me[N].getTrimmedLength());N--)ye++;ye>0&&(le.push(he+me.length-ye),le.push(ye)),he+=me.length-1}return le},j.reflowLargerCreateNewLayout=function(N,j){const X=[];let ie=0,se=j[ie],le=0;for(let he=0;he<N.length;he++)if(se===he){const X=j[++ie];N.onDeleteEmitter.fire({index:he-le,amount:X}),he+=X-1,le+=X,se=j[++ie]}else X.push(he);return{layout:X,countRemoved:le}},j.reflowLargerApplyNewLayout=function(N,j){const X=[];for(let ie=0;ie<j.length;ie++)X.push(N.get(j[ie]));for(let j=0;j<X.length;j++)N.set(j,X[j]);N.length=j.length},j.reflowSmallerGetNewLineLengths=function(N,j,X){const ie=[],se=N.map(((X,ie)=>i(N,ie,j))).reduce(((N,j)=>N+j));let le=0,he=0,ce=0;for(;ce<se;){if(se-ce<X){ie.push(se-ce);break}le+=X;const _e=i(N,he,j);le>_e&&(le-=_e,he++);const me=2===N[he].getWidth(le-1);me&&le--;const ve=me?X-1:X;ie.push(ve),ce+=ve}return ie},j.getWrappedLineTrimmedLength=i},4097:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BufferSet=void 0;const ie=X(7150),se=X(1073),le=X(802);class o extends ie.Disposable{constructor(N,j){super(),this._optionsService=N,this._bufferService=j,this._onBufferActivate=this._register(new le.Emitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new se.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new se.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(N){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(N),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(N,j){this._normal.resize(N,j),this._alt.resize(N,j),this.setupTabStops(N)}setupTabStops(N){this._normal.setupTabStops(N),this._alt.setupTabStops(N)}}j.BufferSet=o},3055:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CellData=void 0;const ie=X(726),se=X(8938),le=X(5451);class o extends le.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new le.ExtendedAttrs,this.combinedData=""}static fromCharData(N){const j=new o;return j.setFromCharData(N),j}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,ie.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(N){this.fg=N[se.CHAR_DATA_ATTR_INDEX],this.bg=0;let j=!1;if(N[se.CHAR_DATA_CHAR_INDEX].length>2)j=!0;else if(2===N[se.CHAR_DATA_CHAR_INDEX].length){const X=N[se.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=X&&X<=56319){const ie=N[se.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=ie&&ie<=57343?this.content=1024*(X-55296)+ie-56320+65536|N[se.CHAR_DATA_WIDTH_INDEX]<<22:j=!0}else j=!0}else this.content=N[se.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|N[se.CHAR_DATA_WIDTH_INDEX]<<22;j&&(this.combinedData=N[se.CHAR_DATA_CHAR_INDEX],this.content=2097152|N[se.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}j.CellData=o},8938:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.WHITESPACE_CELL_CODE=j.WHITESPACE_CELL_WIDTH=j.WHITESPACE_CELL_CHAR=j.NULL_CELL_CODE=j.NULL_CELL_WIDTH=j.NULL_CELL_CHAR=j.CHAR_DATA_CODE_INDEX=j.CHAR_DATA_WIDTH_INDEX=j.CHAR_DATA_CHAR_INDEX=j.CHAR_DATA_ATTR_INDEX=j.DEFAULT_EXT=j.DEFAULT_ATTR=j.DEFAULT_COLOR=void 0,j.DEFAULT_COLOR=0,j.DEFAULT_ATTR=j.DEFAULT_COLOR<<9|256,j.DEFAULT_EXT=0,j.CHAR_DATA_ATTR_INDEX=0,j.CHAR_DATA_CHAR_INDEX=1,j.CHAR_DATA_WIDTH_INDEX=2,j.CHAR_DATA_CODE_INDEX=3,j.NULL_CELL_CHAR="",j.NULL_CELL_WIDTH=1,j.NULL_CELL_CODE=0,j.WHITESPACE_CELL_CHAR=" ",j.WHITESPACE_CELL_WIDTH=1,j.WHITESPACE_CELL_CODE=32},8158:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Marker=void 0;const ie=X(802),se=X(7150);class n{get id(){return this._id}constructor(N){this.line=N,this.isDisposed=!1,this._disposables=[],this._id=n._nextId++,this._onDispose=this.register(new ie.Emitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,se.dispose)(this._disposables),this._disposables.length=0)}register(N){return this._disposables.push(N),N}}j.Marker=n,n._nextId=1},6760:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DEFAULT_CHARSET=j.CHARSETS=void 0,j.CHARSETS={},j.DEFAULT_CHARSET=j.CHARSETS.B,j.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},j.CHARSETS.A={"#":"Â£"},j.CHARSETS.B=void 0,j.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},j.CHARSETS.C=j.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},j.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},j.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},j.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},j.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},j.CHARSETS.E=j.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},j.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},j.CHARSETS.H=j.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},j.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},3534:(N,j)=>{var X,ie,se;Object.defineProperty(j,"__esModule",{value:!0}),j.C1_ESCAPED=j.C1=j.C0=void 0,function(N){N.NUL="\0",N.SOH="",N.STX="",N.ETX="",N.EOT="",N.ENQ="",N.ACK="",N.BEL="",N.BS="\b",N.HT="\t",N.LF="\n",N.VT="\v",N.FF="\f",N.CR="\r",N.SO="",N.SI="",N.DLE="",N.DC1="",N.DC2="",N.DC3="",N.DC4="",N.NAK="",N.SYN="",N.ETB="",N.CAN="",N.EM="",N.SUB="",N.ESC="",N.FS="",N.GS="",N.RS="",N.US="",N.SP=" ",N.DEL=""}(X||(j.C0=X={})),function(N){N.PAD="Â",N.HOP="Â",N.BPH="Â",N.NBH="Â",N.IND="Â",N.NEL="Â",N.SSA="Â",N.ESA="Â",N.HTS="Â",N.HTJ="Â",N.VTS="Â",N.PLD="Â",N.PLU="Â",N.RI="Â",N.SS2="Â",N.SS3="Â",N.DCS="Â",N.PU1="Â",N.PU2="Â",N.STS="Â",N.CCH="Â",N.MW="Â",N.SPA="Â",N.EPA="Â",N.SOS="Â",N.SGCI="Â",N.SCI="Â",N.CSI="Â",N.ST="Â",N.OSC="Â",N.PM="Â",N.APC="Â"}(ie||(j.C1=ie={})),function(N){N.ST=`${X.ESC}\\`}(se||(j.C1_ESCAPED=se={}))},706:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.evaluateKeyboardEvent=function(N,j,X,le){const he={type:0,cancel:!1,key:void 0},ce=(N.shiftKey?1:0)|(N.altKey?2:0)|(N.ctrlKey?4:0)|(N.metaKey?8:0);switch(N.keyCode){case 0:"UIKeyInputUpArrow"===N.key?he.key=j?ie.C0.ESC+"OA":ie.C0.ESC+"[A":"UIKeyInputLeftArrow"===N.key?he.key=j?ie.C0.ESC+"OD":ie.C0.ESC+"[D":"UIKeyInputRightArrow"===N.key?he.key=j?ie.C0.ESC+"OC":ie.C0.ESC+"[C":"UIKeyInputDownArrow"===N.key&&(he.key=j?ie.C0.ESC+"OB":ie.C0.ESC+"[B");break;case 8:he.key=N.ctrlKey?"\b":ie.C0.DEL,N.altKey&&(he.key=ie.C0.ESC+he.key);break;case 9:if(N.shiftKey){he.key=ie.C0.ESC+"[Z";break}he.key=ie.C0.HT,he.cancel=!0;break;case 13:he.key=N.altKey?ie.C0.ESC+ie.C0.CR:ie.C0.CR,he.cancel=!0;break;case 27:he.key=ie.C0.ESC,N.altKey&&(he.key=ie.C0.ESC+ie.C0.ESC),he.cancel=!0;break;case 37:if(N.metaKey)break;ce?(he.key=ie.C0.ESC+"[1;"+(ce+1)+"D",he.key===ie.C0.ESC+"[1;3D"&&(he.key=ie.C0.ESC+(X?"b":"[1;5D"))):he.key=j?ie.C0.ESC+"OD":ie.C0.ESC+"[D";break;case 39:if(N.metaKey)break;ce?(he.key=ie.C0.ESC+"[1;"+(ce+1)+"C",he.key===ie.C0.ESC+"[1;3C"&&(he.key=ie.C0.ESC+(X?"f":"[1;5C"))):he.key=j?ie.C0.ESC+"OC":ie.C0.ESC+"[C";break;case 38:if(N.metaKey)break;ce?(he.key=ie.C0.ESC+"[1;"+(ce+1)+"A",X||he.key!==ie.C0.ESC+"[1;3A"||(he.key=ie.C0.ESC+"[1;5A")):he.key=j?ie.C0.ESC+"OA":ie.C0.ESC+"[A";break;case 40:if(N.metaKey)break;ce?(he.key=ie.C0.ESC+"[1;"+(ce+1)+"B",X||he.key!==ie.C0.ESC+"[1;3B"||(he.key=ie.C0.ESC+"[1;5B")):he.key=j?ie.C0.ESC+"OB":ie.C0.ESC+"[B";break;case 45:N.shiftKey||N.ctrlKey||(he.key=ie.C0.ESC+"[2~");break;case 46:he.key=ce?ie.C0.ESC+"[3;"+(ce+1)+"~":ie.C0.ESC+"[3~";break;case 36:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"H":j?ie.C0.ESC+"OH":ie.C0.ESC+"[H";break;case 35:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"F":j?ie.C0.ESC+"OF":ie.C0.ESC+"[F";break;case 33:N.shiftKey?he.type=2:N.ctrlKey?he.key=ie.C0.ESC+"[5;"+(ce+1)+"~":he.key=ie.C0.ESC+"[5~";break;case 34:N.shiftKey?he.type=3:N.ctrlKey?he.key=ie.C0.ESC+"[6;"+(ce+1)+"~":he.key=ie.C0.ESC+"[6~";break;case 112:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"P":ie.C0.ESC+"OP";break;case 113:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"Q":ie.C0.ESC+"OQ";break;case 114:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"R":ie.C0.ESC+"OR";break;case 115:he.key=ce?ie.C0.ESC+"[1;"+(ce+1)+"S":ie.C0.ESC+"OS";break;case 116:he.key=ce?ie.C0.ESC+"[15;"+(ce+1)+"~":ie.C0.ESC+"[15~";break;case 117:he.key=ce?ie.C0.ESC+"[17;"+(ce+1)+"~":ie.C0.ESC+"[17~";break;case 118:he.key=ce?ie.C0.ESC+"[18;"+(ce+1)+"~":ie.C0.ESC+"[18~";break;case 119:he.key=ce?ie.C0.ESC+"[19;"+(ce+1)+"~":ie.C0.ESC+"[19~";break;case 120:he.key=ce?ie.C0.ESC+"[20;"+(ce+1)+"~":ie.C0.ESC+"[20~";break;case 121:he.key=ce?ie.C0.ESC+"[21;"+(ce+1)+"~":ie.C0.ESC+"[21~";break;case 122:he.key=ce?ie.C0.ESC+"[23;"+(ce+1)+"~":ie.C0.ESC+"[23~";break;case 123:he.key=ce?ie.C0.ESC+"[24;"+(ce+1)+"~":ie.C0.ESC+"[24~";break;default:if(!N.ctrlKey||N.shiftKey||N.altKey||N.metaKey)if(X&&!le||!N.altKey||N.metaKey)!X||N.altKey||N.ctrlKey||N.shiftKey||!N.metaKey?N.key&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&N.keyCode>=48&&1===N.key.length?he.key=N.key:N.key&&N.ctrlKey&&("_"===N.key&&(he.key=ie.C0.US),"@"===N.key&&(he.key=ie.C0.NUL)):65===N.keyCode&&(he.type=1);else{const j=se[N.keyCode],X=j?.[N.shiftKey?1:0];if(X)he.key=ie.C0.ESC+X;else if(N.keyCode>=65&&N.keyCode<=90){const j=N.ctrlKey?N.keyCode-64:N.keyCode+32;let X=String.fromCharCode(j);N.shiftKey&&(X=X.toUpperCase()),he.key=ie.C0.ESC+X}else if(32===N.keyCode)he.key=ie.C0.ESC+(N.ctrlKey?ie.C0.NUL:" ");else if("Dead"===N.key&&N.code.startsWith("Key")){let j=N.code.slice(3,4);N.shiftKey||(j=j.toLowerCase()),he.key=ie.C0.ESC+j,he.cancel=!0}}else N.keyCode>=65&&N.keyCode<=90?he.key=String.fromCharCode(N.keyCode-64):32===N.keyCode?he.key=ie.C0.NUL:N.keyCode>=51&&N.keyCode<=55?he.key=String.fromCharCode(N.keyCode-51+27):56===N.keyCode?he.key=ie.C0.DEL:219===N.keyCode?he.key=ie.C0.ESC:220===N.keyCode?he.key=ie.C0.FS:221===N.keyCode&&(he.key=ie.C0.GS)}return he};const ie=X(3534),se={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']}},726:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Utf8ToUtf32=j.StringToUtf32=void 0,j.stringFromCodePoint=function(N){return N>65535?(N-=65536,String.fromCharCode(55296+(N>>10))+String.fromCharCode(N%1024+56320)):String.fromCharCode(N)},j.utf32ToString=function(N,j=0,X=N.length){let ie="";for(let se=j;se<X;++se){let j=N[se];j>65535?(j-=65536,ie+=String.fromCharCode(55296+(j>>10))+String.fromCharCode(j%1024+56320)):ie+=String.fromCharCode(j)}return ie},j.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(N,j){const X=N.length;if(!X)return 0;let ie=0,se=0;if(this._interim){const X=N.charCodeAt(se++);56320<=X&&X<=57343?j[ie++]=1024*(this._interim-55296)+X-56320+65536:(j[ie++]=this._interim,j[ie++]=X),this._interim=0}for(let le=se;le<X;++le){const se=N.charCodeAt(le);if(55296<=se&&se<=56319){if(++le>=X)return this._interim=se,ie;const he=N.charCodeAt(le);56320<=he&&he<=57343?j[ie++]=1024*(se-55296)+he-56320+65536:(j[ie++]=se,j[ie++]=he)}else 65279!==se&&(j[ie++]=se)}return ie}},j.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(N,j){const X=N.length;if(!X)return 0;let ie,se,le,he,ce=0,_e=0,me=0;if(this.interim[0]){let ie=!1,se=this.interim[0];se&=192==(224&se)?31:224==(240&se)?15:7;let le,he=0;for(;(le=63&this.interim[++he])&&he<4;)se<<=6,se|=le;const _e=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,ve=_e-he;for(;me<ve;){if(me>=X)return 0;if(le=N[me++],128!=(192&le)){me--,ie=!0;break}this.interim[he++]=le,se<<=6,se|=63&le}ie||(2===_e?se<128?me--:j[ce++]=se:3===_e?se<2048||se>=55296&&se<=57343||65279===se||(j[ce++]=se):se<65536||se>1114111||(j[ce++]=se)),this.interim.fill(0)}const ve=X-4;let Se=me;for(;Se<X;){for(;!(!(Se<ve)||128&(ie=N[Se])||128&(se=N[Se+1])||128&(le=N[Se+2])||128&(he=N[Se+3]));)j[ce++]=ie,j[ce++]=se,j[ce++]=le,j[ce++]=he,Se+=4;if(ie=N[Se++],ie<128)j[ce++]=ie;else if(192==(224&ie)){if(Se>=X)return this.interim[0]=ie,ce;if(se=N[Se++],128!=(192&se)){Se--;continue}if(_e=(31&ie)<<6|63&se,_e<128){Se--;continue}j[ce++]=_e}else if(224==(240&ie)){if(Se>=X)return this.interim[0]=ie,ce;if(se=N[Se++],128!=(192&se)){Se--;continue}if(Se>=X)return this.interim[0]=ie,this.interim[1]=se,ce;if(le=N[Se++],128!=(192&le)){Se--;continue}if(_e=(15&ie)<<12|(63&se)<<6|63&le,_e<2048||_e>=55296&&_e<=57343||65279===_e)continue;j[ce++]=_e}else if(240==(248&ie)){if(Se>=X)return this.interim[0]=ie,ce;if(se=N[Se++],128!=(192&se)){Se--;continue}if(Se>=X)return this.interim[0]=ie,this.interim[1]=se,ce;if(le=N[Se++],128!=(192&le)){Se--;continue}if(Se>=X)return this.interim[0]=ie,this.interim[1]=se,this.interim[2]=le,ce;if(he=N[Se++],128!=(192&he)){Se--;continue}if(_e=(7&ie)<<18|(63&se)<<12|(63&le)<<6|63&he,_e<65536||_e>1114111)continue;j[ce++]=_e}}return ce}}},7428:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.UnicodeV6=void 0;const ie=X(6415),se=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],le=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let he;j.UnicodeV6=class{constructor(){if(this.version="6",!he){he=new Uint8Array(65536),he.fill(1),he[0]=0,he.fill(0,1,32),he.fill(0,127,160),he.fill(2,4352,4448),he[9001]=2,he[9002]=2,he.fill(2,11904,42192),he[12351]=1,he.fill(2,44032,55204),he.fill(2,63744,64256),he.fill(2,65040,65050),he.fill(2,65072,65136),he.fill(2,65280,65377),he.fill(2,65504,65511);for(let N=0;N<se.length;++N)he.fill(0,se[N][0],se[N][1]+1)}}wcwidth(N){return N<32?0:N<127?1:N<65536?he[N]:function(N,j){let X,ie=0,se=j.length-1;if(N<j[0][0]||N>j[se][1])return!1;for(;se>=ie;)if(X=ie+se>>1,N>j[X][1])ie=X+1;else{if(!(N<j[X][0]))return!0;se=X-1}return!1}(N,le)?0:N>=131072&&N<=196605||N>=196608&&N<=262141?2:1}charProperties(N,j){let X=this.wcwidth(N),se=0===X&&0!==j;if(se){const N=ie.UnicodeService.extractWidth(j);0===N?se=!1:N>X&&(X=N)}return ie.UnicodeService.createPropertyValue(0,X,se)}}},3562:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.WriteBuffer=void 0;const ie=X(7150),se=X(802);class n extends ie.Disposable{constructor(N){super(),this._action=N,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new se.Emitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(N,j){if(void 0!==j&&this._syncCalls>j)return void(this._syncCalls=0);if(this._pendingData+=N.length,this._writeBuffer.push(N),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let X;for(this._isSyncWriting=!0;X=this._writeBuffer.shift();){this._action(X);const N=this._callbacks.shift();N&&N()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(N,j){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=N.length,this._writeBuffer.push(N),this._callbacks.push(j),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=N.length,this._writeBuffer.push(N),this._callbacks.push(j)}_innerWrite(N=0,j=!0){const X=N||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const N=this._writeBuffer[this._bufferOffset],ie=this._action(N,j);if(ie){const e=N=>Date.now()-X>=12?setTimeout((()=>this._innerWrite(0,N))):this._innerWrite(X,N);return void ie.catch((N=>(queueMicrotask((()=>{throw N})),Promise.resolve(!1)))).then(e)}const se=this._callbacks[this._bufferOffset];if(se&&se(),this._bufferOffset++,this._pendingData-=N.length,Date.now()-X>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}j.WriteBuffer=n},8693:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.parseColor=function(N){if(!N)return;let j=N.toLowerCase();if(0===j.indexOf("rgb:")){j=j.slice(4);const N=X.exec(j);if(N){const j=N[1]?15:N[4]?255:N[7]?4095:65535;return[Math.round(parseInt(N[1]||N[4]||N[7]||N[10],16)/j*255),Math.round(parseInt(N[2]||N[5]||N[8]||N[11],16)/j*255),Math.round(parseInt(N[3]||N[6]||N[9]||N[12],16)/j*255)]}}else if(0===j.indexOf("#")&&(j=j.slice(1),ie.exec(j)&&[3,6,9,12].includes(j.length))){const N=j.length/3,X=[0,0,0];for(let ie=0;ie<3;++ie){const se=parseInt(j.slice(N*ie,N*ie+N),16);X[ie]=1===N?se<<4:2===N?se:3===N?se>>4:se>>8}return X}},j.toRgbString=function(N,j=16){const[X,ie,se]=N;return`rgb:${r(X,j)}/${r(ie,j)}/${r(se,j)}`};const X=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,ie=/^[\da-f]+$/;function r(N,j){const X=N.toString(16),ie=X.length<2?"0"+X:X;switch(j){case 4:return X[0];case 8:return ie;case 12:return(ie+ie).slice(0,3);default:return ie+ie}}},1263:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.PAYLOAD_LIMIT=void 0,j.PAYLOAD_LIMIT=1e7},9823:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DcsHandler=j.DcsParser=void 0;const ie=X(726),se=X(7262),le=X(1263),he=[];j.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=he,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=he}registerHandler(N,j){void 0===this._handlers[N]&&(this._handlers[N]=[]);const X=this._handlers[N];return X.push(j),{dispose:()=>{const N=X.indexOf(j);-1!==N&&X.splice(N,1)}}}clearHandler(N){this._handlers[N]&&delete this._handlers[N]}setHandlerFallback(N){this._handlerFb=N}reset(){if(this._active.length)for(let N=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;N>=0;--N)this._active[N].unhook(!1);this._stack.paused=!1,this._active=he,this._ident=0}hook(N,j){if(this.reset(),this._ident=N,this._active=this._handlers[N]||he,this._active.length)for(let N=this._active.length-1;N>=0;N--)this._active[N].hook(j);else this._handlerFb(this._ident,"HOOK",j)}put(N,j,X){if(this._active.length)for(let ie=this._active.length-1;ie>=0;ie--)this._active[ie].put(N,j,X);else this._handlerFb(this._ident,"PUT",(0,ie.utf32ToString)(N,j,X))}unhook(N,j=!0){if(this._active.length){let X=!1,ie=this._active.length-1,se=!1;if(this._stack.paused&&(ie=this._stack.loopPosition-1,X=j,se=this._stack.fallThrough,this._stack.paused=!1),!se&&!1===X){for(;ie>=0&&(X=this._active[ie].unhook(N),!0!==X);ie--)if(X instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=ie,this._stack.fallThrough=!1,X;ie--}for(;ie>=0;ie--)if(X=this._active[ie].unhook(!1),X instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=ie,this._stack.fallThrough=!0,X}else this._handlerFb(this._ident,"UNHOOK",N);this._active=he,this._ident=0}};const ce=new se.Params;ce.addParam(0),j.DcsHandler=class{constructor(N){this._handler=N,this._data="",this._params=ce,this._hitLimit=!1}hook(N){this._params=N.length>1||N.params[0]?N.clone():ce,this._data="",this._hitLimit=!1}put(N,j,X){this._hitLimit||(this._data+=(0,ie.utf32ToString)(N,j,X),this._data.length>le.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(N){let j=!1;if(this._hitLimit)j=!1;else if(N&&(j=this._handler(this._data,this._params),j instanceof Promise))return j.then((N=>(this._params=ce,this._data="",this._hitLimit=!1,N)));return this._params=ce,this._data="",this._hitLimit=!1,j}}},6717:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.EscapeSequenceParser=j.VT500_TRANSITION_TABLE=j.TransitionTable=void 0;const ie=X(7150),se=X(7262),le=X(1346),he=X(9823);class a{constructor(N){this.table=new Uint8Array(N)}setDefault(N,j){this.table.fill(N<<4|j)}add(N,j,X,ie){this.table[j<<8|N]=X<<4|ie}addMany(N,j,X,ie){for(let se=0;se<N.length;se++)this.table[j<<8|N[se]]=X<<4|ie}}j.TransitionTable=a;const ce=160;j.VT500_TRANSITION_TABLE=function(){const N=new a(4095),j=Array.apply(null,Array(256)).map(((N,j)=>j)),i=(N,X)=>j.slice(N,X),X=i(32,127),ie=i(0,24);ie.push(25),ie.push.apply(ie,i(28,32));const se=i(0,14);let le;for(le in N.setDefault(1,0),N.addMany(X,0,2,0),se)N.addMany([24,26,153,154],le,3,0),N.addMany(i(128,144),le,3,0),N.addMany(i(144,152),le,3,0),N.add(156,le,0,0),N.add(27,le,11,1),N.add(157,le,4,8),N.addMany([152,158,159],le,0,7),N.add(155,le,11,3),N.add(144,le,11,9);return N.addMany(ie,0,3,0),N.addMany(ie,1,3,1),N.add(127,1,0,1),N.addMany(ie,8,0,8),N.addMany(ie,3,3,3),N.add(127,3,0,3),N.addMany(ie,4,3,4),N.add(127,4,0,4),N.addMany(ie,6,3,6),N.addMany(ie,5,3,5),N.add(127,5,0,5),N.addMany(ie,2,3,2),N.add(127,2,0,2),N.add(93,1,4,8),N.addMany(X,8,5,8),N.add(127,8,5,8),N.addMany([156,27,24,26,7],8,6,0),N.addMany(i(28,32),8,0,8),N.addMany([88,94,95],1,0,7),N.addMany(X,7,0,7),N.addMany(ie,7,0,7),N.add(156,7,0,0),N.add(127,7,0,7),N.add(91,1,11,3),N.addMany(i(64,127),3,7,0),N.addMany(i(48,60),3,8,4),N.addMany([60,61,62,63],3,9,4),N.addMany(i(48,60),4,8,4),N.addMany(i(64,127),4,7,0),N.addMany([60,61,62,63],4,0,6),N.addMany(i(32,64),6,0,6),N.add(127,6,0,6),N.addMany(i(64,127),6,0,0),N.addMany(i(32,48),3,9,5),N.addMany(i(32,48),5,9,5),N.addMany(i(48,64),5,0,6),N.addMany(i(64,127),5,7,0),N.addMany(i(32,48),4,9,5),N.addMany(i(32,48),1,9,2),N.addMany(i(32,48),2,9,2),N.addMany(i(48,127),2,10,0),N.addMany(i(48,80),1,10,0),N.addMany(i(81,88),1,10,0),N.addMany([89,90,92],1,10,0),N.addMany(i(96,127),1,10,0),N.add(80,1,11,9),N.addMany(ie,9,0,9),N.add(127,9,0,9),N.addMany(i(28,32),9,0,9),N.addMany(i(32,48),9,9,12),N.addMany(i(48,60),9,8,10),N.addMany([60,61,62,63],9,9,10),N.addMany(ie,11,0,11),N.addMany(i(32,128),11,0,11),N.addMany(i(28,32),11,0,11),N.addMany(ie,10,0,10),N.add(127,10,0,10),N.addMany(i(28,32),10,0,10),N.addMany(i(48,60),10,8,10),N.addMany([60,61,62,63],10,0,11),N.addMany(i(32,48),10,9,12),N.addMany(ie,12,0,12),N.add(127,12,0,12),N.addMany(i(28,32),12,0,12),N.addMany(i(32,48),12,9,12),N.addMany(i(48,64),12,0,11),N.addMany(i(64,127),12,12,13),N.addMany(i(64,127),10,12,13),N.addMany(i(64,127),9,12,13),N.addMany(ie,13,13,13),N.addMany(X,13,13,13),N.add(127,13,0,13),N.addMany([27,156,24,26],13,14,0),N.add(ce,0,2,0),N.add(ce,8,5,8),N.add(ce,6,0,6),N.add(ce,11,0,11),N.add(ce,13,13,13),N}();class h extends ie.Disposable{constructor(N=j.VT500_TRANSITION_TABLE){super(),this._transitions=N,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new se.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(N,j,X)=>{},this._executeHandlerFb=N=>{},this._csiHandlerFb=(N,j)=>{},this._escHandlerFb=N=>{},this._errorHandlerFb=N=>N,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register((0,ie.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this._register(new le.OscParser),this._dcsParser=this._register(new he.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(N,j=[64,126]){let X=0;if(N.prefix){if(N.prefix.length>1)throw new Error("only one byte as prefix supported");if(X=N.prefix.charCodeAt(0),X&&60>X||X>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(N.intermediates){if(N.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let j=0;j<N.intermediates.length;++j){const ie=N.intermediates.charCodeAt(j);if(32>ie||ie>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");X<<=8,X|=ie}}if(1!==N.final.length)throw new Error("final must be a single byte");const ie=N.final.charCodeAt(0);if(j[0]>ie||ie>j[1])throw new Error(`final must be in range ${j[0]} .. ${j[1]}`);return X<<=8,X|=ie,X}identToString(N){const j=[];for(;N;)j.push(String.fromCharCode(255&N)),N>>=8;return j.reverse().join("")}setPrintHandler(N){this._printHandler=N}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(N,j){const X=this._identifier(N,[48,126]);void 0===this._escHandlers[X]&&(this._escHandlers[X]=[]);const ie=this._escHandlers[X];return ie.push(j),{dispose:()=>{const N=ie.indexOf(j);-1!==N&&ie.splice(N,1)}}}clearEscHandler(N){this._escHandlers[this._identifier(N,[48,126])]&&delete this._escHandlers[this._identifier(N,[48,126])]}setEscHandlerFallback(N){this._escHandlerFb=N}setExecuteHandler(N,j){this._executeHandlers[N.charCodeAt(0)]=j}clearExecuteHandler(N){this._executeHandlers[N.charCodeAt(0)]&&delete this._executeHandlers[N.charCodeAt(0)]}setExecuteHandlerFallback(N){this._executeHandlerFb=N}registerCsiHandler(N,j){const X=this._identifier(N);void 0===this._csiHandlers[X]&&(this._csiHandlers[X]=[]);const ie=this._csiHandlers[X];return ie.push(j),{dispose:()=>{const N=ie.indexOf(j);-1!==N&&ie.splice(N,1)}}}clearCsiHandler(N){this._csiHandlers[this._identifier(N)]&&delete this._csiHandlers[this._identifier(N)]}setCsiHandlerFallback(N){this._csiHandlerFb=N}registerDcsHandler(N,j){return this._dcsParser.registerHandler(this._identifier(N),j)}clearDcsHandler(N){this._dcsParser.clearHandler(this._identifier(N))}setDcsHandlerFallback(N){this._dcsParser.setHandlerFallback(N)}registerOscHandler(N,j){return this._oscParser.registerHandler(N,j)}clearOscHandler(N){this._oscParser.clearHandler(N)}setOscHandlerFallback(N){this._oscParser.setHandlerFallback(N)}setErrorHandler(N){this._errorHandler=N}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(N,j,X,ie,se){this._parseStack.state=N,this._parseStack.handlers=j,this._parseStack.handlerPos=X,this._parseStack.transition=ie,this._parseStack.chunkPos=se}parse(N,j,X){let ie,se=0,le=0,he=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,he=this._parseStack.chunkPos+1;else{if(void 0===X||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const j=this._parseStack.handlers;let le=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===X&&le>-1)for(;le>=0&&(ie=j[le](this._params),!0!==ie);le--)if(ie instanceof Promise)return this._parseStack.handlerPos=le,ie;this._parseStack.handlers=[];break;case 4:if(!1===X&&le>-1)for(;le>=0&&(ie=j[le](),!0!==ie);le--)if(ie instanceof Promise)return this._parseStack.handlerPos=le,ie;this._parseStack.handlers=[];break;case 6:if(se=N[this._parseStack.chunkPos],ie=this._dcsParser.unhook(24!==se&&26!==se,X),ie)return ie;27===se&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(se=N[this._parseStack.chunkPos],ie=this._oscParser.end(24!==se&&26!==se,X),ie)return ie;27===se&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,he=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let X=he;X<j;++X){switch(se=N[X],le=this._transitions.table[this.currentState<<8|(se<160?se:ce)],le>>4){case 2:for(let ie=X+1;;++ie){if(ie>=j||(se=N[ie])<32||se>126&&se<ce){this._printHandler(N,X,ie),X=ie-1;break}if(++ie>=j||(se=N[ie])<32||se>126&&se<ce){this._printHandler(N,X,ie),X=ie-1;break}if(++ie>=j||(se=N[ie])<32||se>126&&se<ce){this._printHandler(N,X,ie),X=ie-1;break}if(++ie>=j||(se=N[ie])<32||se>126&&se<ce){this._printHandler(N,X,ie),X=ie-1;break}}break;case 3:this._executeHandlers[se]?this._executeHandlers[se]():this._executeHandlerFb(se),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:X,code:se,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const he=this._csiHandlers[this._collect<<8|se];let _e=he?he.length-1:-1;for(;_e>=0&&(ie=he[_e](this._params),!0!==ie);_e--)if(ie instanceof Promise)return this._preserveStack(3,he,_e,le,X),ie;_e<0&&this._csiHandlerFb(this._collect<<8|se,this._params),this.precedingJoinState=0;break;case 8:do{switch(se){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(se-48)}}while(++X<j&&(se=N[X])>47&&se<60);X--;break;case 9:this._collect<<=8,this._collect|=se;break;case 10:const me=this._escHandlers[this._collect<<8|se];let ve=me?me.length-1:-1;for(;ve>=0&&(ie=me[ve](),!0!==ie);ve--)if(ie instanceof Promise)return this._preserveStack(4,me,ve,le,X),ie;ve<0&&this._escHandlerFb(this._collect<<8|se),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|se,this._params);break;case 13:for(let ie=X+1;;++ie)if(ie>=j||24===(se=N[ie])||26===se||27===se||se>127&&se<ce){this._dcsParser.put(N,X,ie),X=ie-1;break}break;case 14:if(ie=this._dcsParser.unhook(24!==se&&26!==se),ie)return this._preserveStack(6,[],0,le,X),ie;27===se&&(le|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let ie=X+1;;ie++)if(ie>=j||(se=N[ie])<32||se>127&&se<ce){this._oscParser.put(N,X,ie),X=ie-1;break}break;case 6:if(ie=this._oscParser.end(24!==se&&26!==se),ie)return this._preserveStack(5,[],0,le,X),ie;27===se&&(le|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&le}}}j.EscapeSequenceParser=h},1346:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.OscHandler=j.OscParser=void 0;const ie=X(1263),se=X(726),le=[];j.OscParser=class{constructor(){this._state=0,this._active=le,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(N,j){void 0===this._handlers[N]&&(this._handlers[N]=[]);const X=this._handlers[N];return X.push(j),{dispose:()=>{const N=X.indexOf(j);-1!==N&&X.splice(N,1)}}}clearHandler(N){this._handlers[N]&&delete this._handlers[N]}setHandlerFallback(N){this._handlerFb=N}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=le}reset(){if(2===this._state)for(let N=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;N>=0;--N)this._active[N].end(!1);this._stack.paused=!1,this._active=le,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||le,this._active.length)for(let N=this._active.length-1;N>=0;N--)this._active[N].start();else this._handlerFb(this._id,"START")}_put(N,j,X){if(this._active.length)for(let ie=this._active.length-1;ie>=0;ie--)this._active[ie].put(N,j,X);else this._handlerFb(this._id,"PUT",(0,se.utf32ToString)(N,j,X))}start(){this.reset(),this._state=1}put(N,j,X){if(3!==this._state){if(1===this._state)for(;j<X;){const X=N[j++];if(59===X){this._state=2,this._start();break}if(X<48||57<X)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+X-48}2===this._state&&X-j>0&&this._put(N,j,X)}}end(N,j=!0){if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){let X=!1,ie=this._active.length-1,se=!1;if(this._stack.paused&&(ie=this._stack.loopPosition-1,X=j,se=this._stack.fallThrough,this._stack.paused=!1),!se&&!1===X){for(;ie>=0&&(X=this._active[ie].end(N),!0!==X);ie--)if(X instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=ie,this._stack.fallThrough=!1,X;ie--}for(;ie>=0;ie--)if(X=this._active[ie].end(!1),X instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=ie,this._stack.fallThrough=!0,X}else this._handlerFb(this._id,"END",N);this._active=le,this._id=-1,this._state=0}}},j.OscHandler=class{constructor(N){this._handler=N,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(N,j,X){this._hitLimit||(this._data+=(0,se.utf32ToString)(N,j,X),this._data.length>ie.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(N){let j=!1;if(this._hitLimit)j=!1;else if(N&&(j=this._handler(this._data),j instanceof Promise))return j.then((N=>(this._data="",this._hitLimit=!1,N)));return this._data="",this._hitLimit=!1,j}}},7262:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Params=void 0;const X=2147483647;class s{static fromArray(N){const j=new s;if(!N.length)return j;for(let X=Array.isArray(N[0])?1:0;X<N.length;++X){const ie=N[X];if(Array.isArray(ie))for(let N=0;N<ie.length;++N)j.addSubParam(ie[N]);else j.addParam(ie)}return j}constructor(N=32,j=32){if(this.maxLength=N,this.maxSubParamsLength=j,j>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(N),this.length=0,this._subParams=new Int32Array(j),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(N),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const N=new s(this.maxLength,this.maxSubParamsLength);return N.params.set(this.params),N.length=this.length,N._subParams.set(this._subParams),N._subParamsLength=this._subParamsLength,N._subParamsIdx.set(this._subParamsIdx),N._rejectDigits=this._rejectDigits,N._rejectSubDigits=this._rejectSubDigits,N._digitIsSub=this._digitIsSub,N}toArray(){const N=[];for(let j=0;j<this.length;++j){N.push(this.params[j]);const X=this._subParamsIdx[j]>>8,ie=255&this._subParamsIdx[j];ie-X>0&&N.push(Array.prototype.slice.call(this._subParams,X,ie))}return N}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(N){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(N<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=N>X?X:N}}addSubParam(N){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(N<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=N>X?X:N,this._subParamsIdx[this.length-1]++}}hasSubParams(N){return(255&this._subParamsIdx[N])-(this._subParamsIdx[N]>>8)>0}getSubParams(N){const j=this._subParamsIdx[N]>>8,X=255&this._subParamsIdx[N];return X-j>0?this._subParams.subarray(j,X):null}getSubParamsAll(){const N={};for(let j=0;j<this.length;++j){const X=this._subParamsIdx[j]>>8,ie=255&this._subParamsIdx[j];ie-X>0&&(N[j]=this._subParams.slice(X,ie))}return N}addDigit(N){let j;if(this._rejectDigits||!(j=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const ie=this._digitIsSub?this._subParams:this.params,se=ie[j-1];ie[j-1]=~se?Math.min(10*se+N,X):N}}j.Params=s},3027:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.AddonManager=void 0,j.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let N=this._addons.length-1;N>=0;N--)this._addons[N].instance.dispose()}loadAddon(N,j){const X={instance:j,dispose:j.dispose,isDisposed:!1};this._addons.push(X),j.dispose=()=>this._wrappedAddonDispose(X),j.activate(N)}_wrappedAddonDispose(N){if(N.isDisposed)return;let j=-1;for(let X=0;X<this._addons.length;X++)if(this._addons[X]===N){j=X;break}if(-1===j)throw new Error("Could not dispose an addon that has not been loaded");N.isDisposed=!0,N.dispose.apply(N.instance),this._addons.splice(j,1)}}},3235:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BufferApiView=void 0;const ie=X(793),se=X(3055);j.BufferApiView=class{constructor(N,j){this._buffer=N,this.type=j}init(N){return this._buffer=N,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(N){const j=this._buffer.lines.get(N);if(j)return new ie.BufferLineApiView(j)}getNullCell(){return new se.CellData}}},793:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BufferLineApiView=void 0;const ie=X(3055);j.BufferLineApiView=class{constructor(N){this._line=N}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(N,j){if(!(N<0||N>=this._line.length))return j?(this._line.loadCell(N,j),j):this._line.loadCell(N,new ie.CellData)}translateToString(N,j,X){return this._line.translateToString(N,j,X)}}},5101:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BufferNamespaceApi=void 0;const ie=X(3235),se=X(7150),le=X(802);class o extends se.Disposable{constructor(N){super(),this._core=N,this._onBufferChange=this._register(new le.Emitter),this.onBufferChange=this._onBufferChange.event,this._normal=new ie.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new ie.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}j.BufferNamespaceApi=o},6097:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ParserApi=void 0,j.ParserApi=class{constructor(N){this._core=N}registerCsiHandler(N,j){return this._core.registerCsiHandler(N,(N=>j(N.toArray())))}addCsiHandler(N,j){return this.registerCsiHandler(N,j)}registerDcsHandler(N,j){return this._core.registerDcsHandler(N,((N,X)=>j(N,X.toArray())))}addDcsHandler(N,j){return this.registerDcsHandler(N,j)}registerEscHandler(N,j){return this._core.registerEscHandler(N,j)}addEscHandler(N,j){return this.registerEscHandler(N,j)}registerOscHandler(N,j){return this._core.registerOscHandler(N,j)}addOscHandler(N,j){return this.registerOscHandler(N,j)}}},4335:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.UnicodeApi=void 0,j.UnicodeApi=class{constructor(N){this._core=N}register(N){this._core.unicodeService.register(N)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(N){this._core.unicodeService.activeVersion=N}}},9640:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.BufferService=j.MINIMUM_ROWS=j.MINIMUM_COLS=void 0;const le=X(7150),he=X(4097),ce=X(6501),_e=X(802);j.MINIMUM_COLS=2,j.MINIMUM_ROWS=1;let me=class extends le.Disposable{get buffer(){return this.buffers.active}constructor(N){super(),this.isUserScrolling=!1,this._onResize=this._register(new _e.Emitter),this.onResize=this._onResize.event,this._onScroll=this._register(new _e.Emitter),this.onScroll=this._onScroll.event,this.cols=Math.max(N.rawOptions.cols||0,j.MINIMUM_COLS),this.rows=Math.max(N.rawOptions.rows||0,j.MINIMUM_ROWS),this.buffers=this._register(new he.BufferSet(N,this))}resize(N,j){this.cols=N,this.rows=j,this.buffers.resize(N,j),this._onResize.fire({cols:N,rows:j})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(N,j=!1){const X=this.buffer;let ie;ie=this._cachedBlankLine,ie&&ie.length===this.cols&&ie.getFg(0)===N.fg&&ie.getBg(0)===N.bg||(ie=X.getBlankLine(N,j),this._cachedBlankLine=ie),ie.isWrapped=j;const se=X.ybase+X.scrollTop,le=X.ybase+X.scrollBottom;if(0===X.scrollTop){const N=X.lines.isFull;le===X.lines.length-1?N?X.lines.recycle().copyFrom(ie):X.lines.push(ie.clone()):X.lines.splice(le+1,0,ie.clone()),N?this.isUserScrolling&&(X.ydisp=Math.max(X.ydisp-1,0)):(X.ybase++,this.isUserScrolling||X.ydisp++)}else{const N=le-se+1;X.lines.shiftElements(se+1,N-1,-1),X.lines.set(le,ie.clone())}this.isUserScrolling||(X.ydisp=X.ybase),this._onScroll.fire(X.ydisp)}scrollLines(N,j){const X=this.buffer;if(N<0){if(0===X.ydisp)return;this.isUserScrolling=!0}else N+X.ydisp>=X.ybase&&(this.isUserScrolling=!1);const ie=X.ydisp;X.ydisp=Math.max(Math.min(X.ydisp+N,X.ybase),0),ie!==X.ydisp&&(j||this._onScroll.fire(X.ydisp))}};j.BufferService=me,j.BufferService=me=ie([se(0,ce.IOptionsService)],me)},5746:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CharsetService=void 0,j.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(N){this.glevel=N,this.charset=this._charsets[N]}setgCharset(N,j){this._charsets[N]=j,this.glevel===N&&(this.charset=j)}}},7792:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.CoreMouseService=void 0;const le=X(6501),he=X(7150),ce=X(802),_e={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:N=>4!==N.button&&1===N.action&&(N.ctrl=!1,N.alt=!1,N.shift=!1,!0)},VT200:{events:19,restrict:N=>32!==N.action},DRAG:{events:23,restrict:N=>32!==N.action||3!==N.button},ANY:{events:31,restrict:N=>!0}};function h(N,j){let X=(N.ctrl?16:0)|(N.shift?4:0)|(N.alt?8:0);return 4===N.button?(X|=64,X|=N.action):(X|=3&N.button,4&N.button&&(X|=64),8&N.button&&(X|=128),32===N.action?X|=32:0!==N.action||j||(X|=3)),X}const me=String.fromCharCode,ve={DEFAULT:N=>{const j=[h(N,!1)+32,N.col+32,N.row+32];return j[0]>255||j[1]>255||j[2]>255?"":`[M${me(j[0])}${me(j[1])}${me(j[2])}`},SGR:N=>{const j=0===N.action&&4!==N.button?"m":"M";return`[<${h(N,!0)};${N.col};${N.row}${j}`},SGR_PIXELS:N=>{const j=0===N.action&&4!==N.button?"m":"M";return`[<${h(N,!0)};${N.x};${N.y}${j}`}};let Se=class extends he.Disposable{constructor(N,j){super(),this._bufferService=N,this._coreService=j,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this._register(new ce.Emitter),this.onProtocolChange=this._onProtocolChange.event;for(const N of Object.keys(_e))this.addProtocol(N,_e[N]);for(const N of Object.keys(ve))this.addEncoding(N,ve[N]);this.reset()}addProtocol(N,j){this._protocols[N]=j}addEncoding(N,j){this._encodings[N]=j}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return 0!==this._protocols[this._activeProtocol].events}set activeProtocol(N){if(!this._protocols[N])throw new Error(`unknown protocol "${N}"`);this._activeProtocol=N,this._onProtocolChange.fire(this._protocols[N].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(N){if(!this._encodings[N])throw new Error(`unknown encoding "${N}"`);this._activeEncoding=N}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(N){if(N.col<0||N.col>=this._bufferService.cols||N.row<0||N.row>=this._bufferService.rows)return!1;if(4===N.button&&32===N.action)return!1;if(3===N.button&&32!==N.action)return!1;if(4!==N.button&&(2===N.action||3===N.action))return!1;if(N.col++,N.row++,32===N.action&&this._lastEvent&&this._equalEvents(this._lastEvent,N,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(N))return!1;const j=this._encodings[this._activeEncoding](N);return j&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(j):this._coreService.triggerDataEvent(j,!0)),this._lastEvent=N,!0}explainEvents(N){return{down:!!(1&N),up:!!(2&N),drag:!!(4&N),move:!!(8&N),wheel:!!(16&N)}}_equalEvents(N,j,X){if(X){if(N.x!==j.x)return!1;if(N.y!==j.y)return!1}else{if(N.col!==j.col)return!1;if(N.row!==j.row)return!1}return N.button===j.button&&N.action===j.action&&N.ctrl===j.ctrl&&N.alt===j.alt&&N.shift===j.shift}};j.CoreMouseService=Se,j.CoreMouseService=Se=ie([se(0,le.IBufferService),se(1,le.ICoreService)],Se)},4071:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.CoreService=void 0;const le=X(7453),he=X(7150),ce=X(6501),_e=X(802),me=Object.freeze({insertMode:!1}),ve=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let Se=class extends he.Disposable{constructor(N,j,X){super(),this._bufferService=N,this._logService=j,this._optionsService=X,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new _e.Emitter),this.onData=this._onData.event,this._onUserInput=this._register(new _e.Emitter),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new _e.Emitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new _e.Emitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,le.clone)(me),this.decPrivateModes=(0,le.clone)(ve)}reset(){this.modes=(0,le.clone)(me),this.decPrivateModes=(0,le.clone)(ve)}triggerDataEvent(N,j=!1){if(this._optionsService.rawOptions.disableStdin)return;const X=this._bufferService.buffer;j&&this._optionsService.rawOptions.scrollOnUserInput&&X.ybase!==X.ydisp&&this._onRequestScrollToBottom.fire(),j&&this._onUserInput.fire(),this._logService.debug(`sending data "${N}"`,(()=>N.split("").map((N=>N.charCodeAt(0))))),this._onData.fire(N)}triggerBinaryEvent(N){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${N}"`,(()=>N.split("").map((N=>N.charCodeAt(0))))),this._onBinary.fire(N))}};j.CoreService=Se,j.CoreService=Se=ie([se(0,ce.IBufferService),se(1,ce.ILogService),se(2,ce.IOptionsService)],Se)},4720:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DecorationService=void 0;const ie=X(4103),se=X(7150),le=X(3087),he=X(802);let ce=0,_e=0;class h extends se.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new le.SortedList((N=>N?.marker.line)),this._onDecorationRegistered=this._register(new he.Emitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new he.Emitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register((0,se.toDisposable)((()=>this.reset())))}registerDecoration(N){if(N.marker.isDisposed)return;const j=new c(N);if(j){const N=j.marker.onDispose((()=>j.dispose())),X=j.onDispose((()=>{X.dispose(),j&&(this._decorations.delete(j)&&this._onDecorationRemoved.fire(j),N.dispose())}));this._decorations.insert(j),this._onDecorationRegistered.fire(j)}return j}reset(){for(const N of this._decorations.values())N.dispose();this._decorations.clear()}*getDecorationsAtCell(N,j,X){let ie=0,se=0;for(const le of this._decorations.getKeyIterator(j))ie=le.options.x??0,se=ie+(le.options.width??1),N>=ie&&N<se&&(!X||(le.options.layer??"bottom")===X)&&(yield le)}forEachDecorationAtCell(N,j,X,ie){this._decorations.forEachByKey(j,(j=>{ce=j.options.x??0,_e=ce+(j.options.width??1),N>=ce&&N<_e&&(!X||(j.options.layer??"bottom")===X)&&ie(j)}))}}j.DecorationService=h;class c extends se.DisposableStore{get backgroundColorRGB(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=ie.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=ie.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(N){super(),this.options=N,this.onRenderEmitter=this.add(new he.Emitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new he.Emitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=N.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},6025:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.InstantiationService=j.ServiceCollection=void 0;const ie=X(6501),se=X(6201);class n{constructor(...N){this._entries=new Map;for(const[j,X]of N)this.set(j,X)}set(N,j){const X=this._entries.get(N);return this._entries.set(N,j),X}forEach(N){for(const[j,X]of this._entries.entries())N(j,X)}has(N){return this._entries.has(N)}get(N){return this._entries.get(N)}}j.ServiceCollection=n,j.InstantiationService=class{constructor(){this._services=new n,this._services.set(ie.IInstantiationService,this)}setService(N,j){this._services.set(N,j)}getService(N){return this._services.get(N)}createInstance(N,...j){const X=(0,se.getServiceDependencies)(N).sort(((N,j)=>N.index-j.index)),ie=[];for(const j of X){const X=this._services.get(j.id);if(!X)throw new Error(`[createInstance] ${N.name} depends on UNKNOWN service ${j.id}.`);ie.push(X)}const le=X.length>0?X[0].index:j.length;if(j.length!==le)throw new Error(`[createInstance] First service dependency of ${N.name} at position ${le+1} conflicts with ${j.length} static arguments`);return new N(...[...j,...ie])}}},7276:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.LogService=void 0,j.setTraceLogger=function(N){_e=N},j.traceCall=function(N,j,X){if("function"!=typeof X.value)throw new Error("not supported");const ie=X.value;X.value=function(...N){if(_e.logLevel!==he.LogLevelEnum.TRACE)return ie.apply(this,N);_e.trace(`GlyphRenderer#${ie.name}(${N.map((N=>JSON.stringify(N))).join(", ")})`);const j=ie.apply(this,N);return _e.trace(`GlyphRenderer#${ie.name} return`,j),j}};const le=X(7150),he=X(6501),ce={trace:he.LogLevelEnum.TRACE,debug:he.LogLevelEnum.DEBUG,info:he.LogLevelEnum.INFO,warn:he.LogLevelEnum.WARN,error:he.LogLevelEnum.ERROR,off:he.LogLevelEnum.OFF};let _e,me=class extends le.Disposable{get logLevel(){return this._logLevel}constructor(N){super(),this._optionsService=N,this._logLevel=he.LogLevelEnum.OFF,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel()))),_e=this}_updateLogLevel(){this._logLevel=ce[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(N){for(let j=0;j<N.length;j++)"function"==typeof N[j]&&(N[j]=N[j]())}_log(N,j,X){this._evalLazyOptionalParams(X),N.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+j,...X)}trace(N,...j){this._logLevel<=he.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,N,j)}debug(N,...j){this._logLevel<=he.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,N,j)}info(N,...j){this._logLevel<=he.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,N,j)}warn(N,...j){this._logLevel<=he.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,N,j)}error(N,...j){this._logLevel<=he.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,N,j)}};j.LogService=me,j.LogService=me=ie([se(0,he.IOptionsService)],me)},56:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.OptionsService=j.DEFAULT_OPTIONS=void 0;const ie=X(7150),se=X(701),le=X(802);j.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:se.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}};const he=["normal","bold","100","200","300","400","500","600","700","800","900"];class a extends ie.Disposable{constructor(N){super(),this._onOptionChange=this._register(new le.Emitter),this.onOptionChange=this._onOptionChange.event;const X={...j.DEFAULT_OPTIONS};for(const j in N)if(j in X)try{const ie=N[j];X[j]=this._sanitizeAndValidateOption(j,ie)}catch(N){console.error(N)}this.rawOptions=X,this.options={...X},this._setupOptions(),this._register((0,ie.toDisposable)((()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null})))}onSpecificOptionChange(N,j){return this.onOptionChange((X=>{X===N&&j(this.rawOptions[N])}))}onMultipleOptionChange(N,j){return this.onOptionChange((X=>{-1!==N.indexOf(X)&&j()}))}_setupOptions(){const e=N=>{if(!(N in j.DEFAULT_OPTIONS))throw new Error(`No option with key "${N}"`);return this.rawOptions[N]},i=(N,X)=>{if(!(N in j.DEFAULT_OPTIONS))throw new Error(`No option with key "${N}"`);X=this._sanitizeAndValidateOption(N,X),this.rawOptions[N]!==X&&(this.rawOptions[N]=X,this._onOptionChange.fire(N))};for(const N in this.rawOptions){const j={get:e.bind(this,N),set:i.bind(this,N)};Object.defineProperty(this.options,N,j)}}_sanitizeAndValidateOption(N,X){switch(N){case"cursorStyle":if(X||(X=j.DEFAULT_OPTIONS[N]),!function(N){return"block"===N||"underline"===N||"bar"===N}(X))throw new Error(`"${X}" is not a valid value for ${N}`);break;case"wordSeparator":X||(X=j.DEFAULT_OPTIONS[N]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof X&&1<=X&&X<=1e3)break;X=he.includes(X)?X:j.DEFAULT_OPTIONS[N];break;case"cursorWidth":X=Math.floor(X);case"lineHeight":case"tabStopWidth":if(X<1)throw new Error(`${N} cannot be less than 1, value: ${X}`);break;case"minimumContrastRatio":X=Math.max(1,Math.min(21,Math.round(10*X)/10));break;case"scrollback":if((X=Math.min(X,4294967295))<0)throw new Error(`${N} cannot be less than 0, value: ${X}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(X<=0)throw new Error(`${N} cannot be less than or equal to 0, value: ${X}`);break;case"rows":case"cols":if(!X&&0!==X)throw new Error(`${N} must be numeric, value: ${X}`);break;case"windowsPty":X=X??{}}return X}}j.OptionsService=a},8811:function(N,j,X){var ie=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},se=this&&this.__param||function(N,j){return function(X,ie){j(X,ie,N)}};Object.defineProperty(j,"__esModule",{value:!0}),j.OscLinkService=void 0;const le=X(6501);let he=class{constructor(N){this._bufferService=N,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(N){const j=this._bufferService.buffer;if(void 0===N.id){const X=j.addMarker(j.ybase+j.y),ie={data:N,id:this._nextId++,lines:[X]};return X.onDispose((()=>this._removeMarkerFromLink(ie,X))),this._dataByLinkId.set(ie.id,ie),ie.id}const X=N,ie=this._getEntryIdKey(X),se=this._entriesWithId.get(ie);if(se)return this.addLineToLink(se.id,j.ybase+j.y),se.id;const le=j.addMarker(j.ybase+j.y),he={id:this._nextId++,key:this._getEntryIdKey(X),data:X,lines:[le]};return le.onDispose((()=>this._removeMarkerFromLink(he,le))),this._entriesWithId.set(he.key,he),this._dataByLinkId.set(he.id,he),he.id}addLineToLink(N,j){const X=this._dataByLinkId.get(N);if(X&&X.lines.every((N=>N.line!==j))){const N=this._bufferService.buffer.addMarker(j);X.lines.push(N),N.onDispose((()=>this._removeMarkerFromLink(X,N)))}}getLinkData(N){return this._dataByLinkId.get(N)?.data}_getEntryIdKey(N){return`${N.id};;${N.uri}`}_removeMarkerFromLink(N,j){const X=N.lines.indexOf(j);-1!==X&&(N.lines.splice(X,1),0===N.lines.length&&(void 0!==N.data.id&&this._entriesWithId.delete(N.key),this._dataByLinkId.delete(N.id)))}};j.OscLinkService=he,j.OscLinkService=he=ie([se(0,le.IBufferService)],he)},6201:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.serviceRegistry=void 0,j.getServiceDependencies=function(N){return N[ie]||[]},j.createDecorator=function(N){if(j.serviceRegistry.has(N))return j.serviceRegistry.get(N);const r=function(N,j,se){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(N,j,se){j[X]===j?j[ie].push({id:N,index:se}):(j[ie]=[{id:N,index:se}],j[X]=j)}(r,N,se)};return r.toString=()=>N,j.serviceRegistry.set(N,r),r};const X="di$target",ie="di$dependencies";j.serviceRegistry=new Map},6501:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.IDecorationService=j.IUnicodeService=j.IOscLinkService=j.IOptionsService=j.ILogService=j.LogLevelEnum=j.IInstantiationService=j.ICharsetService=j.ICoreService=j.ICoreMouseService=j.IBufferService=void 0;const ie=X(6201);var se;j.IBufferService=(0,ie.createDecorator)("BufferService"),j.ICoreMouseService=(0,ie.createDecorator)("CoreMouseService"),j.ICoreService=(0,ie.createDecorator)("CoreService"),j.ICharsetService=(0,ie.createDecorator)("CharsetService"),j.IInstantiationService=(0,ie.createDecorator)("InstantiationService"),function(N){N[N.TRACE=0]="TRACE",N[N.DEBUG=1]="DEBUG",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.OFF=5]="OFF"}(se||(j.LogLevelEnum=se={})),j.ILogService=(0,ie.createDecorator)("LogService"),j.IOptionsService=(0,ie.createDecorator)("OptionsService"),j.IOscLinkService=(0,ie.createDecorator)("OscLinkService"),j.IUnicodeService=(0,ie.createDecorator)("UnicodeService"),j.IDecorationService=(0,ie.createDecorator)("DecorationService")},6415:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.UnicodeService=void 0;const ie=X(7428),se=X(802);class n{static extractShouldJoin(N){return!!(1&N)}static extractWidth(N){return N>>1&3}static extractCharKind(N){return N>>3}static createPropertyValue(N,j,X=!1){return(16777215&N)<<3|(3&j)<<1|(X?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new se.Emitter,this.onChange=this._onChange.event;const N=new ie.UnicodeV6;this.register(N),this._active=N.version,this._activeProvider=N}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(N){if(!this._providers[N])throw new Error(`unknown Unicode version "${N}"`);this._active=N,this._activeProvider=this._providers[N],this._onChange.fire(N)}register(N){this._providers[N.version]=N}wcwidth(N){return this._activeProvider.wcwidth(N)}getStringCellWidth(N){let j=0,X=0;const ie=N.length;for(let se=0;se<ie;++se){let le=N.charCodeAt(se);if(55296<=le&&le<=56319){if(++se>=ie)return j+this.wcwidth(le);const X=N.charCodeAt(se);56320<=X&&X<=57343?le=1024*(le-55296)+X-56320+65536:j+=this.wcwidth(X)}const he=this.charProperties(le,X);let ce=n.extractWidth(he);n.extractShouldJoin(he)&&(ce-=n.extractWidth(X)),j+=ce,X=he}return j}charProperties(N,j){return this._activeProvider.charProperties(N,j)}}j.UnicodeService=n},4333:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.isAndroid=j.isElectron=j.isWebkitWebView=j.isSafari=j.isChrome=j.isWebKit=j.isFirefox=j.onDidChangeFullscreen=j.onDidChangeZoomLevel=void 0,j.addMatchMediaChangeListener=o,j.setZoomLevel=function(N,j){n.INSTANCE.setZoomLevel(N,j)},j.getZoomLevel=function(N){return n.INSTANCE.getZoomLevel(N)},j.getZoomFactor=function(N){return n.INSTANCE.getZoomFactor(N)},j.setZoomFactor=function(N,j){n.INSTANCE.setZoomFactor(N,j)},j.setFullscreen=function(N,j){n.INSTANCE.setFullscreen(N,j)},j.isFullscreen=function(N){return n.INSTANCE.isFullscreen(N)},j.isStandalone=function(){return he},j.isWCOEnabled=function(){return navigator?.windowControlsOverlay?.visible},j.getWCOBoundingRect=function(){return navigator?.windowControlsOverlay?.getTitlebarAreaRect()};const ie=X(4693),se=X(802);class n{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new se.Emitter,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new se.Emitter,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}static{this.INSTANCE=new n}getZoomLevel(N){return this.mapWindowIdToZoomLevel.get(this.getWindowId(N))??0}setZoomLevel(N,j){if(this.getZoomLevel(j)===N)return;const X=this.getWindowId(j);this.mapWindowIdToZoomLevel.set(X,N),this._onDidChangeZoomLevel.fire(X)}getZoomFactor(N){return this.mapWindowIdToZoomFactor.get(this.getWindowId(N))??1}setZoomFactor(N,j){this.mapWindowIdToZoomFactor.set(this.getWindowId(j),N)}setFullscreen(N,j){if(this.isFullscreen(j)===N)return;const X=this.getWindowId(j);this.mapWindowIdToFullScreen.set(X,N),this._onDidChangeFullscreen.fire(X)}isFullscreen(N){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(N))}getWindowId(N){return N.vscodeWindowId}}function o(N,j,X){"string"==typeof j&&(j=N.matchMedia(j)),j.addEventListener("change",X)}j.onDidChangeZoomLevel=n.INSTANCE.onDidChangeZoomLevel,j.onDidChangeFullscreen=n.INSTANCE.onDidChangeFullscreen;const le="object"==typeof navigator?navigator.userAgent:"";j.isFirefox=le.indexOf("Firefox")>=0,j.isWebKit=le.indexOf("AppleWebKit")>=0,j.isChrome=le.indexOf("Chrome")>=0,j.isSafari=!j.isChrome&&le.indexOf("Safari")>=0,j.isWebkitWebView=!j.isChrome&&!j.isSafari&&j.isWebKit,j.isElectron=le.indexOf("Electron/")>=0,j.isAndroid=le.indexOf("Android")>=0;let he=!1;if("function"==typeof ie.mainWindow.matchMedia){const N=ie.mainWindow.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),j=ie.mainWindow.matchMedia("(display-mode: fullscreen)");he=N.matches,o(ie.mainWindow,N,(({matches:N})=>{he&&j.matches||(he=N)}))}},7745:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.BrowserFeatures=j.KeyboardSupport=void 0;const he=le(X(4333)),ce=X(4693),_e=le(X(8163));var me;!function(N){N[N.Always=0]="Always",N[N.FullScreen=1]="FullScreen",N[N.None=2]="None"}(me||(j.KeyboardSupport=me={}));const ve="object"==typeof navigator?navigator:{};j.BrowserFeatures={clipboard:{writeText:_e.isNative||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(ve&&ve.clipboard&&ve.clipboard.writeText),readText:_e.isNative||!!(ve&&ve.clipboard&&ve.clipboard.readText)},keyboard:_e.isNative||he.isStandalone()?me.Always:ve.keyboard||he.isSafari?me.FullScreen:me.None,touch:"ontouchstart"in ce.mainWindow||ve.maxTouchPoints>0,pointerEvents:ce.mainWindow.PointerEvent&&("ontouchstart"in ce.mainWindow||navigator.maxTouchPoints>0)}},7093:function(N,j,X){var ie,se=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),le=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),he=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&se(j,N,X);return le(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.SafeTriangle=j.DragAndDropObserver=j.ModifierKeyEmitter=j.DetectedFullscreenMode=j.Namespace=j.EventHelper=j.EventType=j.sharedMutationObserver=j.Dimension=j.WindowIntervalTimer=j.scheduleAtNextAnimationFrame=j.runAtThisOrScheduleAtNextAnimationFrame=j.WindowIdleValue=j.addStandardDisposableGenericMouseUpListener=j.addStandardDisposableGenericMouseDownListener=j.addStandardDisposableListener=j.onDidUnregisterWindow=j.onWillUnregisterWindow=j.onDidRegisterWindow=j.hasWindow=j.getWindowById=j.getWindowId=j.getWindowsCount=j.getWindows=j.getDocument=j.getWindow=j.registerWindow=void 0,j.clearNode=function(N){for(;N.firstChild;)N.firstChild.remove()},j.clearNodeRecursively=function e(N){for(;N.firstChild;){const j=N.firstChild;j.remove(),e(j)}},j.addDisposableListener=C,j.addDisposableGenericMouseDownListener=w,j.addDisposableGenericMouseMoveListener=function(N,X,ie){return C(N,Ee.isIOS&&_e.BrowserFeatures.pointerEvents?j.EventType.POINTER_MOVE:j.EventType.MOUSE_MOVE,X,ie)},j.addDisposableGenericMouseUpListener=E,j.runWhenWindowIdle=function(N,j,X){return(0,Se._runWhenIdle)(N,j,X)},j.disposableWindowInterval=function(N,j,X,ie){let se=0;const le=N.setInterval((()=>{se++,("number"==typeof ie&&se>=ie||!0===j())&&he.dispose()}),X),he=(0,we.toDisposable)((()=>{N.clearInterval(le)}));return he},j.measure=function(N,X){return(0,j.scheduleAtNextAnimationFrame)(N,X,1e4)},j.modify=function(N,X){return(0,j.scheduleAtNextAnimationFrame)(N,X,-1e4)},j.addDisposableThrottledListener=function(N,j,X,ie,se){return new T(N,j,X,ie,se)},j.getComputedStyle=k,j.getClientArea=function e(N,X){const ie=(0,j.getWindow)(N),se=ie.document;if(N!==se.body)return new O(N.clientWidth,N.clientHeight);if(Ee.isIOS&&ie?.visualViewport)return new O(ie.visualViewport.width,ie.visualViewport.height);if(ie?.innerWidth&&ie.innerHeight)return new O(ie.innerWidth,ie.innerHeight);if(se.body&&se.body.clientWidth&&se.body.clientHeight)return new O(se.body.clientWidth,se.body.clientHeight);if(se.documentElement&&se.documentElement.clientWidth&&se.documentElement.clientHeight)return new O(se.documentElement.clientWidth,se.documentElement.clientHeight);if(X)return e(X);throw new Error("Unable to figure out browser width and height")},j.getTopLeftOffset=I,j.size=function(N,j,X){"number"==typeof j&&(N.style.width=`${j}px`),"number"==typeof X&&(N.style.height=`${X}px`)},j.position=function(N,j,X,ie,se,le="absolute"){"number"==typeof j&&(N.style.top=`${j}px`),"number"==typeof X&&(N.style.right=`${X}px`),"number"==typeof ie&&(N.style.bottom=`${ie}px`),"number"==typeof se&&(N.style.left=`${se}px`),N.style.position=le},j.getDomNodePagePosition=function(N){const X=N.getBoundingClientRect(),ie=(0,j.getWindow)(N);return{left:X.left+ie.scrollX,top:X.top+ie.scrollY,width:X.width,height:X.height}},j.getDomNodeZoomLevel=function(N){let j=N,X=1;do{const N=k(j).zoom;null!=N&&"1"!==N&&(X*=N),j=j.parentElement}while(null!==j&&j!==j.ownerDocument.documentElement);return X},j.getTotalWidth=P,j.getContentWidth=function(N){const j=M.getBorderLeftWidth(N)+M.getBorderRightWidth(N),X=M.getPaddingLeft(N)+M.getPaddingRight(N);return N.offsetWidth-j-X},j.getTotalScrollWidth=x,j.getContentHeight=function(N){const j=M.getBorderTopWidth(N)+M.getBorderBottomWidth(N),X=M.getPaddingTop(N)+M.getPaddingBottom(N);return N.offsetHeight-j-X},j.getTotalHeight=function(N){const j=M.getMarginTop(N)+M.getMarginBottom(N);return N.offsetHeight+j},j.getLargestChildWidth=function(N,j){const X=j.map((j=>Math.max(x(j),P(j))+function(N,j){if(null===N)return 0;const X=I(N),ie=I(j);return X.left-ie.left}(j,N)||0));return Math.max(...X)},j.isAncestor=B,j.setParentFlowTo=function(N,j){N.dataset[Re]=j.id},j.isAncestorUsingFlowTo=function(N,j){let X=N;for(;X;){if(X===j)return!0;if(Q(X)){const N=U(X);if(N){X=N;continue}}X=X.parentNode}return!1},j.findParentWithClass=F,j.hasParentWithClass=function(N,j,X){return!!F(N,j,X)},j.isShadowRoot=W,j.isInShadowDOM=function(N){return!!H(N)},j.getShadowRoot=H,j.getActiveElement=K,j.isActiveElement=function(N){return K()===N},j.isAncestorOfActiveElement=function(N){return B(K(),N)},j.isActiveDocument=function(N){return N.ownerDocument===z()},j.getActiveDocument=z,j.getActiveWindow=function(){const N=z();return N.defaultView?.window??Le.mainWindow},j.isGlobalStylesheet=function(N){return Te.has(N)},j.createStyleSheet2=function(){return new $},j.createStyleSheet=V,j.cloneGlobalStylesheets=function(N){const j=new we.DisposableStore;for(const[X,ie]of Te)j.add(G(X,ie,N));return j},j.createMetaElement=function(N=Le.mainWindow.document.head){return q("meta",N)},j.createLinkElement=function(N=Le.mainWindow.document.head){return q("link",N)},j.createCSSRule=function e(N,j,X=Y()){if(X&&j){X.sheet?.insertRule(`${N} {${j}}`,0);for(const ie of Te.get(X)??[])e(N,j,ie)}},j.removeCSSRulesContainingSelector=function e(N,j=Y()){if(!j)return;const X=Z(j),ie=[];for(let j=0;j<X.length;j++){const se=X[j];J(se)&&-1!==se.selectorText.indexOf(N)&&ie.push(j)}for(let N=ie.length-1;N>=0;N--)j.sheet?.deleteRule(ie[N]);for(const X of Te.get(j)??[])e(N,X)},j.isHTMLElement=Q,j.isHTMLAnchorElement=function(N){return N instanceof HTMLAnchorElement||N instanceof(0,j.getWindow)(N).HTMLAnchorElement},j.isHTMLSpanElement=function(N){return N instanceof HTMLSpanElement||N instanceof(0,j.getWindow)(N).HTMLSpanElement},j.isHTMLTextAreaElement=function(N){return N instanceof HTMLTextAreaElement||N instanceof(0,j.getWindow)(N).HTMLTextAreaElement},j.isHTMLInputElement=function(N){return N instanceof HTMLInputElement||N instanceof(0,j.getWindow)(N).HTMLInputElement},j.isHTMLButtonElement=function(N){return N instanceof HTMLButtonElement||N instanceof(0,j.getWindow)(N).HTMLButtonElement},j.isHTMLDivElement=function(N){return N instanceof HTMLDivElement||N instanceof(0,j.getWindow)(N).HTMLDivElement},j.isSVGElement=function(N){return N instanceof SVGElement||N instanceof(0,j.getWindow)(N).SVGElement},j.isMouseEvent=function(N){return N instanceof MouseEvent||N instanceof(0,j.getWindow)(N).MouseEvent},j.isKeyboardEvent=function(N){return N instanceof KeyboardEvent||N instanceof(0,j.getWindow)(N).KeyboardEvent},j.isPointerEvent=function(N){return N instanceof PointerEvent||N instanceof(0,j.getWindow)(N).PointerEvent},j.isDragEvent=function(N){return N instanceof DragEvent||N instanceof(0,j.getWindow)(N).DragEvent},j.isEventLike=function(N){const j=N;return!(!j||"function"!=typeof j.preventDefault||"function"!=typeof j.stopPropagation)},j.saveParentsScrollTop=function(N){const j=[];for(let X=0;N&&N.nodeType===N.ELEMENT_NODE;X++)j[X]=N.scrollTop,N=N.parentNode;return j},j.restoreParentsScrollTop=function(N,j){for(let X=0;N&&N.nodeType===N.ELEMENT_NODE;X++)N.scrollTop!==j[X]&&(N.scrollTop=j[X]),N=N.parentNode},j.trackFocus=function(N){return new ee(N)},j.after=function(N,j){return N.after(j),j},j.append=te,j.prepend=function(N,j){return N.insertBefore(j,N.firstChild),j},j.reset=function(N,...j){N.innerText="",te(N,...j)},j.$=ne,j.join=function(N,j){const X=[];return N.forEach(((N,ie)=>{ie>0&&(j instanceof Node?X.push(j.cloneNode()):X.push(document.createTextNode(j))),X.push(N)})),X},j.setVisibility=function(N,...j){N?oe(...j):ae(...j)},j.show=oe,j.hide=ae,j.removeTabIndexAndUpdateFocus=function(N){if(N&&N.hasAttribute("tabIndex")){if(N.ownerDocument.activeElement===N){const j=function(N){for(;N&&N.nodeType===N.ELEMENT_NODE;){if(Q(N)&&N.hasAttribute("tabIndex"))return N;N=N.parentNode}return null}(N.parentElement);j?.focus()}N.removeAttribute("tabindex")}},j.finalHandler=function(N){return j=>{j.preventDefault(),j.stopPropagation(),N(j)}},j.domContentLoaded=function(N){return new Promise((j=>{if("complete"===N.document.readyState||N.document&&null!==N.document.body)j(void 0);else{const i=()=>{N.window.removeEventListener("DOMContentLoaded",i,!1),j()};N.window.addEventListener("DOMContentLoaded",i,!1)}}))},j.computeScreenAwareSize=function(N,j){const X=N.devicePixelRatio*j;return Math.max(1,Math.floor(X))/N.devicePixelRatio},j.windowOpenNoOpener=function(N){Le.mainWindow.open(N,"_blank","noopener")},j.windowOpenPopup=function(N){const j=Math.floor(Le.mainWindow.screenLeft+Le.mainWindow.innerWidth/2-Ie/2),X=Math.floor(Le.mainWindow.screenTop+Le.mainWindow.innerHeight/2-Pe/2);Le.mainWindow.open(N,"_blank",`width=${Ie},height=${Pe},top=${X},left=${j}`)},j.windowOpenWithSuccess=function(N,j=!0){const X=Le.mainWindow.open();return!!X&&(j&&(X.opener=null),X.location.href=N,!0)},j.animate=function(N,X){const s=()=>{X(),ie=(0,j.scheduleAtNextAnimationFrame)(N,s)};let ie=(0,j.scheduleAtNextAnimationFrame)(N,s);return(0,we.toDisposable)((()=>ie.dispose()))},j.asCSSPropertyValue=function(N){return`'${N.replace(/'/g,"%27")}'`},j.asCssValueWithDefault=function e(N,j){if(void 0!==N){const X=N.match(/^\s*var\((.+)\)$/);if(X){const N=X[1].split(",",2);return 2===N.length&&(j=e(N[1].trim(),j)),`var(${N[0]}, ${j})`}return N}return j},j.detectFullscreen=function(N){return N.document.fullscreenElement||N.document.webkitFullscreenElement||N.document.webkitIsFullScreen?{mode:xe.DOCUMENT,guess:!1}:N.innerHeight===N.screen.height?{mode:xe.BROWSER,guess:!1}:(Ee.isMacintosh||Ee.isLinux)&&N.outerHeight===N.screen.height&&N.outerWidth===N.screen.width?{mode:xe.BROWSER,guess:!0}:null},j.multibyteAwareBtoa=function(N){return btoa(function(N){const j=new Uint16Array(N.length);for(let X=0;X<j.length;X++)j[X]=N.charCodeAt(X);let X="";const ie=new Uint8Array(j.buffer);for(let N=0;N<ie.length;N++)X+=String.fromCharCode(ie[N]);return X}(N))},j.getCookieValue=function(N){const j=document.cookie.match("(^|[^;]+)\\s*"+N+"\\s*=\\s*([^;]+)");return j?j.pop():void 0},j.h=function(N,...j){let X,ie;Array.isArray(j[0])?(X={},ie=j[0]):(X=j[0]||{},ie=j[1]);const se=Be.exec(N);if(!se||!se.groups)throw new Error("Bad use of h");const le=se.groups.tag||"div",he=document.createElement(le);se.groups.id&&(he.id=se.groups.id);const ce=[];if(se.groups.class)for(const N of se.groups.class.split("."))""!==N&&ce.push(N);if(void 0!==X.className)for(const N of X.className.split("."))""!==N&&ce.push(N);ce.length>0&&(he.className=ce.join(" "));const _e={};if(se.groups.name&&(_e[se.groups.name]=he),ie)for(const N of ie)Q(N)?he.appendChild(N):"string"==typeof N?he.append(N):"root"in N&&(Object.assign(_e,N),he.appendChild(N.root));for(const[N,j]of Object.entries(X))if("className"!==N)if("style"===N)for(const[N,X]of Object.entries(j))he.style.setProperty(fe(N),"number"==typeof X?X+"px":""+X);else"tabIndex"===N?he.tabIndex=j:he.setAttribute(fe(N),j.toString());return _e.root=he,_e},j.svgElem=function(N,...j){let X,ie;Array.isArray(j[0])?(X={},ie=j[0]):(X=j[0]||{},ie=j[1]);const se=Be.exec(N);if(!se||!se.groups)throw new Error("Bad use of h");const le=se.groups.tag||"div",he=document.createElementNS("http://www.w3.org/2000/svg",le);se.groups.id&&(he.id=se.groups.id);const ce=[];if(se.groups.class)for(const N of se.groups.class.split("."))""!==N&&ce.push(N);if(void 0!==X.className)for(const N of X.className.split("."))""!==N&&ce.push(N);ce.length>0&&(he.className=ce.join(" "));const _e={};if(se.groups.name&&(_e[se.groups.name]=he),ie)for(const N of ie)Q(N)?he.appendChild(N):"string"==typeof N?he.append(N):"root"in N&&(Object.assign(_e,N),he.appendChild(N.root));for(const[N,j]of Object.entries(X))if("className"!==N)if("style"===N)for(const[N,X]of Object.entries(j))he.style.setProperty(fe(N),"number"==typeof X?X+"px":""+X);else"tabIndex"===N?he.tabIndex=j:he.setAttribute(fe(N),j.toString());return _e.root=he,_e},j.copyAttributes=pe,j.trackAttributes=function(N,X,ie){pe(N,X,ie);const se=new we.DisposableStore;return se.add(j.sharedMutationObserver.observe(N,se,{attributes:!0,attributeFilter:ie})((j=>{for(const ie of j)"attributes"===ie.type&&ie.attributeName&&ge(N,X,ie.attributeName)}))),se};const ce=he(X(4333)),_e=X(7745),me=X(5394),ve=X(5964),Se=X(1758),be=X(9807),Ce=he(X(802)),ye=X(7883),we=X(7150),Ee=he(X(8163)),De=X(6304),Le=X(4693),Ae=X(7704);ie=function(){const N=new Map;(0,Le.ensureCodeWindow)(Le.mainWindow,1);const X={window:Le.mainWindow,disposables:new we.DisposableStore};N.set(Le.mainWindow.vscodeWindowId,X);const ie=new Ce.Emitter,se=new Ce.Emitter,le=new Ce.Emitter;return{onDidRegisterWindow:ie.event,onWillUnregisterWindow:le.event,onDidUnregisterWindow:se.event,registerWindow(X){if(N.has(X.vscodeWindowId))return we.Disposable.None;const he=new we.DisposableStore,ce={window:X,disposables:he.add(new we.DisposableStore)};return N.set(X.vscodeWindowId,ce),he.add((0,we.toDisposable)((()=>{N.delete(X.vscodeWindowId),se.fire(X)}))),he.add(C(X,j.EventType.BEFORE_UNLOAD,(()=>{le.fire(X)}))),ie.fire(ce),he},getWindows:()=>N.values(),getWindowsCount:()=>N.size,getWindowId:N=>N.vscodeWindowId,hasWindow:j=>N.has(j),getWindowById:function(j,ie){return("number"==typeof j?N.get(j):void 0)??(ie?X:void 0)},getWindow(N){const j=N;if(j?.ownerDocument?.defaultView)return j.ownerDocument.defaultView.window;const X=N;return X?.view?X.view.window:Le.mainWindow},getDocument(N){const X=N;return(0,j.getWindow)(X).document}}}(),j.registerWindow=ie.registerWindow,j.getWindow=ie.getWindow,j.getDocument=ie.getDocument,j.getWindows=ie.getWindows,j.getWindowsCount=ie.getWindowsCount,j.getWindowId=ie.getWindowId,j.getWindowById=ie.getWindowById,j.hasWindow=ie.hasWindow,j.onDidRegisterWindow=ie.onDidRegisterWindow,j.onWillUnregisterWindow=ie.onWillUnregisterWindow,j.onDidUnregisterWindow=ie.onDidUnregisterWindow;class b{constructor(N,j,X,ie){this._node=N,this._type=j,this._handler=X,this._options=ie||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function C(N,j,X,ie){return new b(N,j,X,ie)}function y(N,j){return function(X){return j(new ve.StandardMouseEvent(N,X))}}function w(N,X,ie){return C(N,Ee.isIOS&&_e.BrowserFeatures.pointerEvents?j.EventType.POINTER_DOWN:j.EventType.MOUSE_DOWN,X,ie)}function E(N,X,ie){return C(N,Ee.isIOS&&_e.BrowserFeatures.pointerEvents?j.EventType.POINTER_UP:j.EventType.MOUSE_UP,X,ie)}j.addStandardDisposableListener=function(N,X,ie,se){let le=ie;return"click"===X||"mousedown"===X||"contextmenu"===X?le=y((0,j.getWindow)(N),ie):"keydown"!==X&&"keypress"!==X&&"keyup"!==X||(le=function(N){return function(j){return N(new me.StandardKeyboardEvent(j))}}(ie)),C(N,X,le,se)},j.addStandardDisposableGenericMouseDownListener=function(N,X,ie){return w(N,y((0,j.getWindow)(N),X),ie)},j.addStandardDisposableGenericMouseUpListener=function(N,X,ie){return E(N,y((0,j.getWindow)(N),X),ie)};class D extends Se.AbstractIdleValue{constructor(N,j){super(N,j)}}j.WindowIdleValue=D;class L extends Se.IntervalTimer{constructor(N){super(),this.defaultTarget=N&&(0,j.getWindow)(N)}cancelAndSet(N,j,X){return super.cancelAndSet(N,j,X??this.defaultTarget)}}j.WindowIntervalTimer=L;class A{constructor(N,j=0){this._runner=N,this.priority=j,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(N){(0,be.onUnexpectedError)(N)}}static sort(N,j){return j.priority-N.priority}}!function(){const N=new Map,X=new Map,ie=new Map,se=new Map;j.scheduleAtNextAnimationFrame=(le,he,ce=0)=>{const _e=(0,j.getWindowId)(le),me=new A(he,ce);let ve=N.get(_e);return ve||(ve=[],N.set(_e,ve)),ve.push(me),ie.get(_e)||(ie.set(_e,!0),le.requestAnimationFrame((()=>(j=>{ie.set(j,!1);const le=N.get(j)??[];for(X.set(j,le),N.set(j,[]),se.set(j,!0);le.length>0;)le.sort(A.sort),le.shift().execute();se.set(j,!1)})(_e)))),me},j.runAtThisOrScheduleAtNextAnimationFrame=(N,ie,le)=>{const he=(0,j.getWindowId)(N);if(se.get(he)){const N=new A(ie,le);let j=X.get(he);return j||(j=[],X.set(he,j)),j.push(N),N}return(0,j.scheduleAtNextAnimationFrame)(N,ie,le)}}();const R=function(N,j){return j};class T extends we.Disposable{constructor(N,j,X,ie=R,se=8){super();let le=null,he=0;const ce=this._register(new Se.TimeoutTimer),l=()=>{he=(new Date).getTime(),X(le),le=null};this._register(C(N,j,(N=>{le=ie(le,N);const j=(new Date).getTime()-he;j>=se?(ce.cancel(),l()):ce.setIfNotSet(l,se-j)})))}}function k(N){return(0,j.getWindow)(N).getComputedStyle(N,null)}class M{static convertToPixels(N,j){return parseFloat(j)||0}static getDimension(N,j,X){const ie=k(N),se=ie?ie.getPropertyValue(j):"0";return M.convertToPixels(N,se)}static getBorderLeftWidth(N){return M.getDimension(N,"border-left-width","borderLeftWidth")}static getBorderRightWidth(N){return M.getDimension(N,"border-right-width","borderRightWidth")}static getBorderTopWidth(N){return M.getDimension(N,"border-top-width","borderTopWidth")}static getBorderBottomWidth(N){return M.getDimension(N,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(N){return M.getDimension(N,"padding-left","paddingLeft")}static getPaddingRight(N){return M.getDimension(N,"padding-right","paddingRight")}static getPaddingTop(N){return M.getDimension(N,"padding-top","paddingTop")}static getPaddingBottom(N){return M.getDimension(N,"padding-bottom","paddingBottom")}static getMarginLeft(N){return M.getDimension(N,"margin-left","marginLeft")}static getMarginTop(N){return M.getDimension(N,"margin-top","marginTop")}static getMarginRight(N){return M.getDimension(N,"margin-right","marginRight")}static getMarginBottom(N){return M.getDimension(N,"margin-bottom","marginBottom")}}class O{static{this.None=new O(0,0)}constructor(N,j){this.width=N,this.height=j}with(N=this.width,j=this.height){return N!==this.width||j!==this.height?new O(N,j):this}static is(N){return"object"==typeof N&&"number"==typeof N.height&&"number"==typeof N.width}static lift(N){return N instanceof O?N:new O(N.width,N.height)}static equals(N,j){return N===j||!(!N||!j)&&N.width===j.width&&N.height===j.height}}function I(N){let j=N.offsetParent,X=N.offsetTop,ie=N.offsetLeft;for(;null!==(N=N.parentNode)&&N!==N.ownerDocument.body&&N!==N.ownerDocument.documentElement;){X-=N.scrollTop;const se=W(N)?null:k(N);se&&(ie-="rtl"!==se.direction?N.scrollLeft:-N.scrollLeft),N===j&&(ie+=M.getBorderLeftWidth(N),X+=M.getBorderTopWidth(N),X+=N.offsetTop,ie+=N.offsetLeft,j=N.offsetParent)}return{left:ie,top:X}}function P(N){const j=M.getMarginLeft(N)+M.getMarginRight(N);return N.offsetWidth+j}function x(N){const j=M.getMarginLeft(N)+M.getMarginRight(N);return N.scrollWidth+j}function B(N,j){return Boolean(j?.contains(N))}j.Dimension=O;const Re="parentFlowToElementId";function U(N){const j=N.dataset[Re];return"string"==typeof j?N.ownerDocument.getElementById(j):null}function F(N,j,X){for(;N&&N.nodeType===N.ELEMENT_NODE;){if(N.classList.contains(j))return N;if(X)if("string"==typeof X){if(N.classList.contains(X))return null}else if(N===X)return null;N=N.parentNode}return null}function W(N){return N&&!!N.host&&!!N.mode}function H(N){for(;N.parentNode;){if(N===N.ownerDocument?.body)return null;N=N.parentNode}return W(N)?N:null}function K(){let N=z().activeElement;for(;N?.shadowRoot;)N=N.shadowRoot.activeElement;return N}function z(){return(0,j.getWindowsCount)()<=1?Le.mainWindow.document:Array.from((0,j.getWindows)()).map((({window:N})=>N.document)).find((N=>N.hasFocus()))??Le.mainWindow.document}const Te=new Map;class ${constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(N){N!==this._currentCssStyle&&(this._currentCssStyle=N,this._styleSheet?this._styleSheet.innerText=N:this._styleSheet=V(Le.mainWindow.document.head,(j=>j.innerText=N)))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function V(N=Le.mainWindow.document.head,X,ie){const se=document.createElement("style");if(se.type="text/css",se.media="screen",X?.(se),N.appendChild(se),ie&&ie.add((0,we.toDisposable)((()=>se.remove()))),N===Le.mainWindow.document.head){const N=new Set;Te.set(se,N);for(const{window:X,disposables:le}of(0,j.getWindows)()){if(X===Le.mainWindow)continue;const j=le.add(G(se,N,X));ie?.add(j)}}return se}function G(N,X,ie){const se=new we.DisposableStore,le=N.cloneNode(!0);ie.document.head.appendChild(le),se.add((0,we.toDisposable)((()=>le.remove())));for(const j of Z(N))le.sheet?.insertRule(j.cssText,le.sheet?.cssRules.length);return se.add(j.sharedMutationObserver.observe(N,se,{childList:!0})((()=>{le.textContent=N.textContent}))),X.add(le),se.add((0,we.toDisposable)((()=>X.delete(le)))),se}function q(N,j=Le.mainWindow.document.head){const X=document.createElement(N);return j.appendChild(X),X}j.sharedMutationObserver=new class{constructor(){this.mutationObservers=new Map}observe(N,j,X){let ie=this.mutationObservers.get(N);ie||(ie=new Map,this.mutationObservers.set(N,ie));const se=(0,De.hash)(X);let le=ie.get(se);if(le)le.users+=1;else{const he=new Ce.Emitter,ce=new MutationObserver((N=>he.fire(N)));ce.observe(N,X);const _e=le={users:1,observer:ce,onDidMutate:he.event};j.add((0,we.toDisposable)((()=>{_e.users-=1,0===_e.users&&(he.dispose(),ce.disconnect(),ie?.delete(se),0===ie?.size&&this.mutationObservers.delete(N))}))),ie.set(se,le)}return le.onDidMutate}};let ke=null;function Y(){return ke||(ke=V()),ke}function Z(N){return N?.sheet?.rules?N.sheet.rules:N?.sheet?.cssRules?N.sheet.cssRules:[]}function J(N){return"string"==typeof N.selectorText}function Q(N){return N instanceof HTMLElement||N instanceof(0,j.getWindow)(N).HTMLElement}j.EventType={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:ce.isWebKit?"webkitAnimationStart":"animationstart",ANIMATION_END:ce.isWebKit?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:ce.isWebKit?"webkitAnimationIteration":"animationiteration"},j.EventHelper={stop:(N,j)=>(N.preventDefault(),j&&N.stopPropagation(),N)};class ee extends we.Disposable{static hasFocusWithin(N){if(Q(N)){const j=H(N);return B(j?j.activeElement:N.ownerDocument.activeElement,N)}{const j=N;return B(j.document.activeElement,j.document)}}constructor(N){super(),this._onDidFocus=this._register(new Ce.Emitter),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Ce.Emitter),this.onDidBlur=this._onDidBlur.event;let X=ee.hasFocusWithin(N),ie=!1;const r=()=>{ie=!1,X||(X=!0,this._onDidFocus.fire())},n=()=>{X&&(ie=!0,(Q(N)?(0,j.getWindow)(N):N).setTimeout((()=>{ie&&(ie=!1,X=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{ee.hasFocusWithin(N)!==X&&(X?n():r())},this._register(C(N,j.EventType.FOCUS,r,!0)),this._register(C(N,j.EventType.BLUR,n,!0)),Q(N)&&(this._register(C(N,j.EventType.FOCUS_IN,(()=>this._refreshStateHandler()))),this._register(C(N,j.EventType.FOCUS_OUT,(()=>this._refreshStateHandler()))))}refreshState(){this._refreshStateHandler()}}function te(N,...j){if(N.append(...j),1===j.length&&"string"!=typeof j[0])return j[0]}const Me=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Oe;function re(N,j,X,...ie){const se=Me.exec(j);if(!se)throw new Error("Bad use of emmet");const le=se[1]||"div";let he;return he=N!==Oe.HTML?document.createElementNS(N,le):document.createElement(le),se[3]&&(he.id=se[3]),se[4]&&(he.className=se[4].replace(/\./g," ").trim()),X&&Object.entries(X).forEach((([N,j])=>{void 0!==j&&(/^on\w+$/.test(N)?he[N]=j:"selected"===N?j&&he.setAttribute(N,"true"):he.setAttribute(N,j))})),he.append(...ie),he}function ne(N,j,...X){return re(Oe.HTML,N,j,...X)}function oe(...N){for(const j of N)j.style.display="",j.removeAttribute("aria-hidden")}function ae(...N){for(const j of N)j.style.display="none",j.setAttribute("aria-hidden","true")}!function(N){N.HTML="http://www.w3.org/1999/xhtml",N.SVG="http://www.w3.org/2000/svg"}(Oe||(j.Namespace=Oe={})),ne.SVG=function(N,j,...X){return re(Oe.SVG,N,j,...X)};const Ie=780,Pe=640;var xe;!function(N){N[N.DOCUMENT=1]="DOCUMENT",N[N.BROWSER=2]="BROWSER"}(xe||(j.DetectedFullscreenMode=xe={}));class de extends Ce.Emitter{constructor(){super(),this._subscriptions=new we.DisposableStore,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Ce.Event.runAndSubscribe(j.onDidRegisterWindow,(({window:N,disposables:j})=>this.registerListeners(N,j)),{window:Le.mainWindow,disposables:this._subscriptions}))}registerListeners(N,j){j.add(C(N,"keydown",(N=>{if(N.defaultPrevented)return;const j=new me.StandardKeyboardEvent(N);if(j.keyCode!==ye.KeyCode.Alt||!N.repeat){if(N.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(N.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(N.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(N.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else{if(j.keyCode===ye.KeyCode.Alt)return;this._keyStatus.lastKeyPressed=void 0}this._keyStatus.altKey=N.altKey,this._keyStatus.ctrlKey=N.ctrlKey,this._keyStatus.metaKey=N.metaKey,this._keyStatus.shiftKey=N.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=N,this.fire(this._keyStatus))}}),!0)),j.add(C(N,"keyup",(N=>{N.defaultPrevented||(!N.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!N.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!N.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!N.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=N.altKey,this._keyStatus.ctrlKey=N.ctrlKey,this._keyStatus.metaKey=N.metaKey,this._keyStatus.shiftKey=N.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=N,this.fire(this._keyStatus)))}),!0)),j.add(C(N.document.body,"mousedown",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),j.add(C(N.document.body,"mouseup",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),j.add(C(N.document.body,"mousemove",(N=>{N.buttons&&(this._keyStatus.lastKeyPressed=void 0)}),!0)),j.add(C(N,"blur",(()=>{this.resetKeyStatus()})))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return de.instance||(de.instance=new de),de.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}j.ModifierKeyEmitter=de;class ue extends we.Disposable{constructor(N,j){super(),this.element=N,this.callbacks=j,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(C(this.element,j.EventType.DRAG_START,(N=>{this.callbacks.onDragStart?.(N)}))),this.callbacks.onDrag&&this._register(C(this.element,j.EventType.DRAG,(N=>{this.callbacks.onDrag?.(N)}))),this._register(C(this.element,j.EventType.DRAG_ENTER,(N=>{this.counter++,this.dragStartTime=N.timeStamp,this.callbacks.onDragEnter?.(N)}))),this._register(C(this.element,j.EventType.DRAG_OVER,(N=>{N.preventDefault(),this.callbacks.onDragOver?.(N,N.timeStamp-this.dragStartTime)}))),this._register(C(this.element,j.EventType.DRAG_LEAVE,(N=>{this.counter--,0===this.counter&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(N))}))),this._register(C(this.element,j.EventType.DRAG_END,(N=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(N)}))),this._register(C(this.element,j.EventType.DROP,(N=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(N)})))}}j.DragAndDropObserver=ue;const Be=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function fe(N){return N.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function pe(N,j,X){for(const{name:ie,value:se}of N.attributes)X&&!X.includes(ie)||j.setAttribute(ie,se)}function ge(N,j,X){const ie=N.getAttribute(X);ie?j.setAttribute(X,ie):j.removeAttribute(X)}j.SafeTriangle=class{constructor(N,j,X){this.originX=N,this.originY=j,this.triangles=[];const{top:ie,left:se,right:le,bottom:he}=X.getBoundingClientRect(),ce=this.triangles;let _e=0;ce[_e++]=se,ce[_e++]=ie,ce[_e++]=le,ce[_e++]=ie,ce[_e++]=se,ce[_e++]=ie,ce[_e++]=se,ce[_e++]=he,ce[_e++]=le,ce[_e++]=ie,ce[_e++]=le,ce[_e++]=he,ce[_e++]=se,ce[_e++]=he,ce[_e++]=le,ce[_e++]=he}contains(N,j){const{triangles:X,originX:ie,originY:se}=this;for(let le=0;le<4;le++)if((0,Ae.isPointWithinTriangle)(N,j,ie,se,X[2*le],X[2*le+1],X[2*le+2],X[2*le+3]))return!0;return!1}}},9675:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.FastDomNode=void 0,j.createFastDomNode=function(N){return new i(N)};class i{constructor(N){this.domNode=N,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(N){const j=s(N);this._maxWidth!==j&&(this._maxWidth=j,this.domNode.style.maxWidth=this._maxWidth)}setWidth(N){const j=s(N);this._width!==j&&(this._width=j,this.domNode.style.width=this._width)}setHeight(N){const j=s(N);this._height!==j&&(this._height=j,this.domNode.style.height=this._height)}setTop(N){const j=s(N);this._top!==j&&(this._top=j,this.domNode.style.top=this._top)}setLeft(N){const j=s(N);this._left!==j&&(this._left=j,this.domNode.style.left=this._left)}setBottom(N){const j=s(N);this._bottom!==j&&(this._bottom=j,this.domNode.style.bottom=this._bottom)}setRight(N){const j=s(N);this._right!==j&&(this._right=j,this.domNode.style.right=this._right)}setPaddingTop(N){const j=s(N);this._paddingTop!==j&&(this._paddingTop=j,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(N){const j=s(N);this._paddingLeft!==j&&(this._paddingLeft=j,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(N){const j=s(N);this._paddingBottom!==j&&(this._paddingBottom=j,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(N){const j=s(N);this._paddingRight!==j&&(this._paddingRight=j,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(N){this._fontFamily!==N&&(this._fontFamily=N,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(N){this._fontWeight!==N&&(this._fontWeight=N,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(N){const j=s(N);this._fontSize!==j&&(this._fontSize=j,this.domNode.style.fontSize=this._fontSize)}setFontStyle(N){this._fontStyle!==N&&(this._fontStyle=N,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(N){this._fontFeatureSettings!==N&&(this._fontFeatureSettings=N,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(N){this._fontVariationSettings!==N&&(this._fontVariationSettings=N,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(N){this._textDecoration!==N&&(this._textDecoration=N,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(N){const j=s(N);this._lineHeight!==j&&(this._lineHeight=j,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(N){const j=s(N);this._letterSpacing!==j&&(this._letterSpacing=j,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(N){this._className!==N&&(this._className=N,this.domNode.className=this._className)}toggleClassName(N,j){this.domNode.classList.toggle(N,j),this._className=this.domNode.className}setDisplay(N){this._display!==N&&(this._display=N,this.domNode.style.display=this._display)}setPosition(N){this._position!==N&&(this._position=N,this.domNode.style.position=this._position)}setVisibility(N){this._visibility!==N&&(this._visibility=N,this.domNode.style.visibility=this._visibility)}setColor(N){this._color!==N&&(this._color=N,this.domNode.style.color=this._color)}setBackgroundColor(N){this._backgroundColor!==N&&(this._backgroundColor=N,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(N){this._layerHint!==N&&(this._layerHint=N,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(N){this._boxShadow!==N&&(this._boxShadow=N,this.domNode.style.boxShadow=N)}setContain(N){this._contain!==N&&(this._contain=N,this.domNode.style.contain=this._contain)}setAttribute(N,j){this.domNode.setAttribute(N,j)}removeAttribute(N){this.domNode.removeAttribute(N)}appendChild(N){this.domNode.appendChild(N.domNode)}removeChild(N){this.domNode.removeChild(N.domNode)}}function s(N){return"number"==typeof N?`${N}px`:N}j.FastDomNode=i},8328:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.GlobalPointerMoveMonitor=void 0;const he=le(X(7093)),ce=X(7150);j.GlobalPointerMoveMonitor=class{constructor(){this._hooks=new ce.DisposableStore,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(N,j){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const X=this._onStopCallback;this._onStopCallback=null,N&&X&&X(j)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(N,j,X,ie,se){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=ie,this._onStopCallback=se;let le=N;try{N.setPointerCapture(j),this._hooks.add((0,ce.toDisposable)((()=>{try{N.releasePointerCapture(j)}catch(N){}})))}catch(j){le=he.getWindow(N)}this._hooks.add(he.addDisposableListener(le,he.EventType.POINTER_MOVE,(N=>{N.buttons===X?(N.preventDefault(),this._pointerMoveCallback(N)):this.stopMonitoring(!0)}))),this._hooks.add(he.addDisposableListener(le,he.EventType.POINTER_UP,(N=>this.stopMonitoring(!0))))}}},6609:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.IframeUtils=void 0,j.parentOriginHash=async function(N,j){if(!crypto.subtle)throw new Error("'crypto.subtle' is not available so webviews will not work. This is likely because the editor is not running in a secure context (https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts).");const X=JSON.stringify({parentOrigin:N,salt:j}),ie=(new TextEncoder).encode(X);return function(N){const j=Array.from(new Uint8Array(N)).map((N=>N.toString(16).padStart(2,"0"))).join("");return BigInt(`0x${j}`).toString(32).padStart(52,"0")}(await crypto.subtle.digest("sha-256",ie))};const X=new WeakMap;function s(N){if(!N.parent||N.parent===N)return null;try{const j=N.location,X=N.parent.location;if("null"!==j.origin&&"null"!==X.origin&&j.origin!==X.origin)return null}catch(N){return null}return N.parent}j.IframeUtils=class{static getSameOriginWindowChain(N){let j=X.get(N);if(!j){j=[],X.set(N,j);let ie,se=N;do{ie=s(se),ie?j.push({window:new WeakRef(se),iframeElement:se.frameElement||null}):j.push({window:new WeakRef(se),iframeElement:null}),se=ie}while(se)}return j.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(N,j){if(!j||N===j)return{top:0,left:0};let X=0,ie=0;const se=this.getSameOriginWindowChain(N);for(const N of se){const se=N.window.deref();if(X+=se?.scrollY??0,ie+=se?.scrollX??0,se===j)break;if(!N.iframeElement)break;const le=N.iframeElement.getBoundingClientRect();X+=le.top,ie+=le.left}return{top:X,left:ie}}}},5394:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.StandardKeyboardEvent=void 0,j.printKeyboardEvent=function(N){const j=[];return N.ctrlKey&&j.push("ctrl"),N.shiftKey&&j.push("shift"),N.altKey&&j.push("alt"),N.metaKey&&j.push("meta"),`modifiers: [${j.join(",")}], code: ${N.code}, keyCode: ${N.keyCode}, key: ${N.key}`},j.printStandardKeyboardEvent=function(N){const j=[];return N.ctrlKey&&j.push("ctrl"),N.shiftKey&&j.push("shift"),N.altKey&&j.push("alt"),N.metaKey&&j.push("meta"),`modifiers: [${j.join(",")}], code: ${N.code}, keyCode: ${N.keyCode} ('${ce.KeyCodeUtils.toString(N.keyCode)}')`};const he=le(X(4333)),ce=X(7883),_e=X(2811),me=le(X(8163)),ve=me.isMacintosh?ce.KeyMod.WinCtrl:ce.KeyMod.CtrlCmd,Se=ce.KeyMod.Alt,be=ce.KeyMod.Shift,Ce=me.isMacintosh?ce.KeyMod.CtrlCmd:ce.KeyMod.WinCtrl;j.StandardKeyboardEvent=class{constructor(N){this._standardKeyboardEventBrand=!0;const j=N;this.browserEvent=j,this.target=j.target,this.ctrlKey=j.ctrlKey,this.shiftKey=j.shiftKey,this.altKey=j.altKey,this.metaKey=j.metaKey,this.altGraphKey=j.getModifierState?.("AltGraph"),this.keyCode=function(N){if(N.charCode){const j=String.fromCharCode(N.charCode).toUpperCase();return ce.KeyCodeUtils.fromString(j)}const j=N.keyCode;if(3===j)return ce.KeyCode.PauseBreak;if(he.isFirefox)switch(j){case 59:return ce.KeyCode.Semicolon;case 60:if(me.isLinux)return ce.KeyCode.IntlBackslash;break;case 61:return ce.KeyCode.Equal;case 107:return ce.KeyCode.NumpadAdd;case 109:return ce.KeyCode.NumpadSubtract;case 173:return ce.KeyCode.Minus;case 224:if(me.isMacintosh)return ce.KeyCode.Meta}else if(he.isWebKit){if(me.isMacintosh&&93===j)return ce.KeyCode.Meta;if(!me.isMacintosh&&92===j)return ce.KeyCode.Meta}return ce.EVENT_KEY_CODE_MAP[j]||ce.KeyCode.Unknown}(j),this.code=j.code,this.ctrlKey=this.ctrlKey||this.keyCode===ce.KeyCode.Ctrl,this.altKey=this.altKey||this.keyCode===ce.KeyCode.Alt,this.shiftKey=this.shiftKey||this.keyCode===ce.KeyCode.Shift,this.metaKey=this.metaKey||this.keyCode===ce.KeyCode.Meta,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(N){return this._asKeybinding===N}_computeKeybinding(){let N=ce.KeyCode.Unknown;this.keyCode!==ce.KeyCode.Ctrl&&this.keyCode!==ce.KeyCode.Shift&&this.keyCode!==ce.KeyCode.Alt&&this.keyCode!==ce.KeyCode.Meta&&(N=this.keyCode);let j=0;return this.ctrlKey&&(j|=ve),this.altKey&&(j|=Se),this.shiftKey&&(j|=be),this.metaKey&&(j|=Ce),j|=N,j}_computeKeyCodeChord(){let N=ce.KeyCode.Unknown;return this.keyCode!==ce.KeyCode.Ctrl&&this.keyCode!==ce.KeyCode.Shift&&this.keyCode!==ce.KeyCode.Alt&&this.keyCode!==ce.KeyCode.Meta&&(N=this.keyCode),new _e.KeyCodeChord(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,N)}}},5964:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.StandardWheelEvent=j.DragMouseEvent=j.StandardMouseEvent=void 0;const he=le(X(4333)),ce=X(6609),_e=le(X(8163));class h{constructor(N,j){this.timestamp=Date.now(),this.browserEvent=j,this.leftButton=0===j.button,this.middleButton=1===j.button,this.rightButton=2===j.button,this.buttons=j.buttons,this.target=j.target,this.detail=j.detail||1,"dblclick"===j.type&&(this.detail=2),this.ctrlKey=j.ctrlKey,this.shiftKey=j.shiftKey,this.altKey=j.altKey,this.metaKey=j.metaKey,"number"==typeof j.pageX?(this.posx=j.pageX,this.posy=j.pageY):(this.posx=j.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=j.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const X=ce.IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(N,j.view);this.posx-=X.left,this.posy-=X.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}j.StandardMouseEvent=h,j.DragMouseEvent=class extends h{constructor(N,j){super(N,j),this.dataTransfer=j.dataTransfer}},j.StandardWheelEvent=class{constructor(N,j=0,X=0){this.browserEvent=N||null,this.target=N?N.target||N.targetNode||N.srcElement:null,this.deltaY=X,this.deltaX=j;let ie=!1;if(he.isChrome){const N=navigator.userAgent.match(/Chrome\/(\d+)/);ie=(N?parseInt(N[1]):123)<=122}if(N){const j=N,X=N,se=N.view?.devicePixelRatio||1;if(void 0!==j.wheelDeltaY)this.deltaY=ie?j.wheelDeltaY/(120*se):j.wheelDeltaY/120;else if(void 0!==X.VERTICAL_AXIS&&X.axis===X.VERTICAL_AXIS)this.deltaY=-X.detail/3;else if("wheel"===N.type){const j=N;j.deltaMode===j.DOM_DELTA_LINE?he.isFirefox&&!_e.isMacintosh?this.deltaY=-N.deltaY/3:this.deltaY=-N.deltaY:this.deltaY=-N.deltaY/40}if(void 0!==j.wheelDeltaX)he.isSafari&&_e.isWindows?this.deltaX=-j.wheelDeltaX/120:this.deltaX=ie?j.wheelDeltaX/(120*se):j.wheelDeltaX/120;else if(void 0!==X.HORIZONTAL_AXIS&&X.axis===X.HORIZONTAL_AXIS)this.deltaX=-N.detail/3;else if("wheel"===N.type){const j=N;j.deltaMode===j.DOM_DELTA_LINE?he.isFirefox&&!_e.isMacintosh?this.deltaX=-N.deltaX/3:this.deltaX=-N.deltaX:this.deltaX=-N.deltaX/40}0===this.deltaY&&0===this.deltaX&&N.wheelDelta&&(this.deltaY=ie?N.wheelDelta/(120*se):N.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}}},8594:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__decorate||function(N,j,X,ie){var se,le=arguments.length,he=le<3?j:null===ie?ie=Object.getOwnPropertyDescriptor(j,X):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)he=Reflect.decorate(N,j,X,ie);else for(var ce=N.length-1;ce>=0;ce--)(se=N[ce])&&(he=(le<3?se(he):le>3?se(j,X,he):se(j,X))||he);return le>3&&he&&Object.defineProperty(j,X,he),he},he=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.Gesture=j.EventType=void 0;const ce=he(X(7093)),_e=X(4693),me=he(X(3058)),ve=X(4838),Se=X(802),be=X(7150),Ce=X(6317);var ye;!function(N){N.Tap="-xterm-gesturetap",N.Change="-xterm-gesturechange",N.Start="-xterm-gesturestart",N.End="-xterm-gesturesend",N.Contextmenu="-xterm-gesturecontextmenu"}(ye||(j.EventType=ye={}));class p extends be.Disposable{static{this.SCROLL_FRICTION=-.005}static{this.HOLD_DELAY=700}static{this.CLEAR_TAP_COUNT_TIME=400}constructor(){super(),this.dispatched=!1,this.targets=new Ce.LinkedList,this.ignoreTargets=new Ce.LinkedList,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Se.Event.runAndSubscribe(ce.onDidRegisterWindow,(({window:N,disposables:j})=>{j.add(ce.addDisposableListener(N.document,"touchstart",(N=>this.onTouchStart(N)),{passive:!1})),j.add(ce.addDisposableListener(N.document,"touchend",(j=>this.onTouchEnd(N,j)))),j.add(ce.addDisposableListener(N.document,"touchmove",(N=>this.onTouchMove(N)),{passive:!1}))}),{window:_e.mainWindow,disposables:this._store}))}static addTarget(N){if(!p.isTouchDevice())return be.Disposable.None;p.INSTANCE||(p.INSTANCE=(0,be.markAsSingleton)(new p));const j=p.INSTANCE.targets.push(N);return(0,be.toDisposable)(j)}static ignoreTarget(N){if(!p.isTouchDevice())return be.Disposable.None;p.INSTANCE||(p.INSTANCE=(0,be.markAsSingleton)(new p));const j=p.INSTANCE.ignoreTargets.push(N);return(0,be.toDisposable)(j)}static isTouchDevice(){return"ontouchstart"in _e.mainWindow||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(N){const j=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let X=0,ie=N.targetTouches.length;X<ie;X++){const ie=N.targetTouches.item(X);this.activeTouches[ie.identifier]={id:ie.identifier,initialTarget:ie.target,initialTimeStamp:j,initialPageX:ie.pageX,initialPageY:ie.pageY,rollingTimestamps:[j],rollingPageX:[ie.pageX],rollingPageY:[ie.pageY]};const se=this.newGestureEvent(ye.Start,ie.target);se.pageX=ie.pageX,se.pageY=ie.pageY,this.dispatchEvent(se)}this.dispatched&&(N.preventDefault(),N.stopPropagation(),this.dispatched=!1)}onTouchEnd(N,j){const X=Date.now(),ie=Object.keys(this.activeTouches).length;for(let se=0,le=j.changedTouches.length;se<le;se++){const le=j.changedTouches.item(se);if(!this.activeTouches.hasOwnProperty(String(le.identifier))){console.warn("move of an UNKNOWN touch",le);continue}const he=this.activeTouches[le.identifier],ce=Date.now()-he.initialTimeStamp;if(ce<p.HOLD_DELAY&&Math.abs(he.initialPageX-me.tail(he.rollingPageX))<30&&Math.abs(he.initialPageY-me.tail(he.rollingPageY))<30){const N=this.newGestureEvent(ye.Tap,he.initialTarget);N.pageX=me.tail(he.rollingPageX),N.pageY=me.tail(he.rollingPageY),this.dispatchEvent(N)}else if(ce>=p.HOLD_DELAY&&Math.abs(he.initialPageX-me.tail(he.rollingPageX))<30&&Math.abs(he.initialPageY-me.tail(he.rollingPageY))<30){const N=this.newGestureEvent(ye.Contextmenu,he.initialTarget);N.pageX=me.tail(he.rollingPageX),N.pageY=me.tail(he.rollingPageY),this.dispatchEvent(N)}else if(1===ie){const j=me.tail(he.rollingPageX),ie=me.tail(he.rollingPageY),se=me.tail(he.rollingTimestamps)-he.rollingTimestamps[0],le=j-he.rollingPageX[0],ce=ie-he.rollingPageY[0],_e=[...this.targets].filter((N=>he.initialTarget instanceof Node&&N.contains(he.initialTarget)));this.inertia(N,_e,X,Math.abs(le)/se,le>0?1:-1,j,Math.abs(ce)/se,ce>0?1:-1,ie)}this.dispatchEvent(this.newGestureEvent(ye.End,he.initialTarget)),delete this.activeTouches[le.identifier]}this.dispatched&&(j.preventDefault(),j.stopPropagation(),this.dispatched=!1)}newGestureEvent(N,j){const X=document.createEvent("CustomEvent");return X.initEvent(N,!1,!0),X.initialTarget=j,X.tapCount=0,X}dispatchEvent(N){if(N.type===ye.Tap){const j=(new Date).getTime();let X=0;X=j-this._lastSetTapCountTime>p.CLEAR_TAP_COUNT_TIME?1:2,this._lastSetTapCountTime=j,N.tapCount=X}else N.type!==ye.Change&&N.type!==ye.Contextmenu||(this._lastSetTapCountTime=0);if(N.initialTarget instanceof Node){for(const j of this.ignoreTargets)if(j.contains(N.initialTarget))return;const j=[];for(const X of this.targets)if(X.contains(N.initialTarget)){let ie=0,se=N.initialTarget;for(;se&&se!==X;)ie++,se=se.parentElement;j.push([ie,X])}j.sort(((N,j)=>N[0]-j[0]));for(const[X,ie]of j)ie.dispatchEvent(N),this.dispatched=!0}}inertia(N,j,X,ie,se,le,he,_e,me){this.handle=ce.scheduleAtNextAnimationFrame(N,(()=>{const ce=Date.now(),ve=ce-X;let Se=0,be=0,Ce=!0;ie+=p.SCROLL_FRICTION*ve,he+=p.SCROLL_FRICTION*ve,ie>0&&(Ce=!1,Se=se*ie*ve),he>0&&(Ce=!1,be=_e*he*ve);const we=this.newGestureEvent(ye.Change);we.translationX=Se,we.translationY=be,j.forEach((N=>N.dispatchEvent(we))),Ce||this.inertia(N,j,ce,ie,se,le+Se,he,_e,me+be)}))}onTouchMove(N){const j=Date.now();for(let X=0,ie=N.changedTouches.length;X<ie;X++){const ie=N.changedTouches.item(X);if(!this.activeTouches.hasOwnProperty(String(ie.identifier))){console.warn("end of an UNKNOWN touch",ie);continue}const se=this.activeTouches[ie.identifier],le=this.newGestureEvent(ye.Change,se.initialTarget);le.translationX=ie.pageX-me.tail(se.rollingPageX),le.translationY=ie.pageY-me.tail(se.rollingPageY),le.pageX=ie.pageX,le.pageY=ie.pageY,this.dispatchEvent(le),se.rollingPageX.length>3&&(se.rollingPageX.shift(),se.rollingPageY.shift(),se.rollingTimestamps.shift()),se.rollingPageX.push(ie.pageX),se.rollingPageY.push(ie.pageY),se.rollingTimestamps.push(j)}this.dispatched&&(N.preventDefault(),N.stopPropagation(),this.dispatched=!1)}}j.Gesture=p,le([ve.memoize],p,"isTouchDevice",null)},8801:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.AbstractScrollbar=void 0;const he=le(X(7093)),ce=X(9675),_e=X(8328),me=X(8974),ve=X(79),Se=X(8286),be=le(X(8163));class _ extends Se.Widget{constructor(N){super(),this._lazyRender=N.lazyRender,this._host=N.host,this._scrollable=N.scrollable,this._scrollByPage=N.scrollByPage,this._scrollbarState=N.scrollbarState,this._visibilityController=this._register(new ve.ScrollbarVisibilityController(N.visibility,"visible scrollbar "+N.extraScrollbarClassName,"invisible scrollbar "+N.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new _e.GlobalPointerMoveMonitor),this._shouldRender=!0,this.domNode=(0,ce.createFastDomNode)(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(he.addDisposableListener(this.domNode.domNode,he.EventType.POINTER_DOWN,(N=>this._domNodePointerDown(N))))}_createArrow(N){const j=this._register(new me.ScrollbarArrow(N));this.domNode.domNode.appendChild(j.bgDomNode),this.domNode.domNode.appendChild(j.domNode)}_createSlider(N,j,X,ie){this.slider=(0,ce.createFastDomNode)(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(N),this.slider.setLeft(j),"number"==typeof X&&this.slider.setWidth(X),"number"==typeof ie&&this.slider.setHeight(ie),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(he.addDisposableListener(this.slider.domNode,he.EventType.POINTER_DOWN,(N=>{0===N.button&&(N.preventDefault(),this._sliderPointerDown(N))}))),this.onclick(this.slider.domNode,(N=>{N.leftButton&&N.stopPropagation()}))}_onElementSize(N){return this._scrollbarState.setVisibleSize(N)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(N){return this._scrollbarState.setScrollSize(N)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(N){return this._scrollbarState.setScrollPosition(N)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(N){N.target===this.domNode.domNode&&this._onPointerDown(N)}delegatePointerDown(N){const j=this.domNode.domNode.getClientRects()[0].top,X=j+this._scrollbarState.getSliderPosition(),ie=j+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),se=this._sliderPointerPosition(N);X<=se&&se<=ie?0===N.button&&(N.preventDefault(),this._sliderPointerDown(N)):this._onPointerDown(N)}_onPointerDown(N){let j,X;if(N.target===this.domNode.domNode&&"number"==typeof N.offsetX&&"number"==typeof N.offsetY)j=N.offsetX,X=N.offsetY;else{const ie=he.getDomNodePagePosition(this.domNode.domNode);j=N.pageX-ie.left,X=N.pageY-ie.top}const ie=this._pointerDownRelativePosition(j,X);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(ie):this._scrollbarState.getDesiredScrollPositionFromOffset(ie)),0===N.button&&(N.preventDefault(),this._sliderPointerDown(N))}_sliderPointerDown(N){if(!(N.target&&N.target instanceof Element))return;const j=this._sliderPointerPosition(N),X=this._sliderOrthogonalPointerPosition(N),ie=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(N.target,N.pointerId,N.buttons,(N=>{const se=this._sliderOrthogonalPointerPosition(N),le=Math.abs(se-X);if(be.isWindows&&le>140)return void this._setDesiredScrollPositionNow(ie.getScrollPosition());const he=this._sliderPointerPosition(N)-j;this._setDesiredScrollPositionNow(ie.getDesiredScrollPositionFromDelta(he))}),(()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()})),this._host.onDragStart()}_setDesiredScrollPositionNow(N){const j={};this.writeScrollPosition(j,N),this._scrollable.setScrollPositionNow(j)}updateScrollbarSize(N){this._updateScrollbarSize(N),this._scrollbarState.setScrollbarSize(N),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}j.AbstractScrollbar=_},151:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.HorizontalScrollbar=void 0;const ie=X(8801),se=X(8245),le=X(9881);class o extends ie.AbstractScrollbar{constructor(N,j,X){const ie=N.getScrollDimensions(),he=N.getCurrentScrollPosition();if(super({lazyRender:j.lazyRender,host:X,scrollbarState:new se.ScrollbarState(j.horizontalHasArrows?j.arrowSize:0,j.horizontal===le.ScrollbarVisibility.Hidden?0:j.horizontalScrollbarSize,j.vertical===le.ScrollbarVisibility.Hidden?0:j.verticalScrollbarSize,ie.width,ie.scrollWidth,he.scrollLeft),visibility:j.horizontal,extraScrollbarClassName:"horizontal",scrollable:N,scrollByPage:j.scrollByPage}),j.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((j.horizontalScrollbarSize-j.horizontalSliderSize)/2),0,void 0,j.horizontalSliderSize)}_updateSlider(N,j){this.slider.setWidth(N),this.slider.setLeft(j)}_renderDomNode(N,j){this.domNode.setWidth(N),this.domNode.setHeight(j),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(N){return this._shouldRender=this._onElementScrollSize(N.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(N.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(N.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(N,j){return N}_sliderPointerPosition(N){return N.pageX}_sliderOrthogonalPointerPosition(N){return N.pageY}_updateScrollbarSize(N){this.slider.setHeight(N)}writeScrollPosition(N,j){N.scrollLeft=j}updateOptions(N){this.updateScrollbarSize(N.horizontal===le.ScrollbarVisibility.Hidden?0:N.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(N.vertical===le.ScrollbarVisibility.Hidden?0:N.verticalScrollbarSize),this._visibilityController.setVisibility(N.horizontal),this._scrollByPage=N.scrollByPage}}j.HorizontalScrollbar=o},8234:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.DomScrollableElement=j.SmoothScrollableElement=j.ScrollableElement=j.AbstractScrollableElement=j.MouseWheelClassifier=void 0;const he=X(4333),ce=le(X(7093)),_e=X(9675),me=X(5964),ve=X(151),Se=X(5473),be=X(8286),Ce=X(1758),ye=X(802),we=X(7150),Ee=le(X(8163)),De=X(9881);class v{constructor(N,j,X){this.timestamp=N,this.deltaX=j,this.deltaY=X,this.score=0}}class S{static{this.INSTANCE=new S}constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(-1===this._front&&-1===this._rear)return!1;let N=1,j=0,X=1,ie=this._rear;for(;;){const se=ie===this._front?N:Math.pow(2,-X);if(N-=se,j+=this._memory[ie].score*se,ie===this._front)break;ie=(this._capacity+ie-1)%this._capacity,X++}return j<=.5}acceptStandardWheelEvent(N){if(he.isChrome){const j=ce.getWindow(N.browserEvent),X=(0,he.getZoomFactor)(j);this.accept(Date.now(),N.deltaX*X,N.deltaY*X)}else this.accept(Date.now(),N.deltaX,N.deltaY)}accept(N,j,X){let ie=null;const se=new v(N,j,X);-1===this._front&&-1===this._rear?(this._memory[0]=se,this._front=0,this._rear=0):(ie=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=se),se.score=this._computeScore(se,ie)}_computeScore(N,j){if(Math.abs(N.deltaX)>0&&Math.abs(N.deltaY)>0)return 1;let X=.5;if(this._isAlmostInt(N.deltaX)&&this._isAlmostInt(N.deltaY)||(X+=.25),j){const ie=Math.abs(N.deltaX),se=Math.abs(N.deltaY),le=Math.abs(j.deltaX),he=Math.abs(j.deltaY),ce=Math.max(Math.min(ie,le),1),_e=Math.max(Math.min(se,he),1),me=Math.max(ie,le),ve=Math.max(se,he);me%ce==0&&ve%_e==0&&(X-=.5)}return Math.min(Math.max(X,0),1)}_isAlmostInt(N){return Math.abs(Math.round(N)-N)<.01}}j.MouseWheelClassifier=S;class b extends be.Widget{get options(){return this._options}constructor(N,j,X){super(),this._onScroll=this._register(new ye.Emitter),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new ye.Emitter),this.onWillScroll=this._onWillScroll.event,this._options=function(N){const j={lazyRender:void 0!==N.lazyRender&&N.lazyRender,className:void 0!==N.className?N.className:"",useShadows:void 0===N.useShadows||N.useShadows,handleMouseWheel:void 0===N.handleMouseWheel||N.handleMouseWheel,flipAxes:void 0!==N.flipAxes&&N.flipAxes,consumeMouseWheelIfScrollbarIsNeeded:void 0!==N.consumeMouseWheelIfScrollbarIsNeeded&&N.consumeMouseWheelIfScrollbarIsNeeded,alwaysConsumeMouseWheel:void 0!==N.alwaysConsumeMouseWheel&&N.alwaysConsumeMouseWheel,scrollYToX:void 0!==N.scrollYToX&&N.scrollYToX,mouseWheelScrollSensitivity:void 0!==N.mouseWheelScrollSensitivity?N.mouseWheelScrollSensitivity:1,fastScrollSensitivity:void 0!==N.fastScrollSensitivity?N.fastScrollSensitivity:5,scrollPredominantAxis:void 0===N.scrollPredominantAxis||N.scrollPredominantAxis,mouseWheelSmoothScroll:void 0===N.mouseWheelSmoothScroll||N.mouseWheelSmoothScroll,arrowSize:void 0!==N.arrowSize?N.arrowSize:11,listenOnDomNode:void 0!==N.listenOnDomNode?N.listenOnDomNode:null,horizontal:void 0!==N.horizontal?N.horizontal:De.ScrollbarVisibility.Auto,horizontalScrollbarSize:void 0!==N.horizontalScrollbarSize?N.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==N.horizontalSliderSize?N.horizontalSliderSize:0,horizontalHasArrows:void 0!==N.horizontalHasArrows&&N.horizontalHasArrows,vertical:void 0!==N.vertical?N.vertical:De.ScrollbarVisibility.Auto,verticalScrollbarSize:void 0!==N.verticalScrollbarSize?N.verticalScrollbarSize:10,verticalHasArrows:void 0!==N.verticalHasArrows&&N.verticalHasArrows,verticalSliderSize:void 0!==N.verticalSliderSize?N.verticalSliderSize:0,scrollByPage:void 0!==N.scrollByPage&&N.scrollByPage};return j.horizontalSliderSize=void 0!==N.horizontalSliderSize?N.horizontalSliderSize:j.horizontalScrollbarSize,j.verticalSliderSize=void 0!==N.verticalSliderSize?N.verticalSliderSize:j.verticalScrollbarSize,Ee.isMacintosh&&(j.className+=" mac"),j}(j),this._scrollable=X,this._register(this._scrollable.onScroll((N=>{this._onWillScroll.fire(N),this._onDidScroll(N),this._onScroll.fire(N)})));const ie={onMouseWheel:N=>this._onMouseWheel(N),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new Se.VerticalScrollbar(this._scrollable,this._options,ie)),this._horizontalScrollbar=this._register(new ve.HorizontalScrollbar(this._scrollable,this._options,ie)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(N),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=(0,_e.createFastDomNode)(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=(0,_e.createFastDomNode)(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=(0,_e.createFastDomNode)(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,(N=>this._onMouseOver(N))),this.onmouseleave(this._listenOnDomNode,(N=>this._onMouseLeave(N))),this._hideTimeout=this._register(new Ce.TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=(0,we.dispose)(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(N){this._verticalScrollbar.delegatePointerDown(N)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(N){this._scrollable.setScrollDimensions(N,!1)}updateClassName(N){this._options.className=N,Ee.isMacintosh&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(N){void 0!==N.handleMouseWheel&&(this._options.handleMouseWheel=N.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),void 0!==N.mouseWheelScrollSensitivity&&(this._options.mouseWheelScrollSensitivity=N.mouseWheelScrollSensitivity),void 0!==N.fastScrollSensitivity&&(this._options.fastScrollSensitivity=N.fastScrollSensitivity),void 0!==N.scrollPredominantAxis&&(this._options.scrollPredominantAxis=N.scrollPredominantAxis),void 0!==N.horizontal&&(this._options.horizontal=N.horizontal),void 0!==N.vertical&&(this._options.vertical=N.vertical),void 0!==N.horizontalScrollbarSize&&(this._options.horizontalScrollbarSize=N.horizontalScrollbarSize),void 0!==N.verticalScrollbarSize&&(this._options.verticalScrollbarSize=N.verticalScrollbarSize),void 0!==N.scrollByPage&&(this._options.scrollByPage=N.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(N){this._revealOnScroll=N}delegateScrollFromMouseWheelEvent(N){this._onMouseWheel(new me.StandardWheelEvent(N))}_setListeningToMouseWheel(N){if(this._mouseWheelToDispose.length>0!==N&&(this._mouseWheelToDispose=(0,we.dispose)(this._mouseWheelToDispose),N)){const e=N=>{this._onMouseWheel(new me.StandardWheelEvent(N))};this._mouseWheelToDispose.push(ce.addDisposableListener(this._listenOnDomNode,ce.EventType.MOUSE_WHEEL,e,{passive:!1}))}}_onMouseWheel(N){if(N.browserEvent?.defaultPrevented)return;const j=S.INSTANCE;j.acceptStandardWheelEvent(N);let X=!1;if(N.deltaY||N.deltaX){let ie=N.deltaY*this._options.mouseWheelScrollSensitivity,se=N.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&se+ie===0?se=ie=0:Math.abs(ie)>=Math.abs(se)?se=0:ie=0),this._options.flipAxes&&([ie,se]=[se,ie]);const le=!Ee.isMacintosh&&N.browserEvent&&N.browserEvent.shiftKey;!this._options.scrollYToX&&!le||se||(se=ie,ie=0),N.browserEvent&&N.browserEvent.altKey&&(se*=this._options.fastScrollSensitivity,ie*=this._options.fastScrollSensitivity);const he=this._scrollable.getFutureScrollPosition();let ce={};if(ie){const N=50*ie,j=he.scrollTop-(N<0?Math.floor(N):Math.ceil(N));this._verticalScrollbar.writeScrollPosition(ce,j)}if(se){const N=50*se,j=he.scrollLeft-(N<0?Math.floor(N):Math.ceil(N));this._horizontalScrollbar.writeScrollPosition(ce,j)}ce=this._scrollable.validateScrollPosition(ce),(he.scrollLeft!==ce.scrollLeft||he.scrollTop!==ce.scrollTop)&&(this._options.mouseWheelSmoothScroll&&j.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(ce):this._scrollable.setScrollPositionNow(ce),X=!0)}let ie=X;!ie&&this._options.alwaysConsumeMouseWheel&&(ie=!0),!ie&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(ie=!0),ie&&(N.preventDefault(),N.stopPropagation())}_onDidScroll(N){this._shouldRender=this._horizontalScrollbar.onDidScroll(N)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(N)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const N=this._scrollable.getCurrentScrollPosition(),j=N.scrollTop>0,X=N.scrollLeft>0,ie=X?" left":"",se=j?" top":"",le=X||j?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${ie}`),this._topShadowDomNode.setClassName(`shadow${se}`),this._topLeftShadowDomNode.setClassName(`shadow${le}${se}${ie}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(N){this._mouseIsOver=!1,this._hide()}_onMouseOver(N){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet((()=>this._hide()),500)}}j.AbstractScrollableElement=b,j.ScrollableElement=class extends b{constructor(N,j){(j=j||{}).mouseWheelSmoothScroll=!1;const X=new De.Scrollable({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:j=>ce.scheduleAtNextAnimationFrame(ce.getWindow(N),j)});super(N,j,X),this._register(X)}setScrollPosition(N){this._scrollable.setScrollPositionNow(N)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},j.SmoothScrollableElement=class extends b{constructor(N,j,X){super(N,j,X)}setScrollPosition(N){N.reuseAnimation?this._scrollable.setScrollPositionSmooth(N,N.reuseAnimation):this._scrollable.setScrollPositionNow(N)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},j.DomScrollableElement=class extends b{constructor(N,j){(j=j||{}).mouseWheelSmoothScroll=!1;const X=new De.Scrollable({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:j=>ce.scheduleAtNextAnimationFrame(ce.getWindow(N),j)});super(N,j,X),this._register(X),this._element=N,this._register(this.onScroll((N=>{N.scrollTopChanged&&(this._element.scrollTop=N.scrollTop),N.scrollLeftChanged&&(this._element.scrollLeft=N.scrollLeft)}))),this.scanDomNode()}setScrollPosition(N){this._scrollable.setScrollPositionNow(N)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}},8974:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.ScrollbarArrow=j.ARROW_IMG_SIZE=void 0;const he=X(8328),ce=X(8286),_e=X(1758),me=le(X(7093));j.ARROW_IMG_SIZE=11;class c extends ce.Widget{constructor(N){super(),this._onActivate=N.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=N.bgWidth+"px",this.bgDomNode.style.height=N.bgHeight+"px",void 0!==N.top&&(this.bgDomNode.style.top="0px"),void 0!==N.left&&(this.bgDomNode.style.left="0px"),void 0!==N.bottom&&(this.bgDomNode.style.bottom="0px"),void 0!==N.right&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=N.className,this.domNode.style.position="absolute",this.domNode.style.width=j.ARROW_IMG_SIZE+"px",this.domNode.style.height=j.ARROW_IMG_SIZE+"px",void 0!==N.top&&(this.domNode.style.top=N.top+"px"),void 0!==N.left&&(this.domNode.style.left=N.left+"px"),void 0!==N.bottom&&(this.domNode.style.bottom=N.bottom+"px"),void 0!==N.right&&(this.domNode.style.right=N.right+"px"),this._pointerMoveMonitor=this._register(new he.GlobalPointerMoveMonitor),this._register(me.addStandardDisposableListener(this.bgDomNode,me.EventType.POINTER_DOWN,(N=>this._arrowPointerDown(N)))),this._register(me.addStandardDisposableListener(this.domNode,me.EventType.POINTER_DOWN,(N=>this._arrowPointerDown(N)))),this._pointerdownRepeatTimer=this._register(new me.WindowIntervalTimer),this._pointerdownScheduleRepeatTimer=this._register(new _e.TimeoutTimer)}_arrowPointerDown(N){N.target&&N.target instanceof Element&&(this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet((()=>{this._pointerdownRepeatTimer.cancelAndSet((()=>this._onActivate()),1e3/24,me.getWindow(N))}),200),this._pointerMoveMonitor.startMonitoring(N.target,N.pointerId,N.buttons,(N=>{}),(()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()})),N.preventDefault())}}j.ScrollbarArrow=c},8245:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ScrollbarState=void 0;class i{constructor(N,j,X,ie,se,le){this._scrollbarSize=Math.round(j),this._oppositeScrollbarSize=Math.round(X),this._arrowSize=Math.round(N),this._visibleSize=ie,this._scrollSize=se,this._scrollPosition=le,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new i(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(N){const j=Math.round(N);return this._visibleSize!==j&&(this._visibleSize=j,this._refreshComputedValues(),!0)}setScrollSize(N){const j=Math.round(N);return this._scrollSize!==j&&(this._scrollSize=j,this._refreshComputedValues(),!0)}setScrollPosition(N){const j=Math.round(N);return this._scrollPosition!==j&&(this._scrollPosition=j,this._refreshComputedValues(),!0)}setScrollbarSize(N){this._scrollbarSize=Math.round(N)}setOppositeScrollbarSize(N){this._oppositeScrollbarSize=Math.round(N)}static _computeValues(N,j,X,ie,se){const le=Math.max(0,X-N),he=Math.max(0,le-2*j),ce=ie>0&&ie>X;if(!ce)return{computedAvailableSize:Math.round(le),computedIsNeeded:ce,computedSliderSize:Math.round(he),computedSliderRatio:0,computedSliderPosition:0};const _e=Math.round(Math.max(20,Math.floor(X*he/ie))),me=(he-_e)/(ie-X),ve=se*me;return{computedAvailableSize:Math.round(le),computedIsNeeded:ce,computedSliderSize:Math.round(_e),computedSliderRatio:me,computedSliderPosition:Math.round(ve)}}_refreshComputedValues(){const N=i._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=N.computedAvailableSize,this._computedIsNeeded=N.computedIsNeeded,this._computedSliderSize=N.computedSliderSize,this._computedSliderRatio=N.computedSliderRatio,this._computedSliderPosition=N.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(N){if(!this._computedIsNeeded)return 0;const j=N-this._arrowSize-this._computedSliderSize/2;return Math.round(j/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(N){if(!this._computedIsNeeded)return 0;const j=N-this._arrowSize;let X=this._scrollPosition;return j<this._computedSliderPosition?X-=this._visibleSize:X+=this._visibleSize,X}getDesiredScrollPositionFromDelta(N){if(!this._computedIsNeeded)return 0;const j=this._computedSliderPosition+N;return Math.round(j/this._computedSliderRatio)}}j.ScrollbarState=i},79:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ScrollbarVisibilityController=void 0;const ie=X(1758),se=X(7150),le=X(9881);class o extends se.Disposable{constructor(N,j,X){super(),this._visibility=N,this._visibleClassName=j,this._invisibleClassName=X,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new ie.TimeoutTimer)}setVisibility(N){this._visibility!==N&&(this._visibility=N,this._updateShouldBeVisible())}setShouldBeVisible(N){this._rawShouldBeVisible=N,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility!==le.ScrollbarVisibility.Hidden&&(this._visibility===le.ScrollbarVisibility.Visible||this._rawShouldBeVisible)}_updateShouldBeVisible(){const N=this._applyVisibilitySetting();this._shouldBeVisible!==N&&(this._shouldBeVisible=N,this.ensureVisibility())}setIsNeeded(N){this._isNeeded!==N&&(this._isNeeded=N,this.ensureVisibility())}setDomNode(N){this._domNode=N,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet((()=>{this._domNode?.setClassName(this._visibleClassName)}),0))}_hide(N){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(N?" fade":"")))}}j.ScrollbarVisibilityController=o},5473:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.VerticalScrollbar=void 0;const ie=X(8801),se=X(8245),le=X(9881);class o extends ie.AbstractScrollbar{constructor(N,j,X){const ie=N.getScrollDimensions(),he=N.getCurrentScrollPosition();if(super({lazyRender:j.lazyRender,host:X,scrollbarState:new se.ScrollbarState(j.verticalHasArrows?j.arrowSize:0,j.vertical===le.ScrollbarVisibility.Hidden?0:j.verticalScrollbarSize,0,ie.height,ie.scrollHeight,he.scrollTop),visibility:j.vertical,extraScrollbarClassName:"vertical",scrollable:N,scrollByPage:j.scrollByPage}),j.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((j.verticalScrollbarSize-j.verticalSliderSize)/2),j.verticalSliderSize,void 0)}_updateSlider(N,j){this.slider.setHeight(N),this.slider.setTop(j)}_renderDomNode(N,j){this.domNode.setWidth(j),this.domNode.setHeight(N),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(N){return this._shouldRender=this._onElementScrollSize(N.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(N.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(N.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(N,j){return j}_sliderPointerPosition(N){return N.pageY}_sliderOrthogonalPointerPosition(N){return N.pageX}_updateScrollbarSize(N){this.slider.setWidth(N)}writeScrollPosition(N,j){N.scrollTop=j}updateOptions(N){this.updateScrollbarSize(N.vertical===le.ScrollbarVisibility.Hidden?0:N.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(N.vertical),this._scrollByPage=N.scrollByPage}}j.VerticalScrollbar=o},8286:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.Widget=void 0;const he=le(X(7093)),ce=X(5394),_e=X(5964),me=X(8594),ve=X(7150);class d extends ve.Disposable{onclick(N,j){this._register(he.addDisposableListener(N,he.EventType.CLICK,(X=>j(new _e.StandardMouseEvent(he.getWindow(N),X)))))}onmousedown(N,j){this._register(he.addDisposableListener(N,he.EventType.MOUSE_DOWN,(X=>j(new _e.StandardMouseEvent(he.getWindow(N),X)))))}onmouseover(N,j){this._register(he.addDisposableListener(N,he.EventType.MOUSE_OVER,(X=>j(new _e.StandardMouseEvent(he.getWindow(N),X)))))}onmouseleave(N,j){this._register(he.addDisposableListener(N,he.EventType.MOUSE_LEAVE,(X=>j(new _e.StandardMouseEvent(he.getWindow(N),X)))))}onkeydown(N,j){this._register(he.addDisposableListener(N,he.EventType.KEY_DOWN,(N=>j(new ce.StandardKeyboardEvent(N)))))}onkeyup(N,j){this._register(he.addDisposableListener(N,he.EventType.KEY_UP,(N=>j(new ce.StandardKeyboardEvent(N)))))}oninput(N,j){this._register(he.addDisposableListener(N,he.EventType.INPUT,j))}onblur(N,j){this._register(he.addDisposableListener(N,he.EventType.BLUR,j))}onfocus(N,j){this._register(he.addDisposableListener(N,he.EventType.FOCUS,j))}onchange(N,j){this._register(he.addDisposableListener(N,he.EventType.CHANGE,j))}ignoreGesture(N){return me.Gesture.ignoreTarget(N)}}j.Widget=d},4693:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.mainWindow=void 0,j.ensureCodeWindow=function(N,j){},j.mainWindow="object"==typeof window?window:globalThis},3058:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Permutation=j.CallbackIterable=j.ArrayQueue=j.booleanComparator=j.numberComparator=j.CompareResult=void 0,j.tail=function(N,j=0){return N[N.length-(1+j)]},j.tail2=function(N){if(0===N.length)throw new Error("Invalid tail call");return[N.slice(0,N.length-1),N[N.length-1]]},j.equals=function(N,j,X=(N,j)=>N===j){if(N===j)return!0;if(!N||!j)return!1;if(N.length!==j.length)return!1;for(let ie=0,se=N.length;ie<se;ie++)if(!X(N[ie],j[ie]))return!1;return!0},j.removeFastWithoutKeepingOrder=function(N,j){const X=N.length-1;j<X&&(N[j]=N[X]),N.pop()},j.binarySearch=function(N,j,X){return n(N.length,(ie=>X(N[ie],j)))},j.binarySearch2=n,j.quickSelect=function e(N,j,X){if((N|=0)>=j.length)throw new TypeError("invalid index");const ie=j[Math.floor(j.length*Math.random())],se=[],le=[],he=[];for(const N of j){const j=X(N,ie);j<0?se.push(N):j>0?le.push(N):he.push(N)}return N<se.length?e(N,se,X):N<se.length+he.length?he[0]:e(N-(se.length+he.length),le,X)},j.groupBy=function(N,j){const X=[];let ie;for(const se of N.slice(0).sort(j))ie&&0===j(ie[0],se)?ie.push(se):(ie=[se],X.push(ie));return X},j.groupAdjacentBy=function*(N,j){let X,ie;for(const se of N)void 0!==ie&&j(ie,se)?X.push(se):(X&&(yield X),X=[se]),ie=se;X&&(yield X)},j.forEachAdjacent=function(N,j){for(let X=0;X<=N.length;X++)j(0===X?void 0:N[X-1],X===N.length?void 0:N[X])},j.forEachWithNeighbors=function(N,j){for(let X=0;X<N.length;X++)j(0===X?void 0:N[X-1],N[X],X+1===N.length?void 0:N[X+1])},j.sortedDiff=o,j.delta=function(N,j,X){const ie=o(N,j,X),se=[],le=[];for(const j of ie)se.push(...N.slice(j.start,j.start+j.deleteCount)),le.push(...j.toInsert);return{removed:se,added:le}},j.top=function(N,j,X){if(0===X)return[];const ie=N.slice(0,X).sort(j);return a(N,j,ie,X,N.length),ie},j.topAsync=function(N,j,X,se,le){return 0===X?Promise.resolve([]):new Promise(((he,ce)=>{(async()=>{const he=N.length,ce=N.slice(0,X).sort(j);for(let _e=X,me=Math.min(X+se,he);_e<he;_e=me,me=Math.min(me+se,he)){if(_e>X&&await new Promise((N=>setTimeout(N))),le&&le.isCancellationRequested)throw new ie.CancellationError;a(N,j,ce,_e,me)}return ce})().then(he,ce)}))},j.coalesce=function(N){return N.filter((N=>!!N))},j.coalesceInPlace=function(N){let j=0;for(let X=0;X<N.length;X++)N[X]&&(N[j]=N[X],j+=1);N.length=j},j.move=function(N,j,X){N.splice(X,0,N.splice(j,1)[0])},j.isFalsyOrEmpty=function(N){return!Array.isArray(N)||0===N.length},j.isNonEmptyArray=function(N){return Array.isArray(N)&&N.length>0},j.distinct=function(N,j=N=>N){const X=new Set;return N.filter((N=>{const ie=j(N);return!X.has(ie)&&(X.add(ie),!0)}))},j.uniqueFilter=function(N){const j=new Set;return X=>{const ie=N(X);return!j.has(ie)&&(j.add(ie),!0)}},j.firstOrDefault=function(N,j){return N.length>0?N[0]:j},j.lastOrDefault=function(N,j){return N.length>0?N[N.length-1]:j},j.commonPrefixLength=function(N,j,X=(N,j)=>N===j){let ie=0;for(let se=0,le=Math.min(N.length,j.length);se<le&&X(N[se],j[se]);se++)ie++;return ie},j.range=function(N,j){let X="number"==typeof j?N:0;"number"==typeof j?X=N:(X=0,j=N);const ie=[];if(X<=j)for(let N=X;N<j;N++)ie.push(N);else for(let N=X;N>j;N--)ie.push(N);return ie},j.index=function(N,j,X){return N.reduce(((N,ie)=>(N[j(ie)]=X?X(ie):ie,N)),Object.create(null))},j.insert=function(N,j){return N.push(j),()=>l(N,j)},j.remove=l,j.arrayInsert=function(N,j,X){const ie=N.slice(0,j),se=N.slice(j);return ie.concat(X,se)},j.shuffle=function(N,j){let X;if("number"==typeof j){let N=j;X=()=>{const j=179426549*Math.sin(N++);return j-Math.floor(j)}}else X=Math.random;for(let j=N.length-1;j>0;j-=1){const ie=Math.floor(X()*(j+1)),se=N[j];N[j]=N[ie],N[ie]=se}},j.pushToStart=function(N,j){const X=N.indexOf(j);X>-1&&(N.splice(X,1),N.unshift(j))},j.pushToEnd=function(N,j){const X=N.indexOf(j);X>-1&&(N.splice(X,1),N.push(j))},j.pushMany=function(N,j){for(const X of j)N.push(X)},j.mapArrayOrNot=function(N,j){return Array.isArray(N)?N.map(j):j(N)},j.asArray=function(N){return Array.isArray(N)?N:[N]},j.getRandomElement=function(N){return N[Math.floor(Math.random()*N.length)]},j.insertInto=h,j.splice=function(N,j,X,ie){const se=c(N,j);let le=N.splice(se,X);return void 0===le&&(le=[]),h(N,se,ie),le},j.compareBy=function(N,j){return(X,ie)=>j(N(X),N(ie))},j.tieBreakComparators=function(...N){return(j,X)=>{for(const ie of N){const N=ie(j,X);if(!le.isNeitherLessOrGreaterThan(N))return N}return le.neitherLessOrGreaterThan}},j.reverseOrder=function(N){return(j,X)=>-N(j,X)};const ie=X(9807),se=X(8297);function n(N,j){let X=0,ie=N-1;for(;X<=ie;){const N=(X+ie)/2|0,se=j(N);if(se<0)X=N+1;else{if(!(se>0))return N;ie=N-1}}return-(X+1)}function o(N,j,X){const ie=[];function r(N,j,X){if(0===j&&0===X.length)return;const se=ie[ie.length-1];se&&se.start+se.deleteCount===N?(se.deleteCount+=j,se.toInsert.push(...X)):ie.push({start:N,deleteCount:j,toInsert:X})}let se=0,le=0;for(;;){if(se===N.length){r(se,0,j.slice(le));break}if(le===j.length){r(se,N.length-se,[]);break}const ie=N[se],he=j[le],ce=X(ie,he);0===ce?(se+=1,le+=1):ce<0?(r(se,1,[]),se+=1):ce>0&&(r(se,0,[he]),le+=1)}return ie}function a(N,j,X,ie,le){for(const he=X.length;ie<le;ie++){const le=N[ie];if(j(le,X[he-1])<0){X.pop();const N=(0,se.findFirstIdxMonotonousOrArrLen)(X,(N=>j(le,N)<0));X.splice(N,0,le)}}}function l(N,j){const X=N.indexOf(j);if(X>-1)return N.splice(X,1),j}function h(N,j,X){const ie=c(N,j),se=N.length,le=X.length;N.length=se+le;for(let j=se-1;j>=ie;j--)N[j+le]=N[j];for(let j=0;j<le;j++)N[j+ie]=X[j]}function c(N,j){return j<0?Math.max(j+N.length,0):Math.min(j,N.length)}var le;!function(N){N.isLessThan=function(N){return N<0},N.isLessThanOrEqual=function(N){return N<=0},N.isGreaterThan=function(N){return N>0},N.isNeitherLessOrGreaterThan=function(N){return 0===N},N.greaterThan=1,N.lessThan=-1,N.neitherLessOrGreaterThan=0}(le||(j.CompareResult=le={})),j.numberComparator=(N,j)=>N-j,j.booleanComparator=(N,X)=>(0,j.numberComparator)(N?1:0,X?1:0),j.ArrayQueue=class{constructor(N){this.items=N,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(N){let j=this.firstIdx;for(;j<this.items.length&&N(this.items[j]);)j++;const X=j===this.firstIdx?null:this.items.slice(this.firstIdx,j);return this.firstIdx=j,X}takeFromEndWhile(N){let j=this.lastIdx;for(;j>=0&&N(this.items[j]);)j--;const X=j===this.lastIdx?null:this.items.slice(j+1,this.lastIdx+1);return this.lastIdx=j,X}peek(){if(0!==this.length)return this.items[this.firstIdx]}peekLast(){if(0!==this.length)return this.items[this.lastIdx]}dequeue(){const N=this.items[this.firstIdx];return this.firstIdx++,N}removeLast(){const N=this.items[this.lastIdx];return this.lastIdx--,N}takeCount(N){const j=this.items.slice(this.firstIdx,this.firstIdx+N);return this.firstIdx+=N,j}};class u{static{this.empty=new u((N=>{}))}constructor(N){this.iterate=N}forEach(N){this.iterate((j=>(N(j),!0)))}toArray(){const N=[];return this.iterate((j=>(N.push(j),!0))),N}filter(N){return new u((j=>this.iterate((X=>!N(X)||j(X)))))}map(N){return new u((j=>this.iterate((X=>j(N(X))))))}some(N){let j=!1;return this.iterate((X=>(j=N(X),!j))),j}findFirst(N){let j;return this.iterate((X=>!N(X)||(j=X,!1))),j}findLast(N){let j;return this.iterate((X=>(N(X)&&(j=X),!0))),j}findLastMaxBy(N){let j,X=!0;return this.iterate((ie=>((X||le.isGreaterThan(N(ie,j)))&&(X=!1,j=ie),!0))),j}}j.CallbackIterable=u;class _{constructor(N){this._indexMap=N}static createSortPermutation(N,j){const X=Array.from(N.keys()).sort(((X,ie)=>j(N[X],N[ie])));return new _(X)}apply(N){return N.map(((j,X)=>N[this._indexMap[X]]))}inverse(){const N=this._indexMap.slice();for(let j=0;j<this._indexMap.length;j++)N[this._indexMap[j]]=j;return new _(N)}}j.Permutation=_},8297:(N,j)=>{function i(N,j,X=N.length-1){for(let ie=X;ie>=0;ie--)if(j(N[ie]))return ie;return-1}function s(N,j,X=0,ie=N.length){let se=X,le=ie;for(;se<le;){const X=Math.floor((se+le)/2);j(N[X])?se=X+1:le=X}return se-1}function r(N,j,X=0,ie=N.length){let se=X,le=ie;for(;se<le;){const X=Math.floor((se+le)/2);j(N[X])?le=X:se=X+1}return se}Object.defineProperty(j,"__esModule",{value:!0}),j.MonotonousArray=void 0,j.findLast=function(N,j){const X=i(N,j);if(-1!==X)return N[X]},j.findLastIdx=i,j.findLastMonotonous=function(N,j){const X=s(N,j);return-1===X?void 0:N[X]},j.findLastIdxMonotonous=s,j.findFirstMonotonous=function(N,j){const X=r(N,j);return X===N.length?void 0:N[X]},j.findFirstIdxMonotonousOrArrLen=r,j.findFirstIdxMonotonous=function(N,j,X=0,ie=N.length){const se=r(N,j,X,ie);return se===N.length?-1:se},j.findFirstMax=o,j.findLastMax=function(N,j){if(0===N.length)return;let X=N[0];for(let ie=1;ie<N.length;ie++){const se=N[ie];j(se,X)>=0&&(X=se)}return X},j.findFirstMin=function(N,j){return o(N,((N,X)=>-j(N,X)))},j.findMaxIdx=function(N,j){if(0===N.length)return-1;let X=0;for(let ie=1;ie<N.length;ie++)j(N[ie],N[X])>0&&(X=ie);return X},j.mapFindFirst=function(N,j){for(const X of N){const N=j(X);if(void 0!==N)return N}};class n{static{this.assertInvariants=!1}constructor(N){this._array=N,this._findLastMonotonousLastIdx=0}findLastMonotonous(N){if(n.assertInvariants){if(this._prevFindLastPredicate)for(const j of this._array)if(this._prevFindLastPredicate(j)&&!N(j))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.");this._prevFindLastPredicate=N}const j=s(this._array,N,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=j+1,-1===j?void 0:this._array[j]}}function o(N,j){if(0===N.length)return;let X=N[0];for(let ie=1;ie<N.length;ie++){const se=N[ie];j(se,X)>0&&(X=se)}return X}j.MonotonousArray=n},1758:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.AsyncIterableSource=j.CancelableAsyncIterableObject=j.AsyncIterableObject=j.LazyStatefulPromise=j.StatefulPromise=j.Promises=j.DeferredPromise=j.IntervalCounter=j.TaskSequentializer=j.GlobalIdleValue=j.AbstractIdleValue=j._runWhenIdle=j.runWhenGlobalIdle=j.ThrottledWorker=j.RunOnceWorker=j.ProcessTimeRunOnceScheduler=j.RunOnceScheduler=j.IntervalTimer=j.TimeoutTimer=j.LimitedQueue=j.Queue=j.Limiter=j.AutoOpenBarrier=j.Barrier=j.ThrottledDelayer=j.Delayer=j.SequencerByKey=j.Sequencer=j.Throttler=void 0,j.isThenable=c,j.createCancelablePromise=d,j.raceCancellation=function(N,j,X){return new Promise(((ie,se)=>{const le=j.onCancellationRequested((()=>{le.dispose(),ie(X)}));N.then(ie,se).finally((()=>le.dispose()))}))},j.raceCancellationError=function(N,j){return new Promise(((X,ie)=>{const le=j.onCancellationRequested((()=>{le.dispose(),ie(new se.CancellationError)}));N.then(X,ie).finally((()=>le.dispose()))}))},j.raceCancellablePromises=async function(N){let j=-1;const X=N.map(((N,X)=>N.then((N=>(j=X,N)))));try{return await Promise.race(X)}finally{N.forEach(((N,X)=>{X!==j&&N.cancel()}))}},j.raceTimeout=function(N,j,X){let ie;const se=setTimeout((()=>{ie?.(void 0),X?.()}),j);return Promise.race([N.finally((()=>clearTimeout(se))),new Promise((N=>ie=N))])},j.asPromise=function(N){return new Promise(((j,X)=>{const ie=N();c(ie)?ie.then(j,X):j(ie)}))},j.promiseWithResolvers=u,j.timeout=g,j.disposableTimeout=function(N,j=0,X){const ie=setTimeout((()=>{N(),X&&se.dispose()}),j),se=(0,he.toDisposable)((()=>{clearTimeout(ie),X?.deleteAndLeak(se)}));return X?.add(se),se},j.sequence=function(N){const j=[];let X=0;const ie=N.length;return Promise.resolve(null).then((function r(se){null!=se&&j.push(se);const le=X<ie?N[X++]():null;return le?le.then(r):Promise.resolve(j)}))},j.first=function(N,j=N=>!!N,X=null){let ie=0;const se=N.length,n=()=>{if(ie>=se)return Promise.resolve(X);const le=N[ie++];return Promise.resolve(le()).then((N=>j(N)?Promise.resolve(N):n()))};return n()},j.firstParallel=function(N,j=N=>!!N,X=null){if(0===N.length)return Promise.resolve(X);let ie=N.length;const r=()=>{ie=-1;for(const j of N)j.cancel?.()};return new Promise(((se,le)=>{for(const he of N)he.then((N=>{--ie>=0&&j(N)?(r(),se(N)):0===ie&&se(X)})).catch((N=>{--ie>=0&&(r(),le(N))}))}))},j.retry=async function(N,j,X){let ie;for(let se=0;se<X;se++)try{return await N()}catch(N){ie=N,await g(j)}throw ie},j.createCancelableAsyncIterable=function(N){const j=new ie.CancellationTokenSource,X=N(j.token);return new R(j,(async N=>{const ie=j.token.onCancellationRequested((()=>{ie.dispose(),j.dispose(),N.reject(new se.CancellationError)}));try{for await(const ie of X){if(j.token.isCancellationRequested)return;N.emitOne(ie)}ie.dispose(),j.dispose()}catch(X){ie.dispose(),j.dispose(),N.reject(X)}}))};const ie=X(8447),se=X(9807),le=X(802),he=X(7150),ce=X(8163),_e=X(5015),me=X(626);function c(N){return!!N&&"function"==typeof N.then}function d(N){const j=new ie.CancellationTokenSource,X=N(j.token),le=new Promise(((N,ie)=>{const le=j.token.onCancellationRequested((()=>{le.dispose(),ie(new se.CancellationError)}));Promise.resolve(X).then((X=>{le.dispose(),j.dispose(),N(X)}),(N=>{le.dispose(),j.dispose(),ie(N)}))}));return new class{cancel(){j.cancel(),j.dispose()}then(N,j){return le.then(N,j)}catch(N){return this.then(void 0,N)}finally(N){return le.finally(N)}}}function u(){let N,j;return{promise:new Promise(((X,ie)=>{N=X,j=ie})),resolve:N,reject:j}}class _{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(N){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=N,!this.queuedPromise){const e=()=>{if(this.queuedPromise=null,this.isDisposed)return;const N=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,N};this.queuedPromise=new Promise((N=>{this.activePromise.then(e,e).then(N)}))}return new Promise(((N,j)=>{this.queuedPromise.then(N,j)}))}return this.activePromise=N(),new Promise(((N,j)=>{this.activePromise.then((j=>{this.activePromise=null,N(j)}),(N=>{this.activePromise=null,j(N)}))}))}dispose(){this.isDisposed=!0}}j.Throttler=_,j.Sequencer=class{constructor(){this.current=Promise.resolve(null)}queue(N){return this.current=this.current.then((()=>N()),(()=>N()))}},j.SequencerByKey=class{constructor(){this.promiseMap=new Map}queue(N,j){const X=(this.promiseMap.get(N)??Promise.resolve()).catch((()=>{})).then(j).finally((()=>{this.promiseMap.get(N)===X&&this.promiseMap.delete(N)}));return this.promiseMap.set(N,X),X}};class f{constructor(N){this.defaultDelay=N,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(N,j=this.defaultDelay){this.task=N,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((N,j)=>{this.doResolve=N,this.doReject=j})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const N=this.task;return this.task=null,N()}})));const i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=j===_e.MicrotaskDelay?(N=>{let j=!0;return queueMicrotask((()=>{j&&(j=!1,N())})),{isTriggered:()=>j,dispose:()=>{j=!1}}})(i):((N,j)=>{let X=!0;const ie=setTimeout((()=>{X=!1,j()}),N);return{isTriggered:()=>X,dispose:()=>{clearTimeout(ie),X=!1}}})(j,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new se.CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}j.Delayer=f,j.ThrottledDelayer=class{constructor(N){this.delayer=new f(N),this.throttler=new _}trigger(N,j){return this.delayer.trigger((()=>this.throttler.queue(N)),j)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};class p{constructor(){this._isOpen=!1,this._promise=new Promise(((N,j)=>{this._completePromise=N}))}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function g(N,j){return j?new Promise(((X,ie)=>{const le=setTimeout((()=>{he.dispose(),X()}),N),he=j.onCancellationRequested((()=>{clearTimeout(le),he.dispose(),ie(new se.CancellationError)}))})):d((j=>g(N,j)))}j.Barrier=p,j.AutoOpenBarrier=class extends p{constructor(N){super(),this._timeout=setTimeout((()=>this.open()),N)}open(){clearTimeout(this._timeout),super.open()}};class m{constructor(N){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=N,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new le.Emitter}whenIdle(){return this.size>0?le.Event.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(N){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise(((j,X)=>{this.outstandingPromises.push({factory:N,c:j,e:X}),this.consume()}))}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const N=this.outstandingPromises.shift();this.runningPromises++;const j=N.factory();j.then(N.c,N.e),j.then((()=>this.consumed()),(()=>this.consumed()))}}consumed(){this._isDisposed||(this.runningPromises--,0==--this._size&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}j.Limiter=m,j.Queue=class extends m{constructor(){super(1)}},j.LimitedQueue=class{constructor(){this.sequentializer=new C,this.tasks=0}queue(N){return this.sequentializer.isRunning()?this.sequentializer.queue((()=>this.sequentializer.run(this.tasks++,N()))):this.sequentializer.run(this.tasks++,N())}},j.TimeoutTimer=class{constructor(N,j){this._isDisposed=!1,this._token=-1,"function"==typeof N&&"number"==typeof j&&this.setIfNotSet(N,j)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(N,j){if(this._isDisposed)throw new se.BugIndicatingError("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout((()=>{this._token=-1,N()}),j)}setIfNotSet(N,j){if(this._isDisposed)throw new se.BugIndicatingError("Calling 'setIfNotSet' on a disposed TimeoutTimer");-1===this._token&&(this._token=setTimeout((()=>{this._token=-1,N()}),j))}},j.IntervalTimer=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(N,j,X=globalThis){if(this.isDisposed)throw new se.BugIndicatingError("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const ie=X.setInterval((()=>{N()}),j);this.disposable=(0,he.toDisposable)((()=>{X.clearInterval(ie),this.disposable=void 0}))}dispose(){this.cancel(),this.isDisposed=!0}};class v{constructor(N,j){this.timeoutToken=-1,this.runner=N,this.timeout=j,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(N=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,N)}get delay(){return this.timeout}set delay(N){this.timeout=N}isScheduled(){return-1!==this.timeoutToken}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}j.RunOnceScheduler=v,j.ProcessTimeRunOnceScheduler=class{constructor(N,j){j%1e3!=0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${j}ms is not a multiple of 1000ms.`),this.runner=N,this.timeout=j,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(N=this.timeout){N%1e3!=0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${N}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(N/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return-1!==this.intervalToken}onInterval(){this.counter--,this.counter>0||(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner?.())}},j.RunOnceWorker=class extends v{constructor(N,j){super(N,j),this.units=[]}work(N){this.units.push(N),this.isScheduled()||this.schedule()}doRun(){const N=this.units;this.units=[],this.runner?.(N)}dispose(){this.units=[],super.dispose()}};class S extends he.Disposable{constructor(N,j){super(),this.options=N,this.handler=j,this.pendingWork=[],this.throttler=this._register(new he.MutableDisposable),this.disposed=!1}get pending(){return this.pendingWork.length}work(N){if(this.disposed)return!1;if("number"==typeof this.options.maxBufferedWork)if(this.throttler.value){if(this.pending+N.length>this.options.maxBufferedWork)return!1}else if(this.pending+N.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1;for(const j of N)this.pendingWork.push(j);return this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new v((()=>{this.throttler.clear(),this.doWork()}),this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}}j.ThrottledWorker=S,"function"!=typeof globalThis.requestIdleCallback||"function"!=typeof globalThis.cancelIdleCallback?j._runWhenIdle=(N,j)=>{(0,ce.setTimeout0)((()=>{if(X)return;const N=Date.now()+15,ie={didTimeout:!0,timeRemaining:()=>Math.max(0,N-Date.now())};j(Object.freeze(ie))}));let X=!1;return{dispose(){X||(X=!0)}}}:j._runWhenIdle=(N,j,X)=>{const ie=N.requestIdleCallback(j,"number"==typeof X?{timeout:X}:void 0);let se=!1;return{dispose(){se||(se=!0,N.cancelIdleCallback(ie))}}},j.runWhenGlobalIdle=N=>(0,j._runWhenIdle)(globalThis,N);class b{constructor(N,X){this._didRun=!1,this._executor=()=>{try{this._value=X()}catch(N){this._error=N}finally{this._didRun=!0}},this._handle=(0,j._runWhenIdle)(N,(()=>this._executor()))}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}j.AbstractIdleValue=b,j.GlobalIdleValue=class extends b{constructor(N){super(globalThis,N)}};class C{isRunning(N){return"number"==typeof N?this._running?.taskId===N:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(N,j,X){return this._running={taskId:N,cancel:()=>X?.(),promise:j},j.then((()=>this.doneRunning(N)),(()=>this.doneRunning(N))),j}doneRunning(N){this._running&&N===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){const N=this._queued;this._queued=void 0,N.run().then(N.promiseResolve,N.promiseReject)}}queue(N){if(this._queued)this._queued.run=N;else{const{promise:j,resolve:X,reject:ie}=u();this._queued={run:N,promise:j,promiseResolve:X,promiseReject:ie}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}}var ve,Se,be;j.TaskSequentializer=C,j.IntervalCounter=class{constructor(N,j=()=>Date.now()){this.interval=N,this.nowFn=j,this.lastIncrementTime=0,this.value=0}increment(){const N=this.nowFn();return N-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=N,this.value=0),this.value++,this.value}},function(N){N[N.Resolved=0]="Resolved",N[N.Rejected=1]="Rejected"}(ve||(ve={}));class D{get isRejected(){return this.outcome?.outcome===ve.Rejected}get isResolved(){return this.outcome?.outcome===ve.Resolved}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===ve.Resolved?this.outcome?.value:void 0}constructor(){this.p=new Promise(((N,j)=>{this.completeCallback=N,this.errorCallback=j}))}complete(N){return new Promise((j=>{this.completeCallback(N),this.outcome={outcome:ve.Resolved,value:N},j()}))}error(N){return new Promise((j=>{this.errorCallback(N),this.outcome={outcome:ve.Rejected,value:N},j()}))}cancel(){return this.error(new se.CancellationError)}}j.DeferredPromise=D,function(N){N.settled=async function(N){let j;const X=await Promise.all(N.map((N=>N.then((N=>N),(N=>{j||(j=N)})))));if(void 0!==j)throw j;return X},N.withAsyncBody=function(N){return new Promise((async(j,X)=>{try{await N(j,X)}catch(N){X(N)}}))}}(Se||(j.Promises=Se={}));class L{get value(){return this._value}get error(){return this._error}get isResolved(){return this._isResolved}constructor(N){this._value=void 0,this._error=void 0,this._isResolved=!1,this.promise=N.then((N=>(this._value=N,this._isResolved=!0,N)),(N=>{throw this._error=N,this._isResolved=!0,N}))}requireValue(){if(!this._isResolved)throw new se.BugIndicatingError("Promise is not resolved yet");if(this._error)throw this._error;return this._value}}j.StatefulPromise=L,j.LazyStatefulPromise=class{constructor(N){this._compute=N,this._promise=new me.Lazy((()=>new L(this._compute())))}requireValue(){return this._promise.value.requireValue()}getPromise(){return this._promise.value.promise}get currentValue(){return this._promise.rawValue?.value}},function(N){N[N.Initial=0]="Initial",N[N.DoneOK=1]="DoneOK",N[N.DoneError=2]="DoneError"}(be||(be={}));class A{static fromArray(N){return new A((j=>{j.emitMany(N)}))}static fromPromise(N){return new A((async j=>{j.emitMany(await N)}))}static fromPromises(N){return new A((async j=>{await Promise.all(N.map((async N=>j.emitOne(await N))))}))}static merge(N){return new A((async j=>{await Promise.all(N.map((async N=>{for await(const X of N)j.emitOne(X)})))}))}static{this.EMPTY=A.fromArray([])}constructor(N,j){this._state=be.Initial,this._results=[],this._error=null,this._onReturn=j,this._onStateChanged=new le.Emitter,queueMicrotask((async()=>{const j={emitOne:N=>this.emitOne(N),emitMany:N=>this.emitMany(N),reject:N=>this.reject(N)};try{await Promise.resolve(N(j)),this.resolve()}catch(N){this.reject(N)}finally{j.emitOne=void 0,j.emitMany=void 0,j.reject=void 0}}))}[Symbol.asyncIterator](){let N=0;return{next:async()=>{for(;;){if(this._state===be.DoneError)throw this._error;if(N<this._results.length)return{done:!1,value:this._results[N++]};if(this._state===be.DoneOK)return{done:!0,value:void 0};await le.Event.toPromise(this._onStateChanged.event)}},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(N,j){return new A((async X=>{for await(const ie of N)X.emitOne(j(ie))}))}map(N){return A.map(this,N)}static filter(N,j){return new A((async X=>{for await(const ie of N)j(ie)&&X.emitOne(ie)}))}filter(N){return A.filter(this,N)}static coalesce(N){return A.filter(N,(N=>!!N))}coalesce(){return A.coalesce(this)}static async toPromise(N){const j=[];for await(const X of N)j.push(X);return j}toPromise(){return A.toPromise(this)}emitOne(N){this._state===be.Initial&&(this._results.push(N),this._onStateChanged.fire())}emitMany(N){this._state===be.Initial&&(this._results=this._results.concat(N),this._onStateChanged.fire())}resolve(){this._state===be.Initial&&(this._state=be.DoneOK,this._onStateChanged.fire())}reject(N){this._state===be.Initial&&(this._state=be.DoneError,this._error=N,this._onStateChanged.fire())}}j.AsyncIterableObject=A;class R extends A{constructor(N,j){super(j),this._source=N}cancel(){this._source.cancel()}}j.CancelableAsyncIterableObject=R,j.AsyncIterableSource=class{constructor(N){let j,X;this._deferred=new D,this._asyncIterable=new A((N=>{if(!j)return X&&N.emitMany(X),this._errorFn=j=>N.reject(j),this._emitFn=j=>N.emitOne(j),this._deferred.p;N.reject(j)}),N),this._emitFn=N=>{X||(X=[]),X.push(N)},this._errorFn=N=>{j||(j=N)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(N){this._errorFn(N),this._deferred.complete()}emitOne(N){this._emitFn(N)}}},8447:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.CancellationTokenSource=j.CancellationToken=void 0,j.cancelOnDispose=function(N){const j=new a;return N.add({dispose(){j.cancel()}}),j.token};const ie=X(802),se=Object.freeze((function(N,j){const X=setTimeout(N.bind(j),0);return{dispose(){clearTimeout(X)}}}));var le;!function(N){N.isCancellationToken=function(j){return j===N.None||j===N.Cancelled||j instanceof o||!(!j||"object"!=typeof j)&&"boolean"==typeof j.isCancellationRequested&&"function"==typeof j.onCancellationRequested},N.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ie.Event.None}),N.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:se})}(le||(j.CancellationToken=le={}));class o{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?se:(this._emitter||(this._emitter=new ie.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class a{constructor(N){this._token=void 0,this._parentListener=void 0,this._parentListener=N&&N.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new o),this._token}cancel(){this._token?this._token instanceof o&&this._token.cancel():this._token=le.Cancelled}dispose(N=!1){N&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof o&&this._token.dispose():this._token=le.None}}j.CancellationTokenSource=a},4869:(N,j)=>{var X;Object.defineProperty(j,"__esModule",{value:!0}),j.CharCode=void 0,function(N){N[N.Null=0]="Null",N[N.Backspace=8]="Backspace",N[N.Tab=9]="Tab",N[N.LineFeed=10]="LineFeed",N[N.CarriageReturn=13]="CarriageReturn",N[N.Space=32]="Space",N[N.ExclamationMark=33]="ExclamationMark",N[N.DoubleQuote=34]="DoubleQuote",N[N.Hash=35]="Hash",N[N.DollarSign=36]="DollarSign",N[N.PercentSign=37]="PercentSign",N[N.Ampersand=38]="Ampersand",N[N.SingleQuote=39]="SingleQuote",N[N.OpenParen=40]="OpenParen",N[N.CloseParen=41]="CloseParen",N[N.Asterisk=42]="Asterisk",N[N.Plus=43]="Plus",N[N.Comma=44]="Comma",N[N.Dash=45]="Dash",N[N.Period=46]="Period",N[N.Slash=47]="Slash",N[N.Digit0=48]="Digit0",N[N.Digit1=49]="Digit1",N[N.Digit2=50]="Digit2",N[N.Digit3=51]="Digit3",N[N.Digit4=52]="Digit4",N[N.Digit5=53]="Digit5",N[N.Digit6=54]="Digit6",N[N.Digit7=55]="Digit7",N[N.Digit8=56]="Digit8",N[N.Digit9=57]="Digit9",N[N.Colon=58]="Colon",N[N.Semicolon=59]="Semicolon",N[N.LessThan=60]="LessThan",N[N.Equals=61]="Equals",N[N.GreaterThan=62]="GreaterThan",N[N.QuestionMark=63]="QuestionMark",N[N.AtSign=64]="AtSign",N[N.A=65]="A",N[N.B=66]="B",N[N.C=67]="C",N[N.D=68]="D",N[N.E=69]="E",N[N.F=70]="F",N[N.G=71]="G",N[N.H=72]="H",N[N.I=73]="I",N[N.J=74]="J",N[N.K=75]="K",N[N.L=76]="L",N[N.M=77]="M",N[N.N=78]="N",N[N.O=79]="O",N[N.P=80]="P",N[N.Q=81]="Q",N[N.R=82]="R",N[N.S=83]="S",N[N.T=84]="T",N[N.U=85]="U",N[N.V=86]="V",N[N.W=87]="W",N[N.X=88]="X",N[N.Y=89]="Y",N[N.Z=90]="Z",N[N.OpenSquareBracket=91]="OpenSquareBracket",N[N.Backslash=92]="Backslash",N[N.CloseSquareBracket=93]="CloseSquareBracket",N[N.Caret=94]="Caret",N[N.Underline=95]="Underline",N[N.BackTick=96]="BackTick",N[N.a=97]="a",N[N.b=98]="b",N[N.c=99]="c",N[N.d=100]="d",N[N.e=101]="e",N[N.f=102]="f",N[N.g=103]="g",N[N.h=104]="h",N[N.i=105]="i",N[N.j=106]="j",N[N.k=107]="k",N[N.l=108]="l",N[N.m=109]="m",N[N.n=110]="n",N[N.o=111]="o",N[N.p=112]="p",N[N.q=113]="q",N[N.r=114]="r",N[N.s=115]="s",N[N.t=116]="t",N[N.u=117]="u",N[N.v=118]="v",N[N.w=119]="w",N[N.x=120]="x",N[N.y=121]="y",N[N.z=122]="z",N[N.OpenCurlyBrace=123]="OpenCurlyBrace",N[N.Pipe=124]="Pipe",N[N.CloseCurlyBrace=125]="CloseCurlyBrace",N[N.Tilde=126]="Tilde",N[N.NoBreakSpace=160]="NoBreakSpace",N[N.U_Combining_Grave_Accent=768]="U_Combining_Grave_Accent",N[N.U_Combining_Acute_Accent=769]="U_Combining_Acute_Accent",N[N.U_Combining_Circumflex_Accent=770]="U_Combining_Circumflex_Accent",N[N.U_Combining_Tilde=771]="U_Combining_Tilde",N[N.U_Combining_Macron=772]="U_Combining_Macron",N[N.U_Combining_Overline=773]="U_Combining_Overline",N[N.U_Combining_Breve=774]="U_Combining_Breve",N[N.U_Combining_Dot_Above=775]="U_Combining_Dot_Above",N[N.U_Combining_Diaeresis=776]="U_Combining_Diaeresis",N[N.U_Combining_Hook_Above=777]="U_Combining_Hook_Above",N[N.U_Combining_Ring_Above=778]="U_Combining_Ring_Above",N[N.U_Combining_Double_Acute_Accent=779]="U_Combining_Double_Acute_Accent",N[N.U_Combining_Caron=780]="U_Combining_Caron",N[N.U_Combining_Vertical_Line_Above=781]="U_Combining_Vertical_Line_Above",N[N.U_Combining_Double_Vertical_Line_Above=782]="U_Combining_Double_Vertical_Line_Above",N[N.U_Combining_Double_Grave_Accent=783]="U_Combining_Double_Grave_Accent",N[N.U_Combining_Candrabindu=784]="U_Combining_Candrabindu",N[N.U_Combining_Inverted_Breve=785]="U_Combining_Inverted_Breve",N[N.U_Combining_Turned_Comma_Above=786]="U_Combining_Turned_Comma_Above",N[N.U_Combining_Comma_Above=787]="U_Combining_Comma_Above",N[N.U_Combining_Reversed_Comma_Above=788]="U_Combining_Reversed_Comma_Above",N[N.U_Combining_Comma_Above_Right=789]="U_Combining_Comma_Above_Right",N[N.U_Combining_Grave_Accent_Below=790]="U_Combining_Grave_Accent_Below",N[N.U_Combining_Acute_Accent_Below=791]="U_Combining_Acute_Accent_Below",N[N.U_Combining_Left_Tack_Below=792]="U_Combining_Left_Tack_Below",N[N.U_Combining_Right_Tack_Below=793]="U_Combining_Right_Tack_Below",N[N.U_Combining_Left_Angle_Above=794]="U_Combining_Left_Angle_Above",N[N.U_Combining_Horn=795]="U_Combining_Horn",N[N.U_Combining_Left_Half_Ring_Below=796]="U_Combining_Left_Half_Ring_Below",N[N.U_Combining_Up_Tack_Below=797]="U_Combining_Up_Tack_Below",N[N.U_Combining_Down_Tack_Below=798]="U_Combining_Down_Tack_Below",N[N.U_Combining_Plus_Sign_Below=799]="U_Combining_Plus_Sign_Below",N[N.U_Combining_Minus_Sign_Below=800]="U_Combining_Minus_Sign_Below",N[N.U_Combining_Palatalized_Hook_Below=801]="U_Combining_Palatalized_Hook_Below",N[N.U_Combining_Retroflex_Hook_Below=802]="U_Combining_Retroflex_Hook_Below",N[N.U_Combining_Dot_Below=803]="U_Combining_Dot_Below",N[N.U_Combining_Diaeresis_Below=804]="U_Combining_Diaeresis_Below",N[N.U_Combining_Ring_Below=805]="U_Combining_Ring_Below",N[N.U_Combining_Comma_Below=806]="U_Combining_Comma_Below",N[N.U_Combining_Cedilla=807]="U_Combining_Cedilla",N[N.U_Combining_Ogonek=808]="U_Combining_Ogonek",N[N.U_Combining_Vertical_Line_Below=809]="U_Combining_Vertical_Line_Below",N[N.U_Combining_Bridge_Below=810]="U_Combining_Bridge_Below",N[N.U_Combining_Inverted_Double_Arch_Below=811]="U_Combining_Inverted_Double_Arch_Below",N[N.U_Combining_Caron_Below=812]="U_Combining_Caron_Below",N[N.U_Combining_Circumflex_Accent_Below=813]="U_Combining_Circumflex_Accent_Below",N[N.U_Combining_Breve_Below=814]="U_Combining_Breve_Below",N[N.U_Combining_Inverted_Breve_Below=815]="U_Combining_Inverted_Breve_Below",N[N.U_Combining_Tilde_Below=816]="U_Combining_Tilde_Below",N[N.U_Combining_Macron_Below=817]="U_Combining_Macron_Below",N[N.U_Combining_Low_Line=818]="U_Combining_Low_Line",N[N.U_Combining_Double_Low_Line=819]="U_Combining_Double_Low_Line",N[N.U_Combining_Tilde_Overlay=820]="U_Combining_Tilde_Overlay",N[N.U_Combining_Short_Stroke_Overlay=821]="U_Combining_Short_Stroke_Overlay",N[N.U_Combining_Long_Stroke_Overlay=822]="U_Combining_Long_Stroke_Overlay",N[N.U_Combining_Short_Solidus_Overlay=823]="U_Combining_Short_Solidus_Overlay",N[N.U_Combining_Long_Solidus_Overlay=824]="U_Combining_Long_Solidus_Overlay",N[N.U_Combining_Right_Half_Ring_Below=825]="U_Combining_Right_Half_Ring_Below",N[N.U_Combining_Inverted_Bridge_Below=826]="U_Combining_Inverted_Bridge_Below",N[N.U_Combining_Square_Below=827]="U_Combining_Square_Below",N[N.U_Combining_Seagull_Below=828]="U_Combining_Seagull_Below",N[N.U_Combining_X_Above=829]="U_Combining_X_Above",N[N.U_Combining_Vertical_Tilde=830]="U_Combining_Vertical_Tilde",N[N.U_Combining_Double_Overline=831]="U_Combining_Double_Overline",N[N.U_Combining_Grave_Tone_Mark=832]="U_Combining_Grave_Tone_Mark",N[N.U_Combining_Acute_Tone_Mark=833]="U_Combining_Acute_Tone_Mark",N[N.U_Combining_Greek_Perispomeni=834]="U_Combining_Greek_Perispomeni",N[N.U_Combining_Greek_Koronis=835]="U_Combining_Greek_Koronis",N[N.U_Combining_Greek_Dialytika_Tonos=836]="U_Combining_Greek_Dialytika_Tonos",N[N.U_Combining_Greek_Ypogegrammeni=837]="U_Combining_Greek_Ypogegrammeni",N[N.U_Combining_Bridge_Above=838]="U_Combining_Bridge_Above",N[N.U_Combining_Equals_Sign_Below=839]="U_Combining_Equals_Sign_Below",N[N.U_Combining_Double_Vertical_Line_Below=840]="U_Combining_Double_Vertical_Line_Below",N[N.U_Combining_Left_Angle_Below=841]="U_Combining_Left_Angle_Below",N[N.U_Combining_Not_Tilde_Above=842]="U_Combining_Not_Tilde_Above",N[N.U_Combining_Homothetic_Above=843]="U_Combining_Homothetic_Above",N[N.U_Combining_Almost_Equal_To_Above=844]="U_Combining_Almost_Equal_To_Above",N[N.U_Combining_Left_Right_Arrow_Below=845]="U_Combining_Left_Right_Arrow_Below",N[N.U_Combining_Upwards_Arrow_Below=846]="U_Combining_Upwards_Arrow_Below",N[N.U_Combining_Grapheme_Joiner=847]="U_Combining_Grapheme_Joiner",N[N.U_Combining_Right_Arrowhead_Above=848]="U_Combining_Right_Arrowhead_Above",N[N.U_Combining_Left_Half_Ring_Above=849]="U_Combining_Left_Half_Ring_Above",N[N.U_Combining_Fermata=850]="U_Combining_Fermata",N[N.U_Combining_X_Below=851]="U_Combining_X_Below",N[N.U_Combining_Left_Arrowhead_Below=852]="U_Combining_Left_Arrowhead_Below",N[N.U_Combining_Right_Arrowhead_Below=853]="U_Combining_Right_Arrowhead_Below",N[N.U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below=854]="U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below",N[N.U_Combining_Right_Half_Ring_Above=855]="U_Combining_Right_Half_Ring_Above",N[N.U_Combining_Dot_Above_Right=856]="U_Combining_Dot_Above_Right",N[N.U_Combining_Asterisk_Below=857]="U_Combining_Asterisk_Below",N[N.U_Combining_Double_Ring_Below=858]="U_Combining_Double_Ring_Below",N[N.U_Combining_Zigzag_Above=859]="U_Combining_Zigzag_Above",N[N.U_Combining_Double_Breve_Below=860]="U_Combining_Double_Breve_Below",N[N.U_Combining_Double_Breve=861]="U_Combining_Double_Breve",N[N.U_Combining_Double_Macron=862]="U_Combining_Double_Macron",N[N.U_Combining_Double_Macron_Below=863]="U_Combining_Double_Macron_Below",N[N.U_Combining_Double_Tilde=864]="U_Combining_Double_Tilde",N[N.U_Combining_Double_Inverted_Breve=865]="U_Combining_Double_Inverted_Breve",N[N.U_Combining_Double_Rightwards_Arrow_Below=866]="U_Combining_Double_Rightwards_Arrow_Below",N[N.U_Combining_Latin_Small_Letter_A=867]="U_Combining_Latin_Small_Letter_A",N[N.U_Combining_Latin_Small_Letter_E=868]="U_Combining_Latin_Small_Letter_E",N[N.U_Combining_Latin_Small_Letter_I=869]="U_Combining_Latin_Small_Letter_I",N[N.U_Combining_Latin_Small_Letter_O=870]="U_Combining_Latin_Small_Letter_O",N[N.U_Combining_Latin_Small_Letter_U=871]="U_Combining_Latin_Small_Letter_U",N[N.U_Combining_Latin_Small_Letter_C=872]="U_Combining_Latin_Small_Letter_C",N[N.U_Combining_Latin_Small_Letter_D=873]="U_Combining_Latin_Small_Letter_D",N[N.U_Combining_Latin_Small_Letter_H=874]="U_Combining_Latin_Small_Letter_H",N[N.U_Combining_Latin_Small_Letter_M=875]="U_Combining_Latin_Small_Letter_M",N[N.U_Combining_Latin_Small_Letter_R=876]="U_Combining_Latin_Small_Letter_R",N[N.U_Combining_Latin_Small_Letter_T=877]="U_Combining_Latin_Small_Letter_T",N[N.U_Combining_Latin_Small_Letter_V=878]="U_Combining_Latin_Small_Letter_V",N[N.U_Combining_Latin_Small_Letter_X=879]="U_Combining_Latin_Small_Letter_X",N[N.LINE_SEPARATOR=8232]="LINE_SEPARATOR",N[N.PARAGRAPH_SEPARATOR=8233]="PARAGRAPH_SEPARATOR",N[N.NEXT_LINE=133]="NEXT_LINE",N[N.U_CIRCUMFLEX=94]="U_CIRCUMFLEX",N[N.U_GRAVE_ACCENT=96]="U_GRAVE_ACCENT",N[N.U_DIAERESIS=168]="U_DIAERESIS",N[N.U_MACRON=175]="U_MACRON",N[N.U_ACUTE_ACCENT=180]="U_ACUTE_ACCENT",N[N.U_CEDILLA=184]="U_CEDILLA",N[N.U_MODIFIER_LETTER_LEFT_ARROWHEAD=706]="U_MODIFIER_LETTER_LEFT_ARROWHEAD",N[N.U_MODIFIER_LETTER_RIGHT_ARROWHEAD=707]="U_MODIFIER_LETTER_RIGHT_ARROWHEAD",N[N.U_MODIFIER_LETTER_UP_ARROWHEAD=708]="U_MODIFIER_LETTER_UP_ARROWHEAD",N[N.U_MODIFIER_LETTER_DOWN_ARROWHEAD=709]="U_MODIFIER_LETTER_DOWN_ARROWHEAD",N[N.U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING=722]="U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING",N[N.U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING=723]="U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING",N[N.U_MODIFIER_LETTER_UP_TACK=724]="U_MODIFIER_LETTER_UP_TACK",N[N.U_MODIFIER_LETTER_DOWN_TACK=725]="U_MODIFIER_LETTER_DOWN_TACK",N[N.U_MODIFIER_LETTER_PLUS_SIGN=726]="U_MODIFIER_LETTER_PLUS_SIGN",N[N.U_MODIFIER_LETTER_MINUS_SIGN=727]="U_MODIFIER_LETTER_MINUS_SIGN",N[N.U_BREVE=728]="U_BREVE",N[N.U_DOT_ABOVE=729]="U_DOT_ABOVE",N[N.U_RING_ABOVE=730]="U_RING_ABOVE",N[N.U_OGONEK=731]="U_OGONEK",N[N.U_SMALL_TILDE=732]="U_SMALL_TILDE",N[N.U_DOUBLE_ACUTE_ACCENT=733]="U_DOUBLE_ACUTE_ACCENT",N[N.U_MODIFIER_LETTER_RHOTIC_HOOK=734]="U_MODIFIER_LETTER_RHOTIC_HOOK",N[N.U_MODIFIER_LETTER_CROSS_ACCENT=735]="U_MODIFIER_LETTER_CROSS_ACCENT",N[N.U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR=741]="U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR",N[N.U_MODIFIER_LETTER_HIGH_TONE_BAR=742]="U_MODIFIER_LETTER_HIGH_TONE_BAR",N[N.U_MODIFIER_LETTER_MID_TONE_BAR=743]="U_MODIFIER_LETTER_MID_TONE_BAR",N[N.U_MODIFIER_LETTER_LOW_TONE_BAR=744]="U_MODIFIER_LETTER_LOW_TONE_BAR",N[N.U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR=745]="U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR",N[N.U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK=746]="U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK",N[N.U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK=747]="U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK",N[N.U_MODIFIER_LETTER_UNASPIRATED=749]="U_MODIFIER_LETTER_UNASPIRATED",N[N.U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD=751]="U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD",N[N.U_MODIFIER_LETTER_LOW_UP_ARROWHEAD=752]="U_MODIFIER_LETTER_LOW_UP_ARROWHEAD",N[N.U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD=753]="U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD",N[N.U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD=754]="U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD",N[N.U_MODIFIER_LETTER_LOW_RING=755]="U_MODIFIER_LETTER_LOW_RING",N[N.U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT=756]="U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT",N[N.U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT=757]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT",N[N.U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT=758]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT",N[N.U_MODIFIER_LETTER_LOW_TILDE=759]="U_MODIFIER_LETTER_LOW_TILDE",N[N.U_MODIFIER_LETTER_RAISED_COLON=760]="U_MODIFIER_LETTER_RAISED_COLON",N[N.U_MODIFIER_LETTER_BEGIN_HIGH_TONE=761]="U_MODIFIER_LETTER_BEGIN_HIGH_TONE",N[N.U_MODIFIER_LETTER_END_HIGH_TONE=762]="U_MODIFIER_LETTER_END_HIGH_TONE",N[N.U_MODIFIER_LETTER_BEGIN_LOW_TONE=763]="U_MODIFIER_LETTER_BEGIN_LOW_TONE",N[N.U_MODIFIER_LETTER_END_LOW_TONE=764]="U_MODIFIER_LETTER_END_LOW_TONE",N[N.U_MODIFIER_LETTER_SHELF=765]="U_MODIFIER_LETTER_SHELF",N[N.U_MODIFIER_LETTER_OPEN_SHELF=766]="U_MODIFIER_LETTER_OPEN_SHELF",N[N.U_MODIFIER_LETTER_LOW_LEFT_ARROW=767]="U_MODIFIER_LETTER_LOW_LEFT_ARROW",N[N.U_GREEK_LOWER_NUMERAL_SIGN=885]="U_GREEK_LOWER_NUMERAL_SIGN",N[N.U_GREEK_TONOS=900]="U_GREEK_TONOS",N[N.U_GREEK_DIALYTIKA_TONOS=901]="U_GREEK_DIALYTIKA_TONOS",N[N.U_GREEK_KORONIS=8125]="U_GREEK_KORONIS",N[N.U_GREEK_PSILI=8127]="U_GREEK_PSILI",N[N.U_GREEK_PERISPOMENI=8128]="U_GREEK_PERISPOMENI",N[N.U_GREEK_DIALYTIKA_AND_PERISPOMENI=8129]="U_GREEK_DIALYTIKA_AND_PERISPOMENI",N[N.U_GREEK_PSILI_AND_VARIA=8141]="U_GREEK_PSILI_AND_VARIA",N[N.U_GREEK_PSILI_AND_OXIA=8142]="U_GREEK_PSILI_AND_OXIA",N[N.U_GREEK_PSILI_AND_PERISPOMENI=8143]="U_GREEK_PSILI_AND_PERISPOMENI",N[N.U_GREEK_DASIA_AND_VARIA=8157]="U_GREEK_DASIA_AND_VARIA",N[N.U_GREEK_DASIA_AND_OXIA=8158]="U_GREEK_DASIA_AND_OXIA",N[N.U_GREEK_DASIA_AND_PERISPOMENI=8159]="U_GREEK_DASIA_AND_PERISPOMENI",N[N.U_GREEK_DIALYTIKA_AND_VARIA=8173]="U_GREEK_DIALYTIKA_AND_VARIA",N[N.U_GREEK_DIALYTIKA_AND_OXIA=8174]="U_GREEK_DIALYTIKA_AND_OXIA",N[N.U_GREEK_VARIA=8175]="U_GREEK_VARIA",N[N.U_GREEK_OXIA=8189]="U_GREEK_OXIA",N[N.U_GREEK_DASIA=8190]="U_GREEK_DASIA",N[N.U_IDEOGRAPHIC_FULL_STOP=12290]="U_IDEOGRAPHIC_FULL_STOP",N[N.U_LEFT_CORNER_BRACKET=12300]="U_LEFT_CORNER_BRACKET",N[N.U_RIGHT_CORNER_BRACKET=12301]="U_RIGHT_CORNER_BRACKET",N[N.U_LEFT_BLACK_LENTICULAR_BRACKET=12304]="U_LEFT_BLACK_LENTICULAR_BRACKET",N[N.U_RIGHT_BLACK_LENTICULAR_BRACKET=12305]="U_RIGHT_BLACK_LENTICULAR_BRACKET",N[N.U_OVERLINE=8254]="U_OVERLINE",N[N.UTF8_BOM=65279]="UTF8_BOM",N[N.U_FULLWIDTH_SEMICOLON=65307]="U_FULLWIDTH_SEMICOLON",N[N.U_FULLWIDTH_COMMA=65292]="U_FULLWIDTH_COMMA"}(X||(j.CharCode=X={}))},9087:(N,j)=>{var X;Object.defineProperty(j,"__esModule",{value:!0}),j.SetWithKey=void 0,j.groupBy=function(N,j){const X=Object.create(null);for(const ie of N){const N=j(ie);let se=X[N];se||(se=X[N]=[]),se.push(ie)}return X},j.diffSets=function(N,j){const X=[],ie=[];for(const ie of N)j.has(ie)||X.push(ie);for(const X of j)N.has(X)||ie.push(X);return{removed:X,added:ie}},j.diffMaps=function(N,j){const X=[],ie=[];for(const[ie,se]of N)j.has(ie)||X.push(se);for(const[X,se]of j)N.has(X)||ie.push(se);return{removed:X,added:ie}},j.intersection=function(N,j){const X=new Set;for(const ie of j)N.has(ie)&&X.add(ie);return X};class s{static{X=Symbol.toStringTag}constructor(N,j){this.toKey=j,this._map=new Map,this[X]="SetWithKey";for(const j of N)this.add(j)}get size(){return this._map.size}add(N){const j=this.toKey(N);return this._map.set(j,N),this}delete(N){return this._map.delete(this.toKey(N))}has(N){return this._map.has(this.toKey(N))}*entries(){for(const N of this._map.values())yield[N,N]}keys(){return this.values()}*values(){for(const N of this._map.values())yield N}clear(){this._map.clear()}forEach(N,j){this._map.forEach((X=>N.call(j,X,X,this)))}[Symbol.iterator](){return this.values()}}j.SetWithKey=s},4838:(N,j)=>{function i(N){return(j,X,ie)=>{let se=null,le=null;if("function"==typeof ie.value?(se="value",le=ie.value):"function"==typeof ie.get&&(se="get",le=ie.get),!le)throw new Error("not supported");ie[se]=N(le,X)}}Object.defineProperty(j,"__esModule",{value:!0}),j.memoize=function(N,j,X){let ie=null,se=null;if("function"==typeof X.value?(ie="value",se=X.value,0!==se.length&&console.warn("Memoize should only be used in functions with zero parameters")):"function"==typeof X.get&&(ie="get",se=X.get),!se)throw new Error("not supported");const le=`$memoize$${j}`;X[ie]=function(...N){return this.hasOwnProperty(le)||Object.defineProperty(this,le,{configurable:!1,enumerable:!1,writable:!1,value:se.apply(this,N)}),this[le]}},j.debounce=function(N,j,X){return i(((ie,se)=>{const le=`$debounce$${se}`,he=`$debounce$result$${se}`;return function(...se){this[he]||(this[he]=X?X():void 0),clearTimeout(this[le]),j&&(this[he]=j(this[he],...se),se=[this[he]]),this[le]=setTimeout((()=>{ie.apply(this,se),this[he]=X?X():void 0}),N)}}))},j.throttle=function(N,j,X){return i(((ie,se)=>{const le=`$throttle$timer$${se}`,he=`$throttle$result$${se}`,ce=`$throttle$lastRun$${se}`,_e=`$throttle$pending$${se}`;return function(...se){if(this[he]||(this[he]=X?X():void 0),null!==this[ce]&&void 0!==this[ce]||(this[ce]=-Number.MAX_VALUE),j&&(this[he]=j(this[he],...se)),this[_e])return;const me=this[ce]+N;me<=Date.now()?(this[ce]=Date.now(),ie.apply(this,[this[he]]),this[he]=X?X():void 0):(this[_e]=!0,this[le]=setTimeout((()=>{this[_e]=!1,this[ce]=Date.now(),ie.apply(this,[this[he]]),this[he]=X?X():void 0}),me-Date.now()))}}))}},9807:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.BugIndicatingError=j.ErrorNoTelemetry=j.ExpectedError=j.NotSupportedError=j.NotImplementedError=j.ReadonlyError=j.CancellationError=j.errorHandler=j.ErrorHandler=void 0,j.setUnexpectedErrorHandler=function(N){j.errorHandler.setUnexpectedErrorHandler(N)},j.isSigPipeError=function(N){if(!N||"object"!=typeof N)return!1;const j=N;return"EPIPE"===j.code&&"WRITE"===j.syscall?.toUpperCase()},j.onUnexpectedError=function(N){r(N)||j.errorHandler.onUnexpectedError(N)},j.onUnexpectedExternalError=function(N){r(N)||j.errorHandler.onUnexpectedExternalError(N)},j.transformErrorForSerialization=function(N){if(N instanceof Error){const{name:j,message:X}=N;return{$isError:!0,name:j,message:X,stack:N.stacktrace||N.stack,noTelemetry:c.isErrorNoTelemetry(N)}}return N},j.transformErrorFromSerialization=function(N){let j;return N.noTelemetry?j=new c:(j=new Error,j.name=N.name),j.message=N.message,j.stack=N.stack,j},j.isCancellationError=r,j.canceled=function(){const N=new Error(X);return N.name=N.message,N},j.illegalArgument=function(N){return N?new Error(`Illegal argument: ${N}`):new Error("Illegal argument")},j.illegalState=function(N){return N?new Error(`Illegal state: ${N}`):new Error("Illegal state")},j.getErrorMessage=function(N){return N?N.message?N.message:N.stack?N.stack.split("\n")[0]:String(N):"Error"};class i{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(N){setTimeout((()=>{if(N.stack){if(c.isErrorNoTelemetry(N))throw new c(N.message+"\n\n"+N.stack);throw new Error(N.message+"\n\n"+N.stack)}throw N}),0)}}addListener(N){return this.listeners.push(N),()=>{this._removeListener(N)}}emit(N){this.listeners.forEach((j=>{j(N)}))}_removeListener(N){this.listeners.splice(this.listeners.indexOf(N),1)}setUnexpectedErrorHandler(N){this.unexpectedErrorHandler=N}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(N){this.unexpectedErrorHandler(N),this.emit(N)}onUnexpectedExternalError(N){this.unexpectedErrorHandler(N)}}j.ErrorHandler=i,j.errorHandler=new i;const X="Canceled";function r(N){return N instanceof n||N instanceof Error&&N.name===X&&N.message===X}class n extends Error{constructor(){super(X),this.name=this.message}}j.CancellationError=n;class o extends TypeError{constructor(N){super(N?`${N} is read-only and cannot be changed`:"Cannot change read-only property")}}j.ReadonlyError=o;class a extends Error{constructor(N){super("NotImplemented"),N&&(this.message=N)}}j.NotImplementedError=a;class l extends Error{constructor(N){super("NotSupported"),N&&(this.message=N)}}j.NotSupportedError=l;class h extends Error{constructor(){super(...arguments),this.isExpected=!0}}j.ExpectedError=h;class c extends Error{constructor(N){super(N),this.name="CodeExpectedError"}static fromError(N){if(N instanceof c)return N;const j=new c;return j.message=N.message,j.stack=N.stack,j}static isErrorNoTelemetry(N){return"CodeExpectedError"===N.name}}j.ErrorNoTelemetry=c;class d extends Error{constructor(N){super(N||"An unexpected bug occurred."),Object.setPrototypeOf(this,d.prototype)}}j.BugIndicatingError=d},802:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ValueWithChangeEvent=j.Relay=j.EventBufferer=j.DynamicListEventMultiplexer=j.EventMultiplexer=j.MicrotaskEmitter=j.DebounceEmitter=j.PauseableEmitter=j.AsyncEmitter=j.createEventDeliveryQueue=j.Emitter=j.ListenerRefusalError=j.ListenerLeakError=j.EventProfiling=j.Event=void 0,j.setGlobalLeakWarningThreshold=function(N){const j=me;return me=N,{dispose(){me=j}}};const ie=X(9807),se=X(8841),le=X(7150),he=X(6317),ce=X(9725);var _e;!function(N){function t(N){return(j,X=null,ie)=>{let se,le=!1;return se=N((N=>{if(!le)return se?se.dispose():le=!0,j.call(X,N)}),null,ie),le&&se.dispose(),se}}function i(N,j,X){return r(((X,ie=null,se)=>N((N=>X.call(ie,j(N))),null,se)),X)}function s(N,j,X){return r(((X,ie=null,se)=>N((N=>j(N)&&X.call(ie,N)),null,se)),X)}function r(N,j){let X;const ie=new m({onWillAddFirstListener(){X=N(ie.fire,ie)},onDidRemoveLastListener(){X?.dispose()}});return j?.add(ie),ie.event}function o(N,j,X=100,ie=!1,se=!1,le,he){let ce,_e,me,ve,Se=0;const be=new m({leakWarningThreshold:le,onWillAddFirstListener(){ce=N((N=>{Se++,_e=j(_e,N),ie&&!me&&(be.fire(_e),_e=void 0),ve=()=>{const N=_e;_e=void 0,me=void 0,(!ie||Se>1)&&be.fire(N),Se=0},"number"==typeof X?(clearTimeout(me),me=setTimeout(ve,X)):void 0===me&&(me=0,queueMicrotask(ve))}))},onWillRemoveListener(){se&&Se>0&&ve?.()},onDidRemoveLastListener(){ve=void 0,ce.dispose()}});return he?.add(be),be.event}N.None=()=>le.Disposable.None,N.defer=function(N,j){return o(N,(()=>{}),0,void 0,!0,void 0,j)},N.once=t,N.map=i,N.forEach=function(N,j,X){return r(((X,ie=null,se)=>N((N=>{j(N),X.call(ie,N)}),null,se)),X)},N.filter=s,N.signal=function(N){return N},N.any=function(...N){return(j,X=null,ie)=>{return se=(0,le.combinedDisposable)(...N.map((N=>N((N=>j.call(X,N)))))),(he=ie)instanceof Array?he.push(se):he&&he.add(se),se;var se,he}},N.reduce=function(N,j,X,ie){let se=X;return i(N,(N=>(se=j(se,N),se)),ie)},N.debounce=o,N.accumulate=function(j,X=0,ie){return N.debounce(j,((N,j)=>N?(N.push(j),N):[j]),X,void 0,!0,void 0,ie)},N.latch=function(N,j=(N,j)=>N===j,X){let ie,se=!0;return s(N,(N=>{const X=se||!j(N,ie);return se=!1,ie=N,X}),X)},N.split=function(j,X,ie){return[N.filter(j,X,ie),N.filter(j,(N=>!X(N)),ie)]},N.buffer=function(N,j=!1,X=[],ie){let se=X.slice(),le=N((N=>{se?se.push(N):he.fire(N)}));ie&&ie.add(le);const o=()=>{se?.forEach((N=>he.fire(N))),se=null},he=new m({onWillAddFirstListener(){le||(le=N((N=>he.fire(N))),ie&&ie.add(le))},onDidAddFirstListener(){se&&(j?setTimeout(o):o())},onDidRemoveLastListener(){le&&le.dispose(),le=null}});return ie&&ie.add(he),he.event},N.chain=function(N,X){return(ie,se,le)=>{const he=X(new l);return N((function(N){const X=he.evaluate(N);X!==j&&ie.call(se,X)}),void 0,le)}};const j=Symbol("HaltChainable");class l{constructor(){this.steps=[]}map(N){return this.steps.push(N),this}forEach(N){return this.steps.push((j=>(N(j),j))),this}filter(N){return this.steps.push((X=>N(X)?X:j)),this}reduce(N,j){let X=j;return this.steps.push((j=>(X=N(X,j),X))),this}latch(N=(N,j)=>N===j){let X,ie=!0;return this.steps.push((se=>{const le=ie||!N(se,X);return ie=!1,X=se,le?se:j})),this}evaluate(N){for(const X of this.steps)if((N=X(N))===j)break;return N}}N.fromNodeEventEmitter=function(N,j,X=N=>N){const s=(...N)=>ie.fire(X(...N)),ie=new m({onWillAddFirstListener:()=>N.on(j,s),onDidRemoveLastListener:()=>N.removeListener(j,s)});return ie.event},N.fromDOMEventEmitter=function(N,j,X=N=>N){const s=(...N)=>ie.fire(X(...N)),ie=new m({onWillAddFirstListener:()=>N.addEventListener(j,s),onDidRemoveLastListener:()=>N.removeEventListener(j,s)});return ie.event},N.toPromise=function(N){return new Promise((j=>t(N)(j)))},N.fromPromise=function(N){const j=new m;return N.then((N=>{j.fire(N)}),(()=>{j.fire(void 0)})).finally((()=>{j.dispose()})),j.event},N.forward=function(N,j){return N((N=>j.fire(N)))},N.runAndSubscribe=function(N,j,X){return j(X),N((N=>j(N)))};class h{constructor(N,j){this._observable=N,this._counter=0,this._hasChanged=!1;const X={onWillAddFirstListener:()=>{N.addObserver(this)},onDidRemoveLastListener:()=>{N.removeObserver(this)}};this.emitter=new m(X),j&&j.add(this.emitter)}beginUpdate(N){this._counter++}handlePossibleChange(N){}handleChange(N,j){this._hasChanged=!0}endUpdate(N){this._counter--,0===this._counter&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}N.fromObservable=function(N,j){return new h(N,j).emitter.event},N.fromObservableLight=function(N){return(j,X,ie)=>{let se=0,he=!1;const ce={beginUpdate(){se++},endUpdate(){se--,0===se&&(N.reportChanges(),he&&(he=!1,j.call(X)))},handlePossibleChange(){},handleChange(){he=!0}};N.addObserver(ce),N.reportChanges();const _e={dispose(){N.removeObserver(ce)}};return ie instanceof le.DisposableStore?ie.add(_e):Array.isArray(ie)&&ie.push(_e),_e}}}(_e||(j.Event=_e={}));class h{static{this.all=new Set}static{this._idPool=0}constructor(N){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${N}_${h._idPool++}`,h.all.add(this)}start(N){this._stopWatch=new ce.StopWatch,this.listenerCount=N}stop(){if(this._stopWatch){const N=this._stopWatch.elapsed();this.durations.push(N),this.elapsedOverall+=N,this.invocationCount+=1,this._stopWatch=void 0}}}j.EventProfiling=h;let me=-1;class d{static{this._idPool=1}constructor(N,j,X=(d._idPool++).toString(16).padStart(3,"0")){this._errorHandler=N,this.threshold=j,this.name=X,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(N,j){const X=this.threshold;if(X<=0||j<X)return;this._stacks||(this._stacks=new Map);const ie=this._stacks.get(N.value)||0;if(this._stacks.set(N.value,ie+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=.5*X;const[N,ie]=this.getMostFrequentStack(),se=`[${this.name}] potential listener LEAK detected, having ${j} listeners already. MOST frequent listener (${ie}):`;console.warn(se),console.warn(N);const le=new _(se,N);this._errorHandler(le)}return()=>{const j=this._stacks.get(N.value)||0;this._stacks.set(N.value,j-1)}}getMostFrequentStack(){if(!this._stacks)return;let N,j=0;for(const[X,ie]of this._stacks)(!N||j<ie)&&(N=[X,ie],j=ie);return N}}class u{static create(){const N=new Error;return new u(N.stack??"")}constructor(N){this.value=N}print(){console.warn(this.value.split("\n").slice(2).join("\n"))}}class _ extends Error{constructor(N,j){super(N),this.name="ListenerLeakError",this.stack=j}}j.ListenerLeakError=_;class f extends Error{constructor(N,j){super(N),this.name="ListenerRefusalError",this.stack=j}}j.ListenerRefusalError=f;let ve=0;class g{constructor(N){this.value=N,this.id=ve++}}class m{constructor(N){this._size=0,this._options=N,this._leakageMon=me>0||this._options?.leakWarningThreshold?new d(N?.onListenerError??ie.onUnexpectedError,this._options?.leakWarningThreshold??me):void 0,this._perfMon=this._options?._profName?new h(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(N,j,X)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const N=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(N);const j=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],X=new f(`${N}. HINT: Stack shows most frequent listener (${j[1]}-times)`,j[0]);return(this._options?.onListenerError||ie.onUnexpectedError)(X),le.Disposable.None}if(this._disposed)return le.Disposable.None;j&&(N=N.bind(j));const se=new g(N);let he;this._leakageMon&&this._size>=Math.ceil(.2*this._leakageMon.threshold)&&(se.stack=u.create(),he=this._leakageMon.check(se.stack,this._size+1)),this._listeners?this._listeners instanceof g?(this._deliveryQueue??=new v,this._listeners=[this._listeners,se]):this._listeners.push(se):(this._options?.onWillAddFirstListener?.(this),this._listeners=se,this._options?.onDidAddFirstListener?.(this)),this._size++;const ce=(0,le.toDisposable)((()=>{he?.(),this._removeListener(se)}));return X instanceof le.DisposableStore?X.add(ce):Array.isArray(X)&&X.push(ce),ce},this._event}_removeListener(N){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(1===this._size)return this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),void(this._size=0);const j=this._listeners,X=j.indexOf(N);if(-1===X)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,j[X]=void 0;const ie=this._deliveryQueue.current===this;if(2*this._size<=j.length){let N=0;for(let X=0;X<j.length;X++)j[X]?j[N++]=j[X]:ie&&(this._deliveryQueue.end--,N<this._deliveryQueue.i&&this._deliveryQueue.i--);j.length=N}}_deliver(N,j){if(!N)return;const X=this._options?.onListenerError||ie.onUnexpectedError;if(X)try{N.value(j)}catch(N){X(N)}else N.value(j)}_deliverQueue(N){const j=N.current._listeners;for(;N.i<N.end;)this._deliver(j[N.i++],N.value);N.reset()}fire(N){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof g)this._deliver(this._listeners,N);else{const j=this._deliveryQueue;j.enqueue(this,N,this._listeners.length),this._deliverQueue(j)}this._perfMon?.stop()}hasListeners(){return this._size>0}}j.Emitter=m,j.createEventDeliveryQueue=()=>new v;class v{constructor(){this.i=-1,this.end=0}enqueue(N,j,X){this.i=0,this.end=X,this.current=N,this.value=j}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}j.AsyncEmitter=class extends m{async fireAsync(N,j,X){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new he.LinkedList),((N,j)=>{if(N instanceof g)j(N);else for(let X=0;X<N.length;X++){const ie=N[X];ie&&j(ie)}})(this._listeners,(j=>this._asyncDeliveryQueue.push([j.value,N])));this._asyncDeliveryQueue.size>0&&!j.isCancellationRequested;){const[se,le]=this._asyncDeliveryQueue.shift(),he=[],ce={...le,token:j,waitUntil:N=>{if(Object.isFrozen(he))throw new Error("waitUntil can NOT be called asynchronous");X&&(N=X(N,se)),he.push(N)}};try{se(ce)}catch(N){(0,ie.onUnexpectedError)(N);continue}Object.freeze(he),await Promise.allSettled(he).then((N=>{for(const j of N)"rejected"===j.status&&(0,ie.onUnexpectedError)(j.reason)}))}}};class S extends m{get isPaused(){return 0!==this._isPaused}constructor(N){super(N),this._isPaused=0,this._eventQueue=new he.LinkedList,this._mergeFn=N?.merge}pause(){this._isPaused++}resume(){if(0!==this._isPaused&&0==--this._isPaused)if(this._mergeFn){if(this._eventQueue.size>0){const N=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(N))}}else for(;!this._isPaused&&0!==this._eventQueue.size;)super.fire(this._eventQueue.shift())}fire(N){this._size&&(0!==this._isPaused?this._eventQueue.push(N):super.fire(N))}}j.PauseableEmitter=S,j.DebounceEmitter=class extends S{constructor(N){super(N),this._delay=N.delay??100}fire(N){this._handle||(this.pause(),this._handle=setTimeout((()=>{this._handle=void 0,this.resume()}),this._delay)),super.fire(N)}},j.MicrotaskEmitter=class extends m{constructor(N){super(N),this._queuedEvents=[],this._mergeFn=N?.merge}fire(N){this.hasListeners()&&(this._queuedEvents.push(N),1===this._queuedEvents.length&&queueMicrotask((()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach((N=>super.fire(N))),this._queuedEvents=[]})))}};class b{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new m({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(N){const j={event:N,listener:null};return this.events.push(j),this.hasListeners&&this.hook(j),(0,le.toDisposable)((0,se.createSingleCallFunction)((()=>{this.hasListeners&&this.unhook(j);const N=this.events.indexOf(j);this.events.splice(N,1)})))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach((N=>this.hook(N)))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach((N=>this.unhook(N)))}hook(N){N.listener=N.event((N=>this.emitter.fire(N)))}unhook(N){N.listener?.dispose(),N.listener=null}dispose(){this.emitter.dispose();for(const N of this.events)N.listener?.dispose();this.events=[]}}j.EventMultiplexer=b,j.DynamicListEventMultiplexer=class{constructor(N,j,X,ie){this._store=new le.DisposableStore;const se=this._store.add(new b),he=this._store.add(new le.DisposableMap);function a(N){he.set(N,se.add(ie(N)))}for(const j of N)a(j);this._store.add(j((N=>{a(N)}))),this._store.add(X((N=>{he.deleteAndDispose(N)}))),this.event=se.event}dispose(){this._store.dispose()}},j.EventBufferer=class{constructor(){this.data=[]}wrapEvent(N,j,X){return(ie,se,le)=>N((N=>{const le=this.data[this.data.length-1];if(!j)return void(le?le.buffers.push((()=>ie.call(se,N))):ie.call(se,N));const he=le;he?(he.items??=[],he.items.push(N),0===he.buffers.length&&le.buffers.push((()=>{he.reducedResult??=X?he.items.reduce(j,X):he.items.reduce(j),ie.call(se,he.reducedResult)}))):ie.call(se,j(X,N))}),void 0,le)}bufferEvents(N){const j={buffers:new Array};this.data.push(j);const X=N();return this.data.pop(),j.buffers.forEach((N=>N())),X}},j.Relay=class{constructor(){this.listening=!1,this.inputEvent=_e.None,this.inputEventListener=le.Disposable.None,this.emitter=new m({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(N){this.inputEvent=N,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=N(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}},j.ValueWithChangeEvent=class{static const(N){return new C(N)}constructor(N){this._value=N,this._onDidChange=new m,this.onDidChange=this._onDidChange.event}get value(){return this._value}set value(N){N!==this._value&&(this._value=N,this._onDidChange.fire(void 0))}};class C{constructor(N){this.value=N,this.onDidChange=_e.None}}},8841:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.createSingleCallFunction=function(N,j){const X=this;let ie,se=!1;return function(){if(se)return ie;if(se=!0,j)try{ie=N.apply(X,arguments)}finally{j()}else ie=N.apply(X,arguments);return ie}}},6304:function(N,j,X){var ie=this&&this.__createBinding||(Object.create?function(N,j,X,ie){void 0===ie&&(ie=X);var se=Object.getOwnPropertyDescriptor(j,X);se&&!("get"in se?!j.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return j[X]}}),Object.defineProperty(N,ie,se)}:function(N,j,X,ie){void 0===ie&&(ie=X),N[ie]=j[X]}),se=this&&this.__setModuleDefault||(Object.create?function(N,j){Object.defineProperty(N,"default",{enumerable:!0,value:j})}:function(N,j){N.default=j}),le=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var j={};if(null!=N)for(var X in N)"default"!==X&&Object.prototype.hasOwnProperty.call(N,X)&&ie(j,N,X);return se(j,N),j};Object.defineProperty(j,"__esModule",{value:!0}),j.StringSHA1=j.Hasher=void 0,j.hash=function(N){return a(N,0)},j.doHash=a,j.numberHash=l,j.stringHash=h,j.toHexString=_;const he=le(X(1316));function a(N,j){switch(typeof N){case"object":return null===N?l(349,j):Array.isArray(N)?(X=N,ie=l(104579,ie=j),X.reduce(((N,j)=>a(j,N)),ie)):function(N,j){return j=l(181387,j),Object.keys(N).sort().reduce(((j,X)=>(j=h(X,j),a(N[X],j))),j)}(N,j);case"string":return h(N,j);case"boolean":return function(N,j){return l(N?433:863,j)}(N,j);case"number":return l(N,j);case"undefined":return l(937,j);default:return l(617,j)}var X,ie}function l(N,j){return(j<<5)-j+N|0}function h(N,j){j=l(149417,j);for(let X=0,ie=N.length;X<ie;X++)j=l(N.charCodeAt(X),j);return j}var ce;function d(N,j,X=32){const ie=X-j;return(N<<j|(~((1<<ie)-1)&N)>>>ie)>>>0}function u(N,j=0,X=N.byteLength,ie=0){for(let se=0;se<X;se++)N[j+se]=ie}function _(N,j=32){return N instanceof ArrayBuffer?Array.from(new Uint8Array(N)).map((N=>N.toString(16).padStart(2,"0"))).join(""):function(N,j,X="0"){for(;N.length<j;)N=X+N;return N}((N>>>0).toString(16),j/4)}j.Hasher=class{constructor(){this._value=0}get value(){return this._value}hash(N){return this._value=a(N,this._value),this._value}},function(N){N[N.BLOCK_SIZE=64]="BLOCK_SIZE",N[N.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"}(ce||(ce={}));class f{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(ce.BLOCK_SIZE+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(N){const j=N.length;if(0===j)return;const X=this._buff;let ie,se,le=this._buffLen,_e=this._leftoverHighSurrogate;for(0!==_e?(ie=_e,se=-1,_e=0):(ie=N.charCodeAt(0),se=0);;){let me=ie;if(he.isHighSurrogate(ie)){if(!(se+1<j)){_e=ie;break}{const j=N.charCodeAt(se+1);he.isLowSurrogate(j)?(se++,me=he.computeCodePoint(ie,j)):me=ce.UNICODE_REPLACEMENT}}else he.isLowSurrogate(ie)&&(me=ce.UNICODE_REPLACEMENT);if(le=this._push(X,le,me),se++,!(se<j))break;ie=N.charCodeAt(se)}this._buffLen=le,this._leftoverHighSurrogate=_e}_push(N,j,X){return X<128?N[j++]=X:X<2048?(N[j++]=192|(1984&X)>>>6,N[j++]=128|(63&X)>>>0):X<65536?(N[j++]=224|(61440&X)>>>12,N[j++]=128|(4032&X)>>>6,N[j++]=128|(63&X)>>>0):(N[j++]=240|(1835008&X)>>>18,N[j++]=128|(258048&X)>>>12,N[j++]=128|(4032&X)>>>6,N[j++]=128|(63&X)>>>0),j>=ce.BLOCK_SIZE&&(this._step(),j-=ce.BLOCK_SIZE,this._totalLen+=ce.BLOCK_SIZE,N[0]=N[ce.BLOCK_SIZE+0],N[1]=N[ce.BLOCK_SIZE+1],N[2]=N[ce.BLOCK_SIZE+2]),j}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,ce.UNICODE_REPLACEMENT)),this._totalLen+=this._buffLen,this._wrapUp()),_(this._h0)+_(this._h1)+_(this._h2)+_(this._h3)+_(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,u(this._buff,this._buffLen),this._buffLen>56&&(this._step(),u(this._buff));const N=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(N/4294967296),!1),this._buffDV.setUint32(60,N%4294967296,!1),this._step()}_step(){const N=f._bigBlock32,j=this._buffDV;for(let X=0;X<64;X+=4)N.setUint32(X,j.getUint32(X,!1),!1);for(let j=64;j<320;j+=4)N.setUint32(j,d(N.getUint32(j-12,!1)^N.getUint32(j-32,!1)^N.getUint32(j-56,!1)^N.getUint32(j-64,!1),1),!1);let X,ie,se,le=this._h0,he=this._h1,ce=this._h2,_e=this._h3,me=this._h4;for(let j=0;j<80;j++)j<20?(X=he&ce|~he&_e,ie=1518500249):j<40?(X=he^ce^_e,ie=1859775393):j<60?(X=he&ce|he&_e|ce&_e,ie=2400959708):(X=he^ce^_e,ie=3395469782),se=d(le,5)+X+me+ie+N.getUint32(4*j,!1)&4294967295,me=_e,_e=ce,ce=d(he,30),he=le,le=se;this._h0=this._h0+le&4294967295,this._h1=this._h1+he&4294967295,this._h2=this._h2+ce&4294967295,this._h3=this._h3+_e&4294967295,this._h4=this._h4+me&4294967295}}j.StringSHA1=f},4218:(N,j)=>{var X;Object.defineProperty(j,"__esModule",{value:!0}),j.Iterable=void 0,function(N){function t(N){return N&&"object"==typeof N&&"function"==typeof N[Symbol.iterator]}N.is=t;const j=Object.freeze([]);function*s(N){yield N}N.empty=function(){return j},N.single=s,N.wrap=function(N){return t(N)?N:s(N)},N.from=function(N){return N||j},N.reverse=function*(N){for(let j=N.length-1;j>=0;j--)yield N[j]},N.isEmpty=function(N){return!N||!0===N[Symbol.iterator]().next().done},N.first=function(N){return N[Symbol.iterator]().next().value},N.some=function(N,j){let X=0;for(const ie of N)if(j(ie,X++))return!0;return!1},N.find=function(N,j){for(const X of N)if(j(X))return X},N.filter=function*(N,j){for(const X of N)j(X)&&(yield X)},N.map=function*(N,j){let X=0;for(const ie of N)yield j(ie,X++)},N.flatMap=function*(N,j){let X=0;for(const ie of N)yield*j(ie,X++)},N.concat=function*(...N){for(const j of N)yield*j},N.reduce=function(N,j,X){let ie=X;for(const X of N)ie=j(ie,X);return ie},N.slice=function*(N,j,X=N.length){for(j<0&&(j+=N.length),X<0?X+=N.length:X>N.length&&(X=N.length);j<X;j++)yield N[j]},N.consume=function(j,X=Number.POSITIVE_INFINITY){const ie=[];if(0===X)return[ie,j];const se=j[Symbol.iterator]();for(let j=0;j<X;j++){const j=se.next();if(j.done)return[ie,N.empty()];ie.push(j.value)}return[ie,{[Symbol.iterator]:()=>se}]},N.asyncToArray=async function(N){const j=[];for await(const X of N)j.push(X);return Promise.resolve(j)}}(X||(j.Iterable=X={}))},7883:(N,j)=>{var X,ie;Object.defineProperty(j,"__esModule",{value:!0}),j.KeyMod=j.KeyCodeUtils=j.ScanCodeUtils=j.NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE=j.EVENT_KEY_CODE_MAP=j.ScanCode=j.KeyCode=void 0,j.KeyChord=function(N,j){return(N|(65535&j)<<16>>>0)>>>0},function(N){N[N.DependsOnKbLayout=-1]="DependsOnKbLayout",N[N.Unknown=0]="Unknown",N[N.Backspace=1]="Backspace",N[N.Tab=2]="Tab",N[N.Enter=3]="Enter",N[N.Shift=4]="Shift",N[N.Ctrl=5]="Ctrl",N[N.Alt=6]="Alt",N[N.PauseBreak=7]="PauseBreak",N[N.CapsLock=8]="CapsLock",N[N.Escape=9]="Escape",N[N.Space=10]="Space",N[N.PageUp=11]="PageUp",N[N.PageDown=12]="PageDown",N[N.End=13]="End",N[N.Home=14]="Home",N[N.LeftArrow=15]="LeftArrow",N[N.UpArrow=16]="UpArrow",N[N.RightArrow=17]="RightArrow",N[N.DownArrow=18]="DownArrow",N[N.Insert=19]="Insert",N[N.Delete=20]="Delete",N[N.Digit0=21]="Digit0",N[N.Digit1=22]="Digit1",N[N.Digit2=23]="Digit2",N[N.Digit3=24]="Digit3",N[N.Digit4=25]="Digit4",N[N.Digit5=26]="Digit5",N[N.Digit6=27]="Digit6",N[N.Digit7=28]="Digit7",N[N.Digit8=29]="Digit8",N[N.Digit9=30]="Digit9",N[N.KeyA=31]="KeyA",N[N.KeyB=32]="KeyB",N[N.KeyC=33]="KeyC",N[N.KeyD=34]="KeyD",N[N.KeyE=35]="KeyE",N[N.KeyF=36]="KeyF",N[N.KeyG=37]="KeyG",N[N.KeyH=38]="KeyH",N[N.KeyI=39]="KeyI",N[N.KeyJ=40]="KeyJ",N[N.KeyK=41]="KeyK",N[N.KeyL=42]="KeyL",N[N.KeyM=43]="KeyM",N[N.KeyN=44]="KeyN",N[N.KeyO=45]="KeyO",N[N.KeyP=46]="KeyP",N[N.KeyQ=47]="KeyQ",N[N.KeyR=48]="KeyR",N[N.KeyS=49]="KeyS",N[N.KeyT=50]="KeyT",N[N.KeyU=51]="KeyU",N[N.KeyV=52]="KeyV",N[N.KeyW=53]="KeyW",N[N.KeyX=54]="KeyX",N[N.KeyY=55]="KeyY",N[N.KeyZ=56]="KeyZ",N[N.Meta=57]="Meta",N[N.ContextMenu=58]="ContextMenu",N[N.F1=59]="F1",N[N.F2=60]="F2",N[N.F3=61]="F3",N[N.F4=62]="F4",N[N.F5=63]="F5",N[N.F6=64]="F6",N[N.F7=65]="F7",N[N.F8=66]="F8",N[N.F9=67]="F9",N[N.F10=68]="F10",N[N.F11=69]="F11",N[N.F12=70]="F12",N[N.F13=71]="F13",N[N.F14=72]="F14",N[N.F15=73]="F15",N[N.F16=74]="F16",N[N.F17=75]="F17",N[N.F18=76]="F18",N[N.F19=77]="F19",N[N.F20=78]="F20",N[N.F21=79]="F21",N[N.F22=80]="F22",N[N.F23=81]="F23",N[N.F24=82]="F24",N[N.NumLock=83]="NumLock",N[N.ScrollLock=84]="ScrollLock",N[N.Semicolon=85]="Semicolon",N[N.Equal=86]="Equal",N[N.Comma=87]="Comma",N[N.Minus=88]="Minus",N[N.Period=89]="Period",N[N.Slash=90]="Slash",N[N.Backquote=91]="Backquote",N[N.BracketLeft=92]="BracketLeft",N[N.Backslash=93]="Backslash",N[N.BracketRight=94]="BracketRight",N[N.Quote=95]="Quote",N[N.OEM_8=96]="OEM_8",N[N.IntlBackslash=97]="IntlBackslash",N[N.Numpad0=98]="Numpad0",N[N.Numpad1=99]="Numpad1",N[N.Numpad2=100]="Numpad2",N[N.Numpad3=101]="Numpad3",N[N.Numpad4=102]="Numpad4",N[N.Numpad5=103]="Numpad5",N[N.Numpad6=104]="Numpad6",N[N.Numpad7=105]="Numpad7",N[N.Numpad8=106]="Numpad8",N[N.Numpad9=107]="Numpad9",N[N.NumpadMultiply=108]="NumpadMultiply",N[N.NumpadAdd=109]="NumpadAdd",N[N.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",N[N.NumpadSubtract=111]="NumpadSubtract",N[N.NumpadDecimal=112]="NumpadDecimal",N[N.NumpadDivide=113]="NumpadDivide",N[N.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",N[N.ABNT_C1=115]="ABNT_C1",N[N.ABNT_C2=116]="ABNT_C2",N[N.AudioVolumeMute=117]="AudioVolumeMute",N[N.AudioVolumeUp=118]="AudioVolumeUp",N[N.AudioVolumeDown=119]="AudioVolumeDown",N[N.BrowserSearch=120]="BrowserSearch",N[N.BrowserHome=121]="BrowserHome",N[N.BrowserBack=122]="BrowserBack",N[N.BrowserForward=123]="BrowserForward",N[N.MediaTrackNext=124]="MediaTrackNext",N[N.MediaTrackPrevious=125]="MediaTrackPrevious",N[N.MediaStop=126]="MediaStop",N[N.MediaPlayPause=127]="MediaPlayPause",N[N.LaunchMediaPlayer=128]="LaunchMediaPlayer",N[N.LaunchMail=129]="LaunchMail",N[N.LaunchApp2=130]="LaunchApp2",N[N.Clear=131]="Clear",N[N.MAX_VALUE=132]="MAX_VALUE"}(X||(j.KeyCode=X={})),function(N){N[N.DependsOnKbLayout=-1]="DependsOnKbLayout",N[N.None=0]="None",N[N.Hyper=1]="Hyper",N[N.Super=2]="Super",N[N.Fn=3]="Fn",N[N.FnLock=4]="FnLock",N[N.Suspend=5]="Suspend",N[N.Resume=6]="Resume",N[N.Turbo=7]="Turbo",N[N.Sleep=8]="Sleep",N[N.WakeUp=9]="WakeUp",N[N.KeyA=10]="KeyA",N[N.KeyB=11]="KeyB",N[N.KeyC=12]="KeyC",N[N.KeyD=13]="KeyD",N[N.KeyE=14]="KeyE",N[N.KeyF=15]="KeyF",N[N.KeyG=16]="KeyG",N[N.KeyH=17]="KeyH",N[N.KeyI=18]="KeyI",N[N.KeyJ=19]="KeyJ",N[N.KeyK=20]="KeyK",N[N.KeyL=21]="KeyL",N[N.KeyM=22]="KeyM",N[N.KeyN=23]="KeyN",N[N.KeyO=24]="KeyO",N[N.KeyP=25]="KeyP",N[N.KeyQ=26]="KeyQ",N[N.KeyR=27]="KeyR",N[N.KeyS=28]="KeyS",N[N.KeyT=29]="KeyT",N[N.KeyU=30]="KeyU",N[N.KeyV=31]="KeyV",N[N.KeyW=32]="KeyW",N[N.KeyX=33]="KeyX",N[N.KeyY=34]="KeyY",N[N.KeyZ=35]="KeyZ",N[N.Digit1=36]="Digit1",N[N.Digit2=37]="Digit2",N[N.Digit3=38]="Digit3",N[N.Digit4=39]="Digit4",N[N.Digit5=40]="Digit5",N[N.Digit6=41]="Digit6",N[N.Digit7=42]="Digit7",N[N.Digit8=43]="Digit8",N[N.Digit9=44]="Digit9",N[N.Digit0=45]="Digit0",N[N.Enter=46]="Enter",N[N.Escape=47]="Escape",N[N.Backspace=48]="Backspace",N[N.Tab=49]="Tab",N[N.Space=50]="Space",N[N.Minus=51]="Minus",N[N.Equal=52]="Equal",N[N.BracketLeft=53]="BracketLeft",N[N.BracketRight=54]="BracketRight",N[N.Backslash=55]="Backslash",N[N.IntlHash=56]="IntlHash",N[N.Semicolon=57]="Semicolon",N[N.Quote=58]="Quote",N[N.Backquote=59]="Backquote",N[N.Comma=60]="Comma",N[N.Period=61]="Period",N[N.Slash=62]="Slash",N[N.CapsLock=63]="CapsLock",N[N.F1=64]="F1",N[N.F2=65]="F2",N[N.F3=66]="F3",N[N.F4=67]="F4",N[N.F5=68]="F5",N[N.F6=69]="F6",N[N.F7=70]="F7",N[N.F8=71]="F8",N[N.F9=72]="F9",N[N.F10=73]="F10",N[N.F11=74]="F11",N[N.F12=75]="F12",N[N.PrintScreen=76]="PrintScreen",N[N.ScrollLock=77]="ScrollLock",N[N.Pause=78]="Pause",N[N.Insert=79]="Insert",N[N.Home=80]="Home",N[N.PageUp=81]="PageUp",N[N.Delete=82]="Delete",N[N.End=83]="End",N[N.PageDown=84]="PageDown",N[N.ArrowRight=85]="ArrowRight",N[N.ArrowLeft=86]="ArrowLeft",N[N.ArrowDown=87]="ArrowDown",N[N.ArrowUp=88]="ArrowUp",N[N.NumLock=89]="NumLock",N[N.NumpadDivide=90]="NumpadDivide",N[N.NumpadMultiply=91]="NumpadMultiply",N[N.NumpadSubtract=92]="NumpadSubtract",N[N.NumpadAdd=93]="NumpadAdd",N[N.NumpadEnter=94]="NumpadEnter",N[N.Numpad1=95]="Numpad1",N[N.Numpad2=96]="Numpad2",N[N.Numpad3=97]="Numpad3",N[N.Numpad4=98]="Numpad4",N[N.Numpad5=99]="Numpad5",N[N.Numpad6=100]="Numpad6",N[N.Numpad7=101]="Numpad7",N[N.Numpad8=102]="Numpad8",N[N.Numpad9=103]="Numpad9",N[N.Numpad0=104]="Numpad0",N[N.NumpadDecimal=105]="NumpadDecimal",N[N.IntlBackslash=106]="IntlBackslash",N[N.ContextMenu=107]="ContextMenu",N[N.Power=108]="Power",N[N.NumpadEqual=109]="NumpadEqual",N[N.F13=110]="F13",N[N.F14=111]="F14",N[N.F15=112]="F15",N[N.F16=113]="F16",N[N.F17=114]="F17",N[N.F18=115]="F18",N[N.F19=116]="F19",N[N.F20=117]="F20",N[N.F21=118]="F21",N[N.F22=119]="F22",N[N.F23=120]="F23",N[N.F24=121]="F24",N[N.Open=122]="Open",N[N.Help=123]="Help",N[N.Select=124]="Select",N[N.Again=125]="Again",N[N.Undo=126]="Undo",N[N.Cut=127]="Cut",N[N.Copy=128]="Copy",N[N.Paste=129]="Paste",N[N.Find=130]="Find",N[N.AudioVolumeMute=131]="AudioVolumeMute",N[N.AudioVolumeUp=132]="AudioVolumeUp",N[N.AudioVolumeDown=133]="AudioVolumeDown",N[N.NumpadComma=134]="NumpadComma",N[N.IntlRo=135]="IntlRo",N[N.KanaMode=136]="KanaMode",N[N.IntlYen=137]="IntlYen",N[N.Convert=138]="Convert",N[N.NonConvert=139]="NonConvert",N[N.Lang1=140]="Lang1",N[N.Lang2=141]="Lang2",N[N.Lang3=142]="Lang3",N[N.Lang4=143]="Lang4",N[N.Lang5=144]="Lang5",N[N.Abort=145]="Abort",N[N.Props=146]="Props",N[N.NumpadParenLeft=147]="NumpadParenLeft",N[N.NumpadParenRight=148]="NumpadParenRight",N[N.NumpadBackspace=149]="NumpadBackspace",N[N.NumpadMemoryStore=150]="NumpadMemoryStore",N[N.NumpadMemoryRecall=151]="NumpadMemoryRecall",N[N.NumpadMemoryClear=152]="NumpadMemoryClear",N[N.NumpadMemoryAdd=153]="NumpadMemoryAdd",N[N.NumpadMemorySubtract=154]="NumpadMemorySubtract",N[N.NumpadClear=155]="NumpadClear",N[N.NumpadClearEntry=156]="NumpadClearEntry",N[N.ControlLeft=157]="ControlLeft",N[N.ShiftLeft=158]="ShiftLeft",N[N.AltLeft=159]="AltLeft",N[N.MetaLeft=160]="MetaLeft",N[N.ControlRight=161]="ControlRight",N[N.ShiftRight=162]="ShiftRight",N[N.AltRight=163]="AltRight",N[N.MetaRight=164]="MetaRight",N[N.BrightnessUp=165]="BrightnessUp",N[N.BrightnessDown=166]="BrightnessDown",N[N.MediaPlay=167]="MediaPlay",N[N.MediaRecord=168]="MediaRecord",N[N.MediaFastForward=169]="MediaFastForward",N[N.MediaRewind=170]="MediaRewind",N[N.MediaTrackNext=171]="MediaTrackNext",N[N.MediaTrackPrevious=172]="MediaTrackPrevious",N[N.MediaStop=173]="MediaStop",N[N.Eject=174]="Eject",N[N.MediaPlayPause=175]="MediaPlayPause",N[N.MediaSelect=176]="MediaSelect",N[N.LaunchMail=177]="LaunchMail",N[N.LaunchApp2=178]="LaunchApp2",N[N.LaunchApp1=179]="LaunchApp1",N[N.SelectTask=180]="SelectTask",N[N.LaunchScreenSaver=181]="LaunchScreenSaver",N[N.BrowserSearch=182]="BrowserSearch",N[N.BrowserHome=183]="BrowserHome",N[N.BrowserBack=184]="BrowserBack",N[N.BrowserForward=185]="BrowserForward",N[N.BrowserStop=186]="BrowserStop",N[N.BrowserRefresh=187]="BrowserRefresh",N[N.BrowserFavorites=188]="BrowserFavorites",N[N.ZoomToggle=189]="ZoomToggle",N[N.MailReply=190]="MailReply",N[N.MailForward=191]="MailForward",N[N.MailSend=192]="MailSend",N[N.MAX_VALUE=193]="MAX_VALUE"}(ie||(j.ScanCode=ie={}));class r{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(N,j){this._keyCodeToStr[N]=j,this._strToKeyCode[j.toLowerCase()]=N}keyCodeToStr(N){return this._keyCodeToStr[N]}strToKeyCode(N){return this._strToKeyCode[N.toLowerCase()]||X.Unknown}}const se=new r,le=new r,he=new r;j.EVENT_KEY_CODE_MAP=new Array(230),j.NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE={};const ce=[],_e=Object.create(null),me=Object.create(null);var ve,Se;j.ScanCodeUtils={lowerCaseToEnum:N=>me[N]||ie.None,toEnum:N=>_e[N]||ie.None,toString:N=>ce[N]||"None"},function(N){N.toString=function(N){return se.keyCodeToStr(N)},N.fromString=function(N){return se.strToKeyCode(N)},N.toUserSettingsUS=function(N){return le.keyCodeToStr(N)},N.toUserSettingsGeneral=function(N){return he.keyCodeToStr(N)},N.fromUserSettings=function(N){return le.strToKeyCode(N)||he.strToKeyCode(N)},N.toElectronAccelerator=function(N){if(N>=X.Numpad0&&N<=X.NumpadDivide)return null;switch(N){case X.UpArrow:return"Up";case X.DownArrow:return"Down";case X.LeftArrow:return"Left";case X.RightArrow:return"Right"}return se.keyCodeToStr(N)}}(ve||(j.KeyCodeUtils=ve={})),function(N){N[N.CtrlCmd=2048]="CtrlCmd",N[N.Shift=1024]="Shift",N[N.Alt=512]="Alt",N[N.WinCtrl=256]="WinCtrl"}(Se||(j.KeyMod=Se={}))},2811:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.ResolvedKeybinding=j.ResolvedChord=j.Keybinding=j.ScanCodeChord=j.KeyCodeChord=void 0,j.decodeKeybinding=function(N,j){if("number"==typeof N){if(0===N)return null;const X=(65535&N)>>>0,ie=(4294901760&N)>>>16;return new c(0!==ie?[a(X,j),a(ie,j)]:[a(X,j)])}{const X=[];for(let ie=0;ie<N.length;ie++)X.push(a(N[ie],j));return new c(X)}},j.createSimpleKeybinding=a;const ie=X(9807),se=X(7883),le=X(8163);var he;function a(N,j){const X=!!(N&he.CtrlCmd),ie=!!(N&he.WinCtrl),se=j===le.OperatingSystem.Macintosh?ie:X,ce=!!(N&he.Shift),_e=!!(N&he.Alt),me=j===le.OperatingSystem.Macintosh?X:ie,ve=N&he.KeyCode;return new l(se,ce,_e,me,ve)}!function(N){N[N.CtrlCmd=2048]="CtrlCmd",N[N.Shift=1024]="Shift",N[N.Alt=512]="Alt",N[N.WinCtrl=256]="WinCtrl",N[N.KeyCode=255]="KeyCode"}(he||(he={}));class l{constructor(N,j,X,ie,se){this.ctrlKey=N,this.shiftKey=j,this.altKey=X,this.metaKey=ie,this.keyCode=se}equals(N){return N instanceof l&&this.ctrlKey===N.ctrlKey&&this.shiftKey===N.shiftKey&&this.altKey===N.altKey&&this.metaKey===N.metaKey&&this.keyCode===N.keyCode}getHashCode(){return`K${this.ctrlKey?"1":"0"}${this.shiftKey?"1":"0"}${this.altKey?"1":"0"}${this.metaKey?"1":"0"}${this.keyCode}`}isModifierKey(){return this.keyCode===se.KeyCode.Unknown||this.keyCode===se.KeyCode.Ctrl||this.keyCode===se.KeyCode.Meta||this.keyCode===se.KeyCode.Alt||this.keyCode===se.KeyCode.Shift}toKeybinding(){return new c([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===se.KeyCode.Ctrl||this.shiftKey&&this.keyCode===se.KeyCode.Shift||this.altKey&&this.keyCode===se.KeyCode.Alt||this.metaKey&&this.keyCode===se.KeyCode.Meta}}j.KeyCodeChord=l;class h{constructor(N,j,X,ie,se){this.ctrlKey=N,this.shiftKey=j,this.altKey=X,this.metaKey=ie,this.scanCode=se}equals(N){return N instanceof h&&this.ctrlKey===N.ctrlKey&&this.shiftKey===N.shiftKey&&this.altKey===N.altKey&&this.metaKey===N.metaKey&&this.scanCode===N.scanCode}getHashCode(){return`S${this.ctrlKey?"1":"0"}${this.shiftKey?"1":"0"}${this.altKey?"1":"0"}${this.metaKey?"1":"0"}${this.scanCode}`}isDuplicateModifierCase(){return this.ctrlKey&&(this.scanCode===se.ScanCode.ControlLeft||this.scanCode===se.ScanCode.ControlRight)||this.shiftKey&&(this.scanCode===se.ScanCode.ShiftLeft||this.scanCode===se.ScanCode.ShiftRight)||this.altKey&&(this.scanCode===se.ScanCode.AltLeft||this.scanCode===se.ScanCode.AltRight)||this.metaKey&&(this.scanCode===se.ScanCode.MetaLeft||this.scanCode===se.ScanCode.MetaRight)}}j.ScanCodeChord=h;class c{constructor(N){if(0===N.length)throw(0,ie.illegalArgument)("chords");this.chords=N}getHashCode(){let N="";for(let j=0,X=this.chords.length;j<X;j++)0!==j&&(N+=";"),N+=this.chords[j].getHashCode();return N}equals(N){if(null===N)return!1;if(this.chords.length!==N.chords.length)return!1;for(let j=0;j<this.chords.length;j++)if(!this.chords[j].equals(N.chords[j]))return!1;return!0}}j.Keybinding=c,j.ResolvedChord=class{constructor(N,j,X,ie,se,le){this.ctrlKey=N,this.shiftKey=j,this.altKey=X,this.metaKey=ie,this.keyLabel=se,this.keyAriaLabel=le}},j.ResolvedKeybinding=class{}},626:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.Lazy=void 0,j.Lazy=class{constructor(N){this.executor=N,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(N){this._error=N}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}},7150:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.DisposableMap=j.ImmortalReference=j.AsyncReferenceCollection=j.ReferenceCollection=j.SafeDisposable=j.RefCountedDisposable=j.MandatoryMutableDisposable=j.MutableDisposable=j.Disposable=j.DisposableStore=j.DisposableTracker=void 0,j.setDisposableTracker=function(N){_e=N},j.trackDisposable=c,j.markAsDisposed=d,j.markAsSingleton=function(N){return _e?.markAsSingleton(N),N},j.isDisposable=_,j.dispose=f,j.disposeIfDisposable=function(N){for(const j of N)_(j)&&j.dispose();return[]},j.combinedDisposable=function(...N){const j=p((()=>f(N)));return function(N,j){if(_e)for(const X of N)_e.setParent(X,j)}(N,j),j},j.toDisposable=p,j.disposeOnReturn=function(N){const j=new g;try{N(j)}finally{j.dispose()}};const ie=X(3058),se=X(9087),le=X(2608),he=X(8841),ce=X(4218);let _e=null;class h{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(N){let j=this.livingDisposables.get(N);return j||(j={parent:null,source:null,isSingleton:!1,value:N,idx:h.idx++},this.livingDisposables.set(N,j)),j}trackDisposable(N){const j=this.getDisposableData(N);j.source||(j.source=(new Error).stack)}setParent(N,j){this.getDisposableData(N).parent=j}markAsDisposed(N){this.livingDisposables.delete(N)}markAsSingleton(N){this.getDisposableData(N).isSingleton=!0}getRootParent(N,j){const X=j.get(N);if(X)return X;const ie=N.parent?this.getRootParent(this.getDisposableData(N.parent),j):N;return j.set(N,ie),ie}getTrackedDisposables(){const N=new Map;return[...this.livingDisposables.entries()].filter((([,j])=>null!==j.source&&!this.getRootParent(j,N).isSingleton)).flatMap((([N])=>N))}computeLeakingDisposables(N=10,j){let X;if(j)X=j;else{const N=new Map,j=[...this.livingDisposables.values()].filter((j=>null!==j.source&&!this.getRootParent(j,N).isSingleton));if(0===j.length)return;const ie=new Set(j.map((N=>N.value)));if(X=j.filter((N=>!(N.parent&&ie.has(N.parent)))),0===X.length)throw new Error("There are cyclic diposable chains!")}if(!X)return;function o(N){const j=N.source.split("\n").map((N=>N.trim().replace("at ",""))).filter((N=>""!==N));return function(N,j){for(;N.length>0&&j.some((j=>"string"==typeof j?j===N[0]:N[0].match(j)));)N.shift()}(j,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),j.reverse()}const he=new le.SetMap;for(const N of X){const j=o(N);for(let X=0;X<=j.length;X++)he.add(j.slice(0,X).join("\n"),N)}X.sort((0,ie.compareBy)((N=>N.idx),ie.numberComparator));let ce="",_e=0;for(const j of X.slice(0,N)){_e++;const N=o(j),ie=[];for(let j=0;j<N.length;j++){let le=N[j];le=`(shared with ${he.get(N.slice(0,j+1).join("\n")).size}/${X.length} leaks) at ${le}`;const ce=he.get(N.slice(0,j).join("\n")),_e=(0,se.groupBy)([...ce].map((N=>o(N)[j])),(N=>N));delete _e[N[j]];for(const[N,j]of Object.entries(_e))ie.unshift(`    - stacktraces of ${j.length} other leaks continue with ${N}`);ie.unshift(le)}ce+=`\n\n\n==================== Leaking disposable ${_e}/${X.length}: ${j.value.constructor.name} ====================\n${ie.join("\n")}\n============================================================\n\n`}return X.length>N&&(ce+=`\n\n\n... and ${X.length-N} more leaking disposables\n\n`),{leaks:X,details:ce}}}function c(N){return _e?.trackDisposable(N),N}function d(N){_e?.markAsDisposed(N)}function u(N,j){_e?.setParent(N,j)}function _(N){return"object"==typeof N&&null!==N&&"function"==typeof N.dispose&&0===N.dispose.length}function f(N){if(ce.Iterable.is(N)){const j=[];for(const X of N)if(X)try{X.dispose()}catch(N){j.push(N)}if(1===j.length)throw j[0];if(j.length>1)throw new AggregateError(j,"Encountered errors while disposing of store");return Array.isArray(N)?[]:N}if(N)return N.dispose(),N}function p(N){const j=c({dispose:(0,he.createSingleCallFunction)((()=>{d(j),N()}))});return j}j.DisposableTracker=h;class g{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1,c(this)}dispose(){this._isDisposed||(d(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(0!==this._toDispose.size)try{f(this._toDispose)}finally{this._toDispose.clear()}}add(N){if(!N)return N;if(N===this)throw new Error("Cannot register a disposable on itself!");return u(N,this),this._isDisposed?g.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(N),N}delete(N){if(N){if(N===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(N),N.dispose()}}deleteAndLeak(N){N&&this._toDispose.has(N)&&(this._toDispose.delete(N),u(N,null))}}j.DisposableStore=g;class m{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new g,c(this),u(this._store,this)}dispose(){d(this),this._store.dispose()}_register(N){if(N===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(N)}}j.Disposable=m;class v{constructor(){this._isDisposed=!1,c(this)}get value(){return this._isDisposed?void 0:this._value}set value(N){this._isDisposed||N===this._value||(this._value?.dispose(),N&&u(N,this),this._value=N)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,d(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){const N=this._value;return this._value=void 0,N&&u(N,null),N}}j.MutableDisposable=v,j.MandatoryMutableDisposable=class{constructor(N){this._disposable=new v,this._isDisposed=!1,this._disposable.value=N}get value(){return this._disposable.value}set value(N){this._isDisposed||N===this._disposable.value||(this._disposable.value=N)}dispose(){this._isDisposed=!0,this._disposable.dispose()}},j.RefCountedDisposable=class{constructor(N){this._disposable=N,this._counter=1}acquire(){return this._counter++,this}release(){return 0==--this._counter&&this._disposable.dispose(),this}},j.SafeDisposable=class{constructor(){this.dispose=()=>{},this.unset=()=>{},this.isset=()=>!1,c(this)}set(N){let j=N;return this.unset=()=>j=void 0,this.isset=()=>void 0!==j,this.dispose=()=>{j&&(j(),j=void 0,d(this))},this}},j.ReferenceCollection=class{constructor(){this.references=new Map}acquire(N,...j){let X=this.references.get(N);X||(X={counter:0,object:this.createReferencedObject(N,...j)},this.references.set(N,X));const{object:ie}=X,se=(0,he.createSingleCallFunction)((()=>{0==--X.counter&&(this.destroyReferencedObject(N,X.object),this.references.delete(N))}));return X.counter++,{object:ie,dispose:se}}},j.AsyncReferenceCollection=class{constructor(N){this.referenceCollection=N}async acquire(N,...j){const X=this.referenceCollection.acquire(N,...j);try{return{object:await X.object,dispose:()=>X.dispose()}}catch(N){throw X.dispose(),N}}},j.ImmortalReference=class{constructor(N){this.object=N}dispose(){}};class S{constructor(){this._store=new Map,this._isDisposed=!1,c(this)}dispose(){d(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{f(this._store.values())}finally{this._store.clear()}}has(N){return this._store.has(N)}get size(){return this._store.size}get(N){return this._store.get(N)}set(N,j,X=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),X||this._store.get(N)?.dispose(),this._store.set(N,j)}deleteAndDispose(N){this._store.get(N)?.dispose(),this._store.delete(N)}deleteAndLeak(N){const j=this._store.get(N);return this._store.delete(N),j}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}j.DisposableMap=S},6317:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.LinkedList=void 0;class i{static{this.Undefined=new i(void 0)}constructor(N){this.element=N,this.next=i.Undefined,this.prev=i.Undefined}}class s{constructor(){this._first=i.Undefined,this._last=i.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===i.Undefined}clear(){let N=this._first;for(;N!==i.Undefined;){const j=N.next;N.prev=i.Undefined,N.next=i.Undefined,N=j}this._first=i.Undefined,this._last=i.Undefined,this._size=0}unshift(N){return this._insert(N,!1)}push(N){return this._insert(N,!0)}_insert(N,j){const X=new i(N);if(this._first===i.Undefined)this._first=X,this._last=X;else if(j){const N=this._last;this._last=X,X.prev=N,N.next=X}else{const N=this._first;this._first=X,X.next=N,N.prev=X}this._size+=1;let ie=!1;return()=>{ie||(ie=!0,this._remove(X))}}shift(){if(this._first!==i.Undefined){const N=this._first.element;return this._remove(this._first),N}}pop(){if(this._last!==i.Undefined){const N=this._last.element;return this._remove(this._last),N}}_remove(N){if(N.prev!==i.Undefined&&N.next!==i.Undefined){const j=N.prev;j.next=N.next,N.next.prev=j}else N.prev===i.Undefined&&N.next===i.Undefined?(this._first=i.Undefined,this._last=i.Undefined):N.next===i.Undefined?(this._last=this._last.prev,this._last.next=i.Undefined):N.prev===i.Undefined&&(this._first=this._first.next,this._first.prev=i.Undefined);this._size-=1}*[Symbol.iterator](){let N=this._first;for(;N!==i.Undefined;)yield N.element,N=N.next}}j.LinkedList=s},2608:(N,j)=>{var X;Object.defineProperty(j,"__esModule",{value:!0}),j.SetMap=j.BidirectionalMap=j.CounterSet=j.Touch=void 0,j.getOrSet=function(N,j,X){let ie=N.get(j);return void 0===ie&&(ie=X,N.set(j,ie)),ie},j.mapToString=function(N){const j=[];return N.forEach(((N,X)=>{j.push(`${X} => ${N}`)})),`Map(${N.size}) {${j.join(", ")}}`},j.setToString=function(N){const j=[];return N.forEach((N=>{j.push(N)})),`Set(${N.size}) {${j.join(", ")}}`},j.mapsStrictEqualIgnoreOrder=function(N,j){if(N===j)return!0;if(N.size!==j.size)return!1;for(const[X,ie]of N)if(!j.has(X)||j.get(X)!==ie)return!1;for(const[X]of j)if(!N.has(X))return!1;return!0},function(N){N[N.None=0]="None",N[N.AsOld=1]="AsOld",N[N.AsNew=2]="AsNew"}(X||(j.Touch=X={})),j.CounterSet=class{constructor(){this.map=new Map}add(N){return this.map.set(N,(this.map.get(N)||0)+1),this}delete(N){let j=this.map.get(N)||0;return 0!==j&&(j--,0===j?this.map.delete(N):this.map.set(N,j),!0)}has(N){return this.map.has(N)}},j.BidirectionalMap=class{constructor(N){if(this._m1=new Map,this._m2=new Map,N)for(const[j,X]of N)this.set(j,X)}clear(){this._m1.clear(),this._m2.clear()}set(N,j){this._m1.set(N,j),this._m2.set(j,N)}get(N){return this._m1.get(N)}getKey(N){return this._m2.get(N)}delete(N){const j=this._m1.get(N);return void 0!==j&&(this._m1.delete(N),this._m2.delete(j),!0)}forEach(N,j){this._m1.forEach(((X,ie)=>{N.call(j,X,ie,this)}))}keys(){return this._m1.keys()}values(){return this._m1.values()}},j.SetMap=class{constructor(){this.map=new Map}add(N,j){let X=this.map.get(N);X||(X=new Set,this.map.set(N,X)),X.add(j)}delete(N,j){const X=this.map.get(N);X&&(X.delete(j),0===X.size&&this.map.delete(N))}forEach(N,j){const X=this.map.get(N);X&&X.forEach(j)}get(N){return this.map.get(N)||new Set}}},7704:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.SlidingWindowAverage=j.MovingAverage=j.Counter=void 0,j.clamp=function(N,j,X){return Math.min(Math.max(N,j),X)},j.rot=function(N,j){return(j+N%j)%j},j.isPointWithinTriangle=function(N,j,X,ie,se,le,he,ce){const _e=he-X,me=ce-ie,ve=se-X,Se=le-ie,be=N-X,Ce=j-ie,ye=_e*_e+me*me,we=_e*ve+me*Se,Ee=_e*be+me*Ce,De=ve*ve+Se*Se,Le=ve*be+Se*Ce,Ae=1/(ye*De-we*we),Re=(De*Ee-we*Le)*Ae,Te=(ye*Le-we*Ee)*Ae;return Re>=0&&Te>=0&&Re+Te<1},j.Counter=class{constructor(){this._next=0}getNext(){return this._next++}},j.MovingAverage=class{constructor(){this._n=1,this._val=0}update(N){return this._val=this._val+(N-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}},j.SlidingWindowAverage=class{constructor(N){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(N),this._values.fill(0,0,N)}update(N){const j=this._values[this._index];return this._values[this._index]=N,this._index=(this._index+1)%this._values.length,this._sum-=j,this._sum+=N,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}},8163:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.isAndroid=j.isEdge=j.isSafari=j.isFirefox=j.isChrome=j.OS=j.OperatingSystem=j.setTimeout0=j.setTimeout0IsFaster=j.translationsConfigFile=j.platformLocale=j.locale=j.Language=j.language=j.userAgent=j.platform=j.isCI=j.isMobile=j.isIOS=j.webWorkerOrigin=j.isWebWorker=j.isWeb=j.isElectron=j.isNative=j.isLinuxSnap=j.isLinux=j.isMacintosh=j.isWindows=j.Platform=j.LANGUAGE_DEFAULT=void 0,j.PlatformToString=function(N){switch(N){case Te.Web:return"Web";case Te.Mac:return"Mac";case Te.Linux:return"Linux";case Te.Windows:return"Windows"}},j.isLittleEndian=function(){if(!Pe){Pe=!0;const N=new Uint8Array(2);N[0]=1,N[1]=2;const j=new Uint16Array(N.buffer);Ie=513===j[0]}return Ie},j.isBigSurOrNewer=function(N){return parseFloat(N)>=20},j.LANGUAGE_DEFAULT="en";let X,ie,se,le=!1,he=!1,ce=!1,_e=!1,me=!1,ve=!1,Se=!1,be=!1,Ce=!1,ye=!1,we=j.LANGUAGE_DEFAULT,Ee=j.LANGUAGE_DEFAULT;const De=globalThis;let Le;void 0!==De.vscode&&void 0!==De.vscode.process?Le=De.vscode.process:"undefined"!=typeof process&&"string"==typeof process?.versions?.node&&(Le=process);const Ae="string"==typeof Le?.versions?.electron,Re=Ae&&"renderer"===Le?.type;if("object"==typeof Le){le="win32"===Le.platform,he="darwin"===Le.platform,ce="linux"===Le.platform,_e=ce&&!!Le.env.SNAP&&!!Le.env.SNAP_REVISION,Se=Ae,Ce=!!Le.env.CI||!!Le.env.BUILD_ARTIFACTSTAGINGDIRECTORY,X=j.LANGUAGE_DEFAULT,we=j.LANGUAGE_DEFAULT;const se=Le.env.VSCODE_NLS_CONFIG;if(se)try{const N=JSON.parse(se);X=N.userLocale,Ee=N.osLocale,we=N.resolvedLanguage||j.LANGUAGE_DEFAULT,ie=N.languagePack?.translationsConfigFile}catch(N){}me=!0}else"object"!=typeof navigator||Re?console.error("Unable to resolve platform."):(se=navigator.userAgent,le=se.indexOf("Windows")>=0,he=se.indexOf("Macintosh")>=0,be=(se.indexOf("Macintosh")>=0||se.indexOf("iPad")>=0||se.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,ce=se.indexOf("Linux")>=0,ye=se?.indexOf("Mobi")>=0,ve=!0,we=globalThis._VSCODE_NLS_LANGUAGE||j.LANGUAGE_DEFAULT,X=navigator.language.toLowerCase(),Ee=X);var Te;!function(N){N[N.Web=0]="Web",N[N.Mac=1]="Mac",N[N.Linux=2]="Linux",N[N.Windows=3]="Windows"}(Te||(j.Platform=Te={}));let ke=Te.Web;var Me,Oe;he?ke=Te.Mac:le?ke=Te.Windows:ce&&(ke=Te.Linux),j.isWindows=le,j.isMacintosh=he,j.isLinux=ce,j.isLinuxSnap=_e,j.isNative=me,j.isElectron=Se,j.isWeb=ve,j.isWebWorker=ve&&"function"==typeof De.importScripts,j.webWorkerOrigin=j.isWebWorker?De.origin:void 0,j.isIOS=be,j.isMobile=ye,j.isCI=Ce,j.platform=ke,j.userAgent=se,j.language=we,function(N){N.value=function(){return j.language},N.isDefaultVariant=function(){return 2===j.language.length?"en"===j.language:j.language.length>=3&&"e"===j.language[0]&&"n"===j.language[1]&&"-"===j.language[2]},N.isDefault=function(){return"en"===j.language}}(Me||(j.Language=Me={})),j.locale=X,j.platformLocale=Ee,j.translationsConfigFile=ie,j.setTimeout0IsFaster="function"==typeof De.postMessage&&!De.importScripts,j.setTimeout0=(()=>{if(j.setTimeout0IsFaster){const N=[];De.addEventListener("message",(j=>{if(j.data&&j.data.vscodeScheduleAsyncWork)for(let X=0,ie=N.length;X<ie;X++){const ie=N[X];if(ie.id===j.data.vscodeScheduleAsyncWork)return N.splice(X,1),void ie.callback()}}));let j=0;return X=>{const ie=++j;N.push({id:ie,callback:X}),De.postMessage({vscodeScheduleAsyncWork:ie},"*")}}return N=>setTimeout(N)})(),function(N){N[N.Windows=1]="Windows",N[N.Macintosh=2]="Macintosh",N[N.Linux=3]="Linux"}(Oe||(j.OperatingSystem=Oe={})),j.OS=he||be?Oe.Macintosh:le?Oe.Windows:Oe.Linux;let Ie=!0,Pe=!1;j.isChrome=!!(j.userAgent&&j.userAgent.indexOf("Chrome")>=0),j.isFirefox=!!(j.userAgent&&j.userAgent.indexOf("Firefox")>=0),j.isSafari=!!(!j.isChrome&&j.userAgent&&j.userAgent.indexOf("Safari")>=0),j.isEdge=!!(j.userAgent&&j.userAgent.indexOf("Edg/")>=0),j.isAndroid=!!(j.userAgent&&j.userAgent.indexOf("Android")>=0)},9881:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.SmoothScrollingOperation=j.SmoothScrollingUpdate=j.Scrollable=j.ScrollState=j.ScrollbarVisibility=void 0;const ie=X(802),se=X(7150);var le;!function(N){N[N.Auto=1]="Auto",N[N.Hidden=2]="Hidden",N[N.Visible=3]="Visible"}(le||(j.ScrollbarVisibility=le={}));class o{constructor(N,j,X,ie,se,le,he){this._forceIntegerValues=N,this._scrollStateBrand=void 0,this._forceIntegerValues&&(j|=0,X|=0,ie|=0,se|=0,le|=0,he|=0),this.rawScrollLeft=ie,this.rawScrollTop=he,j<0&&(j=0),ie+j>X&&(ie=X-j),ie<0&&(ie=0),se<0&&(se=0),he+se>le&&(he=le-se),he<0&&(he=0),this.width=j,this.scrollWidth=X,this.scrollLeft=ie,this.height=se,this.scrollHeight=le,this.scrollTop=he}equals(N){return this.rawScrollLeft===N.rawScrollLeft&&this.rawScrollTop===N.rawScrollTop&&this.width===N.width&&this.scrollWidth===N.scrollWidth&&this.scrollLeft===N.scrollLeft&&this.height===N.height&&this.scrollHeight===N.scrollHeight&&this.scrollTop===N.scrollTop}withScrollDimensions(N,j){return new o(this._forceIntegerValues,void 0!==N.width?N.width:this.width,void 0!==N.scrollWidth?N.scrollWidth:this.scrollWidth,j?this.rawScrollLeft:this.scrollLeft,void 0!==N.height?N.height:this.height,void 0!==N.scrollHeight?N.scrollHeight:this.scrollHeight,j?this.rawScrollTop:this.scrollTop)}withScrollPosition(N){return new o(this._forceIntegerValues,this.width,this.scrollWidth,void 0!==N.scrollLeft?N.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,void 0!==N.scrollTop?N.scrollTop:this.rawScrollTop)}createScrollEvent(N,j){const X=this.width!==N.width,ie=this.scrollWidth!==N.scrollWidth,se=this.scrollLeft!==N.scrollLeft,le=this.height!==N.height,he=this.scrollHeight!==N.scrollHeight,ce=this.scrollTop!==N.scrollTop;return{inSmoothScrolling:j,oldWidth:N.width,oldScrollWidth:N.scrollWidth,oldScrollLeft:N.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:N.height,oldScrollHeight:N.scrollHeight,oldScrollTop:N.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:X,scrollWidthChanged:ie,scrollLeftChanged:se,heightChanged:le,scrollHeightChanged:he,scrollTopChanged:ce}}}j.ScrollState=o;class a extends se.Disposable{constructor(N){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new ie.Emitter),this.onScroll=this._onScroll.event,this._smoothScrollDuration=N.smoothScrollDuration,this._scheduleAtNextAnimationFrame=N.scheduleAtNextAnimationFrame,this._state=new o(N.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(N){this._smoothScrollDuration=N}validateScrollPosition(N){return this._state.withScrollPosition(N)}getScrollDimensions(){return this._state}setScrollDimensions(N,j){const X=this._state.withScrollDimensions(N,j);this._setState(X,Boolean(this._smoothScrolling)),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(N){const j=this._state.withScrollPosition(N);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(j,!1)}setScrollPositionSmooth(N,j){if(0===this._smoothScrollDuration)return this.setScrollPositionNow(N);if(this._smoothScrolling){N={scrollLeft:void 0===N.scrollLeft?this._smoothScrolling.to.scrollLeft:N.scrollLeft,scrollTop:void 0===N.scrollTop?this._smoothScrolling.to.scrollTop:N.scrollTop};const X=this._state.withScrollPosition(N);if(this._smoothScrolling.to.scrollLeft===X.scrollLeft&&this._smoothScrolling.to.scrollTop===X.scrollTop)return;let ie;ie=j?new c(this._smoothScrolling.from,X,this._smoothScrolling.startTime,this._smoothScrolling.duration):this._smoothScrolling.combine(this._state,X,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=ie}else{const j=this._state.withScrollPosition(N);this._smoothScrolling=c.start(this._state,j,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))}hasPendingScrollAnimation(){return Boolean(this._smoothScrolling)}_performSmoothScrolling(){if(!this._smoothScrolling)return;const N=this._smoothScrolling.tick(),j=this._state.withScrollPosition(N);return this._setState(j,!0),this._smoothScrolling?N.isDone?(this._smoothScrolling.dispose(),void(this._smoothScrolling=null)):void(this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))):void 0}_setState(N,j){const X=this._state;X.equals(N)||(this._state=N,this._onScroll.fire(this._state.createScrollEvent(X,j)))}}j.Scrollable=a;class l{constructor(N,j,X){this.scrollLeft=N,this.scrollTop=j,this.isDone=X}}function h(N,j){const X=j-N;return function(j){return N+X*(1-(ie=1-j,Math.pow(ie,3)));var ie}}j.SmoothScrollingUpdate=l;class c{constructor(N,j,X,ie){this.from=N,this.to=j,this.duration=ie,this.startTime=X,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(N,j,X){if(Math.abs(N-j)>2.5*X){let he,ce;return N<j?(he=N+.75*X,ce=j-.75*X):(he=N-.75*X,ce=j+.75*X),ie=h(N,he),se=h(ce,j),le=.33,function(N){return N<le?ie(N/le):se((N-le)/(1-le))}}var ie,se,le;return h(N,j)}dispose(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(N){this.to=N.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(N){const j=(N-this.startTime)/this.duration;if(j<1){const N=this.scrollLeft(j),X=this.scrollTop(j);return new l(N,X,!1)}return new l(this.to.scrollLeft,this.to.scrollTop,!0)}combine(N,j,X){return c.start(N,j,X)}static start(N,j,X){X+=10;const ie=Date.now()-10;return new c(N,j,ie,X)}}j.SmoothScrollingOperation=c},9725:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.StopWatch=void 0;const X=globalThis.performance&&"function"==typeof globalThis.performance.now;class s{static create(N){return new s(N)}constructor(N){this._now=X&&!1===N?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}}j.StopWatch=s},1316:(N,j,X)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.noBreakWhitespace=j.CodePointIterator=void 0,j.isFalsyOrWhitespace=function(N){return!N||"string"!=typeof N||0===N.trim().length},j.format=function(N,...j){return 0===j.length?N:N.replace(le,(function(N,X){const ie=parseInt(X,10);return isNaN(ie)||ie<0||ie>=j.length?N:j[ie]}))},j.format2=function(N,j){return 0===Object.keys(j).length?N:N.replace(he,((N,X)=>j[X]??N))},j.htmlAttributeEncodeValue=function(N){return N.replace(/[<>"'&]/g,(N=>{switch(N){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return N}))},j.escape=function(N){return N.replace(/[<>&]/g,(function(N){switch(N){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return N}}))},j.escapeRegExpCharacters=a,j.count=function(N,j){let X=0,ie=N.indexOf(j);for(;-1!==ie;)X++,ie=N.indexOf(j,ie+j.length);return X},j.truncate=function(N,j,X="â¦"){return N.length<=j?N:`${N.substr(0,j)}${X}`},j.truncateMiddle=function(N,j,X="â¦"){if(N.length<=j)return N;const ie=Math.ceil(j/2)-X.length/2,se=Math.floor(j/2)-X.length/2;return`${N.substr(0,ie)}${X}${N.substr(N.length-se)}`},j.trim=function(N,j=" "){return h(l(N,j),j)},j.ltrim=l,j.rtrim=h,j.convertSimple2RegExpPattern=function(N){return N.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")},j.stripWildcards=function(N){return N.replace(/\*/g,"")},j.createRegExp=function(N,j,X={}){if(!N)throw new Error("Cannot create regex from empty string");j||(N=a(N)),X.wholeWord&&(/\B/.test(N.charAt(0))||(N="\\b"+N),/\B/.test(N.charAt(N.length-1))||(N+="\\b"));let ie="";return X.global&&(ie+="g"),X.matchCase||(ie+="i"),X.multiline&&(ie+="m"),X.unicode&&(ie+="u"),new RegExp(N,ie)},j.regExpLeadsToEndlessLoop=function(N){return"^"!==N.source&&"^$"!==N.source&&"$"!==N.source&&"^\\s*$"!==N.source&&!(!N.exec("")||0!==N.lastIndex)},j.splitLines=function(N){return N.split(/\r\n|\r|\n/)},j.splitLinesIncludeSeparators=function(N){const j=[],X=N.split(/(\r\n|\r|\n)/);for(let N=0;N<Math.ceil(X.length/2);N++)j.push(X[2*N]+(X[2*N+1]??""));return j},j.firstNonWhitespaceIndex=function(N){for(let j=0,X=N.length;j<X;j++){const X=N.charCodeAt(j);if(X!==ie.CharCode.Space&&X!==ie.CharCode.Tab)return j}return-1},j.getLeadingWhitespace=function(N,j=0,X=N.length){for(let se=j;se<X;se++){const X=N.charCodeAt(se);if(X!==ie.CharCode.Space&&X!==ie.CharCode.Tab)return N.substring(j,se)}return N.substring(j,X)},j.lastNonWhitespaceIndex=function(N,j=N.length-1){for(let X=j;X>=0;X--){const j=N.charCodeAt(X);if(j!==ie.CharCode.Space&&j!==ie.CharCode.Tab)return X}return-1},j.replaceAsync=function(N,j,X){const ie=[];let se=0;for(const le of N.matchAll(j)){if(ie.push(N.slice(se,le.index)),void 0===le.index)throw new Error("match.index should be defined");se=le.index+le[0].length,ie.push(X(le[0],...le.slice(1),le.index,N,le.groups))}return ie.push(N.slice(se)),Promise.all(ie).then((N=>N.join("")))},j.compare=function(N,j){return N<j?-1:N>j?1:0},j.compareSubstring=c,j.compareIgnoreCase=function(N,j){return d(N,j,0,N.length,0,j.length)},j.compareSubstringIgnoreCase=d,j.isAsciiDigit=function(N){return N>=ie.CharCode.Digit0&&N<=ie.CharCode.Digit9},j.isLowerAsciiLetter=u,j.isUpperAsciiLetter=function(N){return N>=ie.CharCode.A&&N<=ie.CharCode.Z},j.equalsIgnoreCase=function(N,j){return N.length===j.length&&0===d(N,j)},j.startsWithIgnoreCase=function(N,j){const X=j.length;return!(j.length>N.length)&&0===d(N,j,0,X)},j.commonPrefixLength=function(N,j){const X=Math.min(N.length,j.length);let ie;for(ie=0;ie<X;ie++)if(N.charCodeAt(ie)!==j.charCodeAt(ie))return ie;return X},j.commonSuffixLength=function(N,j){const X=Math.min(N.length,j.length);let ie;const se=N.length-1,le=j.length-1;for(ie=0;ie<X;ie++)if(N.charCodeAt(se-ie)!==j.charCodeAt(le-ie))return ie;return X},j.isHighSurrogate=_,j.isLowSurrogate=f,j.computeCodePoint=p,j.getNextCodePoint=g;const ie=X(4869),se=X(8960),le=/{(\d+)}/g,he=/{([^}]+)}/g;function a(N){return N.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function l(N,j){if(!N||!j)return N;const X=j.length;if(0===X||0===N.length)return N;let ie=0;for(;N.indexOf(j,ie)===ie;)ie+=X;return N.substring(ie)}function h(N,j){if(!N||!j)return N;const X=j.length,ie=N.length;if(0===X||0===ie)return N;let se=ie,le=-1;for(;le=N.lastIndexOf(j,se-1),-1!==le&&le+X===se;){if(0===le)return"";se=le}return N.substring(0,se)}function c(N,j,X=0,ie=N.length,se=0,le=j.length){for(;X<ie&&se<le;X++,se++){const ie=N.charCodeAt(X),le=j.charCodeAt(se);if(ie<le)return-1;if(ie>le)return 1}const he=ie-X,ce=le-se;return he<ce?-1:he>ce?1:0}function d(N,j,X=0,ie=N.length,se=0,le=j.length){for(;X<ie&&se<le;X++,se++){let he=N.charCodeAt(X),ce=j.charCodeAt(se);if(he===ce)continue;if(he>=128||ce>=128)return c(N.toLowerCase(),j.toLowerCase(),X,ie,se,le);u(he)&&(he-=32),u(ce)&&(ce-=32);const _e=he-ce;if(0!==_e)return _e}const he=ie-X,ce=le-se;return he<ce?-1:he>ce?1:0}function u(N){return N>=ie.CharCode.a&&N<=ie.CharCode.z}function _(N){return 55296<=N&&N<=56319}function f(N){return 56320<=N&&N<=57343}function p(N,j){return j-56320+(N-55296<<10)+65536}function g(N,j,X){const ie=N.charCodeAt(X);if(_(ie)&&X+1<j){const j=N.charCodeAt(X+1);if(f(j))return p(ie,j)}return ie}j.CodePointIterator=class{get offset(){return this._offset}constructor(N,j=0){this._str=N,this._len=N.length,this._offset=j}setOffset(N){this._offset=N}prevCodePoint(){const N=function(N,j){const X=N.charCodeAt(j-1);if(f(X)&&j>1){const ie=N.charCodeAt(j-2);if(_(ie))return p(ie,X)}return X}(this._str,this._offset);return this._offset-=N>=se.Constants.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,N}nextCodePoint(){const N=g(this._str,this._len,this._offset);return this._offset+=N>=se.Constants.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,N}eol(){return this._offset>=this._len}},j.noBreakWhitespace="Â "},5015:(N,j)=>{Object.defineProperty(j,"__esModule",{value:!0}),j.MicrotaskDelay=void 0,j.MicrotaskDelay=Symbol("MicrotaskDelay")},8960:(N,j)=>{var X;Object.defineProperty(j,"__esModule",{value:!0}),j.Constants=void 0,j.toUint8=function(N){return N<0?0:N>X.MAX_UINT_8?X.MAX_UINT_8:0|N},j.toUint32=function(N){return N<0?0:N>X.MAX_UINT_32?X.MAX_UINT_32:0|N},function(N){N[N.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",N[N.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",N[N.MAX_UINT_8=255]="MAX_UINT_8",N[N.MAX_UINT_16=65535]="MAX_UINT_16",N[N.MAX_UINT_32=4294967295]="MAX_UINT_32",N[N.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"}(X||(j.Constants=X={}))}},j={};function i(X){var ie=j[X];if(void 0!==ie)return ie.exports;var se=j[X]={exports:{}};return N[X].call(se.exports,se,se.exports,i),se.exports}var X={};return(()=>{var N=X;Object.defineProperty(N,"__esModule",{value:!0}),N.Terminal=void 0;const j=i(7721),ie=i(1718),se=i(7150),le=i(3027),he=i(5101),ce=i(6097),_e=i(4335),me=["cols","rows"];let ve=0;class u extends se.Disposable{constructor(N){super(),this._core=this._register(new ie.CoreBrowserTerminal(N)),this._addonManager=this._register(new le.AddonManager),this._publicOptions={...this._core.options};const t=N=>this._core.options[N],i=(N,j)=>{this._checkReadonlyOptions(N),this._core.options[N]=j};for(const N in this._core.options){const j={get:t.bind(this,N),set:i.bind(this,N)};Object.defineProperty(this._publicOptions,N,j)}}_checkReadonlyOptions(N){if(me.includes(N))throw new Error(`Option "${N}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new ce.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new _e.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new he.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const N=this._core.coreService.decPrivateModes;let j="none";switch(this._core.coreMouseService.activeProtocol){case"X10":j="x10";break;case"VT200":j="vt200";break;case"DRAG":j="drag";break;case"ANY":j="any"}return{applicationCursorKeysMode:N.applicationCursorKeys,applicationKeypadMode:N.applicationKeypad,bracketedPasteMode:N.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:j,originMode:N.origin,reverseWraparoundMode:N.reverseWraparound,sendFocusMode:N.sendFocus,wraparoundMode:N.wraparound}}get options(){return this._publicOptions}set options(N){for(const j in N)this._publicOptions[j]=N[j]}blur(){this._core.blur()}focus(){this._core.focus()}input(N,j=!0){this._core.input(N,j)}resize(N,j){this._verifyIntegers(N,j),this._core.resize(N,j)}open(N){this._core.open(N)}attachCustomKeyEventHandler(N){this._core.attachCustomKeyEventHandler(N)}attachCustomWheelEventHandler(N){this._core.attachCustomWheelEventHandler(N)}registerLinkProvider(N){return this._core.registerLinkProvider(N)}registerCharacterJoiner(N){return this._checkProposedApi(),this._core.registerCharacterJoiner(N)}deregisterCharacterJoiner(N){this._checkProposedApi(),this._core.deregisterCharacterJoiner(N)}registerMarker(N=0){return this._verifyIntegers(N),this._core.registerMarker(N)}registerDecoration(N){return this._checkProposedApi(),this._verifyPositiveIntegers(N.x??0,N.width??0,N.height??0),this._core.registerDecoration(N)}hasSelection(){return this._core.hasSelection()}select(N,j,X){this._verifyIntegers(N,j,X),this._core.select(N,j,X)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(N,j){this._verifyIntegers(N,j),this._core.selectLines(N,j)}dispose(){super.dispose()}scrollLines(N){this._verifyIntegers(N),this._core.scrollLines(N)}scrollPages(N){this._verifyIntegers(N),this._core.scrollPages(N)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(N){this._verifyIntegers(N),this._core.scrollToLine(N)}clear(){this._core.clear()}write(N,j){this._core.write(N,j)}writeln(N,j){this._core.write(N),this._core.write("\r\n",j)}paste(N){this._core.paste(N)}refresh(N,j){this._verifyIntegers(N,j),this._core.refresh(N,j)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(N){this._addonManager.loadAddon(this,N)}static get strings(){return{get promptLabel(){return j.promptLabel.get()},set promptLabel(N){j.promptLabel.set(N)},get tooMuchOutput(){return j.tooMuchOutput.get()},set tooMuchOutput(N){j.tooMuchOutput.set(N)}}}_verifyIntegers(...N){for(ve of N)if(ve===1/0||isNaN(ve)||ve%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...N){for(ve of N)if(ve&&(ve===1/0||isNaN(ve)||ve%1!=0||ve<0))throw new Error("This API only accepts positive integers")}}N.Terminal=u})(),X})()));