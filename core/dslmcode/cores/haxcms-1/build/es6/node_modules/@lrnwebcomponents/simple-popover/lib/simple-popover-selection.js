import{html as e,LitElement as t,render as i}from"../../../lit/index.js";import{unsafeHTML as o}from"../../../lit/directives/unsafe-html.js";import"./simple-popover-manager.js";class SimplePopoverSelection extends t{constructor(){super(),this.opened=!1,this.disabled=!1,this.event="click"}openedToggle(e){this.disabled||(this.opened=!this.opened)}openedChanged(t){if(t){let t=window.SimplePopoverManager.requestAvailability();i(document.createElement("div"),t);let n,l=document.createElement("div"),r=this.querySelectorAll('[slot="options"]');for(var s in 1===r.length&&r[0].children&&1===r[0].children.length&&"SLOT"===r[0].children[0].tagName&&(r=r[0].children[0].assignedNodes({flatten:!0})),r)if(r[s].cloneNode&&r[s].tagName){let e=r[s].cloneNode(!0);e.removeAttribute("slot"),l.appendChild(e)}if(this.querySelector('[slot="style"]')){let t=this.querySelector('[slot="style"]').cloneNode(!0),i=document.createElement("style");i.innerHTML=t.innerHTML,n=e`${o(l.innerHTML)}${o(i.outerHTML)}`}else n=e`${o(l.innerHTML)}`;let d=document.createElement("div");d.setAttribute("slot","body"),t.appendChild(d),i(n,d),setTimeout((()=>{let e=window.SimplePopoverManager.requestAvailability().querySelectorAll("*");for(var t in e)e[t].addEventListener&&e[t].addEventListener("click",this.itemSelect.bind(this));window.SimplePopoverManager.requestAvailability().querySelector("[data-simple-popover-selection-active]")?window.SimplePopoverManager.requestAvailability().querySelector("[data-simple-popover-selection-active]").focus():window.SimplePopoverManager.requestAvailability()&&window.SimplePopoverManager.requestAvailability().querySelector(":first-child")&&window.SimplePopoverManager.requestAvailability().querySelector(":first-child").focus()}),0)}window.SimplePopoverManager.requestAvailability().setPopover(this,this.querySelector('[slot="button"]'),t)}managerReset(){this.opened=!1}updated(e){e.forEach(((e,t)=>{"opened"==t&&this.shadowRoot&&void 0!==e&&(this.openedChanged(this[t]),this.dispatchEvent(new CustomEvent(`${t}-changed`,{detail:this})))}))}itemSelect(e){this.dispatchEvent(new CustomEvent("simple-popover-selection-changed",{bubbles:!0,detail:e.target})),this.opened=!1,setTimeout((()=>{window.SimplePopoverManager.requestAvailability().setPopover(this,this.querySelector('[slot="button"]'),!1),this.querySelector('[slot="button"]').focus()}),0)}static get properties(){return{opened:{type:Boolean,reflect:!0},disabled:{type:Boolean,reflect:!0},event:{type:String}}}firstUpdated(){"click"===this.event?this.addEventListener("click",this.openedToggle.bind(this)):"hover"===this.event&&(this.addEventListener("mouseenter",this.openPopover.bind(this)),this.addEventListener("focusin",this.openPopover.bind(this)),this.addEventListener("focusout",this.closePopover.bind(this)),this.addEventListener("mouseleave",this.closePopover.bind(this)),this.addEventListener("mouseout",this.closePopover.bind(this)))}openPopover(){this.disabled||setTimeout((()=>{this.opened=!0}),0)}closePopover(){setTimeout((()=>{this.opened=!1}),0)}render(){return e`<slot name="button"></slot>`}}customElements.define("simple-popover-selection",SimplePopoverSelection);export{SimplePopoverSelection};