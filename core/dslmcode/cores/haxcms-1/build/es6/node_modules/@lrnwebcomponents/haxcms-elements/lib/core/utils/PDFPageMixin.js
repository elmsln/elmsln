import{html as t}from"../../../../../lit/index.js";import{store as i}from"../haxcms-site-store.js";import"../../../../hax-iconset/lib/simple-hax-iconset.js";import{b64toBlob as o}from"../../../../utils/utils.js";import{MicroFrontendRegistry as e}from"../../../../micro-frontend-registry/micro-frontend-registry.js";import{HAXCMSI18NMixin as s}from"./HAXCMSI18NMixin.js";import{toJS as a}from"../../../../../mobx/dist/mobx.esm.js";import{enableServices as n}from"../../../../micro-frontend-registry/lib/microServices.js";import"../../../../simple-tooltip/simple-tooltip.js";export const PDFPageMixin=function(r){return class extends(s(r)){constructor(){super(),n(["core"]),this.t=this.t||{},this.t={...this.t,downloadPdf:"Download PDF",downloadingPdfPleaseWait:"Downloading PDF, please wait"},this.__pdfLoading=!1}PDFPageButton(i="auto"){return t`
        ${e.has("@core/htmlToPdf")?t` <div
              class="pdf-page-btn"
              part="${this.editMode?"edit-mode-active":""}"
            >
              <simple-icon-button-lite
                part="pdf-page-btn"
                icon="${this.__pdfLoading?"hax:loading":"lrn:pdf"}"
                id="pdf-page-btn"
                @click="${this.downloadPDFviaMicro}"
                icon-position="top"
              >
              </simple-icon-button-lite>
              <simple-tooltip for="pdf-page-btn" position="${i}">
                ${this.__pdfLoading?this.t.downloadingPdfPleaseWait:this.t.downloadPdf}
              </simple-tooltip>
            </div>`:""}
      `}static get properties(){return{...super.properties,__pdfLoading:{type:Boolean}}}async downloadPDFviaMicro(t){this.__pdfLoading=!0;let s=a(i.activeItemContent);var n="";document.querySelector("base")&&(n=document.querySelector("base").href);const r=await e.call("@core/htmlToPdf",{base:n,html:s});if(200==r.status&&r.data){const t=document.createElement("a");t.href=window.URL.createObjectURL(o(r.data,"application/pdf")),t.download=`${a(i.activeTitle)}.pdf`,t.target="_blank",this.appendChild(t),t.click(),this.removeChild(t)}this.__pdfLoading=!1}}};