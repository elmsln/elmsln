Object.defineProperty(exports,"__esModule",{value:!0}),exports.HaxCeContext=void 0;var e=require("lit"),t=require("./hax-store.js");require("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),require("@lrnwebcomponents/hax-body/lib/hax-toolbar-menu.js"),require("@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-menu-item.js"),require("@lrnwebcomponents/hax-body/lib/hax-toolbar.js");var n=require("@lrnwebcomponents/utils/utils"),o=require("./hax-context-behaviors.js"),r=require("mobx"),i=require("@lrnwebcomponents/i18n-manager/lib/I18NMixin.js");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _templateObject2_e668b7808e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral([' <hax-context-item\n                action\n                icon="','"\n                label="','"\n                event-name="hax-ce-custom-button"\n                value="','"\n              ></hax-context-item>']);return _templateObject2_e668b7808e0011ed99ce491205e67b1d=function _templateObject2_e668b7808e0011ed99ce491205e67b1d(){return e},e}function _templateObject_e668b7808e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral(['\n      <div id="toolbar">\n        <hax-toolbar>\n          <div class="group">\n            <hax-context-item\n              action\n              more\n              .icon="','"\n              label="','.."\n              tooltip="',", ",'"\n              ?disabled="','"\n              event-name="hax-transform-node"\n              show-text-label\n            ></hax-context-item>\n            <slot name="primary"></slot>\n          </div>\n          <div class="group">\n            ','\n            <slot name="secondary"></slot>\n          </div>\n          <div class="group">\n            <hax-context-item\n              action\n              icon="icons:code"\n              label="','"\n              ?disabled="','"\n              event-name="hax-source-view-toggle"\n              toggles\n              ?toggled="','"\n              @click="','"\n            ></hax-context-item>\n            <slot name="more"></slot>\n          </div>\n          <div class="group">\n            <hax-toolbar-menu\n              icon="add"\n              label="','"\n            >\n              <simple-toolbar-menu-item slot="menuitem">\n                <hax-context-item\n                  action\n                  align-horizontal="left"\n                  show-text-label\n                  role="menuitem"\n                  icon="hardware:keyboard-arrow-up"\n                  event-name="insert-above-active"\n                  label="','"\n                ></hax-context-item>\n              </simple-toolbar-menu-item>\n              <simple-toolbar-menu-item slot="menuitem">\n                <hax-context-item\n                  action\n                  align-horizontal="left"\n                  show-text-label\n                  role="menuitem"\n                  icon="hardware:keyboard-arrow-down"\n                  event-name="insert-below-active"\n                  label="','"\n                ></hax-context-item>\n              </simple-toolbar-menu-item>\n            </hax-toolbar-menu>\n          </div>\n        </hax-toolbar>\n      </div>\n    ']);return _templateObject_e668b7808e0011ed99ce491205e67b1d=function _templateObject_e668b7808e0011ed99ce491205e67b1d(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _get(e,t,n){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var o=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},_get(e,t,n||e)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var a=function(a){function HaxCeContext(){var e;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HaxCeContext),(e=function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}(this,_getPrototypeOf(HaxCeContext).call(this))).t={changeTo:"Change to",modifyHTMLSource:"Modify HTML source",clickToChange:"Click to change",insertItemAbove:"Insert item above",insertItemAboveOrBelow:"Insert item above or below",insertItemBelow:"Insert item below"},e.registerLocalization({context:_assertThisInitialized(e),namespace:"hax"}),e.haxUIElement=!0,e.onScreen=!1,e.ceButtons=[],e.activeTagName="",e.activeTagIcon="hax:paragraph",e.addEventListener("hax-context-item-selected",e.handleCECustomEvent.bind(_assertThisInitialized(e))),e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(HaxCeContext,(0,i.I18NMixin)((0,o.HaxContextBehaviors)(e.LitElement))),_createClass(HaxCeContext,null,[{key:"styles",get:function get(){return _toConsumableArray(_get(_getPrototypeOf(HaxCeContext),"styles",this))}}]),_createClass(HaxCeContext,[{key:"updated",value:function updated(e){var t=this;_get(_getPrototypeOf(HaxCeContext.prototype),"updated",this)&&_get(_getPrototypeOf(HaxCeContext.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"onScreen"===n&&t.onScreen&&t._resetCEMenu()}))}},{key:"render",value:function render(){var t=this;return(0,e.html)(_templateObject_e668b7808e0011ed99ce491205e67b1d(),this.activeTagIcon,this.t.changeTo,this.activeTagName,this.t.clickToChange,this.disableTransform,this.ceButtons.map((function(t){return(0,e.html)(_templateObject2_e668b7808e0011ed99ce491205e67b1d(),t.icon,t.label,t.callback)})),this.t.modifyHTMLSource,!this.sourceView,this.viewSource,(function(e){return t.viewSource=!t.viewSource}),this.t.insertItemAboveOrBelow,this.t.insertItemAbove,this.t.insertItemBelow)}},{key:"handleCECustomEvent",value:function handleCECustomEvent(e){var n=e.detail;if("hax-ce-custom-button"===n.eventName)this.activeNode&&"function"==typeof this.activeNode[n.value]&&this.activeNode[n.value](e)&&t.HAXStore.refreshActiveNodeForm()}},{key:"firstUpdated",value:function firstUpdated(e){var n=this;_get(_getPrototypeOf(HaxCeContext.prototype),"firstUpdated",this)&&_get(_getPrototypeOf(HaxCeContext.prototype),"firstUpdated",this).call(this,e),(0,r.autorun)((function(){n.activeNode=(0,r.toJS)(t.HAXStore.activeNode),n.activeNode&&n.activeNode.classList&&n._resetCEMenu()}))}},{key:"_resetCEMenu",value:function _resetCEMenu(){var e,o;return regeneratorRuntime.async((function _resetCEMenu$(r){for(;;)switch(r.prev=r.next){case 0:if(this.shadowRoot&&(0,n.wipeSlot)(this,"*"),this.ceButtons=[],this.viewSource=!1,!t.HAXStore.activeHaxBody||null==this.activeNode){r.next=14;break}if(e=t.HAXStore.haxSchemaFromTag(this.activeNode.tagName),this.sourceView=e.canEditSource,t.HAXStore.isTextElement(this.activeNode)){r.next=12;break}return r.next=9,regeneratorRuntime.awrap(t.HAXStore.activeHaxBody.replaceElementWorkflow(this.activeNode,!0));case 9:o=r.sent,this.disableTransform=0===o.length,t.HAXStore.activeGizmo&&(this.activeTagName=t.HAXStore.activeGizmo.title,this.activeTagIcon=t.HAXStore.activeGizmo.icon);case 12:r.next=16;break;case 14:this.activeTagName="",this.activeTagIcon="";case 16:return r.next=18,regeneratorRuntime.awrap(t.HAXStore.runHook(this.activeNode,"inlineContextMenu",[this]));case 18:case"end":return r.stop()}}),null,this)}}],[{key:"tag",get:function get(){return"hax-ce-context"}},{key:"properties",get:function get(){return function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(n,!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},_get(_getPrototypeOf(HaxCeContext),"properties",this),{disableTransform:{type:Boolean},onScreen:{type:Boolean,attribute:"on-screen",reflect:!0},sourceView:{type:Boolean},activeTagIcon:{type:String},activeTagName:{type:String},ceButtons:{type:Array},viewSource:{type:Boolean}})}}]),HaxCeContext}();exports.HaxCeContext=a,window.customElements.define(a.tag,a);