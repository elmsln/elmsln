/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as i}from"../../../../../lit/index.js";import{store as e}from"../haxcms-site-store.js";import{autorun as s,toJS as n}from"../../../../../mobx/dist/mobx.esm.js";import"../../../../jwt-login/jwt-login.js";class HAXCMSBackendPHP extends t{static get tag(){return"haxcms-backend-php"}render(){return i`
      <jwt-login
        id="jwt"
        jwt="${this.jwt}"
        @jwt-changed="${this.jwtChanged}"
      ></jwt-login>
    `}jwtChanged(t){this.jwt=t.detail.value,e.jwt=this.jwt,e.cmsSiteEditor&&e.cmsSiteEditor.instance&&(e.cmsSiteEditor.instance.jwt=this.jwt),null!=this.jwt&&"null"!=this.jwt&&""!=this.jwt&&"string"==typeof this.jwt&&this.dynamicallyImportEditor()}firstUpdated(t){setTimeout((()=>{if(window.appSettings){let t=this.shadowRoot.querySelector("#jwt");t.url=window.appSettings.login,t.refreshUrl=window.appSettings.refreshUrl,t.logoutUrl=window.appSettings.logout,t.redirectUrl=window.appSettings.redirectUrl,window.appSettings.jwt&&(this.jwt=window.appSettings.jwt)}null!=this.jwt&&"null"!=this.jwt&&""!=this.jwt&&"string"==typeof this.jwt?this.dynamicallyImportEditor():window.dispatchEvent(new CustomEvent("haxcms-not-logged-in",{bubbles:!0,composed:!0,cancelable:!1,detail:this}))}),500)}constructor(){super(),this.__disposer=[],s((t=>{this.jwt=n(e.jwt),this.__disposer.push(t)}))}disconnectedCallback(){for(var t in this.__disposer)this.__disposer[t].dispose();super.disconnectedCallback()}static get properties(){return{jwt:{type:String}}}dynamicallyImportEditor(){try{import("../haxcms-site-editor.js").then((t=>{window.appSettings&&(e.cmsSiteEditorAvailability(),e.cmsSiteEditor.instance.jwt=this.jwt,e.jwt=this.jwt,e.cmsSiteEditor.instance.saveNodePath=window.appSettings.saveNodePath,e.cmsSiteEditor.instance.saveManifestPath=window.appSettings.saveManifestPath,e.cmsSiteEditor.instance.saveOutlinePath=window.appSettings.saveOutlinePath,e.cmsSiteEditor.instance.getNodeFieldsPath=window.appSettings.getNodeFieldsPath,e.cmsSiteEditor.instance.getSiteFieldsPath=window.appSettings.getSiteFieldsPath,e.cmsSiteEditor.instance.getFormToken=window.appSettings.getFormToken,e.cmsSiteEditor.instance.publishSitePath=window.appSettings.publishSitePath,e.cmsSiteEditor.instance.syncSitePath=window.appSettings.syncSitePath,e.cmsSiteEditor.instance.revertSitePath=window.appSettings.revertSitePath,e.cmsSiteEditor.instance.createNodePath=window.appSettings.createNodePath,e.cmsSiteEditor.instance.deleteNodePath=window.appSettings.deleteNodePath,e.cmsSiteEditor.instance.getUserDataPath=window.appSettings.getUserDataPath,e.cmsSiteEditor.instance.appStore=window.appSettings.appStore)}),(t=>{}))}catch(t){}}}customElements.define(HAXCMSBackendPHP.tag,HAXCMSBackendPHP);export{HAXCMSBackendPHP};