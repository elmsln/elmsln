import{store as t}from"../haxcms-site-store.js";import{HAXStore as e}from"../../../../hax-body/lib/hax-store.js";import{HAXCMSButton as i}from"../utils/HAXCMSButton.js";import{SimpleToolbarButtonBehaviors as s}from"../../../../simple-toolbar/lib/simple-toolbar-button.js";import{toJS as o}from"../../../../../mobx/dist/mobx.esm.js";export class HAXCMSButtonAdd extends(s(i)){static get tag(){return"haxcms-button-add"}constructor(){super(),this.t=this.t||{},this.t.newPageAdded="New page added",this.t.newPage="Page",this.t.copy="Copy",this.t.newChildPage="Child",this.t.duplicatePage="Duplicate",this.t.docxImport="docx import",this.t.docxImportChildren="docx import children",this.icon="hax:add-page",this.voiceCommand="add page",this.dark=!1,this.type="sibling",this.autoEdit=!1,this.showTextLabel=!0,this.iconPosition="left",this.alignHorizontal="left",this.addEventListener("click",this.HAXCMSButtonClick)}static get styles(){return[...super.styles,...this.iconStyles,...this.labelStyles,...this.tooltipStyles,...this.simpleButtonCoreStyles,...this.simpleButtonLayoutStyles,...this.simpleButtonThemeStyles]}static get properties(){return{...super.properties,autoEdit:{type:Boolean,attribute:"auto-edit"},type:{type:String}}}updated(t){switch(super.updated&&super.updated(t),this.type){case"sibling":return this.label=this.t.newPage;case"child":return this.icon="hax:add-child-page",this.label=this.t.newChildPage;case"duplicate":return this.icon="hax:duplicate",this.label=this.t.duplicatePage;case"docximport":return this.icon="hax:file-doc",this.label=this.t.docxImport;case"docximportchildren":return this.icon="hax:file-doc",this.label=this.t.docxImportChildren}this.icon=void 0,this.setAttribute("role","menuitem")}render(){return this.buttonTemplate}connectedCallback(){super.connectedCallback(),window.addEventListener("haxcms-create-node-success",this.HAXCMSButtonClickResponse.bind(this))}disconnectedCallback(){window.removeEventListener("haxcms-create-node-success",this.HAXCMSButtonClickResponse.bind(this)),super.disconnectedCallback()}HAXCMSButtonClick(){t.playSound("click");let e=null,i=this.t.newPage,s=null;const d=o(t.activeItem);d&&("sibling"===this.type?(s=d.parent,e=parseInt(d.order)+1):"child"===this.type?(s=d.id,e=0):"duplicate"===this.type?(i=d.title+" "+this.t.copy,s=d.parent,e=parseInt(d.order)+1):"docximport"===this.type?(s=null,e=0):"docximportchildren"===this.type&&(s=d.id,e=0)),""===i&&(i="New");var a={node:{title:i,location:""},order:e,parent:s};"duplicate"===this.type?a.node.duplicate=d.id:"docximport"===this.type?a.docximport="site":"docximportchildren"===this.type&&(a.docximport="branch"),this.HAXCMSFireButtonEvent("haxcms-create-node",this,a)}HAXCMSButtonClickResponse(i){this===i.detail.originalTarget&&this.autoEdit&&(e.haxTray.collapsed=!1,setTimeout((()=>{t.editMode=!0}),250))}}customElements.define(HAXCMSButtonAdd.tag,HAXCMSButtonAdd);