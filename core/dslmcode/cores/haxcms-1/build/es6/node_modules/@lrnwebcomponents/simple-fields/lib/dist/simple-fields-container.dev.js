Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleFieldsContainerBehaviors=exports.SimpleFieldsContainer=void 0;var e=require("lit"),t=require("./simple-fields-ui.js");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _templateObject10_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <slot name="suffix"></slot>\n        ',"\n      "]);return _templateObject10_7ec316c0942811ecb1937969798b231a=function _templateObject10_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject9_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <slot name="prefix"></slot>\n        ',"\n      "]);return _templateObject9_7ec316c0942811ecb1937969798b231a=function _templateObject9_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject8_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <label\n          for="','"\n          class="label-main"\n          ?hidden="','"\n          part="label"\n        >\n          <slot name="label-prefix"></slot>\n          <slot name="label"></slot>\n          ',"","\n        </label>\n      "]);return _templateObject8_7ec316c0942811ecb1937969798b231a=function _templateObject8_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject7_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <div id="fieldmeta" aria-live="polite" part="field-meta">\n          <slot name="field-meta"></slot>\n        </div>\n      ']);return _templateObject7_7ec316c0942811ecb1937969798b231a=function _templateObject7_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject6_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <div\n          class="','"\n          part="field-main"\n        >\n          ','\n          <div part="field-inner">\n            ','\n            <slot name="field"></slot>\n            ',"\n          </div>\n        </div>\n      "]);return _templateObject6_7ec316c0942811ecb1937969798b231a=function _templateObject6_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject5_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <div class="border-bottom blur"></div>\n        <div class="border-bottom focus"></div>\n        <div id="field-bottom" part="field-bottom">\n          <div id="error-desc" part="field-bottom-inner">\n            '," ","\n          </div>\n          ","\n        </div>\n      "]);return _templateObject5_7ec316c0942811ecb1937969798b231a=function _templateObject5_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject4_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <div\n          id="error-message"\n          ?hidden="','"\n          role="alert"\n          part="error-msg"\n        >\n          ',"\n        </div>\n      "]);return _templateObject4_7ec316c0942811ecb1937969798b231a=function _templateObject4_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject3_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n        <div id="description" part="field-desc">\n          <slot name="description"></slot>\n          ',"\n        </div>\n      "]);return _templateObject3_7ec316c0942811ecb1937969798b231a=function _templateObject3_7ec316c0942811ecb1937969798b231a(){return e},e}function _templateObject2_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral(['\n          :host {\n            display: block;\n          }\n          :host([error]) {\n            color: var(--simple-fields-error-color, #b40000);\n            transition: color 0.3s ease-in-out;\n          }\n          :host([disabled]) {\n            color: var(--simple-fields-disabled-color, #999);\n          }\n          .field-main.inline,\n          .field-main > div,\n          #field-bottom {\n            display: flex;\n            align-items: stretch;\n            justify-content: flex-start;\n          }\n          * {\n            flex: 1 1 auto;\n          }\n          #fieldmeta {\n            text-align: right;\n          }\n          .field,\n          ::slotted([slot="field"]) {\n            width: auto;\n            border: none;\n            color: var(--simple-fields-color, currentColor);\n            background-color: var(--simple-fields-background-color, transparent);\n            transition: opacity ease-in-out;\n            flex: 1 0 auto;\n          }\n          ::slotted([slot="field"]:focus) {\n            outline: none;\n          }\n          :host[inline] ::slotted([slot="field"]:focus),\n          ::slotted([type="checkbox"][slot="radio"]:focus),\n          ::slotted([type="checkbox"][slot="field"]:focus) {\n            outline: unset;\n          }\n          .field-main.inline .field,\n          .field-main.inline ::slotted([slot="field"]) {\n            min-width: var(--simple-fields-detail-line-height, 22px);\n            height: var(--simple-fields-detail-line-height, 22px);\n            margin: 0 var(--simple-fields-margin-small, 8px) 0 0;\n          }\n          .field[disabled],\n          :host([readonly]) ::slotted([slot="field"]) {\n            opacity: var(--simple-fields-disabled-opacity, 0.7);\n            transition: opacity ease-in-out;\n          }\n          .field[readonly],\n          .field[disabled],\n          :host([readonly]) ::slotted([slot="field"]),\n          :host([disabled]) ::slotted([slot="field"]) {\n            cursor: not-allowed;\n            pointer-events: none;\n          }\n          .border-bottom {\n            height: 0;\n          }\n          :host([disabled]) .border-bottom {\n            border-bottom: 1px dashed var(--simple-fields-border-color, #999);\n          }\n          .border-bottom.blur {\n            border-bottom: 1px solid var(--simple-fields-border-color, #999);\n            width: 100%;\n          }\n          .border-bottom.focus {\n            margin: -1px auto 0;\n            width: 0;\n            border-bottom: 2px solid var(--simple-fields-accent-color, #3f51b5);\n            transition: width 0.5s ease-in-out;\n          }\n          :host(:focus-within) .border-bottom.focus {\n            width: 100%;\n            transition: width 0.5s ease-in-out;\n          }\n          :host([type="checkbox"]) .border-bottom,\n          :host([type="color"]) .border-bottom,\n          :host([type="file"]) .border-bottom,\n          :host([type="radio"]) .border-bottom,\n          :host([type="range"]) .border-bottom {\n            display: none;\n          }\n          ::slotted(input) {\n            padding: 0px;\n          }\n          ::slotted(textarea[slot="field"]) {\n            margin: 0;\n            transition: height 0.5s ease-in-out;\n            box-sizing: border-box;\n            vertical-align: bottom;\n          }\n          ::slotted(fieldset[slot="field"]) {\n            margin: 0;\n            padding: 0;\n            border: none;\n            font-size: var(--simple-fields-font-size, 16px);\n            font-family: var(--simple-fields-font-family, sans-serif);\n            line-height: var(--simple-fields-line-height, 22px);\n            display: var(--simple-fields-radio-option-display, block);\n            flex-wrap: var(--simple-fields-radio-option-flex-wrap, wrap);\n            transition: color 0.3s ease-in-out;\n          }\n        ']);return _templateObject2_7ec316c0942811ecb1937969798b231a=function _templateObject2_7ec316c0942811ecb1937969798b231a(){return e},e}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _templateObject_7ec316c0942811ecb1937969798b231a(){var e=_taggedTemplateLiteral([" "," "," "]);return _templateObject_7ec316c0942811ecb1937969798b231a=function _templateObject_7ec316c0942811ecb1937969798b231a(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _get(e,t,i){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,i){var n=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}},_get(e,t,i||e)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var i=function SimpleFieldsContainerBehaviors(i){return function(i){function _class(){var e;return _classCallCheck(this,_class),(e=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this))).counter="none",e.autovalidate=!1,e.disabled=!1,e.hidden=!1,e.error=!1,e.id=e._generateUUID(),e.inline=!1,e.validTypes=["checkbox","color","date","datetime-local","email","file","fieldset","hidden","month","number","password","radio","range","search","select","tel","text","textarea","time","url","week"],e._observeAndListen(),e.addEventListener("click",e.focus),e}return _inherits(_class,i),_createClass(_class,[{key:"render",value:function render(){return(0,e.html)(_templateObject_7ec316c0942811ecb1937969798b231a(),this.fieldMainTemplate,this.fieldBottom)}}],[{key:"tag",get:function get(){return"simple-fields-container"}},{key:"styles",get:function get(){return[].concat(_toConsumableArray(t.SimpleFieldsBaseStyles),_toConsumableArray(t.SimpleFieldsLabelStyles),_toConsumableArray(t.SimpleFieldsDescriptionStyles),[(0,e.css)(_templateObject2_7ec316c0942811ecb1937969798b231a())])}},{key:"properties",get:function get(){return{autovalidate:{type:Boolean},counter:{type:String},description:{type:String},disabled:{type:Boolean,reflect:!0},defaultErrorMessage:{type:String},defaultRequiredMessage:{type:String},error:{type:Boolean,reflect:!0},errorMessage:{type:String},hidden:{type:Boolean,reflect:!0},field:{type:Object},id:{type:String,reflect:!0},inline:{type:Boolean,reflect:!0},label:{type:String},minchecked:{type:Number},maxchecked:{type:Number},maxwords:{type:Number},name:{type:String,reflect:!0},numberMessage:{type:String},pattern:{type:String},patternMessage:{type:String},prefix:{type:String},readonly:{type:Boolean,reflect:!0},required:{type:Boolean,reflect:!0},requiredMessage:{type:String},suffix:{type:String},type:{type:String},validTypes:{type:Array},value:{type:Object},__delayedFocus:{type:Boolean}}}}]),_createClass(_class,[{key:"disconnectedCallback",value:function disconnectedCallback(){this.removeEventListener("click",this.focus),_get(_getPrototypeOf(_class.prototype),"disconnectedCallback",this).call(this)}},{key:"autoGrow",value:function autoGrow(){arguments.length>0&&void 0!==arguments[0]||this.field;this.field&&(this.field.style.height="auto",this.field.style.height="".concat(this.field.scrollHeight,"px"),this.field.style.overflowY="hidden")}},{key:"firstUpdated",value:function firstUpdated(e){_get(_getPrototypeOf(_class.prototype),"firstUpdated",this)&&_get(_getPrototypeOf(_class.prototype),"firstUpdated",this).call(this,e),this._updateField()}},{key:"updated",value:function updated(e){var t=this,i=!1;e.forEach((function(e,n){"error"===n&&t.error!==e&&(i=!0),"errorMessage"===n&&t.errorMessage!==e&&(i=!0),"error"===n&&t.field&&t.field.setAttribute("aria-invalid",t.error?"true":"false")})),i&&this._fireErrorChanged()}},{key:"focus",value:function focus(){this.field?(this.field.focus(),this.__delayedFocus=!1):this.__delayedFocus=!0}},{key:"select",value:function select(){!this.field||"text"!==this.type&&"textarea"!==this.type||this.field.select()}},{key:"setRangeText",value:function setRangeText(e,t,i,n){!this.field||"text"!==this.type&&"textarea"!==this.type||this.field.setRangeText(e,t,i,n)}},{key:"setSelectionRange",value:function setSelectionRange(e,t,i){!this.field||"text"!==this.type&&"textarea"!==this.type||this.field.setSelectionRange(e,t,i)}},{key:"stepDown",value:function stepDown(){this.field&&this.numeric&&this.field.stepDown()}},{key:"stepUp",value:function stepUp(){this.field&&this.numeric&&this.field.stepUp()}},{key:"validate",value:function validate(){var e=this.field.querySelector("legend");return this.requiredError?(this.error=!0,this.errorMessage=this.requiredMessage||"required"):this.numberError?(this.error=!0,this.errorMessage=this.numberMessage||(this.numberError>0?"select ".concat(this.numberError," more"):"select ".concat(0-this.numberError," fewer"))):this.patternError&&(this.error=!0,this.errorMessage=this.patternMessage||"invalid format"),this.hasFieldset&&e&&(e.innerHTML=e.innerHTML.replace(/\**\s*$/,this.error?"*":""),e.style.color=this.error?"var(--simple-fields-error-color, #b40000)":""),!this.error}},{key:"_fireErrorChanged",value:function _fireErrorChanged(){this.dispatchEvent(new CustomEvent("error-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"_generateUUID",value:function _generateUUID(){return"ss-s-s-s-sss".replace(/s/g,Math.floor(65536*(1+Math.random())).toString(16).substring(1))}},{key:"_getFieldsetValue",value:function _getFieldsetValue(){var e,t;return this.field.querySelector("input[type=radio]")?(e=this.field.querySelector("input:checked"),t=e?e.value:void 0):this.field.querySelector("input[type=checkbox]")&&(t=[],(e=this.field.querySelectorAll("input:checked")).forEach((function(e){return t.push(e.value)}))),t}},{key:"_getFieldValue",value:function _getFieldValue(){var e,t=this;return this.field&&(e=this.hasFieldset?this._getFieldsetValue():"checkbox"===this.type||"radio"===this.type?!!this.field.checked:"select"===this.type?this.multiple?Object.keys(this.field.selectedOptions).map((function(e){return t.field.selectedOptions[e].value})):this.field.selectedOptions[0].value:this.field.value),e}},{key:"_getValidType",value:function _getValidType(e){return"datetime"===e&&this.validTypes.includes(e)?"datetime-local":this.validTypes.includes(e)?e:"text"}},{key:"_handleFieldChange",value:function _handleFieldChange(){"text"!==this.type&&"textarea"!==this.type||this._updateCount(),this.autovalidate&&this.validate(),this.value=this._getFieldValue(),"textarea"===this.type&&this.autoGrow()}},{key:"_observeAndListen",value:function _observeAndListen(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?(this.slottedFieldObserver.observe(this,{attributeFilter:["disabled","readonly","required","slot"],childlist:!0}),this._updateField(),this.addEventListener("click",this.focus),this.addEventListener("focusout",this._onFocusout),this.addEventListener("focusin",this._onFocusin)):(this.slottedFieldObserver.disconnect(),this.removeEventListener("click",this.focus),this.removeEventListener("focusout",this._onFocusout),this.removeEventListener("focusin",this._onFocusin))}},{key:"_onFocusin",value:function _onFocusin(){this.error=!1}},{key:"_onFocusout",value:function _onFocusout(){this.autovalidate&&this.validate()}},{key:"_updateField",value:function _updateField(){var e=this.field;if(this.field=this.querySelector&&this.querySelector("[slot=field]")?this.querySelector("[slot=field]"):void 0,this.id="".concat(this.fieldId||"","-wrapper"),this.field){var t=this.field.tagName.toLowerCase(),i=this.field.getAttribute("type")||"text";if(this.type=this._getValidType("input"===t?i:t),this.required=this.field.required,this.disabled=this.field.disabled,this.readonly=this.field.readonly,this.field.setAttribute("aria-describedby","field-bottom"),this.addEventListener("change",this._handleFieldChange),this.addEventListener("input",this._handleFieldChange),"select"===this.type&&(this.multiple=this.field.multiple),"textarea"===this.type&&(this.field.getAttribute("rows")||this.field.setAttribute("rows",1),this.field.addEventListener("keydown",(function(e){return e.stopPropagation()}))),"fieldset"===this.type){var n=this.querySelector("legend");n&&(n.style.fontSize="var(--simple-fields-detail-font-size, 12px)",n.style.fontFamily="var(--simple-fields-detail-font-family, sans-serif)",n.style.lineHeight="var(--simple-fields-detail-line-height, 22px)",n.style.paddingInlineStart=0,n.style.paddingInlineEnd=0),this.querySelectorAll("label, input").forEach((function(e){return e.style.marginRight="var(--simple-fields-margin, 16px)"})),this.querySelectorAll("label input").forEach((function(e){return e.style.marginLeft="calc(0 - var(--simple-fields-margin, 16px))"}))}}else this.disabled=!1,this.readonly=!1,this.required=!1,this.type=void 0,e&&("textarea"===e.tagName.toLowerCase()&&e.addEventListener("keydown",(function(e){return e.stopPropagation()})),e.removeEventListener("change",this._handleFieldChange),e.removeEventListener("input",this._handleFieldChange));this.field&&this.__delayedFocus&&this.focus()}},{key:"_updateCount",value:function _updateCount(){var e,t=this,i="[\\w\\-\\']+",n=new RegExp(i,"gim"),r=this.field.getAttribute("maxlength")||this.maxlength||!1,l=this.maxwords||!1,o="word"===this.counter?l:r,s=new RegExp(".{0,".concat(r||1,"}"),"g"),a=new RegExp("(".concat(i,"\\W*){0,").concat(l||1,"}"),"g"),c=function matchval(e){return((t.field||{}).value||"").match(e)},d=function length(){return t.field.value?t.field.value.length:0},u=function wordlength(){return t.field&&t.field.value&&c(n)?c(n).length:0},f=function correctLength(e,i,n){e&&i&&i<e&&t.field.value.match(n)&&(t.field.value=c(n)[0].trim())};f(d(),r,s),f(u(),l,a),e="word"===this.counter?u():d(),"none"!==this.counter&&this.shadowRoot&&this.shadowRoot.querySelector("#fieldmeta")&&(this.shadowRoot.querySelector("#fieldmeta").innerHTML=o?"".concat(e,"/").concat(o):e)}},{key:"descriptionTemplate",get:function get(){return(0,e.html)(_templateObject3_7ec316c0942811ecb1937969798b231a(),this.description)}},{key:"errorTemplate",get:function get(){return(0,e.html)(_templateObject4_7ec316c0942811ecb1937969798b231a(),!this.error,this.errorMessage)}},{key:"fieldBottom",get:function get(){return(0,e.html)(_templateObject5_7ec316c0942811ecb1937969798b231a(),this.descriptionTemplate,this.errorTemplate,this.fieldMeta)}},{key:"fieldId",get:function get(){return"".concat(this.id||"field",".input")}},{key:"fieldMainTemplate",get:function get(){return(0,e.html)(_templateObject6_7ec316c0942811ecb1937969798b231a(),this.inline||["checkbox","color","radio"].includes(this.type||"text")?"field-main inline":"field-main",this.labelTemplate,this.prefixTemplate,this.suffixTemplate)}},{key:"fieldMeta",get:function get(){return(0,e.html)(_templateObject7_7ec316c0942811ecb1937969798b231a())}},{key:"hasFieldset",get:function get(){return"fieldset"===this.type}},{key:"labelTemplate",get:function get(){return(0,e.html)(_templateObject8_7ec316c0942811ecb1937969798b231a(),this.fieldId,"fieldset"===this.type,this.label,this.error||this.required?"*":"")}},{key:"multicheck",get:function get(){return this.hasFieldset&&this.field.querySelector("input[type=checkbox]")}},{key:"numberError",get:function get(){var e=!!this._getFieldValue()&&this._getFieldValue().length,t="select"===this.type?this.min:!!this.multicheck&&this.minchecked,i="select"===this.type?this.max:!!this.multicheck&&this.maxchecked;return i&&e&&i<e?i-e:!!(t&&e&&t>e)&&t-e}},{key:"numeric",get:function get(){return["date","month","week","time","datetime-local","number","range"].includes(this.type)}},{key:"patternError",get:function get(){var e=this;return this.pattern&&""!==this.pattern&&this._getFieldValue()&&(this.field.multiple?this._getFieldValue().filter((function(t){return!t.match(e.pattern)})):!this._getFieldValue().match(this.pattern))}},{key:"prefixTemplate",get:function get(){return(0,e.html)(_templateObject9_7ec316c0942811ecb1937969798b231a(),this.prefix)}},{key:"requiredError",get:function get(){return!this._getFieldValue()&&this.required}},{key:"slottedFieldObserver",get:function get(){return new MutationObserver(this._updateField)}},{key:"suffixTemplate",get:function get(){return(0,e.html)(_templateObject10_7ec316c0942811ecb1937969798b231a(),this.suffix)}}]),_class}(i)};exports.SimpleFieldsContainerBehaviors=i;var n=function(t){function SimpleFieldsContainer(){return _classCallCheck(this,SimpleFieldsContainer),_possibleConstructorReturn(this,_getPrototypeOf(SimpleFieldsContainer).apply(this,arguments))}return _inherits(SimpleFieldsContainer,i(e.LitElement)),SimpleFieldsContainer}();exports.SimpleFieldsContainer=n,window.customElements.define(n.tag,n);