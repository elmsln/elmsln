Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditableTableDisplay=void 0;var e=require("lit"),t=require("./editable-table-behaviors.js"),n=require("@lrnwebcomponents/responsive-utility/lib/responsive-utility-behaviors.js");function _templateObject11_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['<span class="cell"\n            >',"</span\n          >"]);return _templateObject11_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject11_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject10_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n            <editable-table-filter\n              class="cell"\n              column-index="','"\n              ?filtered="','"\n            >\n              ',"\n            </editable-table-filter>\n          "]);return _templateObject10_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject10_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject9_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['<td\n      class="td th-or-td"\n      cell-index="','"\n      ?numeric="','"\n      ?negative="','"\n      ?xs-hidden="','"\n    >\n      ',"\n    </td>"]);return _templateObject9_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject9_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject8_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['<th\n      class="th th-or-td"\n      cell-index="','"\n      ?numeric="','"\n      scope="row"\n      ?xs-hidden="','"\n    >\n      ',"\n    </th>"]);return _templateObject8_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject8_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject7_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n      <tr class="tr ','">\n        ',"\n      </tr>\n    "]);return _templateObject7_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject7_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _templateObject6_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n              <tfoot class="tfoot">\n                ',"\n              </tfoot>\n            "]);return _templateObject6_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject6_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject5_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n                        <editable-table-sort\n                          column-index="','"\n                          sort-column="','"\n                        >\n                          ',"\n                        </editable-table-sort>\n                      "]);return _templateObject5_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject5_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject4_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n                <th\n                  class="th th-or-td"\n                  cell-index="','"\n                  ?numeric="','"\n                  scope="col"\n                  ?xs-hidden="','"\n                >\n                  ',"\n                </th>\n              "]);return _templateObject4_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject4_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject3_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n                  <button id="print" @click="','">\n                    <span class="offscreen">Print table.</span>\n                    <simple-icon-lite icon="print"></simple-icon-lite>\n                  </button>\n                  <simple-tooltip\n                    id="print-tooltip"\n                    for="print"\n                    aria-hidden="true"\n                    >Print table.\n                  </simple-tooltip>\n                ']);return _templateObject3_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject3_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject2_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n                  <button id="download" @click="','">\n                    <span class="offscreen">Download as CSV.</span>\n                    <simple-icon-lite icon="file-download"></simple-icon-lite>\n                  </button>\n                  <simple-tooltip\n                    id="download-tooltip"\n                    for="download"\n                    aria-hidden="true"\n                    >Download as CSV.\n                  </simple-tooltip>\n                ']);return _templateObject2_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject2_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _templateObject_aa88f8f04fbd11edb93baf2315d3222f(){var e=_taggedTemplateLiteral(['\n      <table\n        id="table"\n        ?bordered="','"\n        class="table"\n        ?column-header="','"\n        ?column-striped="','"\n        ?condensed="','"\n        ?filter="','"\n        ?footer="','"\n        ?hidden="','"\n        ?numeric-styles="','"\n        ?row-header="','"\n        ?sort="','"\n        ?striped="','"\n      >\n        <caption>\n          <div>\n            <div>','</div>\n            <simple-picker\n              id="column"\n              align-right\n              aria-label="Select Column"\n              @change="','"\n              hide-sample\n              .options="','"\n              .value="','"\n            >\n            </simple-picker>\n            ',"\n            ",'\n          </div>\n        </caption>\n        <thead ?hidden="','" class="thead">\n          <tr class="tr thead-tr">\n            ','\n          </tr>\n        </thead>\n        <tbody class="tbody">\n          ',"\n        </tbody>\n        ",'\n      </table>\n      <div id="htmlImport" hidden><slot></slot></div>\n    ']);return _templateObject_aa88f8f04fbd11edb93baf2315d3222f=function _templateObject_aa88f8f04fbd11edb93baf2315d3222f(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _get(e,t,n){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}},_get(e,t,n||e)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}require("@lrnwebcomponents/simple-picker/simple-picker.js");var r=function(r){function EditableTableDisplay(){var e;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EditableTableDisplay),(e=_possibleConstructorReturn(this,_getPrototypeOf(EditableTableDisplay).call(this))).selected=1,e.sortMode="none",e.sortColumn=-1,e.filterContains=!0,Promise.resolve().then((function(){return _interopRequireWildcard(require("./editable-table-sort.js"))})),Promise.resolve().then((function(){return _interopRequireWildcard(require("./editable-table-filter.js"))})),e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(EditableTableDisplay,(0,t.displayBehaviors)((0,n.ResponsiveUtilityBehaviors)(e.LitElement))),_createClass(EditableTableDisplay,[{key:"render",value:function render(){var t=this;return(0,e.html)(_templateObject_aa88f8f04fbd11edb93baf2315d3222f(),this.bordered,this.columnHeader,this.columnStriped,this.condensed,this.filter,this.footer,this.hidden,this.numericStyles,this.rowHeader,this.sort,this.striped,this.getHTML(this.caption),this._selectedChanged,this.options,this.selected,this.downloadable?(0,e.html)(_templateObject2_aa88f8f04fbd11edb93baf2315d3222f(),this.download):"",this.printable?(0,e.html)(_templateObject3_aa88f8f04fbd11edb93baf2315d3222f(),this.print):"",!this.columnHeader,(this.thead[0]||[]).map((function(n,r){return(0,e.html)(_templateObject4_aa88f8f04fbd11edb93baf2315d3222f(),r,t._isNumericColumn(r),t._isColHidden(r,1),t.sort?(0,e.html)(_templateObject5_aa88f8f04fbd11edb93baf2315d3222f(),r,t.sortColumn,t.getHTML(t._replaceBlankCell(n))):t.getHTML(t._replaceBlankCell(n)))})),this.tbody.map((function(e){return t._isRowFiltered(e)?"":t._tbodyTr(e)})),this.footer?(0,e.html)(_templateObject6_aa88f8f04fbd11edb93baf2315d3222f(),this._tbodyTr(this.tfoot[0],!0,!0)):"")}}],[{key:"styles",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(EditableTableDisplay),"styles",this)||[]),_toConsumableArray(t.editableTableDisplayStyles))}},{key:"haxProperties",get:function get(){return{type:"element",editingElement:{tag:"editable-table",import:"@lrnwebcomponents/editable-table/editable-table.js"},canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Enhanced table",description:"A table for displaying data",icon:"image:grid-on",color:"blue-grey",groups:["Content","Table","Data"],meta:{author:"ELMS:LN"}},settings:{configure:[],advanced:[]},demoSchema:[{tag:"editable-table-display",content:"<table striped><tr><td>-</td><td>-</td><td>-</td></tr><tr><td>-</td><td>-</td><td>-</td></tr><tr><td>-</td><td>-</td><td>-</td></tr></table>",properties:{}}]}}},{key:"tag",get:function get(){return"editable-table-display"}},{key:"properties",get:function get(){return function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(n,!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.displayBehaviors.properties,{},n.ResponsiveUtilityBehaviors.properties,{filterColumn:{type:Number,attribute:"filter-column"},filterContains:{type:Boolean,attribute:"filter-contains"},filterCaseSensitive:{type:Boolean,attribute:"filter-case-sensitive"},filtered:{type:Boolean},filterText:{type:String,attribute:"filter-text"},selected:{type:Number},sortMode:{type:String,attribute:"sort-mode"},sortColumn:{type:Number,attribute:"sort-column"}})}}]),_createClass(EditableTableDisplay,[{key:"connectedCallback",value:function connectedCallback(){var e=this;_get(_getPrototypeOf(EditableTableDisplay.prototype),"connectedCallback",this).call(this),setTimeout((function(){e.addEventListener("change-sort-mode",e._changeSortMode.bind(e)),e.addEventListener("toggle-filter",e.toggleFilter.bind(e))}),0)}},{key:"disconnectedCallback",value:function disconnectedCallback(){this.removeEventListener("change-sort-mode",this._changeSortMode.bind(this)),this.removeEventListener("toggle-filter",this.toggleFilter.bind(this)),_get(_getPrototypeOf(EditableTableDisplay.prototype),"disconnectedCallback",this).call(this)}},{key:"sortData",value:function sortData(e,t){if("none"!==e&&!1!==e){var n=this.tbody.map((function(e){return[e[t]].concat(_toConsumableArray(e))}));"asc"===e?n.sort():n.reverse()}}},{key:"toggleFilter",value:function toggleFilter(e){void 0===e||this.filterColumn==e.detail.columnIndex&&this.filtered?(this.filtered=!1,this.filterText=void 0,this.filterColumn=void 0):(this.filterText=e.detail.innerHTML,this.filterColumn=e.detail.columnIndex,this.filtered=!0)}},{key:"_dataChanged",value:function _dataChanged(e,t){if(!e||e.length<1||e[0].length<1){var n=this.children.item(0);"undefined"!==_typeof(n)&&null!==n&&"TABLE"===n.tagName&&this.importHTML(n)}this.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!0,composed:!0,detail:e}))}},{key:"_changeSortMode",value:function _changeSortMode(e){this.sortColumn===e.detail.columnIndex&&"asc"===this.sortMode?this.sortMode="desc":this.sortColumn===e.detail.columnIndex&&"desc"===this.sortMode?this.sortMode="none":(this.sortMode="asc",this.sortColumn=e.detail.columnIndex),e.detail.setSortMode(this.sortMode)}},{key:"_isColHidden",value:function _isColHidden(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=t||1,0!==parseInt(e)&&parseInt(e)!==parseInt(t)}},{key:"_isCellFiltered",value:function _isCellFiltered(e,t,n){return!!t&&t===e&&n}},{key:"_selectedChanged",value:function _selectedChanged(){this._updateCols()}},{key:"_tableChanged",value:function _tableChanged(){this._updateCols()}},{key:"_tbodyTr",value:function _tbodyTr(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,e.html)(_templateObject7_aa88f8f04fbd11edb93baf2315d3222f(),a?"tfoot-tr":"tbody-tr",n.map((function(e,n){return t._isRowHeader(t.rowHeader,n)?t._tbodyTh(e,n):t._tbodyTd(e,n,r)})))}},{key:"_tbodyTh",value:function _tbodyTh(t,n){return(0,e.html)(_templateObject8_aa88f8f04fbd11edb93baf2315d3222f(),n,this._isNumericColumn(n),this._isColHidden(n,1),this.getHTML(this._replaceBlankCell(t)))}},{key:"_tbodyTd",value:function _tbodyTd(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,e.html)(_templateObject9_aa88f8f04fbd11edb93baf2315d3222f(),n,this._isNumericColumn(n),this._isNegative(t),this._isColHidden(n,1),this.filter?(0,e.html)(_templateObject10_aa88f8f04fbd11edb93baf2315d3222f(),n,this._isCellFiltered(n,this.filterColumn,this.filtered),this.getHTML(this._replaceBlankCell(t))):r?this.getHTML(this._replaceBlankCell(t)):(0,e.html)(_templateObject11_aa88f8f04fbd11edb93baf2315d3222f(),this.getHTML(this._replaceBlankCell(t))))}},{key:"_updateCols",value:function _updateCols(){var e=this.shadowRoot.querySelector("#column").value,t=this.shadowRoot.querySelector("#table").querySelectorAll("th,td");if(t.length>0)for(var n=0;n<t.length;n++){var r=t[n];this._isColHidden(r.cellIndex,e)?r.setAttribute("xs-hidden",!0):r.removeAttribute("xs-hidden")}}},{key:"hidden",get:function get(){return!this.data||this.data.length<1||this.data[0].length<1}},{key:"options",get:function get(){return((this.thead||[[]])[0]||[]).map((function(e,t){return[{alt:e,value:t}]}))}}]),EditableTableDisplay}();exports.EditableTableDisplay=r,window.customElements.define(r.tag,r);