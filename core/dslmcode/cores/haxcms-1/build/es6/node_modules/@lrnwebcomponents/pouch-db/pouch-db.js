/**
 * Copyright 2021
 * @license Apache-2.0, see License.md for full text.
 */
window.PouchDb=window.PouchDb||{},window.PouchDb.requestAvailability=()=>(window.PouchDb.instance||(window.PouchDb.instance=document.createElement("pouch-db"),document.body.appendChild(window.PouchDb.instance)),window.PouchDb.instance);export const PouchDBElement=window.PouchDb.requestAvailability();class PouchDb extends HTMLElement{constructor(){super(),this.windowControllers=new AbortController,this.type="xapi",import("./lib/pouchdb.min.js").then((()=>{this.db=new PouchDB(this.type)}))}static get tag(){return"pouch-db"}connectedCallback(){window.addEventListener("user-engagement",this.userEngagmentFunction.bind(this),{signal:this.windowControllers.signal}),window.addEventListener("pouch-db-get-data",this.getDataFunction.bind(this),{signal:this.windowControllers.signal})}disconnectedCallback(){this.windowControllers.abort()}userEngagmentFunction(e){var t=e.detail;if("MULTIPLE-CHOICE"===e.target.tagName)var n=t.activityDisplay,o="http://adlnet.gov/expapi/verbs/"+n,i="http://haxcms.psu.edu/haxQuiz",s=t.objectName,c="HAX Quiz",a=1,l=0,u=100,d=100,r=t.resultSuccess,b=!0,h="sample",p="sample";var w={actor:{mbox:"mailto:dave@gmail.com",name:"Dave Fusco",objectType:"Agent"},verb:{id:o,display:{"en-US":n}},object:{id:i,definition:{name:{"en-US":s},description:{"en-US":c}},objectType:"Activity"},result:{score:{scaled:a,min:l,max:u,raw:d},success:r,completion:b,response:h,duration:p}},m={_id:(new Date).toISOString(),title:JSON.stringify(w),completed:!1};console.log(m),this.db.put(m,(function callback(e,t){e||console.log("Successfully posted a statement!")})),this.db.allDocs({include_docs:!0,descending:!0},(function(e,t){console.log(t.rows)}))}getDataFunction(e){var t=e.detail;e.target.tagName;switch(t.queryRequest){case"all-quizzes":break;case"single-quiz":t.objectName;break;case"future-query":t.activityDisplay,t.objectName,t.resultSuccess,t.resultCompletion;break;default:}this.db.allDocs({include_docs:!0,descending:!0},(function(e,t){!function processxAPI(e,t){var n=[];e.forEach((function(e){var t=JSON.parse(e.doc.title).object.definition.name["en-US"];n.push(t)})),t(n)}(t.rows,(function displayxAPI(e){!function processItems(e,t){var n={};e.forEach((function(e){n[e]=(n[e]||0)+1})),t(n)}(e,(function display(e){var t=[],n=[];for(let n of Object.keys(e))t.push(n);for(let t of Object.values(e))n.push(t);let o=[""];o={labels:t,series:[n]},window.dispatchEvent(new CustomEvent("pouch-db-show-data",{bubbles:!0,composed:!0,cancelable:!1,detail:o}))}))}))}))}}customElements.define(PouchDb.tag,PouchDb);export{PouchDb};