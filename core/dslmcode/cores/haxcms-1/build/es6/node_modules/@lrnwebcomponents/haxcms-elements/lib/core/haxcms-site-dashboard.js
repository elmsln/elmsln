/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e,css as o}from"../../../../lit/index.js";import{store as i}from"./haxcms-site-store.js";import{varGet as s,varExists as a}from"../../../utils/utils.js";import{autorun as r,toJS as l}from"../../../../mobx/dist/mobx.esm.js";import"../../../simple-tooltip/simple-tooltip.js";import"../../../simple-fields/lib/simple-fields-form.js";import"../../../simple-icon/simple-icon.js";import"../../../simple-icon/lib/simple-icons.js";import"../../../simple-icon/lib/simple-icon-button.js";import{HaxSchematizer as d,HaxElementizer as n}from"../../../hax-body-behaviors/lib/HAXFields.js";class HAXCMSSiteDashboard extends t{static get tag(){return"haxcms-site-dashboard"}constructor(){super(),this.manifest={},this.__disposer=[],r((t=>{this.jwt=l(i.jwt),this.__disposer.push(t)})),r((t=>{this.dashboardOpened=l(i.dashboardOpened),this.__disposer.push(t)})),r((t=>{this.manifest=l(i.manifest),this.__disposer.push(t)}))}static get styles(){return[o`
        :host {
          z-index: 1;
          display: inline-block;
          vertical-align: top;
          position: fixed;
          height: calc(100vh - 48px);
          width: 50vw;
          margin-left: -50vw;
          border-right: 2px solid #17271f;
          overflow: scroll;
          color: black;
          background-color: var(--haxcms-dashboard-bg, orange);
        }
        :host([dashboard-opened]) {
          margin-left: 0;
        }
        .buttons {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          display: flex;
        }
        button.hax-modal-btn {
          font-size: 30px;
          padding: 8px;
          margin: 4px;
          color: white;
          background-color: green;
          border: 4px solid black;
          border-radius: 8px;
          font-family: "Press Start 2P", sans-serif;
        }
        button.hax-modal-btn.cancel {
          background-color: red;
        }
        button.hax-modal-btn:hover,
        button.hax-modal-btn:focus {
          outline: 2px solid black;
          cursor: pointer;
          background-color: darkgreen;
        }
        button.hax-modal-btn.cancel:hover,
        button.hax-modal-btn.cancel:focus {
          background-color: darkred;
        }
        .title {
          color: black;
          font-size: 24px;
          margin: 0 0 0 16px;
          padding: 0;
          display: inline-flex;
        }
        @media screen and (max-width: 600px) {
          :host {
            width: 90vw;
            margin-left: -90vw;
          }
          .title {
            font-size: 14px;
            margin: 0;
          }
          .toptext {
            font-size: 11px;
          }
        }
        button {
          background-color: white;
          color: black;
        }
        .publishlink {
          color: black;
          float: right;
        }
        .title-wrapper {
          padding: 0 16px;
        }
        .toptext {
          padding: 0;
          margin: 0;
          font-size: 12px;
          font-style: italic;
          display: inline-flex;
        }
        .fields-wrapper {
          height: auto;
          background-color: white;
        }
        #siteform {
          --a11y-tabs-height: 80vh;
          --a11y-tabs-tab-height: 75vh;
          --a11y-tabs-tab-overflow: scroll;
          --primary-color: var(--haxcms-color, #000000);
          --paper-input-container-focus-color: var(--haxcms-color, #000000);
          --lumo-primary-text-color: var(--haxcms-color, #000000);
          --a11y-tabs-color: var(--haxcms-color, #000000);
          --a11y-tabs-focus-color: var(--haxcms-color, #000000);
        }
      `]}render(){return e`
      <div class="title-wrapper">
        <h2 class="title">${this.manifest.title} settings</h2>
        ${a(this.manifest,"metadata.site.static.publishedLocation")?e`
              <span class="toptext">
                <a
                  class="publishlink"
                  href="${s(this.manifest,"metadata.site.static.publishedLocation","#")}"
                  rel="noopener noreferrer"
                  target="_blank"
                  >Published version
                </a>
              </span>
            `:""}
      </div>
      <div class="fields-wrapper">
        <simple-fields-form
          id="siteform"
          autoload
          .headers="${this.headers}"
          .body="${this.body}"
          .schematizer="${d}"
          .elementizer="${n}"
          load-endpoint="${this.loadEndpoint}"
          method="${this.method}"
        ></simple-fields-form>
      </div>
      <div class="buttons">
        <button class="hax-modal-btn" @click="${this._saveSiteFieldsTap}">
          Save
        </button>
        <button class="hax-modal-btn cancel" @click="${this._cancel}">
          cancel
        </button>
      </div>
    `}static get properties(){return{dashboardOpened:{type:Boolean,reflect:!0,attribute:"dashboard-opened"},method:{type:String},jwt:{type:String},publishing:{type:Boolean},manifest:{type:Object}}}disconnectedCallback(){for(var t in this.__disposer)this.__disposer[t].dispose();super.disconnectedCallback()}updated(t){super.updated&&super.updated(t),t.forEach(((t,e)=>{"dashboardOpened"===e&&this.dashboardOpened&&(this.removeAttribute("aria-hidden"),this.removeAttribute("tabindex")),"dashboardOpened"!==e||this.dashboardOpened||(this.setAttribute("aria-hidden","aria-hidden"),this.setAttribute("tabindex","-1"))}))}_saveSiteFieldsTap(t){i.playSound("click"),window.dispatchEvent(new CustomEvent("haxcms-save-site-data",{bubbles:!0,composed:!0,cancelable:!0,detail:this.shadowRoot.querySelector("#siteform").submit()}))}_cancel(t){i.playSound("error"),window.dispatchEvent(new CustomEvent("haxcms-load-site-dashboard",{bubbles:!0,composed:!0,cancelable:!1,detail:t.target}))}}customElements.define(HAXCMSSiteDashboard.tag,HAXCMSSiteDashboard);export{HAXCMSSiteDashboard};