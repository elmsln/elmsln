Object.defineProperty(exports,"__esModule",{value:!0}),exports.HaxPicker=void 0;var e=require("lit");require("@lrnwebcomponents/simple-toolbar/lib/simple-button-grid.js");var t=require("./hax-ui-styles.js"),n=require("./hax-store.js");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _templateObject4_e69bae608e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral(['\n                <hax-tray-button\n                  show-text-label\n                  id="picker-item-','"\n                  @click="','"\n                  data-selected="','"\n                  ?disabled="','"\n                  label="','"\n                  icon="','"\n                  icon-position="top"\n                ></hax-tray-button>\n              ']);return _templateObject4_e69bae608e0011ed99ce491205e67b1d=function _templateObject4_e69bae608e0011ed99ce491205e67b1d(){return e},e}function _templateObject3_e69bae608e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral([' <div id="filters">\n            <simple-icon-button-lite\n              icon="editable-table:filter','"\n              label="Toggle Filters"\n              tooltip-position="right"\n              @click="','"\n            >\n            </simple-icon-button-lite>\n            <simple-fields-field\n              ?hidden="','"\n              id="hax-gizmo-filters"\n              label="Filters"\n              type="checkbox"\n              .options="','"\n              @value-changed="','"\n            >\n            </simple-fields-field>\n          </div>']);return _templateObject3_e69bae608e0011ed99ce491205e67b1d=function _templateObject3_e69bae608e0011ed99ce491205e67b1d(){return e},e}function _templateObject2_e69bae608e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral(["\n      ",'\n      <simple-button-grid cols="100px">\n        ',"\n      </simple-button-grid>\n    "]);return _templateObject2_e69bae608e0011ed99ce491205e67b1d=function _templateObject2_e69bae608e0011ed99ce491205e67b1d(){return e},e}function _templateObject_e69bae608e0011ed99ce491205e67b1d(){var e=_taggedTemplateLiteral(["\n        simple-button-grid {\n          overflow-y: auto;\n          margin: var(--hax-ui-spacing-sm);\n          --simple-button-grid-cols: 100px;\n        }\n        #filters {\n          min-height: 24px;\n        }\n        simple-icon-button-lite {\n          float: right;\n          margin-left: -24px;\n        }\n        simple-fields-field::part(fieldset-legend) {\n          line-height: 24px;\n        }\n        simple-fields-field::part(fieldset-options) {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        }\n        simple-fields-field::part(option) {\n          display: flex;\n          flex-wrap: no-wrap;\n          align-items: center;\n          justify-content: space-between;\n          margin: 0 var(--simple-fields-margin-small, 8px);\n          flex-direction: row-reverse;\n        }\n        simple-fields-field::part(option-inner) {\n          flex: 0 0 auto;\n          margin: 0 calc(var(--simple-fields-margin-small, 8px) * 0.5) 0 0;\n        }\n        simple-fields-field::part(option-label) {\n          flex: 1 1 auto;\n          margin: 0;\n          font-size: var(--hax-ui-font-size-sm, 13px);\n        }\n        :host([filter-on]) simple-button-grid {\n          margin-bottom: var(--simple-fields-margin-small, 8px);\n        }\n        :host([filter-on]) #hax-gizmo-filters {\n          margin-bottom: 0;\n        }\n        :host([filter-on]) ::part(fieldset-options) {\n          padding-bottom: var(--simple-fields-margin-small, 8px);\n        }\n      "]);return _templateObject_e69bae608e0011ed99ce491205e67b1d=function _templateObject_e69bae608e0011ed99ce491205e67b1d(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var i=function(i){function HaxPicker(){var e;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HaxPicker),(e=_possibleConstructorReturn(this,_getPrototypeOf(HaxPicker).call(this)))._elements=[],e.selectionList=[],e.pickerType="gizmo",e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(HaxPicker,e.LitElement),_createClass(HaxPicker,null,[{key:"styles",get:function get(){return[].concat(_toConsumableArray(t.HaxComponentStyles),[(0,e.css)(_templateObject_e69bae608e0011ed99ce491205e67b1d())])}}]),_createClass(HaxPicker,[{key:"render",value:function render(){var t=this;return(0,e.html)(_templateObject2_e69bae608e0011ed99ce491205e67b1d(),this.keywords?(0,e.html)(_templateObject3_e69bae608e0011ed99ce491205e67b1d(),this.filterOn?"-off":"",(function(e){return t.filterOn=!t.filterOn}),!this.filterOn,this.keywords,this._handleFilters):"",this.selectionList.map((function(i,r){return t._isFiltered(i.keywords)?(0,e.html)(_templateObject4_e69bae608e0011ed99ce491205e67b1d(),r,t._selected,r,n.HAXStore.activeGizmo&&n.HAXStore.activeGizmo.tag==i.tag,i.title,i.icon):""})))}},{key:"buildOptions",value:function buildOptions(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"element",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"gizmo";this.pickerType=i;var r=[],o=function addKeywords(n){e[n].gizmo.keywords.forEach((function(e){(e=(e||"").toLowerCase()).replace(/[\s\W]*/,"").length>0&&(t.keywords[e]=e)}))};switch(this.keywords={},i){case"gizmo":for(var l in e)e[l].__type=n,r.push({icon:e[l].gizmo.icon,title:e[l].gizmo.title,color:e[l].gizmo.color,tag:e[l].gizmo.tag,keywords:e[l].gizmo.keywords}),o(l);break;case"app":for(var l in e)r.push({icon:e[l].details.icon,title:e[l].details.title,color:e[l].details.color,tag:e[l].gizmo.tag,keywords:e[l].gizmo.keywords}),o(l);break;default:r=e}this._elements=e,this.selectionList=_toConsumableArray(r),setTimeout((function(){t.shadowRoot.querySelector("#picker-item-0").focus()}),50)}},{key:"_handleFilters",value:function _handleFilters(e){var t=this.shadowRoot&&this.shadowRoot.querySelector("#hax-gizmo-filters")?this.shadowRoot.querySelector("#hax-gizmo-filters"):void 0;t&&(this.filters=t.value)}},{key:"_isFiltered",value:function _isFiltered(e){for(var t=0,n=!this.filterOn||!this.filters||this.filters.length<1;!n&&t<this.filters.length;)e.includes(this.filters[t])&&(n=!0),t++;return n}},{key:"_selected",value:function _selected(e){var t=e.target.getAttribute("data-selected");e.preventDefault(),e.stopPropagation(),console.log(this._elements[t],this.pickerType),"undefined"!==_typeof(this._elements[t])&&("gizmo"==this.pickerType?(this._elements[t].replace=!0,this.dispatchEvent(new CustomEvent("hax-insert-content",{bubbles:!0,cancelable:!0,composed:!0,detail:this._elements[t]}))):this.dispatchEvent(new CustomEvent("hax-app-picker-selection",{bubbles:!0,cancelable:!0,composed:!0,detail:this._elements[t]}))),this.close()}},{key:"close",value:function close(){window.dispatchEvent(new CustomEvent("simple-modal-hide",{bubbles:!0,cancelable:!0,detail:{}}))}}],[{key:"tag",get:function get(){return"hax-picker"}},{key:"properties",get:function get(){return{_elements:{type:Array},keywords:{type:Object},selectionList:{type:Array},pickerType:{type:String,attribute:"picker-type"},filters:{type:Array},filterOn:{type:Boolean,attribute:"filter-on",reflect:!0}}}}]),HaxPicker}();exports.HaxPicker=i,window.customElements.define(i.tag,i);