import{hooks as a}from"../utils/hooks.js";import{createDate as e,createUTCDate as r}from"./date-from-array.js";import{daysInYear as t}from"../units/year.js";import{weekOfYear as _,weeksInYear as l,dayOfYearFromWeeks as o}from"../units/week-calendar-utils.js";import{YEAR as n,MONTH as u,DATE as f,HOUR as s,MINUTE as d,SECOND as i,MILLISECOND as y}from"../units/constants.js";import{createLocal as m}from"./local.js";import w from"../utils/defaults.js";import g from"./parsing-flags.js";export function configFromArray(p){var c,C,T,U,D,Y=[];if(!p._d){for(T=function currentDateArray(e){var r=new Date(a.now());return e._useUTC?[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()]}(p),p._w&&null==p._a[f]&&null==p._a[u]&&function dayOfYearFromWeekInfo(a){var e,r,t,u,f,s,d,i;if(e=a._w,null!=e.GG||null!=e.W||null!=e.E)f=1,s=4,r=w(e.GG,a._a[n],_(m(),1,4).year),t=w(e.W,1),((u=w(e.E,1))<1||u>7)&&(i=!0);else{f=a._locale._week.dow,s=a._locale._week.doy;var y=_(m(),f,s);r=w(e.gg,a._a[n],y.year),t=w(e.w,y.week),null!=e.d?((u=e.d)<0||u>6)&&(i=!0):null!=e.e?(u=e.e+f,(e.e<0||e.e>6)&&(i=!0)):u=f}t<1||t>l(r,f,s)?g(a)._overflowWeeks=!0:null!=i?g(a)._overflowWeekday=!0:(d=o(r,t,u,f,s),a._a[n]=d.year,a._dayOfYear=d.dayOfYear)}(p),null!=p._dayOfYear&&(D=w(p._a[n],T[n]),(p._dayOfYear>t(D)||0===p._dayOfYear)&&(g(p)._overflowDayOfYear=!0),C=r(D,0,p._dayOfYear),p._a[u]=C.getUTCMonth(),p._a[f]=C.getUTCDate()),c=0;c<3&&null==p._a[c];++c)p._a[c]=Y[c]=T[c];for(;c<7;c++)p._a[c]=Y[c]=null==p._a[c]?2===c?1:0:p._a[c];24===p._a[s]&&0===p._a[d]&&0===p._a[i]&&0===p._a[y]&&(p._nextDay=!0,p._a[s]=0),p._d=(p._useUTC?r:e).apply(null,Y),U=p._useUTC?p._d.getUTCDay():p._d.getDay(),null!=p._tzm&&p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),p._nextDay&&(p._a[s]=24),p._w&&void 0!==p._w.d&&p._w.d!==U&&(g(p).weekdayMismatch=!0)}}