var t,u;t=this,u=function(){return function(t){t=t||{},function i(){void 0===t.escapeMode&&(t.escapeMode=!0),t.attributePrefix=t.attributePrefix||"_",t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",void 0===t.enableToStringFunc&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],void 0===t.skipEmptyTextNodesForObj&&(t.skipEmptyTextNodesForObj=!0),void 0===t.stripWhitespaces&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],void 0===t.useDoubleQuotes&&(t.useDoubleQuotes=!1),t.xmlElementsFilter=t.xmlElementsFilter||[],t.jsonPropertiesFilter=t.jsonPropertiesFilter||[],void 0===t.keepCData&&(t.keepCData=!1)}();var u={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function x(t){var u=t.localName;return null==u&&(u=t.baseName),null!=u&&""!=u||(u=t.nodeName),u}function s(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):t}function w(t,u,_,h){for(var O=0;O<t.length;O++){var E=t[O];if("string"==typeof E){if(E==h)break}else if(E instanceof RegExp){if(E.test(h))break}else if("function"==typeof E&&E(u,_,h))break}return O!=t.length}function n(u,_,h){"property"===t.arrayAccessForm&&(u[_]instanceof Array?u[_+"_asArray"]=u[_]:u[_+"_asArray"]=[u[_]]),!(u[_]instanceof Array)&&t.arrayAccessFormPaths.length>0&&w(t.arrayAccessFormPaths,u,_,h)&&(u[_]=[u[_]])}function a(t){var u=t.split(/[-T:+Z]/g),_=new Date(u[0],u[1]-1,u[2]),h=u[5].split(".");if(_.setHours(u[3],u[4],h[0]),h.length>1&&_.setMilliseconds(h[1]),u[6]&&u[7]){var O=60*u[6]+Number(u[7]);O=0+("-"==(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*O:O),_.setMinutes(_.getMinutes()-O-_.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(_=new Date(Date.UTC(_.getFullYear(),_.getMonth(),_.getDate(),_.getHours(),_.getMinutes(),_.getSeconds(),_.getMilliseconds())));return _}function b(_,h,O,E){return!(h==u.ELEMENT_NODE&&t.xmlElementsFilter.length>0)||w(t.xmlElementsFilter,_,O,E)}function A(_,h){if(_.nodeType==u.DOCUMENT_NODE){for(var O=new Object,E=_.childNodes,N=0;N<E.length;N++)(T=E.item(N)).nodeType==u.ELEMENT_NODE&&(O[D=x(T)]=A(T,D));return O}if(_.nodeType==u.ELEMENT_NODE){for((O=new Object).__cnt=0,E=_.childNodes,N=0;N<E.length;N++){var T,D=x(T=E.item(N));if(T.nodeType!=u.COMMENT_NODE){var F=h+"."+D;b(O,T.nodeType,D,F)&&(O.__cnt++,null==O[D]?(O[D]=A(T,F),n(O,D,F)):(null!=O[D]&&(O[D]instanceof Array||(O[D]=[O[D]],n(O,D,F))),O[D][O[D].length]=A(T,F)))}}for(var M=0;M<_.attributes.length;M++){var S=_.attributes.item(M);O.__cnt++,O[t.attributePrefix+S.name]=S.value}var P=function r(t){return t.prefix}(_);return null!=P&&""!=P&&(O.__cnt++,O.__prefix=P),null!=O["#text"]&&(O.__text=O["#text"],O.__text instanceof Array&&(O.__text=O.__text.join("\n")),t.stripWhitespaces&&(O.__text=O.__text.trim()),delete O["#text"],"property"==t.arrayAccessForm&&delete O["#text_asArray"],O.__text=function q(u,_,h){if(t.datetimeAccessFormPaths.length>0){var O=h.split(".#")[0];return w(t.datetimeAccessFormPaths,u,_,O)?a(u):u}return u}(O.__text,D,h+"."+D)),null!=O["#cdata-section"]&&(O.__cdata=O["#cdata-section"],delete O["#cdata-section"],"property"==t.arrayAccessForm&&delete O["#cdata-section_asArray"]),0==O.__cnt&&"text"==t.emptyNodeForm?O="":1==O.__cnt&&null!=O.__text?O=O.__text:1!=O.__cnt||null==O.__cdata||t.keepCData?O.__cnt>1&&null!=O.__text&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&""==O.__text||""==O.__text.trim())&&delete O.__text:O=O.__cdata,delete O.__cnt,!t.enableToStringFunc||null==O.__text&&null==O.__cdata||(O.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),O}if(_.nodeType==u.TEXT_NODE||_.nodeType==u.CDATA_SECTION_NODE)return _.nodeValue}function o(u,_,h,O){var E="<"+(null!=u&&null!=u.__prefix?u.__prefix+":":"")+_;if(null!=h)for(var N=0;N<h.length;N++){var T=h[N],D=u[T];t.escapeMode&&(D=s(D)),E+=" "+T.substr(t.attributePrefix.length)+"=",t.useDoubleQuotes?E+='"'+D+'"':E+="'"+D+"'"}return E+=O?"/>":">"}function j(t,u){return"</"+(null!=t.__prefix?t.__prefix+":":"")+u+">"}function y(u,_){return!!("property"==t.arrayAccessForm&&function v(t,u){return-1!==t.indexOf(u,t.length-u.length)}(_.toString(),"_asArray")||0==_.toString().indexOf(t.attributePrefix)||0==_.toString().indexOf("__")||u[_]instanceof Function)}function m(t){var u=0;if(t instanceof Object)for(var _ in t)y(t,_)||u++;return u}function l(u,_,h){return 0==t.jsonPropertiesFilter.length||""==h||w(t.jsonPropertiesFilter,u,_,h)}function c(u){var _=[];if(u instanceof Object)for(var h in u)-1==h.toString().indexOf("__")&&0==h.toString().indexOf(t.attributePrefix)&&_.push(h);return _}function d(u){var _="";return u instanceof Object?_+=function g(u){var _="";return null!=u.__cdata&&(_+="<![CDATA["+u.__cdata+"]]>"),null!=u.__text&&(t.escapeMode?_+=s(u.__text):_+=u.__text),_}(u):null!=u&&(t.escapeMode?_+=s(u):_+=u),_}function p(t,u){return""===t?u:t+"."+u}function f(t,u,_,h){var O="";if(0==t.length)O+=o(t,u,_,!0);else for(var E=0;E<t.length;E++)O+=o(t[E],u,c(t[E]),!1),O+=e(t[E],p(h,u)),O+=j(t[E],u);return O}function e(t,u){var _="";if(m(t)>0)for(var h in t)if(!y(t,h)&&(""==u||l(t,h,p(u,h)))){var O=t[h],E=c(O);null==O||null==O?_+=o(O,h,E,!0):O instanceof Object?O instanceof Array?_+=f(O,h,E,u):O instanceof Date?(_+=o(O,h,E,!1),_+=O.toISOString(),_+=j(O,h)):m(O)>0||null!=O.__text||null!=O.__cdata?(_+=o(O,h,E,!1),_+=e(O,p(u,h)),_+=j(O,h)):_+=o(O,h,E,!0):(_+=o(O,h,E,!1),_+=d(O),_+=j(O,h))}return _+=d(t)}this.parseXmlString=function(t){var u,_=window.ActiveXObject||"ActiveXObject"in window;if(void 0===t)return null;if(window.DOMParser){var h=new window.DOMParser,O=null;if(!_)try{O=h.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(t){O=null}try{u=h.parseFromString(t,"text/xml"),null!=O&&u.getElementsByTagNameNS(O,"parsererror").length>0&&(u=null)}catch(t){u=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(u=new ActiveXObject("Microsoft.XMLDOM")).async="false",u.loadXML(t);return u},this.asArray=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.toXmlDateTime=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.asDateTime=function(t){return"string"==typeof t?a(t):t},this.xml2json=function(t){return A(t)},this.xml_str2json=function(t){var u=this.parseXmlString(t);return null!=u?this.xml2json(u):null},this.json2xml_str=function(t){return e(t,"")},this.json2xml=function(t){var u=this.json2xml_str(t);return this.parseXmlString(u)},this.getVersion=function(){return"1.2.0"}}},"function"==typeof define&&define.amd?define([],u):"object"==typeof exports?module.exports=u():t.X2JS=u();