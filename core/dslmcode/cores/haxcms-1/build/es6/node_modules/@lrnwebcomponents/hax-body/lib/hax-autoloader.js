import{LitElement as e,html as t,css as o}from"../../../lit/index.js";import{HAXElement as s,HAXWiring as r}from"../../hax-body-behaviors/hax-body-behaviors.js";import{varGet as i}from"../../utils/utils.js";import{HAXStore as a}from"./hax-store.js";class HaxAutoloader extends(s(e)){static get styles(){return[o`
        :host {
          display: none;
        }
      `]}render(){return t`<slot></slot>`}static get tag(){return"hax-autoloader"}static get properties(){return{...super.properties,processedList:{type:Object}}}constructor(){super(),this.processedList={}}firstUpdated(e){this.dispatchEvent(new CustomEvent("hax-register-core-piece",{bubbles:!0,cancelable:!0,composed:!0,detail:{piece:"haxAutoloader",object:this}}))}connectedCallback(){super.connectedCallback(),this.observer=new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{this.processNewElements(e)}))}))})),this.observer.observe(this,{childList:!0})}disconnectedCallback(){this.observer.disconnect(),super.disconnectedCallback()}processNewElements(e){let t=this.childNodes;for(let o=0;o<t.length;o++){if(void 0!==t[o].tagName&&void 0===this.processedList[t[o].tagName])try{let s=t[o].tagName.toLowerCase();if("function"==typeof t[o].getHaxProperties){const e=new CustomEvent("hax-register-properties",{bubbles:!0,composed:!0,cancelable:!0,detail:{tag:s,properties:t[o].getHaxProperties(),polymer:!0}});context.dispatchEvent(e)}else if("function"==typeof t[o].HAXWiring){const e=new CustomEvent("hax-register-properties",{bubbles:!0,cancelable:!0,composed:!0,detail:{tag:s,properties:t[o].HAXWiring.getHaxProperties(),polymer:!1}});context.dispatchEvent(e)}else if(window.customElements.get(s)){let t=window.customElements.get(s);if(t)if("function"==typeof t.getHaxProperties)this.setHaxProperties(t.getHaxProperties(),s);else if("function"==typeof t.HAXWiring)this.setHaxProperties(t.HAXWiring.getHaxProperties(),s);else if(t.haxProperties)this.setHaxProperties(t.haxProperties,s);else{console.warn(`${s} didn't have hax wiring so HAX guessed as best it can. See https://haxtheweb.org/documentation-1/hax-development/hax-schema for documentation on adding custom wiring for better UX.`);try{let e=new r,t=e.prototypeHaxProperties();t.gizmo.title=s,t.gizmo.handles=[],t.settings.configure=[],t.settings.advanced=[],t.settings.developer=[],t=e.standardAdvancedProps(t),t.saveOptions={},t.demoSchema=[];let o={};if(customElements.get(s)&&(o=customElements.get(s).properties),o){for(let e in o)if(o[e].type&&o[e].type.name)switch(o[e].type.name){case"String":t.settings.configure.push({property:e,title:e,description:"",inputMethod:"textfield"});break;case"Number":t.settings.configure.push({property:e,title:e,description:"",inputMethod:"number"});break;case"Boolean":t.settings.configure.push({property:e,title:e,description:"",inputMethod:"boolean"})}}else{let e=document.createElement(s).getAttributeNames();for(let o=0;o<e.length;o++)t.settings.configure.push({attribute:e[o],title:e[o],description:"",inputMethod:"textfield"})}e.readyToFireHAXSchema(s,t,this)}catch(e){console.warn("HAX failed to create wiring that worked")}}else console.error(`${s} was not a valid custom element yet a load was attempted`)}else{let e=i(a,`__appStoreData.autoloader.${s}.import`,i(a,`__appStoreData.autoloader.${s}`,`@lrnwebcomponents/${s}/${s}.js`));import(`${new URL("./../../../",import.meta.url).href}${e}`).then((e=>{let t=window.customElements.get(s);t?"function"==typeof t.getHaxProperties?this.setHaxProperties(t.getHaxProperties(),s):"function"==typeof t.HAXWiring?this.setHaxProperties(t.HAXWiring.getHaxProperties(),s):t.haxProperties?this.setHaxProperties(t.haxProperties,s):i(a,`__appStoreData.autoloader.${s}.haxProperties`,!1)?this.setHaxProperties(i(a,`__appStoreData.autoloader.${s}.haxProperties`,!1),s):console.warn(`${s} didn't have hax wiring in the end`):console.error(`${s} was not a valid custom element yet a load was attempted`)})).catch((e=>{console.warn(e)}))}this.processedList[s]=s}catch(e){}t[o].remove()}}}customElements.define(HaxAutoloader.tag,HaxAutoloader);export{HaxAutoloader};