var e=require("underscore"),t=require("../promises"),r=require("../xml");exports.writeStyleMap=function writeStyleMap(e,t){return e.write(n,t),function updateRelationships(e){var t="word/_rels/document.xml.rels",n="http://schemas.openxmlformats.org/package/2006/relationships",i="{"+n+"}Relationship";return e.read(t,"utf8").then(r.readString).then((function(o){addOrUpdateElement(o.children,i,"Id",{Id:"rMammothStyleMap",Type:"http://schemas.zwobble.org/mammoth/style-map",Target:a});var m={"":n};return e.write(t,r.writeString(o,m))}))}(e).then((function(){return function updateContentTypes(e){var t="[Content_Types].xml",n="http://schemas.openxmlformats.org/package/2006/content-types",i="{"+n+"}Override";return e.read(t,"utf8").then(r.readString).then((function(o){addOrUpdateElement(o.children,i,"PartName",{PartName:a,ContentType:"text/prs.mammoth.style-map"});var m={"":n};return e.write(t,r.writeString(o,m))}))}(e)}))},exports.readStyleMap=function readStyleMap(e){return e.exists(n)?e.read(n,"utf8"):t.resolve(null)};var n="mammoth/style-map",a="/"+n;function addOrUpdateElement(t,n,a,i){var o=e.find(t,(function(e){return e.name===n&&e.attributes[a]===i[a]}));o?o.attributes=i:t.push(r.element(n,i))}