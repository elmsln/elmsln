export async function copyToClipboard(t,e=null){e||(e=`Copied ${t} to clipboard`);try{await globalThis.navigator.clipboard.writeText(t)}catch(t){e="Failed to authorize copy, refresh and authorize action"}let n=globalThis.HAXCMSToast?"haxcms-toast-show":"simple-toast-show";globalThis.dispatchEvent(new CustomEvent(n,{bubbles:!0,composed:!0,cancelable:!0,detail:{text:e,duration:5e3}}))}export function b64toBlob(t,e="",n=512){const i=atob(t),r=[];for(let t=0;t<i.length;t+=n){const e=i.slice(t,t+n),s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=e.charCodeAt(t);const a=new Uint8Array(s);r.push(a)}return new Blob(r,{type:e})}export function CSVtoArray(t){let e,n="",i=[""],r=[i],s=0,a=0,o=!0;for(e in t)e=t[e],'"'===e?(o&&e===n&&(i[s]+=e),o=!o):","===e&&o?e=i[++s]="":"\n"===e&&o?("\r"===n&&(i[s]=i[s].slice(0,-1)),i=r[++a]=[e=""],s=0):i[s]+=e,n=e;return r}export function cleanVideoSource(t){var e=t.split("?"),n="";if(t=e[0],2==e.length){let t=e[1].split("&"),i=t[0].split("="),r=Array.isArray(t.shift())?t.shift().join(""):t.shift();if("v"==i[0]){let t=void 0!==r&&""!==r?"?"+r:"";n=i[1]+t}}return-1==t.indexOf("player.vimeo.com")&&-1!=t.indexOf("vimeo.com")?(-1!=t.indexOf("/videos/")&&(t=t.replace("/videos/","/")),t.replace("vimeo.com/","player.vimeo.com/video/")):-1!=t.indexOf("youtube.com/watch")?t.replace("youtube.com/watch","youtube.com/embed/")+n:-1!=t.indexOf("youtube-no-cookie.com/")?t.replace("youtube-no-cookie.com/","youtube.com/")+n:-1!=t.indexOf("youtu.be")?t.replace("youtu.be/","www.youtube.com/embed/")+n:-1!=t.indexOf("sketchfab.com")&&-1==t.indexOf("/embed")?t+"/embed":t}function wrap(t,e){t&&t.parentNode&&(t.parentNode.insertBefore(e,t),e.appendChild(t))}export function lightChildrenToShadowRootSelector(t,e){let n=t.firstElementChild;for(;n;)t.shadowRoot.querySelector(e).appendChild(n),n=t.firstElementChild}function wrapAll(t,e){if(t&&t.length)for(var n in t[0].parentNode.insertBefore(e,t[0]),t)e.appendChild(t[n])}function unwrap(t){if(t&&t.parentNode){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.remove()}}export function normalizeEventPath(t){return t.composed&&t.composedPath?t.composedPath():t.path?t.path:t.originalTarget?[t.originalTarget]:[t.target]}function formatHTML(t,e){var n,i,r,s,a,o;for(i=(e=e||{}).indent_size||2,r=e.indent_char||" ",a=e.brace_style||"collapse",s=0==e.max_char?1/0:e.max_char||80,o=e.unformatted||["simple-icon","vocab-term","inline-audio","lrn-math","moar-sarcasm","a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],n=new function Parser(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}},this.get_content=function(){for(var t="",e=[],n=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(t,this.Utils.whitespace))e.length&&(n=!0),this.line_char_count--;else{if(n){if(this.line_char_count>=this.max_char){e.push("\n");for(var i=0;i<this.indent_level;i++)e.push(this.indent_string);this.line_char_count=0}else e.push(" "),this.line_char_count++;n=!1}e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos==this.input.length)return["","TK_EOF"];var e="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var i=n.exec(this.input),r=i?i.index:this.input.length;return this.pos<r&&(e=this.input.substring(this.pos,r),this.pos=r),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1==this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(){var t,e,n="",i=[],r=!1;do{if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];n=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(n,this.Utils.whitespace)?(r=!0,this.line_char_count--):("'"!==n&&'"'!==n||i[1]&&"!"===i[1]||(n+=this.get_unformatted(n),r=!0),"="===n&&(r=!1),i.length&&"="!==i[i.length-1]&&">"!==n&&r&&(this.line_char_count>=this.max_char?(this.print_newline(!1,i),this.line_char_count=0):(i.push(" "),this.line_char_count++),r=!1),"<"===n&&(t=this.pos-1),i.push(n))}while(">"!==n);var s,a=i.join("");s=-1!=a.indexOf(" ")?a.indexOf(" "):a.indexOf(">");var l=a.substring(1,s).toLowerCase();if("/"===a.charAt(a.length-2)||this.Utils.in_array(l,this.Utils.single_token))this.tag_type="SINGLE";else if("script"===l)this.record_tag(l),this.tag_type="SCRIPT";else if("style"===l)this.record_tag(l),this.tag_type="STYLE";else if(this.Utils.in_array(l,o)){var c=this.get_unformatted("</"+l+">",a);i.push(c),t>0&&this.Utils.in_array(this.input.charAt(t-1),this.Utils.whitespace)&&i.splice(0,0,this.input.charAt(t-1)),e=this.pos-1,this.Utils.in_array(this.input.charAt(e+1),this.Utils.whitespace)&&i.push(this.input.charAt(e+1)),this.tag_type="SINGLE"}else if("!"===l.charAt(0))if(-1!=l.indexOf("[if")){if(-1!=a.indexOf("!IE")){c=this.get_unformatted("--\x3e",a);i.push(c)}this.tag_type="START"}else if(-1!=l.indexOf("[endif"))this.tag_type="END",this.unindent();else if(-1!=l.indexOf("[cdata[")){c=this.get_unformatted("]]>",a);i.push(c),this.tag_type="SINGLE"}else{c=this.get_unformatted("--\x3e",a);i.push(c),this.tag_type="SINGLE"}else"/"===l.charAt(0)?(this.retrieve_tag(l.substring(1)),this.tag_type="END"):(this.record_tag(l),this.tag_type="START"),this.Utils.in_array(l,this.Utils.extra_liners)&&this.print_newline(!0,this.output);return i.join("")},this.get_unformatted=function(t,e){if(e&&-1!=e.toLowerCase().indexOf(t))return"";var n="",i="",r=!0;do{if(this.pos>=this.input.length)return i;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!r){this.line_char_count--;continue}if("\n"===n||"\r"===n){i+="\n",this.line_char_count=0;continue}}i+=n,this.line_char_count++,r=!0}while(-1==i.toLowerCase().indexOf(t));return i},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return"string"!=typeof(t=this.get_contents_to(e))?t:[t,"TK_"+e]}return"CONTENT"===this.current_mode?"string"!=typeof(t=this.get_content())?t:[t,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(t=this.get_tag())?t:[t,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(t){return(t=this.indent_level+t||0)<1?"":Array(t+1).join(this.indent_string)},this.printer=function(t,e,n,i,r){this.input=t||"",this.output=[],this.indent_character=e,this.indent_string="",this.indent_size=n,this.brace_style=r,this.indent_level=0,this.max_char=i,this.line_char_count=0;for(var s=0;s<this.indent_size;s++)this.indent_string+=this.indent_character;this.print_newline=function(t,e){if(this.line_char_count=0,e&&e.length){if(!t)for(;this.Utils.in_array(e[e.length-1],this.Utils.whitespace);)e.pop();e.push("\n");for(var n=0;n<this.indent_level;n++)e.push(this.indent_string)}},this.print_token=function(t){this.output.push(t)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this},n.printer(t,r,i,s,a);;){var l=n.get_token();if(n.token_text=l[0],n.token_type=l[1],"TK_EOF"===n.token_type)break;switch(n.token_type){case"TK_TAG_START":n.print_newline(!1,n.output),n.print_token(n.token_text),n.indent(),n.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":n.print_newline(!1,n.output),n.print_token(n.token_text),n.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===n.last_token&&""===n.last_text){var c=n.token_text.match(/\w+/)[0],p=n.output[n.output.length-1].match(/<\s*(\w+)/);null!==p&&p[1]===c||n.print_newline(!0,n.output)}n.print_token(n.token_text),n.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var h=n.token_text.match(/^\s*<([a-z]+)/i);h&&n.Utils.in_array(h[1],o)||n.print_newline(!1,n.output),n.print_token(n.token_text),n.current_mode="CONTENT";break;case"TK_CONTENT":""!==n.token_text&&n.print_token(n.token_text),n.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==n.token_text){n.output.push("\n");var u=n.token_text;if("TK_SCRIPT"==n.token_type)var d="function"==typeof js_beautify&&js_beautify;else if("TK_STYLE"==n.token_type)d="function"==typeof css_beautify&&css_beautify;if("keep"==e.indent_scripts)var g=0;else if("separate"==e.indent_scripts)g=-n.indent_level;else g=1;var f=n.get_full_indent(g);if(d)u=d(u.replace(/^\s*/,f),e);else{var m=u.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(n.indent_string).length-1,_=n.get_full_indent(g-m);u=u.replace(/^\s*/,f).replace(/\r\n|\r|\n/g,"\n"+_).replace(/\s*$/,"")}u&&(n.print_token(u),n.print_newline(!0,n.output))}n.current_mode="TAG"}n.last_token=n.token_type,n.last_text=n.token_text}return n.output.join("")}export function localStorageGet(t,e=""){try{return null===localStorage.getItem(t)?e:JSON.parse(localStorage.getItem(t))}catch(t){return!1}}export function mimeTypeToName(t){let e=t.split("/");switch(e[1]){case"msword":return".doc";case"application/vnd.ms-excel":return".xls";case"vnd.ms-powerpoint":return".ppt";case"vnd.openxmlformats-officedocument.wordprocessingml.document":return".docx";case"vnd.openxmlformats-officedocument.spreadsheetml.sheet":return".xlsx";case"vnd.openxmlformats-officedocument.presentationml.presentation":return".pptx";case"mpeg":return".mp3";case"svg+xml":return".svg";case"markdown":return".md";case"plain":return"text";case"text":return".txt";case"rtf":case"gif":case"jpeg":case"jpg":case"png":case"webm":case"webp":case"html":case"htm":case"zip":case"csv":case"pdf":case"mp4":return`.${e[1]}`}return"file"}export function localStorageSet(t,e){try{return localStorage.setItem(t,JSON.stringify(e))}catch(t){return!1}}export function localStorageDelete(t){try{return localStorage.removeItem(t)}catch(t){return!1}}function validURL(t){let e;try{e=new URL(t)}catch(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}return"https:"===e.protocol}function valueMapTransform(t,e){let n=[];return e&&t.forEach((t=>{let i={};for(var r in e){let n=e[r];if(!0===n||!1===n||null===n)i[r]=n;else if("function"==typeof n)try{i[r]=n(t)}catch(t){console.warn(t)}else"string"==typeof n&&varExists(t,n)?i[r]=varGet(t,n):i[r]=n}n.push(i)})),n}function camelToDash(t){return t.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}function dashToCamel(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}function haxElementToNode(t){let e=t.tag,n=t.content?t.content:"",i=t.properties?t.properties:{};globalThis.HaxStore&&globalThis.HaxStore.instance&&globalThis.HaxStore.instance._isSandboxed&&"iframe"===e&&(e="webview");var r=globalThis.document.createElement(e);r.innerHTML=n;var s=r.cloneNode(!0);for(var a in i){let t=camelToDash(a);i.hasOwnProperty(a)&&(!0===i[a]?s.setAttribute(t,i[a]):!1===i[a]?s.removeAttribute(t):null!=i[a]&&i[a].constructor===Array?r.properties&&r.properties[a]&&r.properties[a].readOnly||(s.set?s.set(t,i[a]):s[t]=[...i[a]]):null!=i[a]&&i[a].constructor===Object?r.properties&&r.properties[a]&&r.properties[a].readOnly||(s.set?s.set(t,i[a]):s[t]={...i[a]}):s.setAttribute(t,i[a]))}return s}function camelCaseToDash(t){return t.replace(/([A-Z])/g,(t=>`-${t[0].toLowerCase()}`))}function encapScript(t){return t&&"function"==typeof t.replace&&(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<script[\s\S]*?>/gi,"&lt;script&gt;")).replace(/<\/script>/gi,"&lt;/script&gt;")).replace(/<hax-(body|tray|store)[\s\S]*?>/gi,"")).replace(/<\/hax-(body|tray|store)[\s\S]*?>/gi,"")).replace(/<h-a-x[\s\S]*?>/gi,"")).replace(/<\/h-a-x*?>/gi,"")).replace(/<style[\s\S]*?>/gi,"&lt;style&gt;")).replace(/<\/style>/gi,"&lt;/style&gt;")).replace(/<template[\s\S]*?>[\s\S]*?&lt;script[\s\S]*?&gt;[\s\S]*?&lt;\/script&gt;/gi,(function(t,e,n,i){return t=(t=(t=(t=t.replace("&lt;script&gt;","<script>")).replace("&lt;/script&gt;","<\/script>")).replace("&lt;style&gt;","<style>")).replace("&lt;/style&gt;","</style>")}))),t}function findTagsInHTML(t){let e={},n="";var i=t.match(/<\/([a-z,0-9]*?)-(\S*?)>/g);for(var r in i)n=i[r].replace("</","").replace(">",""),e[n]=n;return e}function wipeSlot(t,e="*"){if("*"===e)for(;null!==t.firstChild;)t.removeChild(t.firstChild);else for(var n in t.childNodes)void 0!==t.childNodes[n]&&t.childNodes[n].slot===e&&t.removeChild(t.childNodes[n])}function generateResourceID(t="#"){function idPart(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t+idPart()+idPart()+"-"+idPart()+"-"+idPart()+"-"+idPart()+"-"+idPart()+idPart()+idPart()}export function utf2Html(t){return[...t].map((t=>t.codePointAt()>127?`&#${t.codePointAt()};`:t)).join("")}export function htmlEntities(t){return t.replace(/[\u00A0-\u9999<>\&]/gim,(function(t){return"&#"+t.charCodeAt(0)+";"}))}function stripMSWord(t){var e=t.split("\n\r").join("\n").split("\r").join("\n").split("\n\n").join("\n").split("\n\n").join("\n").split("\n\n").join("\n").split("\n").join(" ").replace(/( class=(")?Mso[a-zA-Z]+(")?)/g,"");e=(e=(e=e.replace(/<\!--(\s|.)*?-->/gim,"")).replace(/<\!(\s|.)*?>/gim,"")).replace(/<(\/)*(meta|link|title|html|head|body|span|font|br|\\\\?xml:|xml|st1:|o:|w:|m:|v:)(\s|.)*?>/gim,"");var n=["style","script","applet","embed","noframes","noscript"];for(var i in n){let t=new RegExp("<"+n[i]+"(s|.)*?"+n[i]+"(.*?)>","gim");e=e.replace(t,"")}for(var i in e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/ style='(\s|.)*?'/gim,"")).replace(/ face="(\s|.)*?"/gim,"")).replace(/ align=.*? /g,"")).replace(/ start='.*?'/g,"")).replace(/line-height:.*?\"/g,'"')).replace(/line-height:.*?;/g,"")).replace(/font-weight:normal;/g,"")).replace(/text-decoration:none;/g,"")).replace(/margin-.*?:.*?\"/g,'"')).replace(/margin-.*?:.*?;/g,"")).replace(/ style=""/g,"")).replace(/ id="(\s|.)*?"/gim,"")).replace(/ dir="(\s|.)*?"/gim,"")).replace(/ role="(\s|.)*?"/gim,"")).replace(/ contenteditable="(\s|.)*?"/gim,"")).replace(/ data-(\s|.)*?"(\s|.)*?"/gim,"")).replace(/ class="(\s|.)*?"/gim,"")).replace(/<pstyle/gm,"<p style")).replace(/<a name=\"_GoBack\"><\/a>/gm,"")).replace(/&nbsp;/gm," ")).replace(/<section>/gm,"<p>")).replace(/<\/section>/gm,"</p>")).replace(/<p><p>/gm,"<p>")).replace(/<p><p>/gm,"<p>")).replace(/<\/p><\/p>/gm,"</p>")).replace(/<\/p><\/p>/gm,"</p>")).replace(/<br \/>/gm,"<br/>")).replace(/<p><br \/><b>/gm,"<p><b>")).replace(/<\/p><br \/><\/b>/gm,"</p></b>")).replace(/<b><p>/gm,"<p>")).replace(/<\/p><\/b>/gm,"</p>")).replace(/<b>/gm,"<strong>")).replace(/<\/b>/gm,"</strong>")).replace(/<p style=\".*?\">/gm,"<p>")).replace(/<ul style=\".*?\">/gm,"<ul>")).replace(/<ol style=\".*?\">/gm,"<ol>")).replace(/<li style=\".*?\">/gm,"<li>")).replace(/<td style=\".*?\">/gm,"<td>")).replace(/<tr style=\".*?\">/gm,"<tr>")).replace(/<li><p>/gm,"<li>")).replace(/<\/p><\/li>/gm,"</li>")).replace(/<b><ul>/gm,"<ul>")).replace(/<\/ul><\/b>/gm,"</ul>")).replace(/<b><ol>/gm,"<ol>")).replace(/<\/ol><\/b>/gm,"</ol>")).replace(/<span><p>/gm,"<p>")).replace(/<\/p><\/span>/gm,"</p>")).replace(/<p>(\s*)<\/p>/gm," ")).replace(/<p><\/p>/gm,"")).replace(/<p>&nbsp;<\/p>/gm," ")).replace(/<p><br\/><\/p>/gm,"")).replace(/<p><br><\/p>/gm,"")).replace(/<\/p>(\s*)<p>/gm,"</p><p>")).replace(/ data-hax-ray="(\s|.)*?"/gim,"")).replace(/ class=""/gim,"")).replace(/ class="hax-active"/gim,"")).replace(/ contenteditable="(\s|.)*?"/gim,""),n){let t=new RegExp("<"+n[i]+"></"+n[i]+">","gi");e=e.replace(t,"")}return e=e.trim()}function varExists(t,e){return"__failedToFind__"!=objectValFromStringPos(t,e,"__failedToFind__")}function varGet(t,e,n=""){return objectValFromStringPos(t,e,n)}function objectValFromStringPos(t,e,n=null){for(var i=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),r=0,s=i.length;r<s;++r){var a=i[r];if(!t)return n;if(!(a in t))return n;t=t[a]}return t}async function nodeToHaxElement(t,e="insert-element"){if(!t)return null;var n={};let i;if(void 0!==t.style&&(n.style=t.getAttribute("style")),null!==n.style&&"null"!==n.style||delete n.style,void 0!==t.attributes.class&&(n.class=t.attributes.class.value.replace("hax-active","")),void 0!==t.attributes.id&&(n.id=t.getAttribute("id")),customElements.get(t.tagName.toLowerCase())&&(i=customElements.get(t.tagName.toLowerCase()).properties),void 0===i&&(i=t.__data),void 0!==i){for(var r in i)"class"!=r&&"style"!=r&&i.hasOwnProperty(r)&&void 0!==typeof t[r]&&null!=t[r]&&""!=t[r]?n[r]=t[r]:!1===t[r]?n[r]=!1:!0===t[r]?n[r]=!0:0===t[r]&&(n[r]=0);for(var s in t.attributes)(void 0!==t.attributes[s].name&&"class"!=t.attributes[s].name&&"style"!=t.attributes[s].name&&"id"!=t.attributes[s].name&&t.attributes.hasOwnProperty(s)&&void 0!==typeof t.attributes[s].value&&null!=t.attributes[s].value&&""!=t.attributes[s].value&&!i.hasOwnProperty(dashToCamel(t.attributes[s].name))||"0"==t.attributes[s].value)&&(n[t.attributes[s].name]=t.attributes[s].value)}else for(var s in t.attributes)void 0!==t.attributes[s].name&&"class"!=t.attributes[s].name&&"style"!=t.attributes[s].name&&"id"!=t.attributes[s].name&&t.attributes.hasOwnProperty(s)&&void 0!==typeof t.attributes[s].value&&null!=t.attributes[s].value&&""!=t.attributes[s].value&&(n[t.attributes[s].name]=t.attributes[s].value);let a=t.tagName.toLowerCase();globalThis.HaxStore&&globalThis.HaxStore.instance&&globalThis.HaxStore.instance._isSandboxed&&"iframe"===a&&(a="webview");let o="";o=globalThis.HaxStore&&globalThis.HaxStore.instance?await globalThis.HaxStore.instance.getHAXSlot(t):t.innerHTML,""==o&&(o=t.innerText),"a"===a||"mark"===a||"abbr"===a?n.innerText=o:"p"!==a&&"table"!==a&&"ol"!==a&&"ul"!==a&&"div"!==a||(n.innerHTML=o);let l={tag:a,properties:n,content:o};return null!==e&&(l.eventName=e),l}export const winEventsElement=function(t){return class extends t{__applyWinEvents(t){if(this.__winEvents)for(var e in this.__winEvents)window[(t?"add":"remove")+"EventListener"](e,this[this.__winEvents[e]])}connectedCallback(){for(var t in super.connectedCallback&&super.connectedCallback(),this.__winEvents)this[this.__winEvents[t]]=this[this.__winEvents[t]].bind(this);this.__applyWinEvents(!0)}disconnectedCallback(){this.__applyWinEvents(!1),super.disconnectedCallback&&super.disconnectedCallback()}}};export{wrap,wrapAll,unwrap,formatHTML,validURL,valueMapTransform,haxElementToNode,dashToCamel,camelToDash,camelCaseToDash,encapScript,findTagsInHTML,wipeSlot,generateResourceID,stripMSWord,varExists,varGet,objectValFromStringPos,nodeToHaxElement};const t=!1,e=globalThis.Node?[globalThis.Node.ELEMENT_NODE,globalThis.Node.TEXT_NODE,globalThis.Node.DOCUMENT_FRAGMENT_NODE]:[];function findNode(n,i,r){const s=i.childNodes||i.children;if(!s)return i;for(let o=0;o<s.length;++o){const l=s[r?o:s.length-1-o];if(a=l,e.includes(a.nodeType)){if(t&&console.debug("checking child",l,"IsLeft",r),n.containsNode(l,!0))return n.containsNode(l,!1)?(t&&console.info("found child",l),l):(t&&console.info("descending child",l),findNode(n,l,r));t&&console.info(i,"does NOT contain",l)}}var a;return i}export function isElementInViewport(t,e={top:0,right:globalThis.innerWidth,bottom:globalThis.innerHeight,left:0}){var n=t.getBoundingClientRect();return n.top>=e.top&&n.left>=e.left&&n.bottom<=e.bottom&&n.right<=e.right}function containsNextElement(t,e,n){const i=e;for(;(e=walkFromNode(e,n))&&e.contains(i););return!!e&&(e instanceof Element&&t.containsNode(e,!0))}function walkFromNode(t,e){if(!e)return t.previousSibling||t.parentNode||null;for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}return null}function initialSpace(t){return t.nodeType!==Node.TEXT_NODE?0:/^\s*/.exec(t.textContent)[0].length}const n=new Map;export function getRange(e){if(e.getSelection){const t=e.getSelection();return t.rangeCount?t.getRangeAt(0):null}const i=n.get(e);if(i)return i;const r=globalThis.getSelection().toString(),s=internalGetShadowSelection(e),a=s&&s.range&&s.range.toString()||null;return null!==a&&a!==r&&a.replace(/\s/g,"")!==r.replace(/\s/g,"")&&(console.warn("invalid range, initial text:",r),console.warn("vs",a,s.mode,s.range)),n.set(e,s.range),globalThis.setTimeout((()=>{n.delete(e)}),0),t&&console.debug("getRange got",s),s.range}export function internalGetShadowSelection(e){const n=globalThis.document.createTextNode(""),i=globalThis.document.createRange(),r=globalThis.getSelection();if(r&&e.host&&!r.containsNode(e.host,!0))return{range:null,mode:"none"};e.insertBefore(n,e.childNodes[0]);const s=r.containsNode(n);if(n.remove(),s)return{range:null,mode:"outside-before"};e.appendChild(n);const a=r.containsNode(n);if(n.remove(),a)return{range:null,mode:"outside-after"};const measure=()=>r.toString().length;r.toString();if("None"===r.type)return null;if("Caret"!==r.type&&"Range"!==r.type)throw new TypeError("unexpected type: "+r.type);r.type;const o=findNode(r,e,!0);let l,c;if("Range"===r.type&&(l=findNode(r,e,!1),c=function getSelectionDirection(e,n,i){if("Range"!==e.type)return;const measure=()=>e.toString().length,r=measure();if(t&&console.info(`initial selection: "${e.toString()}"`),1===r&&n===i)return t&&console.debug("resetting size=1"),e.extend(n,0),void e.collapseToEnd();let s;return e.modify("extend","forward","character"),s=measure(),t&&console.info(`forward selection: "${e.toString()}"`),s>r||containsNextElement(e,i,!0)?(t&&console.info("got forward >, moving right"),e.modify("extend","backward","character"),!0):s<r||!e.containsNode(n)?(t&&console.info("got forward <, moving left"),e.modify("extend","backward","character"),!1):(e.modify("extend","backward","character"),s=measure(),t&&console.info(`backward selection: "${e.toString()}"`),s>r||containsNextElement(e,n,!1)?(t&&console.info("got backwards >, moving left"),e.modify("extend","forward","character"),!1):s<r||!e.containsNode(i)?(t&&console.info("got backwards <, moving right"),e.modify("extend","forward","character"),!0):void 0)}(r,o,l)),"Caret"===r.type){r.extend(o,0);const t=measure();return r.collapseToEnd(),1===o.nodeType&&o.childNodes&&o.childNodes.length>0?(i.setStart(o.childNodes[0],t),i.setEnd(o.childNodes[0],t)):(i.setStart(o,t),i.setEnd(o,t)),{range:i,mode:"caret"}}if(void 0===c){if("Range"!==r.type)throw new TypeError("unexpected type: "+r.type);return i.setStart(o.childNodes[0],0),i.setEnd(l,l.length),{range:i,mode:"all"}}const p=measure();let h,u;const d=l.length-function ignoredTrailingSpace(t){if(t.nodeType!==Node.TEXT_NODE)return 0;const e=/\s*$/.exec(t.textContent)[0].length;return e?e-1:0}(l);return c?(r.extend(o,0),h=measure()+initialSpace(o),r.extend(l,d),u=d-(measure()-p),r.extend(l,u)):(r.extend(l,d),u=d-measure(),r.extend(o,0),h=measure()-p+initialSpace(o),r.extend(o,h)),t&&(o===l?console.info("got string",o.textContent.substr(h,u-h)):(console.info(">>> string",o.textContent.substr(h)),console.info("<<< string",l.textContent.substr(0,u)))),i.setStart(o,h),i.setEnd(l,u),{mode:c?"right":"left",range:i}}export function ReplaceWithPolyfill(){var t,e=this.parentNode,n=arguments.length;if(e)for(n||e.removeChild(this);n--;)"object"!=typeof(t=arguments[n])?t=this.ownerDocument.createTextNode(t):t.parentNode&&t.parentNode.removeChild(t),n?e.insertBefore(t,this.nextSibling):e.replaceChild(t,this)}