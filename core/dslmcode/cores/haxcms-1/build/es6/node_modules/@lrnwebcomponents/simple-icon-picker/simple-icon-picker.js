/**
 * Copyright 2019 Penn State University
 * @license Apache-2.0, see License.md for full text.
 */
import{SimplePicker as e}from"../simple-picker/simple-picker.js";import"../simple-icon/lib/simple-icon-lite.js";import"../simple-icon/lib/simple-icons.js";import{SimpleIconsetStore as t}from"../simple-icon/lib/simple-iconset.js";class SimpleIconPicker extends e{static get properties(){return{...super.properties,allowNull:{type:Boolean},icons:{type:Array},includeSets:{type:Array,attribute:"include-sets"},excludeSets:{type:Array,attribute:"exclude-sets"},exclude:{type:Array,attribute:"exclude"},value:{type:String,reflect:!0},optionsPerRow:{type:Number},__iconList:{type:Array}}}static get tag(){return"simple-icon-picker"}constructor(){super(),this.hideOptionLabels=!0,this.allowNull=!1,this.icons=[],this.value=null,this.options=[],this.optionsPerRow=10}updated(e){super.updated&&super.updated(e),e.forEach(((e,t)=>{["optionsPerRow","icons","allowNull","__iconList"].includes(t)&&(clearTimeout(this.__rebuild),this.__rebuild=setTimeout((()=>{this._getOptions()}),0)),"value"==t&&this.dispatchEvent(new CustomEvent("value-changed",{detail:{value:this[t]}}))}))}firstUpdated(e){super.firstUpdated&&super.firstUpdated(e)}_getStoredIcons(){let e=t&&t.iconlist?t.iconlist:[],i=!!(this.includeSets&&this.includeSets.length>0)&&(typeof this.includeSets!=typeof[]?JSON.parse(this.includeSets):this.includeSets),s=!!(this.excludeSets&&this.excludeSets.length>0)&&(typeof this.excludeSets!=typeof[]?JSON.parse(this.excludeSets):this.excludeSets),l=!!(this.exclude&&this.exclude.length>0)&&(typeof this.exclude!=typeof[]?JSON.parse(this.exclude):this.exclude);return(i||s||l)&&(e=e.filter((e=>{let t=e,o=e,n=!0;return t=t.replace(/:.*/,""),o.replace("icons:",""),l&&(l.includes(e)||l.includes(`icons:${o}`))&&(n=!1),i&&!i.includes(t)&&(n=!1),s&&s.includes(t)&&(n=!1),n}))),e}_getOptions(){let e="string"==typeof this.icons?JSON.parse(this.icons):this.icons,t=this.optionsPerRow;0===e.length&&(e=this._getStoredIcons());let i=!1===this.allowNull?[]:[[{alt:"null",value:null}]],s=!1===this.allowNull?0:1;t=Math.sqrt(e.length+s)<=this.optionsPerRow?Math.ceil(Math.sqrt(e.length+s)):this.optionsPerRow;for(let l=0;l<e.length;l++){let o=s+l,n=Math.floor(o/t),r=o-n*t;void 0!==i[n]&&null!==i[n]||(i[n]=[]),i[n][r]={alt:e[l],icon:e[l],value:e[l]}}this.options=i}_setSelectedOption(){this.options.length>1&&super._setSelectedOption()}}customElements.define(SimpleIconPicker.tag,SimpleIconPicker);export{SimpleIconPicker};