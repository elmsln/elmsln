//! annyang
//! version : 2.6.1
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://www.TalAter.com/annyang/
var e,n;e="undefined"!=typeof window?window:this,n=function(e,n){var t,r=e.SpeechRecognition||e.webkitSpeechRecognition||e.mozSpeechRecognition||e.msSpeechRecognition||e.oSpeechRecognition;if(!r)return null;var o,a,i=[],c={start:[],error:[],end:[],soundstart:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},s=0,u=0,l=!1,f="font-weight: bold; color: #00f;",d=!1,g=!1,p=/\s*\((.*?)\)\s*/g,h=/(\(\?:[^)]+\))\?/g,m=/(\(\?)?:\w+/g,w=/\*\w+/g,y=/[\-{}\[\]+?.,\\\^$|#]/g,invokeCallbacks=function(e,...n){e.forEach((function(e){e.callback.apply(e.context,n)}))},isInitialized=function(){return o!==n},logMessage=function(e,n){-1!==e.indexOf("%c")||n?console.log(e,n||f):console.log(e)},initIfNeeded=function(){isInitialized()||t.init({},!1)},registerCommand=function(e,n,t){i.push({command:e,callback:n,originalPhrase:t}),l&&logMessage("Command successfully loaded: %c"+t,f)},parseResults=function(e){var n;invokeCallbacks(c.result,e);for(let a=0;a<e.length;a++){n=e[a].trim().toLowerCase(),l&&logMessage("Speech recognized: %c"+n,f);for(let a=0,s=i.length;a<s;a++){var t=i[a],r=t.command.exec(n);if(r){var o=r.slice(1);return 0==o.length&&(o=r),l&&(logMessage("command matched: %c"+t.originalPhrase,f),o.length&&logMessage("with parameters",o)),t.callback.apply(this,o),void invokeCallbacks(c.resultMatch,n,t.originalPhrase,e)}}}invokeCallbacks(c.resultNoMatch,e)};return t={init:function(n,f=!0){o&&o.abort&&o.abort(),(o=new r).maxAlternatives=5,o.continuous="http:"===e.location.protocol,o.lang="en-US",o.onstart=function(){g=!0,invokeCallbacks(c.start)},o.onsoundstart=function(){invokeCallbacks(c.soundstart)},o.onerror=function(e){switch(invokeCallbacks(c.error,e),e.error){case"network":invokeCallbacks(c.errorNetwork,e);break;case"not-allowed":case"service-not-allowed":a=!1,(new Date).getTime()-s<200?invokeCallbacks(c.errorPermissionBlocked,e):invokeCallbacks(c.errorPermissionDenied,e)}},o.onend=function(){if(g=!1,invokeCallbacks(c.end),a){var e=(new Date).getTime()-s;(u+=1)%10==0&&l&&logMessage("Speech Recognition is repeatedly stopping and starting. See http://is.gd/annyang_restarts for tips."),e<1e3?setTimeout((function(){t.start({paused:d})}),1e3-e):t.start({paused:d})}},o.onresult=function(e){if(d)return l&&logMessage("Speech heard, but annyang is paused"),!1;var n=e.results[e.resultIndex],t=[];for(let e=0;e<n.length;e++)t[e]=n[e].transcript;parseResults(t)},f&&(i=[]),n.length&&this.addCommands(n)},start:function(e){initIfNeeded(),d=(e=e||{}).paused!==n&&!!e.paused,a=e.autoRestart===n||!!e.autoRestart,e.continuous!==n&&(o.continuous=!!e.continuous),s=(new Date).getTime();try{o.start()}catch(e){l&&logMessage(e.message)}},abort:function(){a=!1,u=0,isInitialized()&&o.abort()},pause:function(){d=!0},resume:function(){t.start()},debug:function(e=!0){l=!!e},setLanguage:function(e){initIfNeeded(),o.lang=e},addCommands:function(n){var t,r;initIfNeeded();for(let o in n)if(n.hasOwnProperty(o))if("function"==typeof(t=e[n[o]]||n[o]))registerCommand((r=(r=o).replace(y,"\\$&").replace(p,"(?:$1)?").replace(m,(function(e,n){return n?e:"([^\\s]+)"})).replace(w,"(.*?)").replace(h,"\\s*$1?\\s*"),new RegExp("^"+r+"$","i")),t,o);else{if(!("object"==typeof t&&t.regexp instanceof RegExp)){l&&logMessage("Can not register command: %c"+o,f);continue}registerCommand(new RegExp(t.regexp.source,"i"),t.callback,o)}},removeCommands:function(e){e===n?i=[]:(e=Array.isArray(e)?e:[e],i=i.filter((n=>{for(let t=0;t<e.length;t++)if(e[t]===n.originalPhrase)return!1;return!0})))},addCallback:function(t,r,o){var a=e[r]||r;"function"==typeof a&&c[t]!==n&&c[t].push({callback:a,context:o||this})},removeCallback:function(e,t){var compareWithCallbackParameter=function(e){return e.callback!==t};for(let r in c)c.hasOwnProperty(r)&&(e!==n&&e!==r||(c[r]=t===n?[]:c[r].filter(compareWithCallbackParameter)))},isListening:function(){return g&&!d},getSpeechRecognizer:function(){return o},trigger:function(e){t.isListening()?(Array.isArray(e)||(e=[e]),parseResults(e)):l&&logMessage(g?"Speech heard, but annyang is paused":"Cannot trigger while annyang is aborted")}}},"function"==typeof define&&define.amd?define([],(function(){return e.annyang=n(e)})):"object"==typeof module&&module.exports?module.exports=n(e):e.annyang=n(e);