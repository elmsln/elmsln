var t=require("underscore");function Numbering(e,r,n){var a=t.flatten(t.values(r).map((function(e){return t.values(e.levels)}))),u=t.indexBy(a.filter((function(t){return null!=t.paragraphStyleId})),"paragraphStyleId");return{findLevel:function findLevel(t,a){var u=e[t];if(u){var l=r[u.abstractNumId];return l?null==l.numStyleLink?r[u.abstractNumId].levels[a]:findLevel(n.findNumberingStyleById(l.numStyleLink).numId,a):null}return null},findLevelByParagraphStyleId:function findLevelByParagraphStyleId(t){return u[t]||null}}}exports.readNumberingXml=function readNumberingXml(t,e){if(!e||!e.styles)throw new Error("styles is missing");var r=function readAbstractNums(t){var e={};return t.getElementsByTagName("w:abstractNum").forEach((function(t){var r=t.attributes["w:abstractNumId"];e[r]=function readAbstractNum(t){var e={};t.getElementsByTagName("w:lvl").forEach((function(t){var r=t.attributes["w:ilvl"],n=t.first("w:numFmt").attributes["w:val"],a=t.firstOrEmpty("w:pStyle").attributes["w:val"];e[r]={isOrdered:"bullet"!==n,level:r,paragraphStyleId:a}}));var r=t.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:e,numStyleLink:r}}(t)})),e}(t);return new Numbering(function readNums(t){var e={};return t.getElementsByTagName("w:num").forEach((function(t){var r=t.attributes["w:numId"],n=t.first("w:abstractNumId").attributes["w:val"];e[r]={abstractNumId:n}})),e}(t),r,e.styles)},exports.Numbering=Numbering,exports.defaultNumbering=new Numbering({},{});