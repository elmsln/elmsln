var e=require("assert"),a=require("../../lib/docx/styles-reader").readStylesXml,n=require("../../lib/xml").Element,t=require("../test")(module);function paragraphStyleElement(e,a){return styleElement("paragraph",e,a)}function characterStyleElement(e,a){return styleElement("character",e,a)}function tableStyleElement(e,a){return styleElement("table",e,a)}function styleElement(e,a,t){return new n("w:style",{"w:type":e,"w:styleId":a},[new n("w:name",{"w:val":t},[])])}function styleWithoutWNameElement(e,a){return new n("w:style",{"w:type":e,"w:styleId":a},[])}t("paragraph style is null if no style with that ID exists",(function(){var t=a(new n("w:styles",{},[]));e.equal(t.findParagraphStyleById("Heading1"),null)})),t("paragraph style can be found by ID",(function(){var t=a(new n("w:styles",{},[paragraphStyleElement("Heading1","Heading 1")]));e.equal(t.findParagraphStyleById("Heading1").styleId,"Heading1")})),t("table style can be found by ID",(function(){var t=a(new n("w:styles",{},[tableStyleElement("TableNormal","Normal Table")]));e.equal(t.findTableStyleById("TableNormal").styleId,"TableNormal")})),t("character style can be found by ID",(function(){var t=a(new n("w:styles",{},[characterStyleElement("Heading1Char","Heading 1 Char")]));e.equal(t.findCharacterStyleById("Heading1Char").styleId,"Heading1Char")})),t("paragraph and character styles are distinct",(function(){var t=a(new n("w:styles",{},[paragraphStyleElement("Heading1","Heading 1"),characterStyleElement("Heading1Char","Heading 1 Char")]));e.equal(t.findCharacterStyleById("Heading1"),null),e.equal(t.findParagraphStyleById("Heading1Char"),null)})),t("character and table styles are distinct",(function(){var t=a(new n("w:styles",{},[tableStyleElement("Heading1","Heading 1")]));e.equal(t.findCharacterStyleById("Heading1"),null)})),t("styles include names",(function(){var t=a(new n("w:styles",{},[paragraphStyleElement("Heading1","Heading 1")]));e.equal(t.findParagraphStyleById("Heading1").name,"Heading 1")})),t("style name is null if w:name element does not exist",(function(){var t=a(new n("w:styles",{},[styleWithoutWNameElement("paragraph","Heading1"),styleWithoutWNameElement("character","Heading1Char")]));e.equal(t.findParagraphStyleById("Heading1").name,null),e.equal(t.findCharacterStyleById("Heading1Char").name,null)})),t("numbering style is null if no style with that ID exists",(function(){var t=a(new n("w:styles",{},[]));e.equal(t.findNumberingStyleById("List1"),null)})),t("numbering style has null numId if style has no paragraph properties",(function(){var t=a(new n("w:styles",{},[new n("w:style",{"w:type":"numbering","w:styleId":"List1"})]));e.equal(t.findNumberingStyleById("List1").numId,null)})),t("numbering style has numId read from paragraph properties",(function(){var t=a(new n("w:styles",{},[new n("w:style",{"w:type":"numbering","w:styleId":"List1"},[new n("w:pPr",{},[new n("w:numPr",{},[new n("w:numId",{"w:val":"42"})])])])]));e.equal(t.findNumberingStyleById("List1").numId,"42")}));