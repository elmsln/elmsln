/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e}from"../../../../../lit/index.js";import{store as i}from"../haxcms-site-store.js";import{autorun as s,toJS as a}from"../../../../../mobx/dist/mobx.esm.js";import{UserScaffoldInstance as o}from"../../../../user-scaffold/user-scaffold.js";import"../../../../jwt-login/jwt-login.js";class HAXCMSBackendPHP extends t{static get tag(){return"haxcms-backend-php"}render(){return e`
      <jwt-login
        id="jwt"
        jwt="${this.jwt}"
        @jwt-changed="${this.jwtChanged}"
      ></jwt-login>
    `}jwtChanged(t){this.jwt=t.detail.value,i.jwt=this.jwt,i.cmsSiteEditor&&i.cmsSiteEditor.instance&&(i.cmsSiteEditor.instance.jwt=this.jwt),null!=this.jwt&&"null"!=this.jwt&&""!=this.jwt&&"string"==typeof this.jwt&&this.dynamicallyImportEditor()}firstUpdated(t){setTimeout((()=>{if(globalThis.appSettings){let t=this.shadowRoot.querySelector("#jwt");t.url=globalThis.appSettings.login,t.refreshUrl=globalThis.appSettings.refreshUrl,t.logoutUrl=globalThis.appSettings.logout,t.redirectUrl=globalThis.appSettings.redirectUrl,globalThis.appSettings.jwt&&(this.jwt=globalThis.appSettings.jwt)}null!=this.jwt&&"null"!=this.jwt&&""!=this.jwt&&"string"==typeof this.jwt?this.dynamicallyImportEditor():globalThis.dispatchEvent(new CustomEvent("haxcms-not-logged-in",{bubbles:!0,composed:!0,cancelable:!1,detail:this}))}),500)}constructor(){super(),this.__disposer=[],s((t=>{this.jwt=a(i.jwt),this.__disposer.push(t)}))}disconnectedCallback(){for(var t in this.__disposer)this.__disposer[t].dispose();super.disconnectedCallback()}static get properties(){return{jwt:{type:String}}}dynamicallyImportEditor(){if(!o.readMemory("ViewOnlyMode"))try{import("../haxcms-site-editor.js").then((t=>{globalThis.appSettings&&(i.cmsSiteEditorAvailability(),i.cmsSiteEditor.instance.jwt=this.jwt,i.jwt=this.jwt,i.cmsSiteEditor.instance.saveNodePath=globalThis.appSettings.saveNodePath,i.cmsSiteEditor.instance.saveManifestPath=globalThis.appSettings.saveManifestPath,i.cmsSiteEditor.instance.saveOutlinePath=globalThis.appSettings.saveOutlinePath,i.cmsSiteEditor.instance.saveNodeDetailsPath=globalThis.appSettings.saveNodeDetailsPath||globalThis.appSettings.saveNodePath,i.cmsSiteEditor.instance.getSiteFieldsPath=globalThis.appSettings.getSiteFieldsPath,i.cmsSiteEditor.instance.getFormToken=globalThis.appSettings.getFormToken,i.cmsSiteEditor.instance.createNodePath=globalThis.appSettings.createNodePath,i.cmsSiteEditor.instance.deleteNodePath=globalThis.appSettings.deleteNodePath,i.cmsSiteEditor.instance.getUserDataPath=globalThis.appSettings.getUserDataPath,i.cmsSiteEditor.instance.appStore=globalThis.appSettings.appStore)}),(t=>{}))}catch(t){}}}globalThis.customElements.define(HAXCMSBackendPHP.tag,HAXCMSBackendPHP);export{HAXCMSBackendPHP};