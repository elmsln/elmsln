var e=require("underscore"),t=require("./docx/docx-reader"),r=require("./docx/style-map"),n=require("./document-to-html").DocumentConverter,o=require("./raw-text").convertElementToRawText,u=require("./style-reader").readStyle,a=require("./options-reader").readOptions,i=require("./unzip"),p=require("./results").Result;function convert(o,c){return c=a(c),i.openZip(o).tap((function(e){return r.readStyleMap(e).then((function(e){c.embeddedStyleMap=e}))})).then((function(r){return t.read(r,o).then((function(e){return e.map(c.transformDocument)})).then((function(t){return function convertDocumentToHtml(t,r){var o=function parseStyleMap(e){return p.combine((e||[]).map(u)).map((function(e){return e.filter((function(e){return!!e}))}))}(r.readStyleMap()),a=e.extend({},r,{styleMap:o.value}),i=new n(a);return t.flatMapThen((function(e){return o.flatMapThen((function(t){return i.convertToHtml(e)}))}))}(t,c)}))}))}exports.convertToHtml=function convertToHtml(e,t){return convert(e,t)},exports.convertToMarkdown=function convertToMarkdown(e,t){var r=Object.create(t||{});return r.outputFormat="markdown",convert(e,r)},exports.convert=convert,exports.extractRawText=function extractRawText(e){return i.openZip(e).then(t.read).then((function(e){return e.map(o)}))},exports.images=require("./images"),exports.transforms=require("./transforms"),exports.underline=require("./underline"),exports.embedStyleMap=function embedStyleMap(e,t){return i.openZip(e).tap((function(e){return r.writeStyleMap(e,t)})).then((function(e){return e.toBuffer()})).then((function(e){return{toBuffer:function(){return e}}}))},exports.readEmbeddedStyleMap=function readEmbeddedStyleMap(e){return i.openZip(e).then(r.readStyleMap)},exports.styleMapping=function(){throw new Error("Use a raw string instead of mammoth.styleMapping e.g. \"p[style-name='Title'] => h1\" instead of mammoth.styleMapping(\"p[style-name='Title'] => h1\")")};