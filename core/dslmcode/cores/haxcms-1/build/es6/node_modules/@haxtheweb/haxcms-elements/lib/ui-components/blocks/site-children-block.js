/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as e,html as t,css as i}from"../../../../../lit/index.js";import{store as n}from"../../core/haxcms-site-store.js";import{autorun as r,toJS as l}from"../../../../../mobx/dist/mobx.esm.js";import"../query/site-query-menu-slice.js";class SiteChildrenBlock extends e{static get tag(){return"site-children-block"}static get haxProperties(){return{canScale:!1,canEditSource:!0,gizmo:{title:"HAXcms: child block",description:"Dynamic block to show child of the current page",icon:"av:call-to-action",color:"grey",tags:["Other","haxcms"],handles:[],meta:{author:"HAXTheWeb core team",owner:"The Pennsylvania State University"}},settings:{configure:[],advanced:[{property:"dynamicMethodology",title:"Dynamic method",description:"How to calculate the children relative to this element",inputMethod:"select",options:{active:"Active children",parent:"Parent's children",ancestor:"All children from the highest ancestor"}},{property:"start",title:"Start level",inputMethod:"number"},{property:"end",title:"End level",inputMethod:"number"}]},demoSchema:[{tag:"site-children-block",properties:{},content:""}]}}constructor(){super(),this.__disposer=[],this.dynamicMethodology="active",this.start=0,this.end=1e3,this.fixedId=!1,this.activeId="",this.__items=[],r((e=>{this.editMode=l(n.editMode),this.__disposer.push(e)})),r((e=>{this.manifest=l(n.manifest),this.__disposer.push(e)})),r((e=>{this.activeId=l(n.activeId),this.__disposer.push(e)}))}static get styles(){return[i`
        :host {
          display: block;
          --site-children-block-indent: 16px;
          --site-children-block-link-active-bg: rgba(255, 255, 255, 0.1);
          transition: 0.2s opacity linear;
          opacity: 1;
        }
        :host([edit-mode]) {
          opacity: 0.2;
          pointer-events: none;
        }
        .link {
          display: block;
          color: var(--site-children-block-link-color, #444444);
          text-decoration: none;
        }
        .link button:hover div,
        .link button:focus div {
          text-decoration: underline;
          color: var(--site-children-block-link-hover-color, #000000);
        }
        button {
          cursor: pointer;
          display: block;
          line-height: inherit;
          font-size: var(--site-children-block-font-size, inherit);
          font-family: inherit;
          padding: 0;
          margin: 0;
          text-align: left;
          text-transform: unset;
          min-width: unset;
          width: 100%;
          margin: 0;
          border-radius: 0;
          justify-content: flex-start;
          background-color: transparent;
          border: none;
          color: inherit;
        }
        ul {
          margin: 0;
          padding: 0;
          list-style: none;
        }
        li {
          margin: 0;
          padding: var(--site-children-block-li-padding, 0);
          border-bottom: var(--site-children-block-border-bottom, none);
        }
        .active {
          background-color: var(--site-children-block-link-active-bg);
          padding-left: 4px;
          border-left: var(--site-children-block-active-border-left);
        }
        .active button {
          font-weight: 700;
          color: var(--site-children-block-link-active-color, #000000);
        }

        .top-level .active {
          padding-left: var(--site-children-block-parent-active-padding);
        }
        .top-level button {
          font-weight: var(--site-children-block-parent-font-weight);
          font-size: calc(var(--site-children-block-font-size, inherit) + 2px);
          text-transform: var(
            --site-children-block-parent-text-transform,
            uppercase
          );
        }
        .top-level .active button {
          font-weight: 700;
        }
        .sub-level button {
          text-transform: var(
            --site-children-block-child-text-transform,
            capitalize
          );
        }

        .spacing .indent {
          display: inline-flex;
        }
        .indent-1 {
          margin-left: calc(var(--site-children-block-indent) * 1);
        }
        .indent-2 {
          margin-left: calc(var(--site-children-block-indent) * 2);
        }
        .indent-3 {
          margin-left: calc(var(--site-children-block-indent) * 3);
        }
        .indent-4 {
          margin-left: calc(var(--site-children-block-indent) * 4);
        }
        .indent-5 {
          margin-left: calc(var(--site-children-block-indent) * 5);
        }
        .indent-6 {
          margin-left: calc(var(--site-children-block-indent) * 6);
        }
        .indent-7 {
          margin-left: calc(var(--site-children-block-indent) * 7);
        }
        .indent-8 {
          margin-left: calc(var(--site-children-block-indent) * 8);
        }
        .indent-9 {
          margin-left: calc(var(--site-children-block-indent) * 9);
        }
        .indent-10 {
          margin-left: calc(var(--site-children-block-indent) * 10);
        }
      `]}resultChanged(e){this.__items=[...e.detail]}render(){return t`
      <ul class="wrapper">
        <site-query-menu-slice
          @result-changed="${this.resultChanged}"
          dynamic-methodology="${this.dynamicMethodology}"
          start="${this.start}"
          end="${this.end}"
          parent="${this.parent}"
          ?fixed-id="${this.fixedId}"
        ></site-query-menu-slice>
        ${this.__items.map((e=>t`${!0===e.metadata.hideInMenu||!1===e.metadata.published?"":t`
                  <li
                    class="spacing ${0===e.indent?"top-level":"sub-level"}"
                  >
                    <a
                      class="link ${e.id===this.activeId?"active":""}"
                      tabindex="-1"
                      href="${e.slug}"
                    >
                      <button>
                        <div class="indent indent-${e.indent}">
                          ${e.title}
                        </div>
                      </button>
                    </a>
                  </li>
                `} `))}
      </ul>
    `}static get properties(){return{dynamicMethodology:{type:String,attribute:"dynamic-methodology"},start:{type:Number},end:{type:Number},parent:{type:String},fixedId:{type:Boolean,attribute:"fixed-id"},__items:{type:Array},activeId:{type:String},editMode:{type:Boolean,reflect:!0,attribute:"edit-mode"}}}}customElements.define(SiteChildrenBlock.tag,SiteChildrenBlock);export{SiteChildrenBlock};