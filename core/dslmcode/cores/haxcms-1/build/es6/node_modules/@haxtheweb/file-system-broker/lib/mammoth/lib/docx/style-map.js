var e=require("underscore"),t=require("../promises"),r=require("../xml");exports.writeStyleMap=function writeStyleMap(e,t){return e.write(a,t),function updateRelationships(e){var t="word/_rels/document.xml.rels",a="http://schemas.openxmlformats.org/package/2006/relationships",o="{"+a+"}Relationship";return e.read(t,"utf8").then(r.readString).then((function(m){addOrUpdateElement(m.children,o,"Id",{Id:"rMammothStyleMap",Type:n,Target:i});var p={"":a};return e.write(t,r.writeString(m,p))}))}(e).then((function(){return function updateContentTypes(e){var t="[Content_Types].xml",n="http://schemas.openxmlformats.org/package/2006/content-types",a="{"+n+"}Override";return e.read(t,"utf8").then(r.readString).then((function(o){addOrUpdateElement(o.children,a,"PartName",{PartName:i,ContentType:"text/prs.mammoth.style-map"});var m={"":n};return e.write(t,r.writeString(o,m))}))}(e)}))},exports.readStyleMap=function readStyleMap(e){return e.exists(a)?e.read(a,"utf8"):t.resolve(null)};var n="http://schemas.zwobble.org/mammoth/style-map",a="mammoth/style-map",i="/"+a;function addOrUpdateElement(t,n,a,i){var o=e.find(t,(function(e){return e.name===n&&e.attributes[a]===i[a]}));o?o.attributes=i:t.push(r.element(n,i))}