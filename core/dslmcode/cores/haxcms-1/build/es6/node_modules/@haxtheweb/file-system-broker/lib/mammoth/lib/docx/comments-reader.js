var e=require("../documents"),t=require("../results").Result;exports.createCommentsReader=function createCommentsReader(r){function readCommentElement(t){var n=t.attributes["w:id"];function readOptionalAttribute(e){return(t.attributes[e]||"").trim()||null}return r.readXmlElements(t.children).map((function(t){return e.comment({commentId:n,body:t,authorName:readOptionalAttribute("w:author"),authorInitials:readOptionalAttribute("w:initials")})}))}return function readCommentsXml(e){return t.combine(e.getElementsByTagName("w:comment").map(readCommentElement))}};