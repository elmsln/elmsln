import{html as e,PolymerElement as i}from"../../../../@polymer/polymer/polymer-element.js";import{dom as s}from"../../../../@polymer/polymer/lib/legacy/polymer.dom.js";import"../../../../@polymer/polymer/lib/elements/dom-repeat.js";import"../../../../@polymer/polymer/lib/elements/dom-if.js";import{SecureRequestXhr as l}from"../../../secure-request/secure-request.js";import"../../../simple-icon/simple-icon.js";import"../../../simple-icon/lib/simple-icons.js";import"../../../simple-icon/lib/simple-icon-button.js";import"../../../hax-iconset/lib/simple-hax-iconset.js";import"../../../../@polymer/paper-dialog/paper-dialog.js";import"../../../../@vaadin/vaadin-upload/vaadin-upload.js";import"../../../secure-request/secure-request.js";import"./lrnapp-studio-submission-edit-add-asset.js";import"./lrnapp-studio-submission-edit-file.js";class LrnappStudioSubmissionEditFiles extends(l(i)){static get template(){return e`
      <style>
        :host {
          display: block;
          position: relative;
          min-height: 200px;
        }
        #pages {
          display: block;
        }
        .files__files {
          display: flex;
          flex-wrap: wrap;
        }
        .files__files > * {
          margin-right: 16px;
          min-width: 200px;
        }
        paper-dialog {
          width: 50%;
          width: 50vmax;
          padding: 16px;
        }
      </style>

      <div class="files__files">
        <template is="dom-repeat" items="[[files]]" as="file">
          <lrnapp-studio-submission-edit-file
            file="[[file]]"
            on-deleted="_deleteImage"
            data-index$="[[index]]"
          ></lrnapp-studio-submission-edit-file>
        </template>
        <lrnapp-studio-submission-edit-add-asset
          on-click="_addFile"
          icon="editor:attach-file"
        ></lrnapp-studio-submission-edit-add-asset>
      </div>
      <paper-dialog id="dialog">
        <h2>Add Files</h2>
        <div class="files__upload">
          <template is="dom-if" if="[[uploadUrl]]">
            <vaadin-upload
              accept="[[fileTypes]]"
              target="[[uploadUrl]]"
              method="POST"
              form-data-name="file-upload"
              on-upload-success="_handleImageUploadSuccess"
            >
              <div class="files__drop-label">
                <simple-icon icon="description"></simple-icon>
                Upload files here:
              </div>
            </vaadin-upload>
          </template>
        </div>
        <div>
          <button dialog-dismiss>Cancel</button>
        </div>
      </paper-dialog>
    `}static get tag(){return"lrnapp-studio-submission-edit-files"}static get properties(){return{files:{type:Array,notify:!0,value:null},selectedPage:{type:String,value:0},uploadUrl:{type:String,value:null,observer:"log"},fileTypes:{type:String,value:""}}}static get observers(){return["_filesChanged(files)"]}_filesChanged(e){}_addFile(e){this.$.dialog.open()}_selectPage(e){var i=s(e).localTarget.getAttribute("data-page");this.set("selectedPage",i)}_handleImageUploadSuccess(e){this.set("selectedPage",0);var i=e.detail.xhr.response;if((i=JSON.parse(i)).data.file){var s=i.data.file;null===this.files&&this.set("files",[]),this.push("files",s),this.$.dialog.close()}}_deleteImage(e){var i=s(e).localTarget.getAttribute("data-index");this.splice("files",Number(i),1)}_canUpload(){return null!==this.uploadUrl}log(e){}connectedCallback(){super.connectedCallback();const e=this.generateUrl("/api/files");null!==e&&this.set("uploadUrl",e)}}customElements.define(LrnappStudioSubmissionEditFiles.tag,LrnappStudioSubmissionEditFiles);export{LrnappStudioSubmissionEditFiles};