import t from"../utils/abs-floor.js";import{cloneWithOffset as e}from"../units/offset.js";import{normalizeUnits as s}from"../units/aliases.js";export function diff(a,i,r){var o,f,n;if(!this.isValid())return NaN;if(!(o=e(a,this)).isValid())return NaN;switch(f=6e4*(o.utcOffset()-this.utcOffset()),i=s(i)){case"year":n=monthDiff(this,o)/12;break;case"month":n=monthDiff(this,o);break;case"quarter":n=monthDiff(this,o)/3;break;case"second":n=(this-o)/1e3;break;case"minute":n=(this-o)/6e4;break;case"hour":n=(this-o)/36e5;break;case"day":n=(this-o-f)/864e5;break;case"week":n=(this-o-f)/6048e5;break;default:n=this-o}return r?n:t(n)}function monthDiff(t,e){var s=12*(e.year()-t.year())+(e.month()-t.month()),a=t.clone().add(s,"months");return-(s+(e-a<0?(e-a)/(a-t.clone().add(s-1,"months")):(e-a)/(t.clone().add(s+1,"months")-a)))||0}