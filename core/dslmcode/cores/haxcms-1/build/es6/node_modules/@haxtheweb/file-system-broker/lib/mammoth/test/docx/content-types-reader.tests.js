var e=require("assert"),n=require("../../lib/docx/content-types-reader").readContentTypesFromXml,t=require("../../lib/xml").Element,a=require("../test")(module);a("reads default-per-extension from XML",(function(){var a=n(new t("content-types:Types",{},[new t("content-types:Default",{Extension:"png",ContentType:"image/png"})]));e.equal(a.findContentType("word/media/hat.png"),"image/png")})),a("reads overrides in preference to defaults",(function(){var a=n(new t("content-types:Types",{},[new t("content-types:Default",{Extension:"png",ContentType:"image/png"}),new t("content-types:Override",{PartName:"/word/media/hat.png",ContentType:"image/hat"})]));e.equal(a.findContentType("word/media/hat.png"),"image/hat")})),a("fallback content types have common image types",(function(){var a=n(new t("content-types:Types",{},[]));e.equal(a.findContentType("word/media/hat.png"),"image/png"),e.equal(a.findContentType("word/media/hat.gif"),"image/gif"),e.equal(a.findContentType("word/media/hat.jpg"),"image/jpeg"),e.equal(a.findContentType("word/media/hat.jpeg"),"image/jpeg"),e.equal(a.findContentType("word/media/hat.bmp"),"image/bmp"),e.equal(a.findContentType("word/media/hat.tif"),"image/tiff"),e.equal(a.findContentType("word/media/hat.tiff"),"image/tiff")})),a("fallback content types are case insensitive on extension",(function(){var a=n(new t("content-types:Types",{},[]));e.equal(a.findContentType("word/media/hat.PnG"),"image/png")}));