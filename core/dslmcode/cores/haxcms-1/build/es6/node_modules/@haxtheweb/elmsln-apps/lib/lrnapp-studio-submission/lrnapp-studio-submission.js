import{html as t,PolymerElement as e}from"../../../../@polymer/polymer/polymer-element.js";import{SecureRequestXhr as s}from"../../../secure-request/secure-request.js";import"../../../../@polymer/app-route/app-location.js";import"../../../../@polymer/app-route/app-route.js";import"../../../../@polymer/polymer/lib/elements/dom-if.js";import"../../../../@polymer/paper-toast/paper-toast.js";import"./lrnapp-studio-submission-page.js";import"../elmsln-base-deps.js";import"./lrnapp-studio-submission-button.js";class LrnappStudioSubmission extends(s(e)){static get template(){return t`
      <style>
        :host {
          display: block;
        }
        button {
          padding: 0;
          margin: 0;
          min-width: 1rem;
        }
      </style>
      <app-location route="{{route}}"></app-location>
      <app-route
        route="{{route}}"
        pattern="[[endPoint]]/submissions/:submission"
        data="{{data}}"
        tail="{{tail}}"
      >
      </app-route>

      <template is="dom-if" if="[[data.submission]]">
        <lrnapp-studio-submission-page
          base-path="{{basePath}}"
          route="{{tail}}"
          id="[[data.submission]]"
          end-point="[[endPoint]]"
          csrf-token="[[csrfToken]]"
          data="{{data}}"
        ></lrnapp-studio-submission-page>
      </template>
      <template is="dom-if" if="[[!data.submission]]">
        This is the lrnapp-studio-submission page.
      </template>

      <paper-toast id="toast"></paper-toast>
    `}static get tag(){return"lrnapp-studio-submission"}static get properties(){return{elmslnCourse:{type:String},elmslnSection:{type:String},basePath:{type:String},csrfToken:{type:String},endPoint:{type:String},activePage:{type:String},basePath:{type:String},endPoint:{type:String},csrfToken:{type:String}}}static get observers(){return["_routeChanged(route, endPoint)","_updateCookies(endPoint, csrfToken)"]}connectedCallback(){super.connectedCallback(),this.addEventListener("submissionDeleted",this._handleSubmissionDeletion.bind(this)),this.addEventListener("displaymessage",this._handleDisplayMessage.bind(this))}disconnectedCallback(){this.removeEventListener("submissionDeleted",this._handleSubmissionDeletion.bind(this)),this.removeEventListener("displaymessage",this._handleDisplayMessage.bind(this)),super.disconnectedCallback()}_handleRouteChange(t){var e=t.detail.path;e&&(this.set("route.path",e),this.notifyPath("route.path"))}_routeChanged(t,e){if("string"==typeof t.path){if("string"==typeof e&&t.path.startsWith(e))return;window.location.reload()}}_handleSubmissionDeletion(t){t.detail.submission&&(this.set("route.path",this.endPoint),this.notifyPath("route.path"),this.$.toast.show("Submission has been deleted."))}_updateCookies(t,e){t&&e&&this.setCookies(t,e)}_handleDisplayMessage(t,e){void 0!==t.detail.messsage&&this.$.toast.show(t.detail.message)}_toArray(t){return null==t?[]:Object.keys(t).map((function(e){return t[e]}))}}customElements.define(LrnappStudioSubmission.tag,LrnappStudioSubmission);export{LrnappStudioSubmission};