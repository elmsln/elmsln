/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as e,html as t,css as s}from"../../lit/index.js";import{DDDSuper as i}from"../d-d-d/d-d-d.js";class AwesomeExplosion extends(i(e)){static get styles(){return[super.styles,s`
        :host {
          display: inline-block;
          cursor: pointer;
          transition: transform var(--ddd-duration-fast) var(--ddd-timing-ease);
        }
        :host(:hover) {
          transform: scale(1.05);
        }
        :host(:focus-visible) {
          outline: var(--ddd-focus-ring);
          outline-offset: var(--ddd-focus-offset);
        }

        /* DDD-based sizing using icon variables */
        :host([size="tiny"]) #image {
          width: var(--ddd-icon-sm);
          height: var(--ddd-icon-sm);
        }
        :host([size="small"]) #image {
          width: var(--ddd-icon-lg);
          height: var(--ddd-icon-lg);
        }
        :host([size="medium"]) #image {
          width: var(--ddd-icon-xl);
          height: var(--ddd-icon-xl);
        }
        :host([size="large"]) #image {
          width: var(--ddd-icon-2xl);
          height: var(--ddd-icon-2xl);
        }
        :host([size="epic"]) #image {
          width: var(--ddd-icon-4xl);
          height: var(--ddd-icon-4xl);
        }

        /* DDD-based color theming with dark mode support */
        :host([color="red"]) #image {
          filter: sepia() saturate(10000%) hue-rotate(30deg) brightness(0.9);
        }
        :host([color="purple"]) #image {
          filter: sepia() saturate(10000%) hue-rotate(290deg) brightness(0.9);
        }
        :host([color="blue"]) #image {
          filter: sepia() saturate(10000%) hue-rotate(210deg) brightness(0.9);
        }
        :host([color="orange"]) #image {
          filter: sepia() saturate(10000%) hue-rotate(320deg) brightness(0.9);
        }
        :host([color="yellow"]) #image {
          filter: sepia() saturate(10000%) hue-rotate(70deg) brightness(0.9);
        }

        /* Dark mode adjustments */
        @media (prefers-color-scheme: dark) {
          :host([color]) #image {
            filter-brightness: 1.2;
          }
        }

        /* Respect reduced motion preference */
        @media (prefers-reduced-motion: reduce) {
          :host {
            transition: none;
          }
          :host(:hover) {
            transform: none;
          }
          #image {
            animation: none !important;
          }
        }

        #image {
          width: var(--ddd-icon-xl);
          height: var(--ddd-icon-xl);
          border-radius: var(--ddd-radius-sm);
          transition: filter var(--ddd-duration-fast) var(--ddd-timing-ease);
        }

        /* Accessibility improvements */
        :host([disabled]) {
          pointer-events: none;
          opacity: var(--ddd-opacity-40);
        }

        .visually-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          border: 0;
        }
      `]}constructor(){super(),this.state="stop",this.image=new URL("./assets/explode.gif",import.meta.url).href,this.sound=new URL("./assets/273320__clagnut__fireworks.mp3",import.meta.url).href,this.size="medium",this.color="",this.resetSound=!1,this.soundEnabled=!0,this.disabled=!1,this.tabIndex=0,this._checkUserPreferences(),setTimeout((()=>{this.addEventListener("click",this._handleClick.bind(this)),this.addEventListener("keydown",this._handleKeydown.bind(this)),this.soundEnabled&&!globalThis.matchMedia("(prefers-reduced-motion: reduce)").matches&&(this.addEventListener("mouseover",this._handleMouseOver.bind(this)),this.addEventListener("mouseout",this._handleMouseOut.bind(this)))}),0)}render(){return t`
      <img
        loading="lazy"
        src="${this.image}"
        id="image"
        class="image-tag"
        alt="${this._getAltText()}"
        role="button"
        aria-pressed="${this.playing?"true":"false"}"
        aria-label="${this._getAriaLabel()}"
      />
      <span class="visually-hidden">
        ${this.soundEnabled?"Click or hover to play explosion sound":"Visual explosion effect (sound disabled)"}
      </span>
    `}static get tag(){return"awesome-explosion"}static get haxProperties(){return new URL(`./lib/${this.tag}.haxProperties.json`,import.meta.url).href}updated(e){e.forEach(((e,t)=>{"state"==t&&(this.stopped=this._calculateStopped(this.state),this.playing=this._calculatePlaying(this.state),this.paused=this._calculatePaused(this.state))}))}static get properties(){return{...super.properties,state:{type:String,reflect:!0},stopped:{type:Boolean},playing:{type:Boolean},paused:{type:Boolean},image:{type:String},sound:{type:String},size:{type:String,reflect:!0},color:{type:String,reflect:!0},resetSound:{type:Boolean,reflect:!0,attribute:"reset-sound"},soundEnabled:{type:Boolean,reflect:!0,attribute:"sound-enabled"},disabled:{type:Boolean,reflect:!0}}}_calculateStopped(e,t){"stop"==e?(this.stopped=!0,void 0!==globalThis.audio&&(globalThis.audio.currentTime=0),this._stopSound(),this.dispatchEvent(new CustomEvent("awesome-event",{bubbles:!0,cancelable:!0,composed:!0,detail:{message:"Sound stopped"}}))):this.stopped=!1}_calculatePlaying(e,t){"play"==e?(this.playing=!0,this._playSound(),this.dispatchEvent(new CustomEvent("awesome-event",{bubbles:!0,cancelable:!0,composed:!0,detail:{message:"Sound played"}}))):this.playing=!1}_calculatePaused(e,t){"pause"==e?(this.paused=!0,this._stopSound(),this.dispatchEvent(new CustomEvent("awesome-event",{bubbles:!0,cancelable:!0,composed:!0,detail:{message:"Sound paused"}}))):this.paused=!1}_stopSound(){void 0!==globalThis.audio&&(globalThis.audio.pause(),this.resetSound&&(globalThis.audio.currentTime=0))}_handleClick(e){this.disabled||("play"===this.state?this.state="stop":this.state="play")}_handleKeydown(e){this.disabled||" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),this._handleClick(e))}_handleMouseOver(e){!this.disabled&&this.soundEnabled&&(globalThis.matchMedia("(prefers-reduced-motion: reduce)").matches||(this.state="play"))}_handleMouseOut(e){this.disabled||(this.state="pause")}_checkUserPreferences(){const e=globalThis.matchMedia("(prefers-reduced-motion: reduce)").matches,t=globalThis.localStorage&&globalThis.localStorage.getItem("awesome-explosion-sound-enabled");null!==t&&(this.soundEnabled="true"===t),e&&(this.soundEnabled=!1)}_getAltText(){const e=this.color?` ${this.color}`:"";return`${"medium"!==this.size?` ${this.size}`:""}${e} explosion animation`}_getAriaLabel(){return`Explosion animation ${this.playing?"playing":"stopped"}${this.soundEnabled?" with sound":" (muted)"}. Click to toggle.`}_setPlaySound(e){this.state="play"}_setStopSound(e){this.state="pause"}_playSound(){this.soundEnabled&&!this.disabled&&(globalThis.matchMedia("(prefers-reduced-motion: reduce)").matches||(void 0===globalThis.audio&&(globalThis.audio=new Audio(this.sound),globalThis.audio.volume=.2),globalThis.audio.play().catch((e=>{console.warn("Audio playback failed:",e)}))))}}globalThis.customElements.define(AwesomeExplosion.tag,AwesomeExplosion);export{AwesomeExplosion};