var e=require("assert"),t=require("jszip"),n=require("../../lib/zipfile"),r=require("../../lib/docx/style-map"),o=require("../test")(module);o("reading embedded style map on document without embedded style map returns null",(function(){return normalDocx().then((function(t){return r.readStyleMap(t).then((function(t){e.equal(t,null)}))}))})),o("embedded style map can be read after being written",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return r.readStyleMap(t).then((function(t){e.equal(t,"p => h1")}))}))}))})),o("embedded style map is written to separate file",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return t.read("mammoth/style-map","utf8").then((function(t){e.equal(t,"p => h1")}))}))}))})),o("embedded style map is referenced in relationships",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return t.read("word/_rels/document.xml.rels","utf8").then((function(t){e.equal(t,a)}))}))}))})),o("re-embedding style map replaces original",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return r.writeStyleMap(t,"p => h2")})).then((function(){return t.read("word/_rels/document.xml.rels","utf8").then((function(t){e.equal(t,a)}))})).then((function(){return r.readStyleMap(t).then((function(t){e.equal(t,"p => h2")}))}))}))})),o("embedded style map has override content type in [Content_Types].xml",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return t.read("[Content_Types].xml","utf8").then((function(t){e.equal(t,i)}))}))}))})),o("replacing style map keeps content type",(function(){return normalDocx().then((function(t){return r.writeStyleMap(t,"p => h1").then((function(){return r.writeStyleMap(t,"p => h2")})).then((function(){return t.read("[Content_Types].xml","utf8").then((function(t){e.equal(t,i)}))}))}))}));var a='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/><Relationship Id="rMammothStyleMap" Type="http://schemas.zwobble.org/mammoth/style-map" Target="/mammoth/style-map"/></Relationships>',i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="png" ContentType="image/png"/><Override PartName="/mammoth/style-map" ContentType="text/prs.mammoth.style-map"/></Types>';function normalDocx(){var e=new t;return e.file("word/_rels/document.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/></Relationships>'),e.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="png" ContentType="image/png"/></Types>'),e.generateAsync({type:"arraybuffer"}).then((function(e){return n.openArrayBuffer(e)}))}