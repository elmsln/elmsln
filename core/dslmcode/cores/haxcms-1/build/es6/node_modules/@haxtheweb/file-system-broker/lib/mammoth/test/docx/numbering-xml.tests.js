var e=require("assert"),n=require("duck"),t=require("../../lib/docx/numbering-xml").readNumberingXml,w=require("../../lib/docx/styles-reader"),a=require("../../lib/xml").Element,r=require("../test")(module);r("w:num element inherits levels from w:abstractNum",(function(){var e=t(new a("w:numbering",{},[new a("w:abstractNum",{"w:abstractNumId":"42"},[new a("w:lvl",{"w:ilvl":"0"},[new a("w:numFmt",{"w:val":"bullet"})]),new a("w:lvl",{"w:ilvl":"1"},[new a("w:numFmt",{"w:val":"decimal"})])]),new a("w:num",{"w:numId":"47"},[new a("w:abstractNumId",{"w:val":"42"})])]),{styles:w.defaultStyles});n.assertThat(e.findLevel("47","0"),n.hasProperties({isOrdered:!1})),n.assertThat(e.findLevel("47","1"),n.hasProperties({isOrdered:!0}))})),r("w:num element referencing non-existent w:abstractNumId is ignored",(function(){var e=t(new a("w:numbering",{},[new a("w:num",{"w:numId":"47"},[new a("w:abstractNumId",{"w:val":"42"})])]),{styles:w.defaultStyles});n.assertThat(e.findLevel("47","0"),n.equalTo(null))})),r("when w:abstractNum has w:numStyleLink then style is used to find w:num",(function(){var e=t(new a("w:numbering",{},[new a("w:abstractNum",{"w:abstractNumId":"100"},[new a("w:lvl",{"w:ilvl":"0"},[new a("w:numFmt",{"w:val":"decimal"})])]),new a("w:abstractNum",{"w:abstractNumId":"101"},[new a("w:numStyleLink",{"w:val":"List1"})]),new a("w:num",{"w:numId":"200"},[new a("w:abstractNumId",{"w:val":"100"})]),new a("w:num",{"w:numId":"201"},[new a("w:abstractNumId",{"w:val":"101"})])]),{styles:new w.Styles({},{},{},{List1:{numId:"200"}})});n.assertThat(e.findLevel("201","0"),n.hasProperties({isOrdered:!0}))})),r("numbering level can be found by paragraph style ID",(function(){var e=t(new a("w:numbering",{},[new a("w:abstractNum",{"w:abstractNumId":"42"},[new a("w:lvl",{"w:ilvl":"0"},[new a("w:numFmt",{"w:val":"bullet"})])]),new a("w:abstractNum",{"w:abstractNumId":"43"},[new a("w:lvl",{"w:ilvl":"0"},[new a("w:pStyle",{"w:val":"List"}),new a("w:numFmt",{"w:val":"decimal"})])])]),{styles:w.defaultStyles});n.assertThat(e.findLevelByParagraphStyleId("List"),n.hasProperties({isOrdered:!0})),n.assertThat(e.findLevelByParagraphStyleId("Paragraph"),n.equalTo(null))})),r("when styles is missing then error is thrown",(function(){e.throws((function(){t(new a("w:numbering",{},[]))}),/styles is missing/)}));