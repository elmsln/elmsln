var e=require("underscore"),r=require("../promises"),t=require("../xml");exports.read=read,exports.readXmlFromZipFile=function readXmlFromZipFile(e,t){return e.exists(t)?e.read(t,"utf-8").then(stripUtf8Bom).then(read):r.resolve(null)};var n={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","urn:schemas-microsoft-com:vml":"v","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:office:word":"office-word"};function read(e){return t.readString(e,n).then((function(e){return collapseAlternateContent(e)[0]}))}function stripUtf8Bom(e){return e.replace(/^\uFEFF/g,"")}function collapseAlternateContent(r){return"element"===r.type?"mc:AlternateContent"===r.name?r.first("mc:Fallback").children:(r.children=e.flatten(r.children.map(collapseAlternateContent,!0)),[r]):[r]}