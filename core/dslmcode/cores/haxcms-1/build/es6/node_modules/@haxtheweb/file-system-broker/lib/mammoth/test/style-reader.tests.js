var e=require("assert"),t=require("../lib/styles/html-paths"),a=require("../lib/styles/document-matchers"),r=require("../lib/style-reader"),s=require("../lib/results"),n=require("./test")(module),l=r.readHtmlPath,c=r.readDocumentMatcher,i=r.readStyle;function assertHtmlPath(t,a){e.deepEqual(l(t),s.success(a))}function assertDocumentMatcher(t,a){e.deepEqual(c(t),s.success(a))}function assertStyleMapping(t,a){e.deepEqual(i(t),s.success(a))}n("styleReader.readHtmlPath",{"reads empty path":function(){assertHtmlPath("",t.empty)},"reads single element":function(){assertHtmlPath("p",t.elements(["p"]))},"reads choice of elements":function(){assertHtmlPath("ul|ol",t.elements([t.element(["ul","ol"])]))},"reads nested elements":function(){assertHtmlPath("ul > li",t.elements(["ul","li"]))},"reads class on element":function(){assertHtmlPath("p.tip",t.elements([t.element("p",{class:"tip"})]))},"reads class with escaped colon":function(){assertHtmlPath("p.a\\:b",t.elements([t.element("p",{class:"a:b"})]))},"reads multiple classes on element":function(){assertHtmlPath("p.tip.help",t.elements([t.element("p",{class:"tip help"})]))},"reads when element must be fresh":function(){assertHtmlPath("p:fresh",t.elements([t.element("p",{},{fresh:!0})]))},"reads separator for elements":function(){assertHtmlPath("p:separator('x')",t.elements([t.element("p",{},{separator:"x"})]))},"reads separator with escape sequence":function(){assertHtmlPath("p:separator('\\r\\n\\t\\'\\\\')",t.elements([t.element("p",{},{separator:"\r\n\t'\\"})]))},"reads ignore element":function(){assertHtmlPath("!",t.ignore)}}),n("styleReader.readDocumentMatcher",{"reads plain paragraph":function(){assertDocumentMatcher("p",a.paragraph())},"reads paragraph with style ID":function(){assertDocumentMatcher("p.Heading1",a.paragraph({styleId:"Heading1"}))},"reads paragraph with exact style name":function(){assertDocumentMatcher("p[style-name='Heading 1']",a.paragraph({styleName:a.equalTo("Heading 1")}))},"reads paragraph with style name prefix":function(){assertDocumentMatcher("p[style-name^='Heading']",a.paragraph({styleName:a.startsWith("Heading")}))},"reads p:ordered-list(1) as ordered list with index of 0":function(){assertDocumentMatcher("p:ordered-list(1)",a.paragraph({list:{isOrdered:!0,levelIndex:0}}))},"reads p:unordered-list(1) as unordered list with index of 0":function(){assertDocumentMatcher("p:unordered-list(1)",a.paragraph({list:{isOrdered:!1,levelIndex:0}}))},"reads plain run":function(){assertDocumentMatcher("r",a.run())},"reads plain table":function(){assertDocumentMatcher("table",a.table())},"reads table with style ID":function(){assertDocumentMatcher("table.TableNormal",a.table({styleId:"TableNormal"}))},"reads table with style name":function(){assertDocumentMatcher("table[style-name='Normal Table']",a.table({styleName:a.equalTo("Normal Table")}))},"reads bold":function(){assertDocumentMatcher("b",a.bold)},"reads italic":function(){assertDocumentMatcher("i",a.italic)},"reads underline":function(){assertDocumentMatcher("u",a.underline)},"reads strikethrough":function(){assertDocumentMatcher("strike",a.strikethrough)},"reads all-caps":function(){assertDocumentMatcher("all-caps",a.allCaps)},"reads small-caps":function(){assertDocumentMatcher("small-caps",a.smallCaps)},"reads comment-reference":function(){assertDocumentMatcher("comment-reference",a.commentReference)},"reads line breaks":function(){assertDocumentMatcher("br[type='line']",a.lineBreak)},"reads page breaks":function(){assertDocumentMatcher("br[type='page']",a.pageBreak)},"reads column breaks":function(){assertDocumentMatcher("br[type='column']",a.columnBreak)}}),n("styleReader.read",{"document matcher is mapped to HTML path using arrow":function(){assertStyleMapping("p => h1",{from:a.paragraph(),to:t.elements(["h1"])})},"reads style mapping with no HTML path":function(){assertStyleMapping("r =>",{from:a.run(),to:t.empty})},"error when not all input is consumed":function(){e.deepEqual(i("r => span a"),new s.Result(null,[s.warning("Did not understand this style mapping, so ignored it: r => span a\nError was at character number 10: Expected end but got whitespace")]))}});