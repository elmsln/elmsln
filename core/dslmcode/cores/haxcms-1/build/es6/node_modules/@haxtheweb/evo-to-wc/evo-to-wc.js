/**
 * Copyright 2018 Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
export class EvoToWc{get courseicons(){return{assessment:"assessment",brainstorm:"lightbulb-outline",casestudy:"work",discussion:"question-answer",email:"mail",game:"hardware:videogame-asset",group:"social:group",handson:"pan-tool",image:"image:image",mobile:"hardware:phone-android",presentation:"device:dvr",reading:"chrome-reader-mode",reflection:"lightbulb-outline",rss:"mdi-social:rss-box",selfcheck:"assignment-turned-in",survey:"assignment",transcript:"receipt",video:"av:movie",webresource:"language",written:"create",yammer:"lrn:assessment"}}get headings(){return["h1","h2","h3","h4","h5","h6"]}constructor(){}convert(e=globalThis.document.body){this.convertIfNeeded(e,[{selector:".coursework",function:"convertIcons"},{selector:".graphme",function:"convertGraphmes"},{selector:".tablestyle,.tablestyle2,.tablestyle3",function:"convertTablestyles"},{selector:".tabbed-interface",function:"convertTabs"},{selector:".expandable,.accordion-interface",function:"convertCollapses"},{selector:"figure",function:"convertFigures"},{selector:"img.gif-player",function:"convertGifs"},{selector:".image-thumbnail, .dynamic-image-group,.wcslideplayer, .clickable-list",function:"convertGalleries"},{selector:".newcolorbox,.colorbox,.pulltext,.yellownote,.speechbubble",function:"convertCards"}])}convertIfNeeded(e,t=[]){t.forEach((t=>{let l=e.querySelectorAll(t.selector);l.length>0&&this[t.function](l,e)}))}convertAccordions(e=[]){import("../a11y-collapse/lib/a11y-collapse-group.js"),e.forEach((e=>{let t,l=globalThis.document.createElement("a11y-collapse-group"),o=[...e.childNodes];l.radio=!0,l.headingButton=!0,o.forEach((e=>{this.isHeading(e)?(t=globalThis.document.createElement("a11y-collapse"),e.slot="heading",t.headingButton=!0,t.append(e),l.append(t)):t&&t.append(e)})),e.parentElement.insertBefore(l,e),e.remove()}))}convertCards(e=[],t){import("../accent-card/accent-card.js"),this.convertIfNeeded(t,[{selector:".newcolorbox",function:"convertNewcolorboxes"},{selector:".colorbox",function:"convertColorboxes"},{selector:".pulltext",function:"convertPulltexts"},{selector:".yellownote",function:"convertYellownotes"},{selector:".speechbubble",function:"convertSpeechbubbles"}])}convertCarousels(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("lrndesign-gallery"),l=e.querySelectorAll("figure");t.layout="carousel",t.accentColor="light-blue",l.forEach((e=>t.append(this.slotGallery(e)))),e.parentNode.insertBefore(t,e),e.remove()}))}convertCollapses(e=[],t){import("../a11y-collapse/a11y-collapse.js"),this.convertIfNeeded(t,[{selector:".expandable",function:"convertExpandables"},{selector:".accordion-interface",function:"convertAccordions"}])}convertColorboxes(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("accent-card");t.accentColor="light-blue",this.replace(e,t,this.slotAccentCard)}))}convertExpandables(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("a11y-collapse"),l=e.querySelector(".collapseable")?[...e.querySelector(".collapseable").childNodes]:[],o=e.querySelector(".expandcollapse"),r=globalThis.document.createElement("span");for((o?[...o.childNodes]:[]).forEach((e=>r.append(e))),o.parentNode.insertBefore(r,o);r.parentNode&&r.parentNode!==e;)r=r.parentNode;r.slot="heading",t.headingButton=!0,t.append(r),l.forEach((e=>t.append(e))),e.parentNode.insertBefore(t,e),e.remove()}))}convertFigures(e=[]){import("../a11y-figure/a11y-figure.js"),e.forEach((e=>{let t,l,o,r=e.querySelector("figcaption"),a=globalThis.document.createElement("a11y-figure"),n=e.querySelector("img");r&&e.classList.contains("image-info")&&(t=[...r.childNodes],this.setSize(n,a),l=globalThis.document.createElement("details"),o=globalThis.document.createElement("summary"),o.innerHTML="info",l.append(o),t.forEach((e=>l.append(e))),r.append(l),e.classList.remove("image-info")),e.parentElement.insertBefore(a,e),a.append(e)}))}convertGifs(e=[]){import("../a11y-gif-player/a11y-gif-player.js"),e.forEach((e=>{let t=globalThis.document.createElement("a11y-gif-player"),l=e.src||"";this.setSize(e,t),this.setSize(e,t,"height"),t.src=l,t.srcWithoutAnimation=l.replace(/\.\w+$/,".gif"),e.parentElement.insertBefore(t,e),e.remove()}))}convertGalleries(e=[],t){this.convertIfNeeded(t,[{selector:".image-thumbnail",function:"convertThumbnails"},{selector:".dynamic-image-group,.wcslideplayer",function:"convertCarousels"},{selector:".clickable-list",function:"convertImageLists"}])}convertGraphmes(e=[]){import("../lrndesign-chart/lib/lrndesign-bar.js"),import("../lrndesign-chart/lib/lrndesign-line.js"),import("../lrndesign-chart/lib/lrndesign-pie.js"),e.forEach((e=>{["bar","line","pie"].forEach((t=>this.insertChart(e,t))),e.classList.contains("showtable")||e.remove(),e.classList.remove("graphme")}))}convertIcons(e,t){import("../hax-iconset/lib/simple-hax-iconset.js"),import("../simple-icon/lib/simple-icon-lite.js"),import("../simple-icon/lib/simple-icons.js"),Object.keys(this.courseicons).forEach((e=>{t.querySelectorAll(`.coursework.${e}`).forEach((t=>{let l=t.firstElementChild,o=globalThis.document.createElement("simple-icon-lite");o.icon=this.courseicons[e],o.style.marginRight="0.25em",l.insertBefore(o,l.firstChild),t.classList.remove("coursework"),t.classList.remove(e)}))}))}convertImageLists(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("lrndesign-gallery"),l=e.querySelectorAll("li");t.layout="grid",t.accentColor="light-blue",l.forEach((e=>t.append(this.slotGallery(e)))),e.parentNode.insertBefore(t,e),e.remove()}))}convertNewcolorboxes(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("accent-card");t.noBorder=!0,t.flat=!0,this.replace(e,t,this.slotAccentCard)}))}convertPulltexts(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("accent-card");t.accentColor="light-blue",t.horizontal=!0,this.replace(e,t,this.slotAccentCard)}))}convertSpeechbubbles(e=[]){e.forEach((e=>{let t=globalThis.document.createElement("accent-card"),l=e.nextElementSibling;t.accentColor="light-blue",t.horizontal=!0,this.replace(e,t,this.slotAccentCard),l.classList.contains("speechbubble-caption")&&(l.slot="footer",l.style.fontSize="85%",l.classList.remove("speechbubble-caption"),t.append(l),l.style.textAlign="right")}))}convertTabs(e=[]){import("../a11y-tabs/a11y-tabs.js"),e.forEach((e=>{let t=globalThis.document.createElement("a11y-tabs");this.replace(e,t,this.slotTabs.bind(this))}))}convertTablestyles(e){import("../editable-table/editable-table.js"),e.forEach((e=>{let t=globalThis.document.createElement("editable-table");t.bordered=e.classList.contains("dottedrows")||e.classList.contains("dottedcols")||e.classList.contains("linedrows")||e.classList.contains("linedcols"),t.columnStriped=e.classList.contains("alternatecols"),t.striped=!t.columnStriped&&e.classList.contains("alternaterows"),e.parentElement.insertBefore(t,e),e.classList.remove("tablestyle"),e.classList.remove("tablestyle2"),e.classList.remove("tablestyle3"),t.append(e)}))}convertThumbnails(e){e.forEach((e=>{let t=globalThis.document.createElement("lrndesign-gallery"),l=e.src,o=l.match("_thumb.")?l:void 0,r=o?o.replace(/_thumb\./,"_full."):void 0;t.innerHTML=`<figure><img src="${l}" ></figure>`,parent=e.parentElement,t.layout="masonry",t.accentColor="light-blue",t.sources=[{alt:e.alt||"",details:"",src:l,thumbnail:o,large:r,sizing:"contain",title:e.alt||""}],t.style.display="inline-block",t.style.width="50%",t.style.minWidth="400px",t.style.maxWidth="800px",e.parentNode.insertBefore(t,e),e.remove(),parent&&"figure"==parent.tagName.toLowerCase()&&(parent.style.display="flex",parent.style.flexDirection="column",parent.style.alignItems="stretch")}))}convertYellownotes(e){e.forEach((e=>{let t=globalThis.document.createElement("accent-card");t.accentColor="yellow",t.accentBackground=!0,t.noBorder=!0,this.replace(e,t,this.slotAccentCard)}))}insertChart(e,t="bar"){let l=globalThis.document.createElement("table"),o=e.classList.contains(`${t}chart`)?globalThis.document.createElement(`lrndesign-${t}`):void 0;o&&(o.scale="ct-octave",[...e.childNodes].forEach((e=>l.append(e.cloneNode(!0)))),o.append(l),"pie"!==t&&(o.showGridBackground=!0),"line"===t&&(o.fullWidth=!0),e.parentNode.insertBefore(o,e))}isHeading(e){return e&&e.tagName&&this.headings.includes(e.tagName.toLowerCase())}replace(e,t,l){return e.parentElement.insertBefore(t,e),[...e.childNodes].forEach((e=>{(e=l?l(e):e)&&t.append(e)})),e.remove(),t}setSize(e,t,l="width"){let o=`${e[l]}`;o&&(o.match(/\d$/)&&(o=`${o}px`),t.style[l]=o)}slotAccentCard(e){if(e&&e.tagName)this.isHeading(e)?e.slot="heading":e.slot="content";else{let t=globalThis.document.createElement("span");t.append(e),t.slot="content",e=t}return e}slotGallery(e){let t=globalThis.document.createElement("figure"),l=globalThis.document.createElement("figcaption"),o=e.firstElementChild.querySelector("img")||e.querySelector("img"),r=e.querySelector("figcaption")?[...e.querySelector("figcaption").childNodes]:[...e.childNodes],a=e.querySelector(this.headings.join());return o&&(o.removeAttribute("width"),o.removeAttribute("height"),t.append(o)),a||(a=globalThis.document.createElement("h3"),o&&(a.innerHTML=o.alt)),l.append(a),r.forEach((t=>{t!=e.firstElementChild&&l.append(t)})),t.append(l),t}slotTabs(e){if(e&&e.tagName){let t=globalThis.document.createElement("a11y-tab");if(t.id=e.id,e.firstElementChild)e.firstElementChild.slot="label",t.append(e.firstElementChild);else if(e.firstChild){let l=globalThis.document.createElement("span");l.slot="label",l.append(e),t.append(l)}else t.label=t.id;return this.replace(e,t),t}return!1}}globalThis.EvoToWc=globalThis.EvoToWc||{},globalThis.EvoToWc.requestAvailability=()=>(globalThis.EvoToWc.instance||(globalThis.EvoToWc.instance=new EvoToWc),globalThis.dispatchEvent(new CustomEvent("register-hax-converter",{bubbles:!0,composed:!0,cancelable:!0,detail:globalThis.EvoToWc.instance.convert})),globalThis.EvoToWc.instance);export const EvoToWcConverter=globalThis.EvoToWc.requestAvailability();