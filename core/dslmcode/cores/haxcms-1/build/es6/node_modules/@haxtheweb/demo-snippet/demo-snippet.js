/**
 * Copyright 2025 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 *
 * Inspired by @polymer version, updated for lit, DDD,
 * dark mode and to leverage the HAX ecosystem.
 */
import{LitElement as e,html as t,css as o}from"../../lit/index.js";import{DDDSuper as d}from"../d-d-d/d-d-d.js";import"../code-sample/code-sample.js";class DemoSnippet extends(d(e)){static get tag(){return"demo-snippet"}static get properties(){return{_markdown:{type:String}}}static get styles(){return[o`
        :host {
          display: block;
          border-radius: var(--ddd-radius-sm);
          overflow: hidden;
          box-shadow: var(--ddd-boxShadow-sm);
          margin: var(--ddd-spacing-10) auto;
          transition: all 0.3s ease-in-out;
        }

        :host(:hover),
        :host(:focus-within) {
          box-shadow: var(--ddd-boxShadow-lg);
        }

        .demo {
          display: block;
          border-bottom: var(--ddd-border-xs);
          border-color: light-dark(
            var(--ddd-theme-default-limestoneLight),
            var(--ddd-theme-default-coalyGray)
          );
          background-color: light-dark(
            var(--ddd-theme-default-limestoneLight),
            var(--ddd-theme-default-potentialMidnight)
          );
          margin: 0;
          padding: var(--ddd-spacing-5);
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
          :host {
            border: 2px solid;
          }

          .demo {
            border-bottom-width: 2px;
          }
        }

        /* Code sample styling */
        code-sample {
          margin: 0;
          border-radius: 0;
        }
      `]}render(){return t`
      <div class="demo">
        <slot id="content" @slotchange="${this._onSlotChange}"></slot>
      </div>

      <code-sample id="codeDisplay" type="html" copy-clipboard-button>
        <template></template>
      </code-sample>
    `}constructor(){super(),this._markdown="",this._observer=null}firstUpdated(){super.firstUpdated(),this.updateComplete.then((()=>{this._updateMarkdown()}))}updated(e){super.updated(e),e.has("_markdown")&&this._markdown&&this._updateCodeSample()}disconnectedCallback(){super.disconnectedCallback(),this._observer&&(this._observer.disconnect(),this._observer=null)}_onSlotChange(){this._updateMarkdown()}_updateMarkdown(){const e=this.shadowRoot.querySelector("#content");if(!e)return;const t=e.assignedNodes({flatten:!0}).find((e=>e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.tagName));if(!t)return void(this._markdown="");let o=t.innerHTML;if(o=this._unindent(o),o=o.replace(/ class=""/g,""),o=o.replace(/=""/g,""),this._markdown=o,!t.hasAttribute("is")){const e=document.importNode(t.content,!0),o=this.shadowRoot.querySelector(".demo slot");if(o){o.parentNode.appendChild(e)}}this.dispatchEvent(new CustomEvent("dom-ready",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}_updateCodeSample(){const e=this.shadowRoot.querySelector("#codeDisplay");if(!e)return;const t=e.querySelector("template");t&&e.removeChild(t);const o=document.createElement("template");o.setAttribute("preserve-content","preserve-content"),o.innerHTML=this._markdown,e.appendChild(o)}_unindent(e){if(!e)return"";const t=e.split("\n");for(;t.length&&""===t[0].trim();)t.shift();for(;t.length&&""===t[t.length-1].trim();)t.pop();if(0===t.length)return"";let o=1/0;return t.forEach((e=>{if(e.trim()){const t=e.match(/^(\s*)/);t&&(o=Math.min(o,t[1].length))}})),o===1/0&&(o=0),t.map((e=>e.substring(o))).join("\n")}}globalThis.customElements.define(DemoSnippet.tag,DemoSnippet);export{DemoSnippet};