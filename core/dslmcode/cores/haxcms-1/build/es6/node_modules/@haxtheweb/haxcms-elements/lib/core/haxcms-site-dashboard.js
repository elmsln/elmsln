/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html as t,css as e}from"../../../../lit/index.js";import{store as o}from"./haxcms-site-store.js";import{autorun as i,toJS as s}from"../../../../mobx/dist/mobx.esm.js";import"../../../simple-tooltip/simple-tooltip.js";import"../../../simple-fields/lib/simple-fields-form.js";import"../../../simple-icon/simple-icon.js";import"../../../simple-icon/lib/simple-icons.js";import"../../../simple-icon/lib/simple-icon-button.js";import{HaxUiBaseStyles as a}from"../../../hax-body/lib/hax-ui-styles.js";import{HaxSchematizer as r,HaxElementizer as d}from"../../../hax-body-behaviors/lib/HAXFields.js";import{SimpleColors as l}from"../../../simple-colors/simple-colors.js";class HAXCMSSiteDashboard extends l{static get tag(){return"haxcms-site-dashboard"}constructor(){super(),this.siteTitle="",this.method="POST",this.loadEndpoint="",this.body={},this.headers={},this.__disposer=[],i((t=>{this.jwt=s(o.jwt),this.__disposer.push(t)})),i((t=>{this.siteTitle=s(o.siteTitle),this.__disposer.push(t)}))}static get styles(){return[a,e`
        :host {
          z-index: 1;
          display: block;
          border-right: 2px solid #17271f;
          overflow: scroll;
          color: black;
        }
        .buttons {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          display: flex;
        }
        button.hax-modal-btn {
          font-size: var(--ddd-font-size-s);
          padding: var(--ddd-spacing-3) var(--ddd-spacing-5);
          margin: var(--ddd-spacing-2);
          color: white;
          background-color: var(--ddd-theme-default-skyBlue);
          border: 2px solid var(--ddd-theme-default-navy);
          border-radius: var(--ddd-radius-sm);
          font-family: var(--ddd-font-navigation);
          cursor: pointer;
          transition: background-color 0.3s ease;
        }
        button.hax-modal-btn.cancel {
          background-color: var(--ddd-theme-default-original87Pink);
        }
        button.hax-modal-btn:hover,
        button.hax-modal-btn:focus {
          outline: 2px solid var(--ddd-theme-default-keystoneYellow);
          background-color: var(--ddd-theme-default-nittanyNavy);
        }
        button.hax-modal-btn.cancel:hover,
        button.hax-modal-btn.cancel:focus {
          background-color: var(--ddd-theme-default-error);
        }
        @media screen and (max-width: 600px) {
          button.hax-modal-btn {
            font-size: var(--ddd-font-size-xs);
            padding: var(--ddd-spacing-2) var(--ddd-spacing-3);
          }
        }
        button {
          background-color: white;
          color: black;
        }
        .fields-wrapper {
          height: auto;
          background-color: white;
        }
        #siteform {
          --a11y-tabs-height: 65vh;
          --a11y-tabs-tab-height: 60vh;
          --primary-color: var(--haxcms-color, #000000);
          --paper-input-container-focus-color: var(--haxcms-color, #000000);
          --lumo-primary-text-color: var(--haxcms-color, #000000);
          --a11y-tabs-color: var(--haxcms-color, #000000);
          --a11y-tabs-focus-color: var(--haxcms-color, #000000);
          color: var(--hax-ui-color);
          --simple-fields-color: var(--hax-ui-color);
        }
      `]}render(){return t`
      <div class="fields-wrapper">
        <simple-fields-form
          id="siteform"
          .headers="${this.headers}"
          .body="${this.body}"
          .schematizer="${r}"
          .elementizer="${d}"
          load-endpoint="${this.loadEndpoint}"
          @simple-fields-form-data-loaded="${this.fieldDataLoaded}"
          method="${this.method}"
        ></simple-fields-form>
      </div>
      <div class="buttons">
        <button class="hax-modal-btn" @click="${this._saveSiteFieldsTap}">
          Save
        </button>
        <button class="hax-modal-btn cancel" @click="${this._cancel}">
          cancel
        </button>
      </div>
    `}static get properties(){return{...super.properties,loadEndpoint:{type:String,attribute:"load-endpoint"},headers:{type:Object},body:{type:Object},method:{type:String},jwt:{type:String},publishing:{type:Boolean},siteTitle:{type:String}}}disconnectedCallback(){for(var t in this.__disposer)this.__disposer[t].dispose();super.disconnectedCallback()}fieldDataLoaded(){const t=o.getManifestItems(!0);var e=[];t.forEach((o=>{if(o.id!=this.itemId){let i=o,s="- ";for(;i&&null!=i.parent;)i=t.find((t=>t.id==i.parent)),i&&(s="--"+s);e.push({text:s+o.title,value:o.id})}})),requestAnimationFrame((()=>{const t=this.shadowRoot.querySelector("#siteform").fields;t.find((t=>"manifest"===t.property)).properties.find((t=>"theme"===t.property)).properties.find((t=>"regions"===t.property)).properties.map((t=>{"array"===t.inputMethod&&(t.properties[0].itemsList=e)}));const o=t.find((t=>"manifest"===t.property)).properties.find((t=>"site"===t.property));if(o&&o.properties){const t=o.properties.find((t=>"manifest-metadata-site-homePageId"===t.property));if(t){const o={"":"-- default to first page --"};e.forEach((t=>{o[t.value]=t.text})),t.options=o}}setTimeout((()=>{this.shadowRoot.querySelector("#siteform").fields=[...t],requestAnimationFrame((()=>{this.shadowRoot.querySelector("#siteform").requestUpdate()}))}),0)}))}generateRequest(){this.shadowRoot.querySelector("#siteform").loadData()}_saveSiteFieldsTap(t){o.playSound("click"),globalThis.dispatchEvent(new CustomEvent("haxcms-save-site-data",{bubbles:!0,composed:!0,cancelable:!0,detail:this.shadowRoot.querySelector("#siteform").submit()})),setTimeout((()=>{globalThis.dispatchEvent(new CustomEvent("simple-modal-hide",{bubbles:!0,cancelable:!0,detail:{}}))}),0)}_cancel(t){o.playSound("error"),globalThis.dispatchEvent(new CustomEvent("simple-modal-hide",{bubbles:!0,cancelable:!0,detail:{}}))}}globalThis.customElements.define(HAXCMSSiteDashboard.tag,HAXCMSSiteDashboard);export{HAXCMSSiteDashboard};