import{getTabbableElements as e}from"./chunk.2NHP677Q.js";var t=[],n=class{constructor(t){this.tabDirection="forward",this.handleFocusIn=()=>{this.checkFocus()},this.handleKeyDown=t=>{var n;if("Tab"!==t.key)return;t.shiftKey?this.tabDirection="backward":this.tabDirection="forward",t.preventDefault();const s=e(this.element),i=s[0];let c=this.currentFocusIndex;if(-1===c)return this.currentFocus=i,void this.currentFocus.focus({preventScroll:!0});const r="forward"===this.tabDirection?1:-1;c+r>=s.length?c=0:this.currentFocusIndex+r<0?c=s.length-1:c+=r,this.currentFocus=s[c],null==(n=this.currentFocus)||n.focus({preventScroll:!0}),setTimeout((()=>this.checkFocus()))},this.handleKeyUp=()=>{this.tabDirection="forward"},this.element=t}activate(){t.push(this.element),document.addEventListener("focusin",this.handleFocusIn),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}deactivate(){t=t.filter((e=>e!==this.element)),this.currentFocus=null,document.removeEventListener("focusin",this.handleFocusIn),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}isActive(){return t[t.length-1]===this.element}checkFocus(){if(this.isActive()){const t=e(this.element);if(!this.element.matches(":focus-within")){const e=t[0],n=t[t.length-1],s="forward"===this.tabDirection?e:n;"function"==typeof(null==s?void 0:s.focus)&&(this.currentFocus=s,s.focus({preventScroll:!0}))}}}get currentFocusIndex(){return e(this.element).findIndex((e=>e===this.currentFocus))}};export{n as Modal};