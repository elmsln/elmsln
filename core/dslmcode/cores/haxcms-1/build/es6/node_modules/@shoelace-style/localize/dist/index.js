const t=new Set,e=new MutationObserver(update),n=new Map;let a,r=document.documentElement.dir||"ltr",o=document.documentElement.lang||navigator.language;e.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]});export function registerTranslation(...t){t.map((t=>{const e=t.$code.toLowerCase();n.has(e)?n.set(e,Object.assign(Object.assign({},n.get(e)),t)):n.set(e,t),a||(a=t)})),update()}export function update(){r=document.documentElement.dir||"ltr",o=document.documentElement.lang||navigator.language,[...t.keys()].map((t=>{"function"==typeof t.requestUpdate&&t.requestUpdate()}))}export class LocalizeController{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){t.add(this.host)}hostDisconnected(){t.delete(this.host)}dir(){return`${this.host.dir||r}`.toLowerCase()}lang(){return`${this.host.lang||o}`.toLowerCase()}getTranslationData(t){var e,a;const r=new Intl.Locale(t.replace(/_/g,"-")),o=null==r?void 0:r.language.toLowerCase(),l=null!==(a=null===(e=null==r?void 0:r.region)||void 0===e?void 0:e.toLowerCase())&&void 0!==a?a:"";return{locale:r,language:o,region:l,primary:n.get(`${o}-${l}`),secondary:n.get(o)}}exists(t,e){var n;const{primary:r,secondary:o}=this.getTranslationData(null!==(n=e.lang)&&void 0!==n?n:this.lang());return e=Object.assign({includeFallback:!1},e),!!(r&&r[t]||o&&o[t]||e.includeFallback&&a&&a[t])}term(t,...e){const{primary:n,secondary:r}=this.getTranslationData(this.lang());let o;if(n&&n[t])o=n[t];else if(r&&r[t])o=r[t];else{if(!a||!a[t])return console.error(`No translation found for: ${String(t)}`),String(t);o=a[t]}return"function"==typeof o?o(...e):o}date(t,e){return t=new Date(t),new Intl.DateTimeFormat(this.lang(),e).format(t)}number(t,e){return t=Number(t),isNaN(t)?"":new Intl.NumberFormat(this.lang(),e).format(t)}relativeTime(t,e,n){return new Intl.RelativeTimeFormat(this.lang(),n).format(t,e)}}