import{clamp as e}from"./chunk.HF7GESMZ.js";import{AutoplayController as t}from"./chunk.F4VGSDIW.js";import{carousel_styles_default as i}from"./chunk.4DOW4ZG2.js";import{ScrollController as s}from"./chunk.VTZVPCX4.js";import{SlCarouselItem as o}from"./chunk.2B7ZRWV6.js";import{prefersReducedMotion as r}from"./chunk.W5IOVX7A.js";import{LocalizeController as a}from"./chunk.2A3352EO.js";import{SlIcon as l}from"./chunk.M4HIRIJ5.js";import{watch as n}from"./chunk.C7FWPEOY.js";import{ShoelaceElement as c}from"./chunk.Z7XDKKOD.js";import{__decorateClass as h}from"./chunk.6M63UXML.js";import{classMap as d}from"../../../../lit/directives/class-map.js";import{html as p}from"../../../../lit/index.js";import{map as g}from"../../../../lit/directives/map.js";import{property as u,query as v,state as m}from"../../../../lit/decorators.js";import{range as b}from"../../../../lit/directives/range.js";var y=class extends c{constructor(){super(...arguments),this.loop=!1,this.navigation=!1,this.pagination=!1,this.autoplay=!1,this.autoplayInterval=3e3,this.slidesPerPage=1,this.slidesPerMove=1,this.orientation="horizontal",this.mouseDragging=!1,this.activeSlide=0,this.autoplayController=new t(this,(()=>this.next())),this.scrollController=new s(this),this.slides=this.getElementsByTagName("sl-carousel-item"),this.intersectionObserverEntries=new Map,this.localize=new a(this),this.handleSlotChange=e=>{e.some((e=>[...e.addedNodes,...e.removedNodes].some((e=>o.isCarouselItem(e)&&!e.hasAttribute("data-clone")))))&&this.initializeSlides(),this.requestUpdate()}}connectedCallback(){super.connectedCallback(),this.setAttribute("role","region"),this.setAttribute("aria-label",this.localize.term("carousel"));const e=new IntersectionObserver((e=>{e.forEach((e=>{this.intersectionObserverEntries.set(e.target,e);const t=e.target;t.toggleAttribute("inert",!e.isIntersecting),t.classList.toggle("--in-view",e.isIntersecting),t.setAttribute("aria-hidden",e.isIntersecting?"false":"true")}))}),{root:this,threshold:.6});this.intersectionObserver=e,e.takeRecords().forEach((e=>{this.intersectionObserverEntries.set(e.target,e)}))}disconnectedCallback(){super.disconnectedCallback(),this.intersectionObserver.disconnect(),this.mutationObserver.disconnect()}firstUpdated(){this.initializeSlides(),this.mutationObserver=new MutationObserver(this.handleSlotChange),this.mutationObserver.observe(this,{childList:!0,subtree:!1})}getPageCount(){return Math.ceil(this.getSlides().length/this.slidesPerPage)}getCurrentPage(){return Math.ceil(this.activeSlide/this.slidesPerPage)}getSlides({excludeClones:e=!0}={}){return[...this.slides].filter((t=>!e||!t.hasAttribute("data-clone")))}handleKeyDown(e){if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key)){const t=e.target,i="rtl"===this.localize.dir(),s=null!==t.closest('[part~="pagination-item"]'),o="ArrowDown"===e.key||!i&&"ArrowRight"===e.key||i&&"ArrowLeft"===e.key,r="ArrowUp"===e.key||!i&&"ArrowLeft"===e.key||i&&"ArrowRight"===e.key;e.preventDefault(),r&&this.previous(),o&&this.next(),"Home"===e.key&&this.goToSlide(0),"End"===e.key&&this.goToSlide(this.getSlides().length-1),s&&this.updateComplete.then((()=>{var e;const t=null==(e=this.shadowRoot)?void 0:e.querySelector('[part~="pagination-item--active"]');t&&t.focus()}))}}handleScrollEnd(){const e=this.getSlides(),t=[...this.intersectionObserverEntries.values()].find((e=>e.isIntersecting));if(this.loop&&(null==t?void 0:t.target.hasAttribute("data-clone"))){const e=Number(t.target.getAttribute("data-clone"));this.goToSlide(e,"auto")}else t&&(this.activeSlide=e.indexOf(t.target))}initializeSlides(){const e=this.getSlides(),t=this.intersectionObserver;if(this.intersectionObserverEntries.clear(),this.getSlides({excludeClones:!1}).forEach(((e,i)=>{t.unobserve(e),e.classList.remove("--in-view"),e.classList.remove("--is-active"),e.setAttribute("aria-label",this.localize.term("slideNum",i+1)),e.hasAttribute("data-clone")&&e.remove()})),this.loop){const t=this.slidesPerPage,i=e.slice(-t),s=e.slice(0,t);i.reverse().forEach(((t,i)=>{const s=t.cloneNode(!0);s.setAttribute("data-clone",String(e.length-i-1)),this.prepend(s)})),s.forEach(((e,t)=>{const i=e.cloneNode(!0);i.setAttribute("data-clone",String(t)),this.append(i)}))}this.getSlides({excludeClones:!1}).forEach((e=>{t.observe(e)})),this.goToSlide(this.activeSlide,"auto")}handelSlideChange(){const e=this.getSlides();e.forEach(((e,t)=>{e.classList.toggle("--is-active",t===this.activeSlide)})),this.hasUpdated&&this.emit("sl-slide-change",{detail:{index:this.activeSlide,slide:e[this.activeSlide]}})}handleSlidesPerMoveChange(){const e=this.getSlides({excludeClones:!1}),t=this.slidesPerMove;e.forEach(((e,i)=>{Math.abs(i-t)%t==0?e.style.removeProperty("scroll-snap-align"):e.style.setProperty("scroll-snap-align","none")}))}handleAutoplayChange(){this.autoplayController.stop(),this.autoplay&&this.autoplayController.start(this.autoplayInterval)}handleMouseDraggingChange(){this.scrollController.mouseDragging=this.mouseDragging}previous(e="smooth"){let t=this.activeSlide||this.activeSlide-this.slidesPerMove,i=!1;for(;!i&&t>0;)t-=1,i=Math.abs(t-this.slidesPerMove)%this.slidesPerMove==0;this.goToSlide(t,e)}next(e="smooth"){this.goToSlide(this.activeSlide+this.slidesPerMove,e)}goToSlide(t,i="smooth"){const{slidesPerPage:s,loop:o,scrollContainer:a}=this,l=this.getSlides(),n=this.getSlides({excludeClones:!1}),c=(t+l.length)%l.length;this.activeSlide=c;const h=n[e(t+(o?s:0),0,n.length-1)],d=a.getBoundingClientRect(),p=h.getBoundingClientRect();a.scrollTo({left:p.left-d.left+a.scrollLeft,top:p.top-d.top+a.scrollTop,behavior:r()?"auto":i})}render(){const{scrollController:e,slidesPerPage:t}=this,i=this.getPageCount(),s=this.getCurrentPage(),o=this.loop||s>0,r=this.loop||s<i-1,a="ltr"===this.localize.dir();return p`
      <div part="base" class="carousel">
        <div
          id="scroll-container"
          part="scroll-container"
          class="${d({carousel__slides:!0,"carousel__slides--horizontal":"horizontal"===this.orientation,"carousel__slides--vertical":"vertical"===this.orientation})}"
          style="--slides-per-page: ${this.slidesPerPage};"
          aria-busy="${e.scrolling?"true":"false"}"
          aria-atomic="true"
          tabindex="0"
          @keydown=${this.handleKeyDown}
          @scrollend=${this.handleScrollEnd}
        >
          <slot></slot>
        </div>

        ${this.navigation?p`
              <div part="navigation" class="carousel__navigation">
                <button
                  part="navigation-button navigation-button--previous"
                  class="${d({"carousel__navigation-button":!0,"carousel__navigation-button--previous":!0,"carousel__navigation-button--disabled":!o})}"
                  aria-label="${this.localize.term("previousSlide")}"
                  aria-controls="scroll-container"
                  aria-disabled="${o?"false":"true"}"
                  @click=${o?()=>this.previous():null}
                >
                  <slot name="previous-icon">
                    <sl-icon library="system" name="${a?"chevron-left":"chevron-right"}"></sl-icon>
                  </slot>
                </button>

                <button
                  part="navigation-button navigation-button--next"
                  class=${d({"carousel__navigation-button":!0,"carousel__navigation-button--next":!0,"carousel__navigation-button--disabled":!r})}
                  aria-label="${this.localize.term("nextSlide")}"
                  aria-controls="scroll-container"
                  aria-disabled="${r?"false":"true"}"
                  @click=${r?()=>this.next():null}
                >
                  <slot name="next-icon">
                    <sl-icon library="system" name="${a?"chevron-right":"chevron-left"}"></sl-icon>
                  </slot>
                </button>
              </div>
            `:""}
        ${this.pagination?p`
              <div part="pagination" role="tablist" class="carousel__pagination" aria-controls="scroll-container">
                ${g(b(i),(e=>{const o=e===s;return p`
                    <button
                      part="pagination-item ${o?"pagination-item--active":""}"
                      class="${d({"carousel__pagination-item":!0,"carousel__pagination-item--active":o})}"
                      role="tab"
                      aria-selected="${o?"true":"false"}"
                      aria-label="${this.localize.term("goToSlide",e+1,i)}"
                      tabindex=${o?"0":"-1"}
                      @click=${()=>this.goToSlide(e*t)}
                      @keydown=${this.handleKeyDown}
                    ></button>
                  `}))}
              </div>
            `:""}
      </div>
    `}};y.styles=i,y.dependencies={"sl-icon":l},h([u({type:Boolean,reflect:!0})],y.prototype,"loop",2),h([u({type:Boolean,reflect:!0})],y.prototype,"navigation",2),h([u({type:Boolean,reflect:!0})],y.prototype,"pagination",2),h([u({type:Boolean,reflect:!0})],y.prototype,"autoplay",2),h([u({type:Number,attribute:"autoplay-interval"})],y.prototype,"autoplayInterval",2),h([u({type:Number,attribute:"slides-per-page"})],y.prototype,"slidesPerPage",2),h([u({type:Number,attribute:"slides-per-move"})],y.prototype,"slidesPerMove",2),h([u()],y.prototype,"orientation",2),h([u({type:Boolean,reflect:!0,attribute:"mouse-dragging"})],y.prototype,"mouseDragging",2),h([v("slot:not([name])")],y.prototype,"defaultSlot",2),h([v(".carousel__slides")],y.prototype,"scrollContainer",2),h([v(".carousel__pagination")],y.prototype,"paginationContainer",2),h([m()],y.prototype,"activeSlide",2),h([n("loop",{waitUntilFirstUpdate:!0}),n("slidesPerPage",{waitUntilFirstUpdate:!0})],y.prototype,"initializeSlides",1),h([n("activeSlide")],y.prototype,"handelSlideChange",1),h([n("slidesPerMove")],y.prototype,"handleSlidesPerMoveChange",1),h([n("autoplay")],y.prototype,"handleAutoplayChange",1),h([n("mouseDragging")],y.prototype,"handleMouseDraggingChange",1);export{y as SlCarousel};