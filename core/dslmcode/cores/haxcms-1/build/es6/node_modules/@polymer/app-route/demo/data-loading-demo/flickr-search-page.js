/**
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
import"../../../polymer/polymer-legacy.js";import"../../../paper-spinner/paper-spinner.js";import"../../../paper-input/paper-input.js";import"../../app-route.js";import{Polymer as e}from"../../../polymer/lib/legacy/polymer-fn.js";import{html as r}from"../../../polymer/lib/utils/html-tag.js";e({_template:r`
    <style>
      paper-spinner {
        display: block;
      }
      img {
        max-width: 200px;
        max-height: 200px;
      }
    </style>
    <app-route pattern="/" route="{{route}}" query-params="{{queryParams}}" active="{{active}}">
    </app-route>
    <paper-input autofocus label="Search the public domain on Flickr" value="{{queryParams.search}}">
    </paper-input>

    <iron-ajax auto url="https://www.flickr.com/services/rest/" handle-as="json" debounce-duration="300" params="{{params}}" last-response="{{response}}" last-error="{{error}}" loading="{{loading}}">
    </iron-ajax>
    <paper-spinner active="{{loading}}"></paper-spinner>
    <template is="dom-repeat" items="{{response.photos.photo}}" as="photo">
      <a href="{{_computeLink(photo)}}">
        <img src="{{_computeSrc(photo)}}">
      </a>
    </template>
    <template is="dom-if" if="{{error}}">
      <span>{{error.statusCode}}</span> Error:
      <pre>{{error.response}}</pre>
    </template>
`,is:"flickr-search-page",properties:{apiKey:{type:String},params:{type:Object,computed:"_computeParams(apiKey, queryParams.search)"},route:{type:Object}},observers:["_clearOldSearchResults(queryParams.search)","_setDefaultSearch(active)"],_clearOldSearchResults:function(){this.response=null},_computeParams:function(e,r){return{method:"flickr.photos.search",api_key:e,text:r,license:"7,8",format:"json",nojsoncallback:1}},_computeSrc:function(e){return e&&e.farm?"https://farm"+e.farm+".staticflickr.com/"+e.server+"/"+e.id+"_"+e.secret+".jpg":""},_computeLink:function(e){return window.location.pathname+"#/image/"+e.farm+"/"+e.server+"/"+e.id+"/"+e.secret},_setDefaultSearch:function(e){e&&!this.queryParams.search&&this.set("queryParams.search","spaceship")}});