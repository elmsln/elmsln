/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
import"../polymer/polymer-legacy.js";import{IronMeta as t}from"../iron-meta/iron-meta.js";import{Polymer as e}from"../polymer/lib/legacy/polymer-fn.js";import{dom as i}from"../polymer/lib/legacy/polymer.dom.js";e({is:"iron-iconset",properties:{src:{type:String,observer:"_srcChanged"},name:{type:String,observer:"_nameChanged"},width:{type:Number,value:0},icons:{type:String},size:{type:Number,value:24},_offsetX:{type:Number,value:0},_offsetY:{type:Number,value:0},iconNames:{type:Array,notify:!0}},hostAttributes:{style:"display: none;"},created:function(){this._meta=new t({type:"iconset",key:null,value:null})},ready:function(){this._themes=this._mapThemes()},applyIcon:function(t,e,i,o){this._validateIconMap();var n=this._getThemedOffset(e,i);t&&n&&this._addIconStyles(t,this._srcUrl,n,o||1,this.size,this.width)},removeIcon:function(t){this._removeIconStyles(t.style)},_mapThemes:function(){var t=Object.create(null);return i(this).querySelectorAll("property[theme]").forEach((function(e){var i=window.parseInt(e.getAttribute("offset-x"),10)||0,o=window.parseInt(e.getAttribute("offset-y"),10)||0;t[e.getAttribute("theme")]={offsetX:i,offsetY:o}})),t},_srcChanged:function(t){this._srcUrl=this.ownerDocument!==document?this.resolveUrl(t):t,this._prepareIconset()},_nameChanged:function(t){this._prepareIconset()},_prepareIconset:function(){this._meta.value=null,this._meta.key=this.name,this._meta.value=this,this.async((function(){this.fire("iron-iconset-added",this,{node:window})}))},_invalidateIconMap:function(){this._iconMapValid=!1},_validateIconMap:function(){this._iconMapValid||(this._recomputeIconMap(),this._iconMapValid=!0)},_recomputeIconMap:function(){this.iconNames=this._computeIconNames(this.icons),this.iconMap=this._computeIconMap(this._offsetX,this._offsetY,this.size,this.width,this.iconNames)},_computeIconNames:function(t){return t.split(/\s+/g)},_computeIconMap:function(t,e,i,o,n){var s={};if(void 0!==t&&void 0!==e){var r=t;n.forEach((function(n){s[n]={offsetX:t,offsetY:e},t+i<o?t+=i:(t=r,e+=i)}),this)}return s},_getThemedOffset:function(t,e){var i=this._getIconOffset(t),o=this._themes[e];return i&&o?{offsetX:i.offsetX+o.offsetX,offsetY:i.offsetY+o.offsetY}:i},_getIconOffset:function(t){return this.iconMap[t]||this.iconMap[this.iconNames[Number(t)]]},_addIconStyles:function(t,e,i,o,n,s){var r=t.style;r.backgroundImage="url("+e+")",r.backgroundPosition=-i.offsetX*o+"px "+-i.offsetY*o+"px",r.backgroundSize=1===o?"auto":s*o+"px",r.width=n+"px",r.height=n+"px",t.setAttribute("role","img")},_removeIconStyles:function(t){t.background=""}});