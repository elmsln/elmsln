/**
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
import"../polymer/polymer-legacy.js";import"../iron-ajax/iron-ajax.js";import e from"../../intl-messageformat/src/main.js";window.IntlMessageFormat=e;var s=Object.assign?Object.assign.bind(Object):function(e,s){for(var o in s)s.hasOwnProperty(o)&&(e[o]=s[o]);return e};export const AppLocalizeBehavior={__localizationCache:{requests:{},messages:{},ajax:null},properties:{language:{type:String},resources:{type:Object},formats:{type:Object,value:function(){return{}}},useKeyIfMissing:{type:Boolean,value:!1},localize:{type:Function,computed:"__computeLocalize(language, resources, formats)"},bubbleEvent:{type:Boolean,value:!1}},loadResources:function(e,s,o){var t=this.constructor.prototype;this.__checkLocalizationCache(t);var a,r=t.__localizationCache.ajax;function onRequestResponse(e){this.__onRequestResponse(e,s,o)}(r||(r=t.__localizationCache.ajax=document.createElement("iron-ajax")),a=t.__localizationCache.requests[e])?a.completes.then(onRequestResponse.bind(this),this.__onRequestError.bind(this)):(r.url=e,(a=r.generateRequest()).completes.then(onRequestResponse.bind(this),this.__onRequestError.bind(this)),t.__localizationCache.requests[e]=a)},__computeLocalize:function(s,o,t){var a=this.constructor.prototype;return this.__checkLocalizationCache(a),a.__localizationCache||(a.__localizationCache={requests:{},messages:{},ajax:null}),a.__localizationCache.messages={},function(){var r=arguments[0];if(r&&o&&s&&o[s]){var i=o[s][r];if(!i)return this.useKeyIfMissing?r:"";var n=r+i,c=a.__localizationCache.messages[n];c||(c=new e(i,s,t),a.__localizationCache.messages[n]=c);for(var l={},u=1;u<arguments.length;u+=2)l[arguments[u]]=arguments[u+1];return c.format(l)}}.bind(this)},__onRequestResponse:function(e,o,t){var a={},r=e.response;if(t?o?(a.resources=s({},this.resources||{}),a["resources."+o]=s(a.resources[o]||{},r)):a.resources=s(this.resources,r):o?(a.resources={},a.resources[o]=r,a["resources."+o]=r):a.resources=r,this.setProperties)this.setProperties(a);else for(var i in a)this.set(i,a[i]);this.fire("app-localize-resources-loaded",e,{bubbles:this.bubbleEvent})},__onRequestError:function(e){this.fire("app-localize-resources-error")},__checkLocalizationCache:function(e){void 0!==e&&void 0===e.__localizationCache&&(e.__localizationCache={requests:{},messages:{},ajax:null})}};