import{noChange as t}from"../lit-html.js";import{isPrimitive as e}from"../directive-helpers.js";import{AsyncDirective as s}from"../async-directive.js";import{PseudoWeakRef as i,Pauser as r}from"./private-async-helpers.js";import{directive as o}from"../directive.js";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const n=t=>!e(t)&&"function"==typeof t.then;class h extends s{constructor(){super(...arguments),this._$Cwt=1073741823,this._$Cyt=[],this._$CK=new i(this),this._$CX=new r}render(...e){var s;return null!==(s=e.find((t=>!n(t))))&&void 0!==s?s:t}update(e,s){const i=this._$Cyt;let r=i.length;this._$Cyt=s;const o=this._$CK,c=this._$CX;this.isConnected||this.disconnected();for(let t=0;t<s.length&&!(t>this._$Cwt);t++){const e=s[t];if(!n(e))return this._$Cwt=t,e;t<r&&e===i[t]||(this._$Cwt=1073741823,r=0,Promise.resolve(e).then((async t=>{for(;c.get();)await c.get();const s=o.deref();if(void 0!==s){const i=s._$Cyt.indexOf(e);i>-1&&i<s._$Cwt&&(s._$Cwt=i,s.setValue(t))}})))}return t}disconnected(){this._$CK.disconnect(),this._$CX.pause()}reconnected(){this._$CK.reconnect(this),this._$CX.resume()}}const c=o(h);export{h as UntilDirective,c as until};